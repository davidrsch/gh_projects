"use strict";(()=>{function _(u,B,R){try{let o=function(s){try{let e=/^(-?\d+(?:\.\d+)?)\.\.(-?\d+(?:\.\d+)?)$/,a=/^(<=|>=|<|>|=|==)?\s*(-?\d+(?:\.\d+)?)$/,f=e.exec(s);if(f)return{type:"range",min:Number(f[1]),max:Number(f[2])};if(f=a.exec(s),f)return{type:"comp",op:f[1]||"=",val:Number(f[2])}}catch{}return null},h=function(s){return String(s||"").replace(/[-/\\^$+?.()|[\]{}]/g,"\\$&")};var W=o,q=h;let N=String(u||"").trim();if(!N.toLowerCase())return B.map(s=>String(s&&(s.id||s.raw&&s.raw.id)));let A={};try{for(let s=0;s<R.length;s++){let e=R[s];e&&(e.name&&(A[String(e.name).toLowerCase()]=s),e.id&&(A[String(e.id).toLowerCase()]=s))}}catch{}let k={},O=/(\-?\w+):"([^"]+)"|(\-?\w+):(\S+)/g,x,S=N;for(;(x=O.exec(N))!==null;){let s=(x[1]||x[3]||"").toLowerCase(),e=x[2]||x[4]||"";if(!s)continue;let a=[];try{x[2]?a.push(String(e).toLowerCase()):String(e).split(",").map(f=>String(f||"").trim()).filter(f=>f.length>0).forEach(f=>a.push(String(f).toLowerCase()))}catch{a.push(String(e||"").toLowerCase())}k[s]=k[s]||[],k[s]=k[s].concat(a),S=S.replace(x[0]," ")}let L=S.split(/\s+/).map(s=>String(s||"").trim()).filter(s=>s.length>0).map(s=>s.toLowerCase()),v=[];for(let s=0;s<B.length;s++){let e=B[s],a=[];try{let d=e&&e.content?e.content:e&&e.raw&&e.raw.itemContent||{};d&&(d.title&&a.push(String(d.title)),d.name&&a.push(String(d.name)),d.number&&a.push(String(d.number)),d.url&&a.push(String(d.url)));let C=Array.isArray(e.fieldValues)?e.fieldValues:[];for(let E=0;E<C.length;E++){let i=C[E];if(i)try{i.type==="single_select"?i.option&&i.option.name&&a.push(String(i.option.name)):i.type==="labels"||i.type==="label"?(i.labels||[]).forEach(w=>w&&a.push(String(w.name||w))):i.type==="text"?i.text&&a.push(String(i.text)):i.type==="number"?i.number!==void 0&&a.push(String(i.number)):i.type==="issue"||i.type==="parent_issue"?(i.parent&&i.parent.title&&a.push(String(i.parent.title)),i.parent&&i.parent.number&&a.push(String(i.parent.number))):i.type==="pull_request"?i.pullRequests&&Array.isArray(i.pullRequests.nodes)&&i.pullRequests.nodes.forEach(w=>{w&&w.title&&a.push(String(w.title)),w&&w.number&&a.push(String(w.number))}):i&&i.raw&&a.push(JSON.stringify(i.raw))}catch{}}}catch{}let f=a.join(" \0 ").toLowerCase(),g=!0;for(let d in k){if(!k.hasOwnProperty(d))continue;let C=k[d]||[],E=d&&String(d).startsWith("-"),i=E?String(d).slice(1):d;for(let w=0;w<C.length;w++){let c=C[w],y=!1;try{if(i==="type"&&(e&&e.content&&(e.content.__typename||e.content.type)||e&&e.raw&&e.raw.__typename||e&&e.type||"").toString().toLowerCase().indexOf(c)!==-1&&(y=!0),!y&&i==="is"&&(e&&e.content&&e.content.state||e&&e.state||e&&e.raw&&e.raw.state||"").toString().toLowerCase().indexOf(c)!==-1&&(y=!0),!y&&i==="repo"&&(e&&e.content&&e.content.repository&&e.content.repository.nameWithOwner||e&&e.repository&&e.repository.nameWithOwner||e&&e.raw&&e.raw.itemContent&&e.raw.itemContent.repository&&e.raw.itemContent.repository.nameWithOwner||"").toString().toLowerCase().indexOf(c)!==-1&&(y=!0),!y&&(i==="has"||i==="no")){let t=String(c||"").toLowerCase(),n=A[t];if(n!=null){let r=e&&Array.isArray(e.fieldValues)&&e.fieldValues[n]||null,p=r&&(r.type==="labels"?r.labels&&r.labels.length>0:r.type==="text"?String(r.text||"").length>0:r.type==="number"?r.number!==void 0&&r.number!==null:!!(r&&(r.option||r.raw||r.parent||r.pullRequests)));i==="has"?y=!!p:y=!p}else y=f.indexOf(t)!==-1}if(!y&&A[i]!==void 0){let t=A[i],n=e&&Array.isArray(e.fieldValues)&&e.fieldValues[t]||null;if(n){let r=o(c);if(r&&(R[t]&&String(R[t].dataType||R[t].type||"").toUpperCase()==="NUMBER"||n.type==="number")){let p=null;try{n.type==="number"&&typeof n.number=="number"?p=Number(n.number):n.raw&&n.raw.value!==void 0?p=Number(n.raw.value):n.raw&&n.raw.number!==void 0&&(p=Number(n.raw.number))}catch{}if(p!==null&&!isNaN(p))if(r.type==="comp"){let l=r.op||"=",m=Number(r.val);l===">"?y=p>m:l===">="?y=p>=m:l==="<"?y=p<m:l==="<="?y=p<=m:y=p===m}else r.type==="range"&&(y=p>=Number(r.min)&&p<=Number(r.max))}else{let p=function(l){try{if(!l)return"";if(l.type==="single_select")return String(l.option&&l.option.name||"").toLowerCase();if(l.type==="labels"||l.type==="label")return(l.labels||[]).map(m=>String(m&&(m.name||m)||"")).join(" ").toLowerCase();if(l.type==="text")return String(l.text||"").toLowerCase();if(l.type==="number")return String(l.number||"").toLowerCase();if(l.type==="issue"||l.type==="parent_issue")return String(l.parent&&l.parent.title||"").toLowerCase();if(l.type==="pull_request")return(l.pullRequests&&Array.isArray(l.pullRequests.nodes)?l.pullRequests.nodes.map(m=>String(m.title||m.number||"")).join(" "):"").toLowerCase();if(l&&l.raw)return JSON.stringify(l.raw).toLowerCase()}catch{}return""}(n);if(c.indexOf("*")!==-1)try{new RegExp(h(c).replace(/\\\*/g,".*"),"i").test(p)&&(y=!0)}catch{}else p.indexOf(c)!==-1&&(y=!0)}}}if(!y)if(c.indexOf("*")!==-1)try{new RegExp(h(c).replace(/\\\*/g,".*"),"i").test(f)&&(y=!0)}catch{}else f.indexOf(c)!==-1&&(y=!0)}catch{}if(E){if(y){g=!1;break}}else if(!y){g=!1;break}}if(!g)break}if(g){for(let d=0;d<L.length;d++){let C=L[d];if(C){if(C.indexOf("*")!==-1)try{if(!new RegExp(h(C).replace(/\\\*/g,".*"),"i").test(f)){g=!1;break}}catch{g=!1;break}else if(f.indexOf(C)===-1){g=!1;break}}}g&&v.push(String(e&&(e.id||e.raw&&e.raw.id)))}}return v}catch{return B.map(b=>String(b&&(b.id||b.raw&&b.raw.id)))}}function K(u){try{let s=function(t){try{h.textContent=String(t);let n=!!(String(o.value||"").trim()||String(b||"").trim()||t);h.style.display=n?"":"none"}catch{}},d=function(){try{let n=String(o.value||"")!==String(b||"")||!!(O&&O());e.disabled=!n,a.disabled=!n;try{e.style.opacity=n?"1":"0.5",e.style.cursor=n?"pointer":"default",a.style.opacity=n?"1":"0.5",a.style.cursor=n?"pointer":"default";let r=!!(String(o.value||"").trim()||String(b||"").trim());h.style.display=r?"":"none"}catch{}}catch{}},y=function(t){try{let n=String(t||"").trim().toLowerCase();if(!n){c.style.display="none";return}let r=C.filter(p=>String(p||"").toLowerCase().includes(n));if(!r||r.length===0){c.style.display="none";return}c.innerHTML="";for(let p=0;p<Math.min(r.length,50);p++){let l=r[p],m=document.createElement("div");m.textContent=String(l),m.style.padding="6px 8px",m.style.cursor="pointer",m.style.whiteSpace="nowrap",m.style.overflow="hidden",m.style.textOverflow="ellipsis",m.addEventListener("mousedown",function(H){H.preventDefault();try{let M=String(o.value||"").split(/\s+/);M[M.length-1]=String(l);let V=M.join(" ").trim();try{o.value=V}catch{}try{o.dispatchEvent(new Event("input",{bubbles:!0}))}catch{}try{typeof u.onChange=="function"&&u.onChange(V)}catch{}try{o.focus()}catch{}}catch{}}),c.appendChild(m)}c.style.display="block"}catch{try{c.style.display="none"}catch{}}};var B=s,R=d,W=y;let q=u&&u.parent?u.parent:document.body,N=u&&u.suffix?String(u.suffix):"",b=typeof(u&&u.effFilter)=="string"?u.effFilter:"",A=u&&u.viewKey?u.viewKey:null,k=u&&u.step?Number(u.step):30,O=u&&u.layoutChangedGetter||function(){return!1},x=document.createElement("div");x.style.display="flex",x.style.justifyContent="space-between",x.style.alignItems="center",x.style.marginBottom="8px";let S=document.createElement("div");S.style.display="flex",S.style.alignItems="center",S.style.gap="8px",S.style.flex="1 1 auto",S.style.minWidth="0";let L=document.createElement("div");L.style.position="relative",L.style.flex="1 1 0",L.style.minWidth="0";let o=document.createElement("input");o.type="text",o.placeholder="Filter items...",o.style.padding="6px 36px 6px 8px",o.style.border="1px solid var(--vscode-editorWidget-border)",o.style.borderRadius="0px",o.style.width="100%",o.style.boxSizing="border-box",o.style.background="var(--vscode-input-background)",o.style.color="var(--vscode-input-foreground)",o.style.outline="none",o.setAttribute("data-filter-input",N||"");let h=document.createElement("span");h.setAttribute("data-filter-count",N||""),h.style.position="absolute",h.style.right="44px",h.style.top="50%",h.style.transform="translateY(-50%)",h.style.color="var(--vscode-descriptionForeground)",h.style.fontSize="12px",h.style.display="none";let v=document.createElement("button");v.type="button",v.textContent="\u2715",v.title="Clear filter",v.style.position="absolute",v.style.right="8px",v.style.top="50%",v.style.transform="translateY(-50%)",v.style.border="none",v.style.background="transparent",v.style.cursor="pointer",L.appendChild(o),L.appendChild(h),L.appendChild(v);let e=document.createElement("button");e.type="button",e.textContent="Save",e.style.padding="6px 8px",e.style.border="none",e.style.borderRadius="0px",e.style.background="#2ea44f",e.style.color="#ffffff",e.style.minHeight="28px",e.style.lineHeight="16px",e.disabled=!0;let a=document.createElement("button");a.type="button",a.textContent="Discard",a.style.padding="6px 8px",a.style.border="1px solid var(--vscode-editorWidget-border)",a.style.borderRadius="0px",a.style.background="transparent",a.style.color="var(--vscode-button-foreground)",a.style.minHeight="28px",a.style.lineHeight="16px",a.disabled=!0,S.appendChild(L),S.appendChild(a),S.appendChild(e);let f=document.createElement("div"),g=document.createElement("button");g.type="button",g.textContent="Load more",g.style.marginLeft="8px",g.style.border="1px solid var(--vscode-editorWidget-border)",g.style.borderRadius="0px",g.style.background="transparent",g.style.color="var(--vscode-button-foreground)",g.style.minHeight="28px",g.style.lineHeight="16px",f.appendChild(g),x.appendChild(S),x.appendChild(f),q.appendChild(x),o.addEventListener("input",d);let C=[],E=[],i=[],w=[],c=document.createElement("div");c.style.position="absolute",c.style.left="0",c.style.right="0",c.style.top="100%",c.style.zIndex="40",c.style.background="var(--vscode-editor-background)",c.style.border="1px solid var(--vscode-editorWidget-border)",c.style.display="none",c.style.maxHeight="240px",c.style.overflow="auto",c.style.boxSizing="border-box",L.appendChild(c),o.addEventListener("input",function(){try{let n=String(o.value||"").split(/\s+/).pop()||"";y(n)}catch{}}),o.addEventListener("input",function(){try{let t=String(o.value||""),n=new Set(_(t,E,i));try{typeof window.vscodeApi=="object"&&window.vscodeApi&&typeof window.vscodeApi.postMessage=="function"&&window.vscodeApi.postMessage({command:"debugLog",level:"debug",viewKey:A,message:"filterInput",data:{filter:t,matched:n.size,original:E.length}})}catch{}try{typeof s=="function"&&s(n.size)}catch{}for(let r=0;r<w.length;r++)try{w[r](n,t)}catch{}}catch{}}),o.addEventListener("blur",function(){setTimeout(()=>{try{c.style.display="none"}catch{}},150)}),v.addEventListener("click",function(){try{o.value="";try{o.dispatchEvent(new Event("input",{bubbles:!0}))}catch{}try{typeof u.onChange=="function"&&u.onChange("")}catch{}}catch{}}),e.addEventListener("click",function(){try{if(window.vscodeApi&&typeof window.vscodeApi.postMessage=="function"&&window.vscodeApi.postMessage({command:"setViewFilter",viewKey:A,filter:o.value}),b=String(o.value||""),typeof u.onSave=="function")try{u.onSave(b)}catch{}try{d()}catch{}}catch{}}),a.addEventListener("click",function(){try{if(window.vscodeApi&&typeof window.vscodeApi.postMessage=="function"&&window.vscodeApi.postMessage({command:"discardViewFilter",viewKey:A}),typeof u.onDiscard=="function")try{u.onDiscard()}catch{}try{d()}catch{}}catch{}}),g.addEventListener("click",function(){try{if(typeof u.onLoadMore=="function")return u.onLoadMore();try{window.vscodeApi&&typeof window.vscodeApi.postMessage=="function"&&window.vscodeApi.postMessage({command:"requestFields",first:k,viewKey:A})}catch{}}catch{}});try{o.value=typeof b=="string"?b:""}catch{}return d(),{headerEl:x,setCount:function(t){try{h.textContent=String(t);let n=!!(String(o.value||"").trim()||String(b||"").trim()||t);h.style.display=n?"":"none"}catch{}},setEffectiveFilter:function(t){try{b=typeof t=="string"?t:String(t||""),o.value=b,d()}catch{}},setCandidates:function(t){try{C=Array.isArray(t)?t.map(r=>String(r||"")):[];let n=String(o.value||"").split(/\s+/).pop()||"";n&&y(n)}catch{}},setLoadState:function(t,n){try{g.disabled=!t,g.textContent=n||(t?"Load more":"All loaded")}catch{}},focusInput:function(){try{o.focus()}catch{}},inputEl:o,saveBtn:e,discardBtn:a,clearBtn:v,registerItems:function(t,n){try{E=Array.isArray(t)?t.slice():[],i=n&&Array.isArray(n.fields)?n.fields:[];try{s(E.length)}catch{}}catch{}},onFilterChange:function(t){try{typeof t=="function"&&w.push(t)}catch{}}}}catch{return null}}window.filterBarHelper={create:K};})();
//# sourceMappingURL=filterBarHelper.js.map
