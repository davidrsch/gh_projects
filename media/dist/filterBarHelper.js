"use strict";(()=>{function q(d,P,G){try{let a=function(l){try{let e=/^(-?\d+(?:\.\d+)?)\.\.(-?\d+(?:\.\d+)?)$/,r=/^(<=|>=|<|>|=|==)?\s*(-?\d+(?:\.\d+)?)$/,w=e.exec(l);if(w)return{type:"range",min:Number(w[1]),max:Number(w[2])};if(w=r.exec(l),w)return{type:"comp",op:w[1]||"=",val:Number(w[2])}}catch{}return null},b=function(l){return String(l||"").replace(/[-/\\^$+?.()|[\]{}]/g,"\\$&")};var F=a,R=b;let k=String(d||"").trim();if(!k.toLowerCase())return P.map(l=>String(l&&(l.id||l.raw&&l.raw.id)));let N={};try{for(let l=0;l<G.length;l++){let e=G[l];e&&(e.name&&(N[String(e.name).toLowerCase()]=l),e.id&&(N[String(e.id).toLowerCase()]=l))}}catch{}let M={},I=/(?:(\-?[\w\-]+)|"([^"]+)"):([^\s"]+|"([^"]+)")/g,_,v=k;for(;(_=I.exec(k))!==null;){let l=(_[1]||_[2]||"").toLowerCase(),e=!!_[4],r=_[4]||_[3]||"";if(!l)continue;let w=[];try{e?w.push(String(r).toLowerCase()):String(r).split(",").map(p=>String(p||"").trim()).filter(p=>p.length>0).forEach(p=>w.push(String(p).toLowerCase()))}catch{w.push(String(r||"").toLowerCase())}M[l]=M[l]||[],M[l]=M[l].concat(w),v=v.replace(_[0]," ")}let L=v.split(/\s+/).map(l=>String(l||"").trim()).filter(l=>l.length>0).map(l=>l.toLowerCase()),C=[];for(let l=0;l<P.length;l++){let e=P[l],r=[];try{let f=e&&e.content?e.content:e&&e.raw&&e.raw.itemContent||{};f&&(f.title&&r.push(String(f.title)),f.name&&r.push(String(f.name)),f.number&&r.push(String(f.number)),f.url&&r.push(String(f.url)));let A=Array.isArray(e.fieldValues)?e.fieldValues:[];for(let E=0;E<A.length;E++){let t=A[E];if(t)try{t.type==="single_select"?t.option&&t.option.name&&r.push(String(t.option.name)):t.type==="labels"||t.type==="label"?(t.labels||[]).forEach(h=>h&&r.push(String(h.name||h))):t.type==="text"?t.text&&r.push(String(t.text)):t.type==="number"?t.number!==void 0&&r.push(String(t.number)):t.type==="issue"||t.type==="parent_issue"?(t.parent&&t.parent.title&&r.push(String(t.parent.title)),t.parent&&t.parent.number&&r.push(String(t.parent.number))):t.type==="pull_request"?t.pullRequests&&Array.isArray(t.pullRequests.nodes)&&t.pullRequests.nodes.forEach(h=>{h&&h.title&&r.push(String(h.title)),h&&h.number&&r.push(String(h.number))}):t.type==="milestone"?t.milestone&&t.milestone.title&&r.push(String(t.milestone.title)):t.type==="iteration"?t.title&&r.push(String(t.title)):t.type==="repository"?t.repositoryName&&r.push(String(t.repositoryName)):t.type==="assignees"?t.assignees&&Array.isArray(t.assignees)&&t.assignees.forEach(h=>{h.login&&r.push(String(h.login)),h.name&&r.push(String(h.name))}):t&&t.raw&&r.push(JSON.stringify(t.raw))}catch{}}}catch{}let w=r.join(" \0 ").toLowerCase(),p=!0;for(let f in M){if(!M.hasOwnProperty(f))continue;let A=M[f]||[],E=f&&String(f).startsWith("-"),t=E?String(f).slice(1):f;for(let h=0;h<A.length;h++){let u=A[h],y=!1;try{if(t==="type"&&(e&&e.content&&(e.content.__typename||e.content.type)||e&&e.raw&&e.raw.__typename||e&&e.type||"").toString().toLowerCase().indexOf(u)!==-1&&(y=!0),!y&&t==="is"&&(e&&e.content&&e.content.state||e&&e.state||e&&e.raw&&e.raw.state||"").toString().toLowerCase().indexOf(u)!==-1&&(y=!0),!y&&t==="repo"&&(e&&e.content&&e.content.repository&&e.content.repository.nameWithOwner||e&&e.repository&&e.repository.nameWithOwner||e&&e.raw&&e.raw.itemContent&&e.raw.itemContent.repository&&e.raw.itemContent.repository.nameWithOwner||"").toString().toLowerCase().indexOf(u)!==-1&&(y=!0),!y&&(t==="assignee"||t==="assignees")){let o=e&&e.content&&e.content.assignees&&e.content.assignees.nodes||(e&&e.content&&Array.isArray(e.content.assignees)?e.content.assignees:[])||(e&&Array.isArray(e.fieldValues)&&e.fieldValues.find(s=>s.type==="assignees"||s.assignees))?.assignees||[];(Array.isArray(o)?o:[]).map(s=>String(s.login||s.name||"").toLowerCase()).join(" ").includes(u)&&(y=!0)}if(!y&&t==="parent"){let o=Array.isArray(e.fieldValues)?e.fieldValues:[];for(let g=0;g<o.length;g++){let s=o[g];if(s&&(s.type==="parent_issue"||s.type==="issue")&&String(s.parent&&s.parent.title||"").toLowerCase().includes(u)){y=!0;break}}}if(!y&&(t==="has"||t==="no")){let o=String(u||"").toLowerCase(),g=N[o];if(g!=null){let s=e&&Array.isArray(e.fieldValues)&&e.fieldValues[g]||null,m=s&&(s.type==="labels"?s.labels&&s.labels.length>0:s.type==="text"?String(s.text||"").length>0:s.type==="number"?s.number!==void 0&&s.number!==null:s.type==="assignees"?s.assignees&&s.assignees.length>0:!!(s&&(s.option||s.raw||s.parent||s.pullRequests)));t==="has"?y=!!m:y=!m}else y=w.indexOf(o)!==-1}let n=N[t.toLowerCase()];if(!y&&n!==void 0){let o=n,g=e&&Array.isArray(e.fieldValues)&&e.fieldValues[o]||null;if(g){let s=a(u);if(s&&(G[o]&&String(G[o].dataType||G[o].type||"").toUpperCase()==="NUMBER"||g.type==="number")){let m=null;try{g.type==="number"&&typeof g.number=="number"?m=Number(g.number):g.raw&&g.raw.value!==void 0?m=Number(g.raw.value):g.raw&&g.raw.number!==void 0&&(m=Number(g.raw.number))}catch{}if(m!==null&&!isNaN(m))if(s.type==="comp"){let i=s.op||"=",S=Number(s.val);i===">"?y=m>S:i===">="?y=m>=S:i==="<"?y=m<S:i==="<="?y=m<=S:y=m===S}else s.type==="range"&&(y=m>=Number(s.min)&&m<=Number(s.max))}else{let m=function(i){try{return i?i.type==="single_select"?String(i.option&&i.option.name||"").toLowerCase():i.type==="labels"||i.type==="label"?(i.labels||[]).map(S=>String(S&&(S.name||S)||"")).join(" ").toLowerCase():i.type==="assignees"?(i.assignees||[]).map(S=>String(S.login||S.name||"")).join(" ").toLowerCase():i.type==="text"?String(i.text||"").toLowerCase():i.type==="number"?String(i.number||"").toLowerCase():i.type==="date"?String(i.date||"").split("T")[0].toLowerCase():i.type==="issue"||i.type==="parent_issue"?String(i.parent&&i.parent.title||"").toLowerCase():i.type==="milestone"?String(i.milestone&&i.milestone.title||"").toLowerCase():i.type==="iteration"?String(i.title||"").toLowerCase():i.type==="repository"?String(i.repositoryName||"").toLowerCase():(i.pullRequests&&Array.isArray(i.pullRequests.nodes)?i.pullRequests.nodes.map(S=>String(S.title||S.number||"")).join(" "):"").toLowerCase():""}catch{}return""}(g);if(u.indexOf("*")!==-1)try{new RegExp(b(u).replace(/\\\*/g,".*"),"i").test(m)&&(y=!0)}catch{}else m===u&&(y=!0)}}}if(!y&&!["parent","type","is","repo","has","no"].includes(t)&&N[t.toLowerCase()]===void 0)if(u.indexOf("*")!==-1)try{new RegExp(b(u).replace(/\\\*/g,".*"),"i").test(w)&&(y=!0)}catch{}else w.indexOf(u)!==-1&&(y=!0)}catch{}if(E){if(y){p=!1;break}}else if(!y){p=!1;break}}if(!p)break}if(p){for(let f=0;f<L.length;f++){let A=L[f];if(A){if(A.indexOf("*")!==-1)try{if(!new RegExp(b(A).replace(/\\\*/g,".*"),"i").test(w)){p=!1;break}}catch{p=!1;break}else if(w.indexOf(A)===-1){p=!1;break}}}p&&C.push(String(e&&(e.id||e.raw&&e.raw.id)))}}return C}catch{return P.map(x=>String(x&&(x.id||x.raw&&x.raw.id)))}}function W(d){try{let l=function(n){try{b.textContent=String(n);let c=!!(String(a.value||"").trim()||String(x||"").trim()||n);b.style.display=c?"":"none"}catch{}},f=function(){try{let c=String(a.value||"")!==String(x||"")||!!(I&&I());e.disabled=!c,r.disabled=!c;try{e.style.opacity=c?"1":"0.5",e.style.cursor=c?"pointer":"default",r.style.opacity=c?"1":"0.5",r.style.cursor=c?"pointer":"default";let o=!!(String(a.value||"").trim()||String(x||"").trim());b.style.display=o?"":"none"}catch{}}catch{}},y=function(n){try{let c=String(n||"").trim().toLowerCase();if(!c){u.style.display="none";return}let o=A.filter(g=>String(g||"").toLowerCase().includes(c));if(!o||o.length===0){u.style.display="none";return}u.innerHTML="";for(let g=0;g<Math.min(o.length,50);g++){let s=o[g],m=document.createElement("div");m.textContent=String(s),m.style.padding="6px 8px",m.style.cursor="pointer",m.style.whiteSpace="nowrap",m.style.overflow="hidden",m.style.textOverflow="ellipsis",m.addEventListener("mousedown",function(i){i.preventDefault();try{let B=String(a.value||"").split(/\s+/);B[B.length-1]=String(s);let V=B.join(" ").trim();try{a.value=V}catch{}try{a.dispatchEvent(new Event("input",{bubbles:!0}))}catch{}try{typeof d.onChange=="function"&&d.onChange(V)}catch{}try{a.focus()}catch{}}catch{}}),u.appendChild(m)}u.style.display="block"}catch{try{u.style.display="none"}catch{}}};var P=l,G=f,F=y;let R=d&&d.parent?d.parent:document.body,k=d&&d.suffix?String(d.suffix):"",x=typeof(d&&d.effFilter)=="string"?d.effFilter:"",N=d&&d.viewKey?d.viewKey:null,M=d&&d.step?Number(d.step):30,I=d&&d.layoutChangedGetter||function(){return!1},_=document.createElement("div");_.style.display="flex",_.style.justifyContent="space-between",_.style.alignItems="center",_.style.marginBottom="8px";let v=document.createElement("div");v.style.display="flex",v.style.alignItems="center",v.style.gap="8px",v.style.flex="1 1 auto",v.style.minWidth="0";let L=document.createElement("div");L.style.position="relative",L.style.flex="1 1 0",L.style.minWidth="0";let a=document.createElement("input");a.type="text",a.placeholder="Filter items...",a.style.padding="6px 36px 6px 8px",a.style.border="1px solid var(--vscode-editorWidget-border)",a.style.borderRadius="0px",a.style.width="100%",a.style.boxSizing="border-box",a.style.background="var(--vscode-input-background)",a.style.color="var(--vscode-input-foreground)",a.style.outline="none",a.setAttribute("data-filter-input",k||"");let b=document.createElement("span");b.setAttribute("data-filter-count",k||""),b.style.position="absolute",b.style.right="44px",b.style.top="50%",b.style.transform="translateY(-50%)",b.style.color="var(--vscode-descriptionForeground)",b.style.fontSize="12px",b.style.display="none";let C=document.createElement("button");C.type="button",C.textContent="\u2715",C.title="Clear filter",C.style.position="absolute",C.style.right="8px",C.style.top="50%",C.style.transform="translateY(-50%)",C.style.border="none",C.style.background="transparent",C.style.cursor="pointer",L.appendChild(a),L.appendChild(b),L.appendChild(C);let e=document.createElement("button");e.type="button",e.textContent="Save",e.style.padding="6px 8px",e.style.border="none",e.style.borderRadius="0px",e.style.background="var(--vscode-button-background, #2ea44f)",e.style.color="var(--vscode-button-foreground, #ffffff)",e.style.minHeight="28px",e.style.lineHeight="16px",e.disabled=!0;let r=document.createElement("button");r.type="button",r.textContent="Discard",r.style.padding="6px 8px",r.style.border="1px solid var(--vscode-editorWidget-border)",r.style.borderRadius="0px",r.style.background="transparent",r.style.color="var(--vscode-button-foreground)",r.style.minHeight="28px",r.style.lineHeight="16px",r.disabled=!0,v.appendChild(L),v.appendChild(r),v.appendChild(e);let w=document.createElement("div"),p=document.createElement("button");p.type="button",p.textContent="Load more",p.style.marginLeft="8px",p.style.border="1px solid var(--vscode-editorWidget-border)",p.style.borderRadius="0px",p.style.background="transparent",p.style.color="var(--vscode-button-foreground)",p.style.minHeight="28px",p.style.lineHeight="16px",w.appendChild(p),_.appendChild(v),_.appendChild(w),R.appendChild(_),a.addEventListener("input",f);let A=[],E=[],t=[],h=[],u=document.createElement("div");u.style.position="absolute",u.style.left="0",u.style.right="0",u.style.top="100%",u.style.zIndex="40",u.style.background="var(--vscode-editor-background)",u.style.border="1px solid var(--vscode-editorWidget-border)",u.style.display="none",u.style.maxHeight="240px",u.style.overflow="auto",u.style.boxSizing="border-box",L.appendChild(u),a.addEventListener("input",function(){try{let c=String(a.value||"").split(/\s+/).pop()||"";y(c)}catch{}}),a.addEventListener("input",function(){try{let n=String(a.value||""),c=new Set(q(n,E,t));try{window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"debugLog",level:"debug",viewKey:N,message:"filterInput",data:{filter:n,matched:c.size,original:E.length}})}catch{}try{typeof l=="function"&&l(c.size)}catch{}for(let o=0;o<h.length;o++)try{h[o](c,n)}catch{}}catch{}}),a.addEventListener("blur",function(){setTimeout(()=>{try{u.style.display="none"}catch{}},150)}),C.addEventListener("click",function(){try{a.value="";try{a.dispatchEvent(new Event("input",{bubbles:!0}))}catch{}try{typeof d.onChange=="function"&&d.onChange("")}catch{}}catch{}}),e.addEventListener("click",function(){try{try{window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"setViewFilter",viewKey:N,filter:a.value})}catch{}if(x=String(a.value||""),typeof d.onSave=="function")try{d.onSave(x)}catch{}try{f()}catch{}}catch{}}),r.addEventListener("click",function(){try{try{window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"discardViewFilter",viewKey:N})}catch{}if(typeof d.onDiscard=="function")try{d.onDiscard()}catch{}try{f()}catch{}}catch{}}),p.addEventListener("click",function(){try{if(typeof d.onLoadMore=="function")return d.onLoadMore();try{window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"requestFields",first:M,viewKey:N})}catch{}}catch{}});try{a.value=typeof x=="string"?x:""}catch{}return f(),{headerEl:_,setCount:function(n){try{b.textContent=String(n);let c=!!(String(a.value||"").trim()||String(x||"").trim()||n);b.style.display=c?"":"none"}catch{}},setEffectiveFilter:function(n){try{x=typeof n=="string"?n:String(n||""),a.value=x,f()}catch{}},setCandidates:function(n){try{A=Array.isArray(n)?n.map(o=>String(o||"")):[];let c=String(a.value||"").split(/\s+/).pop()||"";c&&y(c)}catch{}},setLoadState:function(n,c){try{p.disabled=!n,p.textContent=c||(n?"Load more":"All loaded")}catch{}},focusInput:function(){try{a.focus()}catch{}},inputEl:a,saveBtn:e,discardBtn:r,clearBtn:C,registerItems:function(n,c){try{E=Array.isArray(n)?n.slice():[],t=c&&Array.isArray(c.fields)?c.fields:[];try{l(E.length)}catch{}}catch{}},onFilterChange:function(n){try{typeof n=="function"&&h.push(n)}catch{}}}}catch{return null}}window.filterBarHelper={create:W};})();
//# sourceMappingURL=filterBarHelper.js.map
