{
  "version": 3,
  "sources": ["../../src/webviews/client/services/GroupDataService.ts", "../../src/webviews/client/components/FieldsMenu.ts", "../../src/webviews/client/components/GroupByMenu.ts", "../../src/webviews/client/components/SortByMenu.ts", "../../src/webviews/client/components/FieldSumMenu.ts", "../../src/webviews/client/components/AddItemMenu.ts", "../../src/webviews/client/utils.ts", "../../src/webviews/client/utils/logger.ts", "../../src/webviews/client/utils/domUtils.ts", "../../src/webviews/client/viewFetcherUtils.ts", "../../src/webviews/client/renderers/GroupRenderer.ts", "../../src/webviews/client/renderers/BoardCardRenderer.ts", "../../src/webviews/client/components/SlicePanel.ts", "../../src/webviews/client/utils/tableSorting.ts", "../../src/webviews/client/components/menuManager.ts", "../../src/webviews/client/components/ActiveTabMenu.ts", "../../src/webviews/client/components/initActiveTabMenus.ts", "../../src/webviews/client/boardViewFetcher.ts"],
  "sourcesContent": ["export class GroupDataService {\r\n  public static groupItems(items: any[], field: any): any[] {\r\n    // Normalize options: Single Select uses .options, Iteration uses .configuration.iterations\r\n    let options: any[] = [];\r\n    const dType = (field.dataType || \"\").toLowerCase();\r\n    if (dType === \"single_select\") {\r\n      options = field.options || [];\r\n    } else if (dType === \"iteration\") {\r\n      options = (field.configuration && field.configuration.iterations) || [];\r\n    }\r\n    // If we have explicit options (single select/iteration), use them to group.\r\n    if (options && options.length > 0) {\r\n      const groups: any[] = options.map((opt: any) => ({\r\n        option: opt,\r\n        items: [],\r\n      }));\r\n      const unassigned: any[] = [];\r\n\r\n      items.forEach((item, index) => {\r\n        const fv = item.fieldValues.find(\r\n          (v: any) =>\r\n            String(v.fieldId) === String(field.id) ||\r\n            v.fieldName === field.name,\r\n        );\r\n        let placed = false;\r\n\r\n        if (fv) {\r\n          // Match logic\r\n          let matchId: string | null = null;\r\n          let matchName: string | null = null;\r\n\r\n          if (dType === \"single_select\") {\r\n            matchId = fv.optionId || (fv.option && fv.option.id);\r\n            matchName = fv.name || (fv.option && fv.option.name);\r\n          } else if (dType === \"iteration\") {\r\n            matchId =\r\n              fv.iterationId || (fv.iteration && fv.iteration.id) || fv.id;\r\n            matchName = fv.title || (fv.iteration && fv.iteration.title);\r\n          }\r\n\r\n          if (matchId || matchName) {\r\n            const group = groups.find(\r\n              (g: any) =>\r\n                (matchId && String(g.option.id) === String(matchId)) ||\r\n                (matchName &&\r\n                  (String(g.option.name) === String(matchName) ||\r\n                    String(g.option.title) === String(matchName))),\r\n            );\r\n            if (group) {\r\n              group.items.push({ item, index });\r\n              placed = true;\r\n            }\r\n          }\r\n        }\r\n\r\n        if (!placed) {\r\n          unassigned.push({ item, index });\r\n        }\r\n      });\r\n\r\n      if (unassigned.length > 0) {\r\n        groups.push({\r\n          option: { name: \"Unassigned\", title: \"Unassigned\", color: \"GRAY\" },\r\n          items: unassigned,\r\n        });\r\n      }\r\n\r\n      \r\n\r\n      return groups.filter((g: any) => g.items.length > 0);\r\n    }\r\n\r\n    // Fallback grouping: build groups based on actual item values (useful for assignees, repository, date, number, etc.)\r\n    const map = new Map<string, { option: any; items: any[] }>();\r\n    const unassignedFallback: any[] = [];\r\n\r\n    items.forEach((item, index) => {\r\n      const fv = item.fieldValues.find(\r\n        (v: any) =>\r\n          String(v.fieldId) === String(field.id) || v.fieldName === field.name,\r\n      );\r\n      let val: any = null;\r\n      if (fv) {\r\n        // Text/title/number/date straightforward\r\n        if (fv.text !== undefined) val = fv.text;\r\n        else if (fv.title !== undefined) val = fv.title;\r\n        else if (fv.number !== undefined) val = fv.number;\r\n        else if (fv.date !== undefined) val = fv.date;\r\n        // single_select / option\r\n        else if (fv.option)\r\n          val = fv.option.name || fv.option.title || fv.option.id;\r\n        // iteration\r\n        else if (fv.iteration) val = fv.iteration.title || fv.iteration.id;\r\n        // parent_issue - try parent/parentIssue/issue/item/value/raw\r\n        else if (\r\n          fv.parent ||\r\n          fv.parentIssue ||\r\n          fv.issue ||\r\n          fv.item ||\r\n          fv.value\r\n        ) {\r\n          const p =\r\n            fv.parent || fv.parentIssue || fv.issue || fv.item || fv.value;\r\n          if (p) {\r\n            // Prefer number, then id, then url, then title\r\n            val =\r\n              p.number ||\r\n              p.id ||\r\n              (p.raw && (p.raw.number || p.raw.id)) ||\r\n              p.url ||\r\n              p.title ||\r\n              p.name ||\r\n              null;\r\n          }\r\n        }\r\n        // assignees\r\n        else if (fv.assignees)\r\n          val = Array.isArray(fv.assignees)\r\n            ? fv.assignees.map((a: any) => a.login || a.name).join(\", \")\r\n            : fv.assignees;\r\n        // repository\r\n        else if (fv.repository)\r\n          val =\r\n            fv.repository.nameWithOwner ||\r\n            fv.repository.name ||\r\n            fv.repository.full_name ||\r\n            fv.repository.id;\r\n        // milestone\r\n        else if (fv.milestone)\r\n          val = fv.milestone.title || fv.milestone.id || fv.milestone.name;\r\n        else val = fv.value !== undefined ? fv.value : null;\r\n      }\r\n\r\n      if (val === null || val === undefined || val === \"\") {\r\n        unassignedFallback.push({ item, index });\r\n        return;\r\n      }\r\n\r\n      // Normalize string values for grouping to avoid excessive fragmentation\r\n      let displayVal: any = val;\r\n      if (typeof val === \"string\") {\r\n        // Trim and use first line to represent multi-line text fields\r\n        try {\r\n          displayVal = String(val).trim();\r\n          const lines = displayVal.split(/\\r?\\n/);\r\n          if (lines.length > 0) displayVal = lines[0].trim();\r\n          // Limit length for display/key purposes\r\n          if (displayVal.length > 120) displayVal = displayVal.slice(0, 120);\r\n        } catch (e) {}\r\n      }\r\n\r\n      const key = String(typeof displayVal === \"string\" ? displayVal.toLowerCase() : displayVal);\r\n      if (!map.has(key)) {\r\n        map.set(key, { option: { id: key, name: String(displayVal), title: String(displayVal) }, items: [] });\r\n      }\r\n      map.get(key)!.items.push({ item, index });\r\n    });\r\n\r\n    const groupsArr = Array.from(map.values());\r\n    if (unassignedFallback.length > 0) {\r\n      groupsArr.push({\r\n        option: { name: \"Unassigned\", title: \"Unassigned\", color: \"GRAY\" },\r\n        items: unassignedFallback,\r\n      });\r\n    }\r\n    \r\n    return groupsArr;\r\n  }\r\n}\r\n", "/**\r\n * Fields Menu\r\n * Dropdown used from table plus-column. Shows project fields split into Visible / Hidden sections\r\n * First item is a \"+ New field\" button. Visible fields show a leading checkmark.\r\n */\r\n\r\nexport interface FieldItem {\r\n  id: string;\r\n  name: string;\r\n  iconClass?: string;\r\n  dataType?: string;\r\n  locked?: boolean;\r\n}\r\n\r\nexport interface FieldsMenuOptions {\r\n  fields: FieldItem[];\r\n  visibleFieldIds: Set<string>;\r\n  onToggleVisibility?: (fieldId: string, visible: boolean) => void;\r\n  onCreateField?: () => void;\r\n}\r\n\r\nexport class FieldsMenu {\r\n  private options: FieldsMenuOptions;\r\n  private menuElement: HTMLElement | null = null;\r\n  private backdropElement: HTMLElement | null = null;\r\n  private anchorElementRef: HTMLElement | null = null;\r\n  private anchorRectRef: DOMRect | undefined = undefined;\r\n\r\n  constructor(options: FieldsMenuOptions) {\r\n    this.options = options;\r\n  }\r\n\r\n  public show(anchorElement: HTMLElement, anchorRect?: DOMRect) {\r\n    this.hide();\r\n    this.anchorElementRef = anchorElement;\r\n    this.anchorRectRef = anchorRect;\r\n\r\n    // Backdrop to detect outside clicks\r\n    // Remove existing field/group submenus so only one is visible\r\n    try {\r\n      document.querySelectorAll('[data-menu-type=\"fields-menu\"], [data-menu-type=\"group-by-menu\"]').forEach((n) => n.remove());\r\n    } catch (e) { }\r\n\r\n    this.backdropElement = document.createElement(\"div\");\r\n    this.backdropElement.style.position = \"fixed\";\r\n    this.backdropElement.style.top = \"0\";\r\n    this.backdropElement.style.left = \"0\";\r\n    this.backdropElement.style.right = \"0\";\r\n    this.backdropElement.style.bottom = \"0\";\r\n    this.backdropElement.style.zIndex = \"998\";\r\n    this.backdropElement.addEventListener(\"click\", () => this.hide());\r\n    this.backdropElement.dataset.menuType = 'fields-menu';\r\n    document.body.appendChild(this.backdropElement);\r\n\r\n    // Create menu offscreen first so we can measure size and pick best placement\r\n    this.menuElement = document.createElement(\"div\");\r\n    this.menuElement.className = \"fields-menu\";\r\n    this.menuElement.dataset.menuType = 'fields-menu';\r\n    this.menuElement.style.position = \"absolute\";\r\n    this.menuElement.style.visibility = \"hidden\";\r\n    this.menuElement.style.left = \"0px\";\r\n    this.menuElement.style.top = \"0px\";\r\n    this.menuElement.style.background = \"var(--vscode-menu-background)\";\r\n    this.menuElement.style.border = \"1px solid var(--vscode-menu-border)\";\r\n    this.menuElement.style.borderRadius = \"4px\";\r\n    this.menuElement.style.boxShadow = \"0 2px 8px rgba(0,0,0,0.15)\";\r\n    this.menuElement.style.minWidth = \"220px\";\r\n    this.menuElement.style.padding = \"6px 0\";\r\n    // When there are many fields, allow the menu to scroll vertically instead of growing off-screen\r\n    this.menuElement.style.maxHeight = \"60vh\";\r\n    this.menuElement.style.overflowY = \"auto\";\r\n    this.menuElement.style.boxSizing = \"border-box\";\r\n    this.menuElement.style.zIndex = \"1000\";\r\n    this.menuElement.style.fontSize = \"13px\";\r\n\r\n    // Append hidden, build, measure, then position\r\n    document.body.appendChild(this.menuElement);\r\n    this.buildMenu();\r\n\r\n    let rect = anchorRect as DOMRect | undefined;\r\n    if (!rect) rect = anchorElement.getBoundingClientRect();\r\n    try { console.debug('FieldsMenu.show anchorRect', { top: rect.top, left: rect.left, right: rect.right, height: rect.height }); } catch (e) { }\r\n    const menuRect = this.menuElement.getBoundingClientRect();\r\n    const margin = 8;\r\n    const vw = window.innerWidth || document.documentElement.clientWidth;\r\n    const vh = window.innerHeight || document.documentElement.clientHeight;\r\n\r\n    // Vertical placement: prefer below, otherwise above, else clamp\r\n    let top = rect.bottom + margin;\r\n    if (rect.bottom + menuRect.height + margin > vh) {\r\n      // try above\r\n      if (rect.top - menuRect.height - margin >= 0) {\r\n        top = rect.top - menuRect.height - margin;\r\n      } else {\r\n        // clamp within viewport\r\n        top = Math.max(\r\n          margin,\r\n          Math.min(vh - menuRect.height - margin, rect.bottom + margin),\r\n        );\r\n      }\r\n    }\r\n\r\n    // Horizontal placement: align left by default, but if called from a parent ActiveTabMenu\r\n    // open to the right of the parent menu so it behaves like a submenu.\r\n    let left = rect.left;\r\n    try {\r\n      // Anchor placement relative to the clicked row\r\n      const anchorRect = rect;\r\n      // Prefer opening to the right of the anchor row; fall back to left\r\n      left = Math.round(anchorRect.right + 4);\r\n      if (left + menuRect.width > vw) {\r\n        left = Math.round(anchorRect.left - menuRect.width - 4);\r\n        if (left < margin) left = Math.max(margin, vw - menuRect.width - margin);\r\n      }\r\n    } catch (e) {\r\n      left = rect.left;\r\n    }\r\n    // Clamp left\r\n    left = Math.max(margin, Math.min(left, vw - menuRect.width - margin));\r\n\r\n    // If the menu is taller than the viewport, clamp top and let menu scroll (maxHeight already set)\r\n    // Center vertically on the anchor row where possible\r\n    let finalTop = Math.round(rect.top + (rect.height - menuRect.height) / 2);\r\n    finalTop = Math.max(margin, Math.min(finalTop, Math.max(margin, vh - menuRect.height - margin)));\r\n    this.menuElement.style.top = `${Math.round(finalTop)}px`;\r\n    this.menuElement.style.left = `${Math.round(left)}px`;\r\n    this.menuElement.style.visibility = \"visible\";\r\n    try { console.debug('FieldsMenu positioned', { top: Math.round(finalTop), left: Math.round(left) }); } catch (e) { }\r\n    return { el: this.menuElement, refresh: this.refresh.bind(this) };\r\n  }\r\n\r\n  public refresh() {\r\n    if (!this.menuElement) return;\r\n    // rebuild content\r\n    this.menuElement.innerHTML = '';\r\n    this.buildMenu();\r\n    // reposition if we still have anchor info\r\n    try {\r\n      let rect = this.anchorRectRef as DOMRect | undefined;\r\n      if (!rect && this.anchorElementRef) rect = this.anchorElementRef.getBoundingClientRect();\r\n      if (!rect) return;\r\n      const menuRect = this.menuElement.getBoundingClientRect();\r\n      const margin = 8;\r\n      const vw = window.innerWidth || document.documentElement.clientWidth;\r\n      const vh = window.innerHeight || document.documentElement.clientHeight;\r\n\r\n      let left = Math.round(rect.right + 4);\r\n      if (left + menuRect.width > vw) {\r\n        left = Math.round(rect.left - menuRect.width - 4);\r\n        if (left < margin) left = Math.max(margin, vw - menuRect.width - margin);\r\n      }\r\n      left = Math.max(margin, Math.min(left, vw - menuRect.width - margin));\r\n\r\n      let finalTop = Math.round(rect.top + (rect.height - menuRect.height) / 2);\r\n      finalTop = Math.max(margin, Math.min(finalTop, Math.max(margin, vh - menuRect.height - margin)));\r\n      this.menuElement.style.top = `${Math.round(finalTop)}px`;\r\n      this.menuElement.style.left = `${Math.round(left)}px`;\r\n    } catch (e) { }\r\n  }\r\n\r\n  public hide() {\r\n    if (this.menuElement) {\r\n      this.menuElement.remove();\r\n      this.menuElement = null;\r\n    }\r\n    if (this.backdropElement) {\r\n      this.backdropElement.remove();\r\n      this.backdropElement = null;\r\n    }\r\n  }\r\n\r\n  private buildMenu() {\r\n    if (!this.menuElement) return;\r\n\r\n    // Header\r\n    const title = document.createElement(\"div\");\r\n    title.style.display = \"flex\";\r\n    title.style.alignItems = \"center\";\r\n    title.style.padding = \"6px 12px\";\r\n    title.style.fontWeight = \"600\";\r\n    title.style.color = \"var(--vscode-descriptionForeground)\";\r\n    title.style.fontSize = \"12px\";\r\n    title.style.textTransform = \"uppercase\";\r\n\r\n    const icon = document.createElement(\"i\");\r\n    icon.className = \"octicon octicon-note\";\r\n    icon.style.marginRight = \"8px\";\r\n    title.appendChild(icon);\r\n\r\n    const label = document.createElement(\"span\");\r\n    label.textContent = \"Fields\";\r\n    title.appendChild(label);\r\n\r\n    this.menuElement.appendChild(title);\r\n    this.addSeparator();\r\n\r\n    // + New field\r\n    const newField = document.createElement(\"div\");\r\n    newField.style.display = \"flex\";\r\n    newField.style.alignItems = \"center\";\r\n    newField.style.padding = \"6px 12px\";\r\n    newField.style.cursor = \"pointer\";\r\n    newField.style.color = \"var(--vscode-menu-foreground)\";\r\n    newField.innerHTML = `<span style=\"margin-right:8px;font-weight:700\">+</span><span>New field</span>`;\r\n    newField.addEventListener(\"mouseenter\", () => {\r\n      newField.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n      newField.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n    });\r\n    newField.addEventListener(\"mouseleave\", () => {\r\n      newField.style.background = \"transparent\";\r\n      newField.style.color = \"var(--vscode-menu-foreground)\";\r\n    });\r\n    newField.addEventListener(\"click\", () => {\r\n      this.options.onCreateField?.();\r\n      this.hide();\r\n    });\r\n    this.menuElement.appendChild(newField);\r\n\r\n    this.addSeparator();\r\n\r\n    const visible = this.options.fields.filter((f) =>\r\n      this.options.visibleFieldIds.has(f.id),\r\n    );\r\n    const hidden = this.options.fields.filter(\r\n      (f) => !this.options.visibleFieldIds.has(f.id),\r\n    );\r\n\r\n    this.addSectionHeader(\"Visible fields\");\r\n    if (visible.length === 0) this.addEmptyRow(\"No visible fields\");\r\n    else visible.forEach((f) => this.addFieldRow(f, true));\r\n\r\n    this.addSeparator();\r\n\r\n    this.addSectionHeader(\"Hidden fields\");\r\n    if (hidden.length === 0) this.addEmptyRow(\"No hidden fields\");\r\n    else hidden.forEach((f) => this.addFieldRow(f, false));\r\n  }\r\n\r\n  private addSectionHeader(text: string) {\r\n    if (!this.menuElement) return;\r\n    const h = document.createElement(\"div\");\r\n    h.textContent = text;\r\n    h.style.padding = \"6px 12px\";\r\n    h.style.fontSize = \"11px\";\r\n    h.style.fontWeight = \"600\";\r\n    h.style.color = \"var(--vscode-descriptionForeground)\";\r\n    h.style.textTransform = \"uppercase\";\r\n    this.menuElement.appendChild(h);\r\n  }\r\n  private addEmptyRow(text: string) {\r\n    if (!this.menuElement) return;\r\n    const r = document.createElement(\"div\");\r\n    r.textContent = text;\r\n    r.style.padding = \"6px 12px\";\r\n    r.style.color = \"var(--vscode-menu-foreground)\";\r\n    r.style.opacity = \"0.8\";\r\n    this.menuElement.appendChild(r);\r\n  }\r\n\r\n  private addFieldRow(field: FieldItem, visible: boolean) {\r\n    if (!this.menuElement) return;\r\n    const row = document.createElement(\"div\");\r\n    row.style.display = \"flex\";\r\n    row.style.alignItems = \"center\";\r\n    row.style.padding = \"6px 12px\";\r\n    row.style.cursor = field.locked ? \"default\" : \"pointer\";\r\n    row.style.color = \"var(--vscode-menu-foreground)\";\r\n    if (field.locked) {\r\n      row.style.opacity = \"0.6\";\r\n    }\r\n\r\n    if (visible) {\r\n      const c = document.createElement(\"span\");\r\n      c.textContent = \"\u2713\";\r\n      c.style.marginRight = \"8px\";\r\n      c.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n      row.appendChild(c);\r\n    } else {\r\n      const s = document.createElement(\"span\");\r\n      s.style.display = \"inline-block\";\r\n      s.style.width = \"14px\";\r\n      s.style.marginRight = \"8px\";\r\n      row.appendChild(s);\r\n    }\r\n\r\n    // Determine icon SVG based on field dataType or provided iconClass. Use placeholder tokens for octicon paths so user can replace them later.\r\n    const iconHtml = this.getIconForField(field);\r\n    const icon = document.createElement(\"span\");\r\n    icon.innerHTML = iconHtml;\r\n    icon.style.marginRight = \"8px\";\r\n    icon.style.display = \"inline-flex\";\r\n    icon.style.alignItems = \"center\";\r\n    row.appendChild(icon);\r\n    const label = document.createElement(\"span\");\r\n    label.textContent = field.name;\r\n    label.style.flex = \"1\";\r\n    label.style.whiteSpace = \"nowrap\";\r\n    label.style.overflow = \"hidden\";\r\n    label.style.textOverflow = \"ellipsis\";\r\n    row.appendChild(label);\r\n\r\n    if (!field.locked) {\r\n      row.addEventListener(\"mouseenter\", () => {\r\n        row.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n        row.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n      });\r\n      row.addEventListener(\"mouseleave\", () => {\r\n        row.style.background = \"transparent\";\r\n        row.style.color = \"var(--vscode-menu-foreground)\";\r\n      });\r\n      row.addEventListener(\"click\", () => {\r\n        const newVisible = !visible;\r\n        this.options.onToggleVisibility?.(field.id, newVisible);\r\n        if (newVisible) this.options.visibleFieldIds.add(field.id);\r\n        else this.options.visibleFieldIds.delete(field.id);\r\n        this.menuElement && ((this.menuElement.innerHTML = \"\"), this.buildMenu());\r\n      });\r\n    }\r\n\r\n    this.menuElement.appendChild(row);\r\n  }\r\n\r\n  private addSeparator() {\r\n    if (!this.menuElement) return;\r\n    const s = document.createElement(\"div\");\r\n    s.style.height = \"1px\";\r\n    s.style.background = \"var(--vscode-menu-separatorBackground)\";\r\n    s.style.margin = \"6px 0\";\r\n    this.menuElement.appendChild(s);\r\n  }\r\n\r\n  /**\r\n   * Return inline SVG HTML for the given field using the icon registry.\r\n   */\r\n  private getIconForField(field: FieldItem): string {\r\n    const dataType = (field.dataType || \"\").toString().toLowerCase();\r\n\r\n    // If getIconNameForDataType is available from the icon registry, use it\r\n    if (\r\n      typeof (window as any).getIconNameForDataType === \"function\" &&\r\n      typeof (window as any).getIconSvg === \"function\"\r\n    ) {\r\n      const iconName = (window as any).getIconNameForDataType(dataType);\r\n      return (window as any).getIconSvg(iconName);\r\n    }\r\n\r\n    // Fallback: use provided CSS iconClass if available\r\n    if (field.iconClass) {\r\n      return `<i class=\"${field.iconClass}\"></i>`;\r\n    }\r\n\r\n    // Ultimate fallback: empty span\r\n    return \"<span></span>\";\r\n  }\r\n}\r\n\r\nexport default FieldsMenu;\r\n", "import { GroupDataService } from '../services/GroupDataService';\r\n\r\nexport interface GroupByMenuOptions {\r\n  fields: { id: string; name: string; iconClass?: string; dataType?: string }[];\r\n  items?: any[];\r\n  current?: string | null;\r\n  title?: string; // Dynamic title: \"Column by\", \"Swimlanes\", \"Group by\"\r\n  onSelect?: (fieldName: string | null) => void;\r\n}\r\n\r\nexport class GroupByMenu {\r\n  private options: GroupByMenuOptions;\r\n  private menuEl: HTMLElement | null = null;\r\n  private backdropEl: HTMLElement | null = null;\r\n  private anchor: HTMLElement | null = null;\r\n  private anchorRect: DOMRect | undefined = undefined;\r\n\r\n  constructor(options: GroupByMenuOptions) {\r\n    this.options = options;\r\n  }\r\n\r\n  public show(anchor: HTMLElement, anchorRect?: DOMRect): { el: HTMLElement | null; refresh: () => void } {\r\n    this.hide();\r\n    this.anchor = anchor;\r\n    this.anchorRect = anchorRect;\r\n\r\n    this.backdropEl = document.createElement('div');\r\n    this.backdropEl.style.position = 'fixed';\r\n    this.backdropEl.style.top = '0';\r\n    this.backdropEl.style.left = '0';\r\n    this.backdropEl.style.right = '0';\r\n    this.backdropEl.style.bottom = '0';\r\n    this.backdropEl.style.zIndex = '998';\r\n    this.backdropEl.addEventListener('click', () => this.hide());\r\n    document.body.appendChild(this.backdropEl);\r\n\r\n    // Remove any existing submenus first\r\n    try {\r\n      document.querySelectorAll('[data-menu-type=\"fields-menu\"], [data-menu-type=\"group-by-menu\"]').forEach((n) => n.remove());\r\n    } catch (e) { }\r\n\r\n    this.menuEl = document.createElement('div');\r\n    this.menuEl.className = 'group-by-menu';\r\n    this.menuEl.dataset.menuType = 'group-by-menu';\r\n    this.menuEl.style.position = 'absolute';\r\n    this.menuEl.style.background = 'var(--vscode-menu-background)';\r\n    this.menuEl.style.border = '1px solid var(--vscode-menu-border)';\r\n    this.menuEl.style.borderRadius = '4px';\r\n    this.menuEl.style.boxShadow = '0 2px 8px rgba(0,0,0,0.15)';\r\n    this.menuEl.style.minWidth = '180px';\r\n    this.menuEl.style.maxHeight = '60vh';\r\n    this.menuEl.style.overflowY = 'auto';\r\n    this.menuEl.style.boxSizing = 'border-box';\r\n    this.menuEl.style.padding = '4px 0';\r\n    this.menuEl.style.zIndex = '1000';\r\n    this.menuEl.style.fontSize = '13px';\r\n    document.body.appendChild(this.menuEl);\r\n\r\n    this.buildMenuContent();\r\n    this.positionMenu();\r\n    return { el: this.menuEl, refresh: this.refresh.bind(this) };\r\n  }\r\n\r\n  private buildMenuContent() {\r\n    if (!this.menuEl) return;\r\n    this.menuEl.innerHTML = '';\r\n\r\n    const title = document.createElement('div');\r\n    title.textContent = this.options.title || 'Group by';\r\n    title.style.padding = '6px 12px';\r\n    title.style.fontWeight = '600';\r\n    title.style.color = 'var(--vscode-descriptionForeground)';\r\n    title.style.fontSize = '12px';\r\n    this.menuEl.appendChild(title);\r\n\r\n    this.addSeparator();\r\n\r\n    // \"No grouping\" option\r\n    const noneRow = document.createElement('div');\r\n    noneRow.style.display = 'flex';\r\n    noneRow.style.alignItems = 'center';\r\n    noneRow.style.padding = '6px 12px';\r\n    noneRow.style.cursor = 'pointer';\r\n\r\n    const noneCheck = document.createElement('span');\r\n    noneCheck.style.display = 'inline-flex';\r\n    noneCheck.style.width = '14px';\r\n    noneCheck.style.marginRight = '8px';\r\n    noneCheck.style.alignItems = 'center';\r\n    noneCheck.style.justifyContent = 'center';\r\n    if (!this.options.current) {\r\n      noneCheck.textContent = '\u2713';\r\n      noneCheck.style.color = 'var(--vscode-menu-selectionForeground)';\r\n    }\r\n    noneRow.appendChild(noneCheck);\r\n\r\n    const noneLabel = document.createElement('span');\r\n    noneLabel.textContent = 'No grouping';\r\n    noneRow.appendChild(noneLabel);\r\n\r\n    noneRow.addEventListener('mouseenter', () => {\r\n      noneRow.style.background = 'var(--vscode-menu-selectionBackground)';\r\n      noneRow.style.color = 'var(--vscode-menu-selectionForeground)';\r\n    });\r\n    noneRow.addEventListener('mouseleave', () => {\r\n      noneRow.style.background = 'transparent';\r\n      noneRow.style.color = 'var(--vscode-menu-foreground)';\r\n    });\r\n    noneRow.addEventListener('click', () => {\r\n      this.options.current = null;\r\n      this.options.onSelect?.(null);\r\n      this.refresh();\r\n    });\r\n    this.menuEl.appendChild(noneRow);\r\n\r\n    this.addSeparator();\r\n\r\n    // Determine candidate fields\r\n    let candidateFields = this.options.fields || [];\r\n    try {\r\n      if (this.options.items && Array.isArray(this.options.items) && this.options.items.length > 0) {\r\n        candidateFields = (this.options.fields || []).filter((f: any) => {\r\n          try {\r\n            const groups = GroupDataService.groupItems(this.options.items || [], f);\r\n            return Array.isArray(groups) && groups.length > 0;\r\n          } catch (e) {\r\n            return false;\r\n          }\r\n        });\r\n      }\r\n    } catch (e) { }\r\n\r\n    (candidateFields || []).forEach(f => {\r\n      const r = document.createElement('div');\r\n      r.style.display = 'flex';\r\n      r.style.alignItems = 'center';\r\n      r.style.padding = '6px 12px';\r\n      r.style.cursor = 'pointer';\r\n\r\n      // leading checkmark\r\n      const check = document.createElement('span');\r\n      check.style.display = 'inline-flex';\r\n      check.style.width = '14px';\r\n      check.style.marginRight = '8px';\r\n      check.style.alignItems = 'center';\r\n      check.style.justifyContent = 'center';\r\n      const currentVal = this.options.current ? String(this.options.current).toLowerCase() : null;\r\n      const matchesCurrent = currentVal && (String(f.id).toLowerCase() === currentVal || String(f.name || '').toLowerCase() === currentVal);\r\n      if (matchesCurrent) {\r\n        check.textContent = '\u2713';\r\n        check.style.color = 'var(--vscode-menu-selectionForeground)';\r\n      }\r\n      r.appendChild(check);\r\n\r\n      // left icon (field type)\r\n      const left = document.createElement('span');\r\n      left.style.display = 'inline-flex';\r\n      left.style.alignItems = 'center';\r\n      left.style.justifyContent = 'center';\r\n      left.style.marginRight = '8px';\r\n      try {\r\n        const dt = (f.dataType || '').toString().toLowerCase();\r\n        if (typeof (window as any).getIconNameForDataType === 'function' && typeof (window as any).getIconSvg === 'function') {\r\n          const iconName = (window as any).getIconNameForDataType(dt);\r\n          left.innerHTML = (window as any).getIconSvg(iconName) || '';\r\n          left.querySelectorAll && left.querySelectorAll('svg').forEach((s: any) => s.setAttribute && s.setAttribute('fill', 'currentColor'));\r\n        } else if (f.iconClass) {\r\n          left.innerHTML = `<i class=\"${f.iconClass}\"></i>`;\r\n        }\r\n      } catch (e) { }\r\n      r.appendChild(left);\r\n\r\n      const label = document.createElement('div');\r\n      label.textContent = f.name;\r\n      label.style.flex = '1';\r\n      r.appendChild(label);\r\n\r\n      // Hover effects\r\n      r.addEventListener('mouseenter', () => {\r\n        r.style.background = 'var(--vscode-menu-selectionBackground)';\r\n        r.style.color = 'var(--vscode-menu-selectionForeground)';\r\n      });\r\n      r.addEventListener('mouseleave', () => {\r\n        r.style.background = 'transparent';\r\n        r.style.color = 'var(--vscode-menu-foreground)';\r\n      });\r\n\r\n      // Click: update current and refresh (don't close)\r\n      r.addEventListener('click', () => {\r\n        this.options.current = String(f.name);\r\n        this.options.onSelect?.(String(f.name));\r\n        this.refresh();\r\n      });\r\n\r\n      this.menuEl!.appendChild(r);\r\n    });\r\n  }\r\n\r\n  private positionMenu() {\r\n    if (!this.menuEl) return;\r\n\r\n    let rectAnchor = this.anchorRect;\r\n    if (!rectAnchor && this.anchor) rectAnchor = this.anchor.getBoundingClientRect();\r\n    if (!rectAnchor) return;\r\n\r\n    const mrect = this.menuEl.getBoundingClientRect();\r\n    const vw = window.innerWidth || document.documentElement.clientWidth;\r\n    const vh = window.innerHeight || document.documentElement.clientHeight;\r\n    const margin = 8;\r\n\r\n    let top = Math.round(rectAnchor.top + (rectAnchor.height - mrect.height) / 2);\r\n    const maxTop = Math.max(margin, vh - mrect.height - margin);\r\n    top = Math.max(margin, Math.min(top, maxTop));\r\n\r\n    let left = Math.round(rectAnchor.right + 4);\r\n    if (left + mrect.width > vw) {\r\n      left = Math.round(rectAnchor.left - mrect.width - 4);\r\n      if (left < margin) {\r\n        left = Math.max(margin, vw - mrect.width - margin);\r\n      }\r\n    }\r\n\r\n    this.menuEl.style.top = `${top}px`;\r\n    this.menuEl.style.left = `${left}px`;\r\n  }\r\n\r\n  // Refresh content without closing/repositioning\r\n  public refresh() {\r\n    if (this.menuEl) {\r\n      this.buildMenuContent();\r\n    }\r\n  }\r\n\r\n  private addSeparator() {\r\n    if (!this.menuEl) return;\r\n    const s = document.createElement('div');\r\n    s.style.height = '1px';\r\n    s.style.background = 'var(--vscode-menu-separatorBackground)';\r\n    s.style.margin = '6px 0';\r\n    this.menuEl.appendChild(s);\r\n  }\r\n\r\n  public hide() {\r\n    if (this.menuEl) { this.menuEl.remove(); this.menuEl = null; }\r\n    if (this.backdropEl) { this.backdropEl.remove(); this.backdropEl = null; }\r\n  }\r\n}\r\n\r\nexport default GroupByMenu;\r\n\r\n", "export interface SortByMenuOptions {\r\n    fields: { id: string; name: string; iconClass?: string; dataType?: string }[];\r\n    current?: string | null; // Current sort field ID or null for no sorting\r\n    onSelect?: (fieldId: string | null) => void;\r\n}\r\n\r\nfunction getIconSvg(iconName: string, size: number = 14): string {\r\n    if ((window as any).getIconSvg) return (window as any).getIconSvg(iconName as any, { size });\r\n    return \"\";\r\n}\r\n\r\nfunction getIconNameForDataType(dataType: string): string {\r\n    if ((window as any).getIconNameForDataType) return (window as any).getIconNameForDataType(dataType);\r\n    return \"note\";\r\n}\r\n\r\nexport class SortByMenu {\r\n    private options: SortByMenuOptions;\r\n    private menuEl: HTMLElement | null = null;\r\n    private backdropEl: HTMLElement | null = null;\r\n    private anchor: HTMLElement | null = null;\r\n    private anchorRect: DOMRect | undefined = undefined;\r\n\r\n    constructor(options: SortByMenuOptions) {\r\n        this.options = options;\r\n    }\r\n\r\n    public show(anchor: HTMLElement, anchorRect?: DOMRect): { el: HTMLElement | null; refresh: () => void } {\r\n        this.hide();\r\n        this.anchor = anchor;\r\n        this.anchorRect = anchorRect;\r\n\r\n        this.backdropEl = document.createElement('div');\r\n        this.backdropEl.style.position = 'fixed';\r\n        this.backdropEl.style.top = '0';\r\n        this.backdropEl.style.left = '0';\r\n        this.backdropEl.style.right = '0';\r\n        this.backdropEl.style.bottom = '0';\r\n        this.backdropEl.style.zIndex = '998';\r\n        this.backdropEl.addEventListener('click', () => this.hide());\r\n        document.body.appendChild(this.backdropEl);\r\n\r\n        // Remove any existing submenus first\r\n        try {\r\n            document.querySelectorAll('[data-menu-type=\"sort-by-menu\"]').forEach((n) => n.remove());\r\n        } catch (e) { }\r\n\r\n        this.menuEl = document.createElement('div');\r\n        this.menuEl.className = 'sort-by-menu';\r\n        this.menuEl.dataset.menuType = 'sort-by-menu';\r\n        this.menuEl.style.position = 'absolute';\r\n        this.menuEl.style.background = 'var(--vscode-menu-background)';\r\n        this.menuEl.style.border = '1px solid var(--vscode-menu-border)';\r\n        this.menuEl.style.borderRadius = '4px';\r\n        this.menuEl.style.boxShadow = '0 2px 8px rgba(0,0,0,0.15)';\r\n        this.menuEl.style.minWidth = '180px';\r\n        this.menuEl.style.maxHeight = '60vh';\r\n        this.menuEl.style.overflowY = 'auto';\r\n        this.menuEl.style.boxSizing = 'border-box';\r\n        this.menuEl.style.padding = '4px 0';\r\n        this.menuEl.style.zIndex = '1000';\r\n        this.menuEl.style.fontSize = '13px';\r\n        document.body.appendChild(this.menuEl);\r\n\r\n        this.buildMenuContent();\r\n        this.positionMenu();\r\n        return { el: this.menuEl, refresh: this.refresh.bind(this) };\r\n    }\r\n\r\n    private buildMenuContent() {\r\n        if (!this.menuEl) return;\r\n        this.menuEl.innerHTML = '';\r\n\r\n        const title = document.createElement('div');\r\n        title.textContent = 'Sort by';\r\n        title.style.padding = '6px 12px';\r\n        title.style.fontWeight = '600';\r\n        title.style.color = 'var(--vscode-descriptionForeground)';\r\n        title.style.fontSize = '12px';\r\n        this.menuEl.appendChild(title);\r\n\r\n        this.addSeparator();\r\n\r\n        // \"No sorting\" option\r\n        this.addSortRow(null, 'No sorting', null, !this.options.current);\r\n\r\n        this.addSeparator();\r\n\r\n        // All fields\r\n        (this.options.fields || []).forEach(f => {\r\n            const iconName = getIconNameForDataType(f.dataType || '');\r\n            const isActive = this.options.current === f.id || this.options.current === f.name;\r\n            this.addSortRow(f.id, f.name, iconName, isActive);\r\n        });\r\n    }\r\n\r\n    private addSortRow(id: string | null, label: string, iconName: string | null, isActive: boolean) {\r\n        if (!this.menuEl) return;\r\n\r\n        const row = document.createElement('div');\r\n        row.style.display = 'flex';\r\n        row.style.alignItems = 'center';\r\n        row.style.padding = '6px 12px';\r\n        row.style.cursor = 'pointer';\r\n\r\n        // Checkmark\r\n        const check = document.createElement('span');\r\n        check.style.display = 'inline-flex';\r\n        check.style.width = '14px';\r\n        check.style.marginRight = '8px';\r\n        check.style.alignItems = 'center';\r\n        check.style.justifyContent = 'center';\r\n        if (isActive) {\r\n            check.textContent = '\u2713';\r\n            check.style.color = 'var(--vscode-menu-selectionForeground)';\r\n        }\r\n        row.appendChild(check);\r\n\r\n        // Icon\r\n        if (iconName) {\r\n            const iconEl = document.createElement('span');\r\n            iconEl.style.display = 'inline-flex';\r\n            iconEl.style.alignItems = 'center';\r\n            iconEl.style.justifyContent = 'center';\r\n            iconEl.style.marginRight = '8px';\r\n            try {\r\n                iconEl.innerHTML = getIconSvg(iconName, 14);\r\n                iconEl.querySelectorAll('svg').forEach((s: any) => s.setAttribute && s.setAttribute('fill', 'currentColor'));\r\n            } catch (e) { }\r\n            row.appendChild(iconEl);\r\n        }\r\n\r\n        // Label\r\n        const labelEl = document.createElement('span');\r\n        labelEl.textContent = label;\r\n        labelEl.style.flex = '1';\r\n        row.appendChild(labelEl);\r\n\r\n        // Hover effects\r\n        row.addEventListener('mouseenter', () => {\r\n            row.style.background = 'var(--vscode-menu-selectionBackground)';\r\n            row.style.color = 'var(--vscode-menu-selectionForeground)';\r\n        });\r\n        row.addEventListener('mouseleave', () => {\r\n            row.style.background = 'transparent';\r\n            row.style.color = 'var(--vscode-menu-foreground)';\r\n        });\r\n\r\n        // Click: select sort field and refresh\r\n        row.addEventListener('click', () => {\r\n            this.options.current = id;\r\n            if (this.options.onSelect) {\r\n                this.options.onSelect(id);\r\n            }\r\n            this.refresh();\r\n        });\r\n\r\n        this.menuEl.appendChild(row);\r\n    }\r\n\r\n    private positionMenu() {\r\n        if (!this.menuEl) return;\r\n\r\n        let rectAnchor = this.anchorRect;\r\n        if (!rectAnchor && this.anchor) rectAnchor = this.anchor.getBoundingClientRect();\r\n        if (!rectAnchor) return;\r\n\r\n        const mrect = this.menuEl.getBoundingClientRect();\r\n        const vw = window.innerWidth || document.documentElement.clientWidth;\r\n        const vh = window.innerHeight || document.documentElement.clientHeight;\r\n        const margin = 8;\r\n\r\n        let top = Math.round(rectAnchor.top + (rectAnchor.height - mrect.height) / 2);\r\n        const maxTop = Math.max(margin, vh - mrect.height - margin);\r\n        top = Math.max(margin, Math.min(top, maxTop));\r\n\r\n        let left = Math.round(rectAnchor.right + 4);\r\n        if (left + mrect.width > vw) {\r\n            left = Math.round(rectAnchor.left - mrect.width - 4);\r\n            if (left < margin) {\r\n                left = Math.max(margin, vw - mrect.width - margin);\r\n            }\r\n        }\r\n\r\n        this.menuEl.style.top = `${top}px`;\r\n        this.menuEl.style.left = `${left}px`;\r\n    }\r\n\r\n    public refresh() {\r\n        if (this.menuEl) {\r\n            this.buildMenuContent();\r\n        }\r\n    }\r\n\r\n    private addSeparator() {\r\n        if (!this.menuEl) return;\r\n        const s = document.createElement('div');\r\n        s.style.height = '1px';\r\n        s.style.background = 'var(--vscode-menu-separatorBackground)';\r\n        s.style.margin = '6px 0';\r\n        this.menuEl.appendChild(s);\r\n    }\r\n\r\n    public hide() {\r\n        if (this.menuEl) { this.menuEl.remove(); this.menuEl = null; }\r\n        if (this.backdropEl) { this.backdropEl.remove(); this.backdropEl = null; }\r\n    }\r\n}\r\n\r\nexport default SortByMenu;\r\n", "export interface FieldSumMenuOptions {\r\n  fields: { id: string; name: string; dataType?: string; iconClass?: string }[];\r\n  current: string[]; // array of ids (or '__count__')\r\n  title?: string;\r\n  onChange?: (selected: string[]) => void;\r\n}\r\n\r\nexport class FieldSumMenu {\r\n  private options: FieldSumMenuOptions;\r\n  private menuEl: HTMLElement | null = null;\r\n  private backdropEl: HTMLElement | null = null;\r\n  private anchor: HTMLElement | null = null;\r\n\r\n  constructor(options: FieldSumMenuOptions) {\r\n    this.options = options;\r\n  }\r\n\r\n  public show(anchor: HTMLElement, anchorRect?: DOMRect): { el: HTMLElement | null; refresh: () => void } {\r\n    this.hide();\r\n    this.anchor = anchor;\r\n\r\n    this.backdropEl = document.createElement('div');\r\n    this.backdropEl.style.position = 'fixed';\r\n    this.backdropEl.style.top = '0';\r\n    this.backdropEl.style.left = '0';\r\n    this.backdropEl.style.right = '0';\r\n    this.backdropEl.style.bottom = '0';\r\n    this.backdropEl.style.zIndex = '998';\r\n    this.backdropEl.addEventListener('click', () => this.hide());\r\n    document.body.appendChild(this.backdropEl);\r\n\r\n    this.menuEl = document.createElement('div');\r\n    this.menuEl.className = 'field-sum-menu';\r\n    this.menuEl.dataset.menuType = 'field-sum-menu';\r\n    this.menuEl.style.position = 'absolute';\r\n    this.menuEl.style.background = 'var(--vscode-menu-background)';\r\n    this.menuEl.style.border = '1px solid var(--vscode-menu-border)';\r\n    this.menuEl.style.borderRadius = '4px';\r\n    this.menuEl.style.boxShadow = '0 2px 8px rgba(0,0,0,0.15)';\r\n    this.menuEl.style.minWidth = '200px';\r\n    this.menuEl.style.maxHeight = '60vh';\r\n    this.menuEl.style.overflowY = 'auto';\r\n    this.menuEl.style.padding = '4px 0';\r\n    this.menuEl.style.zIndex = '1000';\r\n    this.menuEl.style.fontSize = '13px';\r\n    document.body.appendChild(this.menuEl);\r\n\r\n    this.buildMenu();\r\n    this.positionMenu(anchorRect);\r\n    return { el: this.menuEl, refresh: this.refresh.bind(this) };\r\n  }\r\n\r\n  private buildMenu() {\r\n    if (!this.menuEl) return;\r\n    this.menuEl.innerHTML = '';\r\n\r\n    const title = document.createElement('div');\r\n    title.textContent = this.options.title || 'Field sum';\r\n    title.style.padding = '6px 12px';\r\n    title.style.fontWeight = '600';\r\n    title.style.color = 'var(--vscode-descriptionForeground)';\r\n    title.style.fontSize = '12px';\r\n    this.menuEl.appendChild(title);\r\n\r\n    const addRow = (id: string, label: string, icon?: string, selected?: boolean) => {\r\n      const r = document.createElement('div');\r\n      r.style.display = 'flex';\r\n      r.style.alignItems = 'center';\r\n      r.style.padding = '6px 12px';\r\n      r.style.cursor = 'pointer';\r\n\r\n      const check = document.createElement('span');\r\n      check.style.display = 'inline-flex';\r\n      check.style.width = '14px';\r\n      check.style.marginRight = '8px';\r\n      check.style.alignItems = 'center';\r\n      check.style.justifyContent = 'center';\r\n      if (selected) { check.textContent = '\u2713'; check.style.color = 'var(--vscode-menu-selectionForeground)'; }\r\n      r.appendChild(check);\r\n\r\n      if (icon) {\r\n        const left = document.createElement('span');\r\n        left.style.display = 'inline-flex'; left.style.marginRight = '8px';\r\n        try { left.innerHTML = (window as any).getIconSvg?.(icon) || ''; left.querySelectorAll && left.querySelectorAll('svg').forEach((s: any) => s.setAttribute && s.setAttribute('fill','currentColor')); } catch (e) {}\r\n        r.appendChild(left);\r\n      }\r\n\r\n      const lbl = document.createElement('div');\r\n      lbl.textContent = label;\r\n      lbl.style.flex = '1';\r\n      r.appendChild(lbl);\r\n\r\n      r.addEventListener('mouseenter', () => { r.style.background = 'var(--vscode-menu-selectionBackground)'; r.style.color = 'var(--vscode-menu-selectionForeground)'; });\r\n      r.addEventListener('mouseleave', () => { r.style.background = 'transparent'; r.style.color = 'var(--vscode-menu-foreground)'; });\r\n\r\n      r.addEventListener('click', (ev) => {\r\n        ev.stopPropagation();\r\n        const cur = new Set(this.options.current || []);\r\n        if (cur.has(id)) cur.delete(id); else cur.add(id);\r\n        this.options.current = Array.from(cur);\r\n        try { if (typeof this.options.onChange === 'function') this.options.onChange(this.options.current); } catch (e) {}\r\n        // keep menu open but update checks\r\n        this.refresh();\r\n      });\r\n\r\n      this.menuEl!.appendChild(r);\r\n    };\r\n\r\n    // Count option\r\n    const currentSet = new Set(this.options.current || []);\r\n    addRow('__count__', 'Count', 'check', currentSet.has('__count__'));\r\n\r\n    // Numeric fields\r\n    (this.options.fields || []).forEach(f => {\r\n      const dt = String(f.dataType || '').toLowerCase();\r\n      if (dt === 'number' || dt === 'numeric' || dt.includes('num')) {\r\n        addRow(String(f.id), f.name, 'number', currentSet.has(String(f.id)));\r\n      }\r\n    });\r\n  }\r\n\r\n  private positionMenu(anchorRect?: DOMRect) {\r\n    if (!this.menuEl || !this.anchor) return;\r\n    let rect = anchorRect;\r\n    if (!rect) rect = this.anchor.getBoundingClientRect();\r\n\r\n    const menuRect = this.menuEl.getBoundingClientRect();\r\n    const vw = window.innerWidth || document.documentElement.clientWidth;\r\n    const vh = window.innerHeight || document.documentElement.clientHeight;\r\n    let left = rect.right + 4;\r\n    if (left + menuRect.width > vw) {\r\n      left = rect.left - menuRect.width - 4;\r\n      if (left < 4) left = Math.max(4, Math.min(vw - menuRect.width - 4, rect.right - menuRect.width));\r\n    }\r\n    this.menuEl.style.top = `${Math.round(rect.bottom + 4)}px`;\r\n    this.menuEl.style.left = `${Math.round(left)}px`;\r\n  }\r\n\r\n  public refresh() {\r\n    if (this.menuEl) this.buildMenu();\r\n  }\r\n\r\n  public hide() {\r\n    if (this.menuEl) { this.menuEl.remove(); this.menuEl = null; }\r\n    if (this.backdropEl) { this.backdropEl.remove(); this.backdropEl = null; }\r\n  }\r\n}\r\n\r\nexport default FieldSumMenu;\r\n", "export interface AddItemMenuOptions {\r\n  anchorElement: HTMLElement;\r\n  onCreateIssue: () => void;\r\n  onAddFromRepo: () => void;\r\n}\r\n\r\nexport class AddItemMenu {\r\n  private options: AddItemMenuOptions;\r\n  private menuElement: HTMLElement | null = null;\r\n  private backdropElement: HTMLElement | null = null;\r\n\r\n  constructor(options: AddItemMenuOptions) {\r\n    this.options = options;\r\n  }\r\n\r\n  public show() {\r\n    this.hide();\r\n\r\n    this.backdropElement = document.createElement(\"div\");\r\n    this.backdropElement.style.position = \"fixed\";\r\n    this.backdropElement.style.top = \"0\";\r\n    this.backdropElement.style.left = \"0\";\r\n    this.backdropElement.style.right = \"0\";\r\n    this.backdropElement.style.bottom = \"0\";\r\n    this.backdropElement.style.zIndex = \"998\";\r\n    this.backdropElement.addEventListener(\"click\", () => this.hide());\r\n    document.body.appendChild(this.backdropElement);\r\n\r\n    this.menuElement = document.createElement(\"div\");\r\n    this.menuElement.className = \"add-item-menu\";\r\n    this.menuElement.style.position = \"absolute\";\r\n    this.menuElement.style.background = \"var(--vscode-menu-background)\";\r\n    this.menuElement.style.border = \"1px solid var(--vscode-menu-border)\";\r\n    this.menuElement.style.borderRadius = \"4px\";\r\n    this.menuElement.style.boxShadow = \"0 2px 8px rgba(0,0,0,0.15)\";\r\n    this.menuElement.style.minWidth = \"220px\";\r\n    this.menuElement.style.padding = \"4px 0\";\r\n    this.menuElement.style.zIndex = \"1000\";\r\n    this.menuElement.style.fontSize = \"13px\";\r\n\r\n    document.body.appendChild(this.menuElement);\r\n    this.buildMenu();\r\n\r\n    const rect = this.options.anchorElement.getBoundingClientRect();\r\n    const menuRect = this.menuElement.getBoundingClientRect();\r\n    const margin = 8;\r\n    const vw = window.innerWidth || document.documentElement.clientWidth;\r\n    const vh = window.innerHeight || document.documentElement.clientHeight;\r\n\r\n    let top = rect.bottom + margin;\r\n    if (rect.bottom + menuRect.height + margin > vh) {\r\n      if (rect.top - menuRect.height - margin >= 0) {\r\n        top = rect.top - menuRect.height - margin;\r\n      } else {\r\n        top = Math.max(\r\n          margin,\r\n          Math.min(vh - menuRect.height - margin, rect.bottom + margin),\r\n        );\r\n      }\r\n    }\r\n\r\n    let left = rect.left;\r\n    if (rect.left + menuRect.width + margin > vw) {\r\n      left = Math.max(margin, rect.right - menuRect.width);\r\n    }\r\n    left = Math.max(margin, Math.min(left, vw - menuRect.width - margin));\r\n\r\n    this.menuElement.style.top = `${Math.round(top)}px`;\r\n    this.menuElement.style.left = `${Math.round(left)}px`;\r\n  }\r\n\r\n  public hide() {\r\n    if (this.menuElement) {\r\n      this.menuElement.remove();\r\n      this.menuElement = null;\r\n    }\r\n    if (this.backdropElement) {\r\n      this.backdropElement.remove();\r\n      this.backdropElement = null;\r\n    }\r\n  }\r\n\r\n  private buildMenu() {\r\n    if (!this.menuElement) return;\r\n\r\n    const mkItem = (\r\n      iconName: string,\r\n      label: string,\r\n      description: string,\r\n      onClick: () => void,\r\n    ) => {\r\n      const row = document.createElement(\"div\");\r\n      row.className = \"add-item-menu-item\";\r\n      row.style.display = \"flex\";\r\n      row.style.alignItems = \"center\";\r\n      row.style.padding = \"6px 12px\";\r\n      row.style.cursor = \"pointer\";\r\n      row.style.color = \"var(--vscode-menu-foreground)\";\r\n\r\n      const iconSpan = document.createElement(\"span\");\r\n      iconSpan.style.display = \"inline-flex\";\r\n      iconSpan.style.alignItems = \"center\";\r\n      iconSpan.style.justifyContent = \"center\";\r\n      iconSpan.style.marginRight = \"8px\";\r\n      iconSpan.innerHTML = (window as any).getIconSvg?.(iconName as any) || \"\";\r\n      row.appendChild(iconSpan);\r\n\r\n      const textContainer = document.createElement(\"div\");\r\n      textContainer.style.display = \"flex\";\r\n      textContainer.style.flexDirection = \"column\";\r\n      textContainer.style.flex = \"1\";\r\n\r\n      const titleEl = document.createElement(\"div\");\r\n      titleEl.textContent = label;\r\n      titleEl.style.fontWeight = \"500\";\r\n      textContainer.appendChild(titleEl);\r\n\r\n      if (description) {\r\n        const descEl = document.createElement(\"div\");\r\n        descEl.textContent = description;\r\n        descEl.style.fontSize = \"11px\";\r\n        descEl.style.color = \"var(--vscode-descriptionForeground)\";\r\n        textContainer.appendChild(descEl);\r\n      }\r\n\r\n      row.appendChild(textContainer);\r\n\r\n      row.addEventListener(\"mouseenter\", () => {\r\n        row.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n        row.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n      });\r\n      row.addEventListener(\"mouseleave\", () => {\r\n        row.style.background = \"transparent\";\r\n        row.style.color = \"var(--vscode-menu-foreground)\";\r\n      });\r\n\r\n      row.addEventListener(\"click\", () => {\r\n        onClick();\r\n        this.hide();\r\n      });\r\n\r\n      this.menuElement!.appendChild(row);\r\n    };\r\n\r\n    mkItem(\r\n      \"issue-opened\",\r\n      \"Create new issue\",\r\n      \"Create a project issue in a repository.\",\r\n      this.options.onCreateIssue,\r\n    );\r\n\r\n    mkItem(\r\n      \"repo\",\r\n      \"Add item from repository\",\r\n      \"Attach an existing issue or pull request from a repo.\",\r\n      this.options.onAddFromRepo,\r\n    );\r\n  }\r\n}\r\n", "export function escapeHtml(s: any): string {\r\n  return s\r\n    ? String(s)\r\n        .replace(/&/g, \"&amp;\")\r\n        .replace(/</g, \"&lt;\")\r\n        .replace(/>/g, \"&gt;\")\r\n    : \"\";\r\n}\r\n\r\nexport function normalizeColor(color: any): string | null {\r\n  if (!color) return null;\r\n  let n = String(color).trim();\r\n  if (\r\n    /^#?[0-9a-f]{3}$/i.test(n) ||\r\n    /^#?[0-9a-f]{6}$/i.test(n) ||\r\n    /^#?[0-9a-f]{8}$/i.test(n)\r\n  ) {\r\n    let b = n[0] === \"#\" ? n.slice(1) : n;\r\n    return \"#\" + (b.length === 8 ? b.substring(0, 6) : b);\r\n  }\r\n  let s = {\r\n    GRAY: \"#848d97\",\r\n    RED: \"#f85149\",\r\n    ORANGE: \"#db6d28\",\r\n    YELLOW: \"#d29922\",\r\n    GREEN: \"#3fb950\",\r\n    BLUE: \"#2f81f7\",\r\n    PURPLE: \"#a371f7\",\r\n    PINK: \"#db61a2\",\r\n    BLACK: \"#000000\",\r\n    WHITE: \"#ffffff\",\r\n  };\r\n  let u = n.toUpperCase();\r\n  return (s as any)[u] || null;\r\n}\r\n\r\nexport function addAlpha(color: any, alpha: any): string | null {\r\n  if (!color) return null;\r\n  let s = color.replace(\"#\", \"\");\r\n  let u = (b: any) => parseInt(b, 16);\r\n  if (s.length === 3) {\r\n    let b = u(s[0] + s[0]),\r\n      S = u(s[1] + s[1]),\r\n      v = u(s[2] + s[2]);\r\n    return \"rgba(\" + b + \",\" + S + \",\" + v + \",\" + alpha + \")\";\r\n  }\r\n  if (s.length === 6 || s.length === 8) {\r\n    let b = s.length === 8 ? s.substring(0, 6) : s,\r\n      S = u(s.substring(0, 2)),\r\n      v = u(b.substring(2, 4)),\r\n      C = u(b.substring(4, 6));\r\n    return \"rgba(\" + S + \",\" + v + \",\" + C + \",\" + alpha + \")\";\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function getContrastColor(color: any): string {\r\n  if (!color) return \"#333333\";\r\n  let n = color.replace(\"#\", \"\");\r\n  let s = (C: any) => parseInt(C, 16);\r\n  let u, b, S;\r\n  if (n.length === 3)\r\n    ((u = s(n[0] + n[0])), (b = s(n[1] + n[1])), (S = s(n[2] + n[2])));\r\n  else if (n.length === 6 || n.length === 8) {\r\n    let C = n.length === 8 ? n.substring(0, 6) : n;\r\n    ((u = s(C.substring(0, 2))),\r\n      (b = s(C.substring(2, 4))),\r\n      (S = s(C.substring(4, 6))));\r\n  } else return \"#333333\";\r\n  return 0.2126 * (u / 255) + 0.7152 * (b / 255) + 0.0722 * (S / 255) > 0.6\r\n    ? \"#111111\"\r\n    : \"#ffffff\";\r\n}\r\n", "/// <reference path=\"../global.d.ts\" />\r\n\r\nexport function logDebug(viewKey: string, message: string, data?: any) {\r\n  try {\r\n    if (\r\n      (window as any).__APP_MESSAGING__ &&\r\n      typeof (window as any).__APP_MESSAGING__.postMessage === \"function\"\r\n    ) {\r\n      (window as any).__APP_MESSAGING__.postMessage({\r\n        command: \"debugLog\",\r\n        level: \"debug\",\r\n        viewKey: viewKey,\r\n        message: message,\r\n        data: data,\r\n      });\r\n    }\r\n  } catch (e) {}\r\n  try {\r\n    if (console && console.log) {\r\n      console.log(message, data);\r\n    }\r\n  } catch (e) {}\r\n}\r\n", "export function setLoadingState(container: HTMLElement, titleText: string) {\r\n  container.innerHTML =\r\n    '<div class=\"title\">' +\r\n    titleText +\r\n    '</div><div class=\"loading\"><em>Loading...</em></div>';\r\n}\r\n\r\nexport function setErrorState(\r\n  container: HTMLElement,\r\n  titleText: string,\r\n  error: string,\r\n) {\r\n  container.innerHTML =\r\n    '<div class=\"title\">' +\r\n    titleText +\r\n    '</div><div style=\"color:var(--vscode-editor-foreground)\">' +\r\n    error +\r\n    \"</div>\";\r\n}\r\n\r\nexport function createLoadMoreButton(onClick: () => void): HTMLButtonElement {\r\n  const btn = document.createElement(\"button\");\r\n  btn.type = \"button\";\r\n  btn.textContent = \"Load more\";\r\n  btn.style.marginLeft = \"8px\";\r\n  btn.style.border = \"1px solid var(--vscode-editorWidget-border)\";\r\n  btn.addEventListener(\"click\", () => {\r\n    onClick();\r\n    btn.disabled = true;\r\n    btn.textContent = \"Loading...\";\r\n  });\r\n  return btn;\r\n}\r\n\r\nexport function clearElement(element: HTMLElement) {\r\n  while (element.firstChild) {\r\n    element.removeChild(element.firstChild);\r\n  }\r\n}\r\n\r\nexport function toggleClass(\r\n  element: HTMLElement,\r\n  className: string,\r\n  force?: boolean,\r\n) {\r\n  element.classList.toggle(className, force);\r\n}\r\n", "/// <reference path=\"./global.d.ts\" />\r\nimport { logDebug } from \"./utils/logger\";\r\nimport {\r\n  setLoadingState,\r\n  setErrorState,\r\n  createLoadMoreButton,\r\n} from \"./utils/domUtils\";\r\n\r\nexport { logDebug, setLoadingState, setErrorState, createLoadMoreButton };\r\n\r\n/**\r\n * Initializes the filter bar using the shared filterBarHelper.\r\n * Returns the barApi if successful, or null.\r\n */\r\nexport function initFilterBar(\r\n  container: HTMLElement,\r\n  viewKey: string,\r\n  options: {\r\n    suffix?: string;\r\n    step?: number;\r\n    effFilter?: string;\r\n    onLoadMore?: () => void;\r\n    onSave?: (filter: any) => void;\r\n    onDiscard?: () => void;\r\n  },\r\n): any {\r\n  if (\r\n    window.filterBarHelper &&\r\n    typeof window.filterBarHelper.create === \"function\"\r\n  ) {\r\n    try {\r\n      return window.filterBarHelper.create({\r\n        parent: container,\r\n        suffix: options.suffix || viewKey,\r\n        effFilter:\r\n          typeof options.effFilter === \"string\" ? options.effFilter : undefined,\r\n        viewKey: viewKey,\r\n        step: options.step || 50,\r\n        onLoadMore: options.onLoadMore,\r\n        onSave: options.onSave,\r\n        onDiscard: options.onDiscard,\r\n      });\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\n/**\r\n * Toggles visibility of elements based on matched IDs from the filter.\r\n */\r\nexport function applyFilterVisibility(\r\n  root: HTMLElement | Document,\r\n  selector: string,\r\n  matchedIds: Set<string>,\r\n  displayStyle: string = \"block\",\r\n) {\r\n  try {\r\n    const elements = Array.from(root.querySelectorAll(selector));\r\n    for (let i = 0; i < elements.length; i++) {\r\n      try {\r\n        const el = elements[i] as HTMLElement;\r\n        const id = el.getAttribute(\"data-gh-item-id\");\r\n        el.style.display = matchedIds.has(String(id)) ? displayStyle : \"none\";\r\n      } catch (e) {}\r\n    }\r\n  } catch (e) {}\r\n}\r\n", "import { normalizeColor, escapeHtml, addAlpha } from \"../utils\";\r\nimport { RowRenderer } from \"./RowRenderer\";\r\n\r\nexport class GroupRenderer {\r\n  constructor(private fields: any[], private allItems: any[], private groupDivisors?: string[] | null) { }\r\n\r\n  private getIconSvg(iconName: string, size: number = 14): string {\r\n    if ((window as any).getIconSvg) {\r\n      return (window as any).getIconSvg(iconName as any, { size });\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  public renderGroup(\r\n    tbody: HTMLTableSectionElement,\r\n    group: any,\r\n    groupingField: any,\r\n    rowRenderer: RowRenderer,\r\n  ) {\r\n    const trHeader = document.createElement(\"tr\");\r\n    trHeader.className = \"group-header\";\r\n    const tdHeader = document.createElement(\"td\");\r\n    tdHeader.colSpan = this.fields.length + 1;\r\n    tdHeader.style.padding = \"8px\";\r\n    tdHeader.style.background = \"var(--vscode-editor-background)\";\r\n    tdHeader.style.fontWeight = \"600\";\r\n    tdHeader.style.borderTop = \"1px solid var(--vscode-editorGroup-border)\";\r\n    tdHeader.style.borderBottom = \"1px solid var(--vscode-editorGroup-border)\";\r\n    tdHeader.style.position = \"sticky\";\r\n    tdHeader.style.top = \"32px\";\r\n    tdHeader.style.zIndex = \"9\";\r\n    tdHeader.style.boxShadow = \"0 1px 2px rgba(0,0,0,0.1)\";\r\n\r\n    const headerContent = document.createElement(\"div\");\r\n    headerContent.style.display = \"flex\";\r\n    headerContent.style.alignItems = \"center\";\r\n    headerContent.style.gap = \"8px\";\r\n\r\n    const built = buildGroupHeaderElement(this.fields, this.allItems, group, groupingField, { groupDivisors: this.groupDivisors });\r\n    const iconExpanded = this.getIconSvg(\"triangle-down\", 16);\r\n    const iconCollapsed = this.getIconSvg(\"triangle-right\", 16);\r\n\r\n    // Apply sticky styles directly to the built element to preserve wrapper structure\r\n    // This ensures the same DOM structure across table, board, and roadmap views\r\n    built.style.position = \"sticky\";\r\n    built.style.left = \"0\";\r\n    built.style.zIndex = \"12\";\r\n    built.style.background = tdHeader.style.background;\r\n    built.style.paddingRight = \"8px\";\r\n\r\n    // Append the built element directly (preserve wrapper) instead of moving children\r\n    headerContent.appendChild(built);\r\n\r\n    const toggleEl = built.querySelector('.group-toggle') as HTMLElement | null;\r\n\r\n    // Note: Avatar handling and \"Unassigned\" rename are now handled in buildGroupHeaderElement()\r\n    // to ensure consistency across table, board, and roadmap views.\r\n\r\n\r\n\r\n    tdHeader.appendChild(headerContent);\r\n    trHeader.appendChild(tdHeader);\r\n    tbody.appendChild(trHeader);\r\n\r\n    // Render Items\r\n    const groupRows: HTMLTableRowElement[] = [];\r\n    // Use a sanitized class name for group toggling (avoid spaces/special chars)\r\n    const rawId = group && group.option && group.option.id ? String(group.option.id) : String(Math.random()).replace(\"0.\", \"_\");\r\n    const safeId = rawId.replace(/\\s+/g, \"-\").replace(/[^A-Za-z0-9_\\-]/g, \"_\");\r\n    group.items.forEach((groupItem: any) => {\r\n      const tr = rowRenderer.createRow(groupItem.item, groupItem.index);\r\n      try {\r\n        tr.classList.add(\"group-row-\" + safeId); // Add class for group toggling\r\n      } catch (e) { }\r\n      tbody.appendChild(tr);\r\n      groupRows.push(tr);\r\n    });\r\n\r\n    // Toggle Logic\r\n    let isCollapsed = false;\r\n    const setCollapsed = (collapsed: boolean) => {\r\n      isCollapsed = collapsed;\r\n      if (toggleEl) toggleEl.innerHTML = isCollapsed ? iconCollapsed : iconExpanded;\r\n      groupRows.forEach((row) => {\r\n        row.style.display = isCollapsed ? \"none\" : \"table-row\";\r\n      });\r\n      try {\r\n        if (isCollapsed) trHeader.classList.add(\"collapsed\");\r\n        else trHeader.classList.remove(\"collapsed\");\r\n      } catch (e) { }\r\n    };\r\n\r\n    if (toggleEl) {\r\n      toggleEl.addEventListener(\"click\", (ev) => {\r\n        ev.stopPropagation();\r\n        setCollapsed(!isCollapsed);\r\n      });\r\n    }\r\n\r\n    // Allow clicking the whole header to toggle collapse/expand for easier interaction and tests\r\n    tdHeader.addEventListener(\"click\", (ev) => {\r\n      // Ignore clicks on controls inside header (e.g., links, buttons)\r\n      const target = ev.target as HTMLElement;\r\n      if (target && (target.tagName === \"BUTTON\" || target.closest(\"button\") || target.closest(\"a\"))) return;\r\n      setCollapsed(!isCollapsed);\r\n    });\r\n  }\r\n\r\n  // Consumers should use the shared `buildGroupHeaderElement` directly when needed.\r\n}\r\n\r\nfunction createEl(tag = \"div\") { return document.createElement(tag); }\r\n\r\nfunction renderColorDot(option: any): HTMLElement {\r\n  const colorDot = createEl(\"div\");\r\n  colorDot.className = \"group-color-dot\";\r\n  colorDot.style.width = \"12px\";\r\n  colorDot.style.height = \"12px\";\r\n  colorDot.style.borderRadius = \"50%\";\r\n  colorDot.style.backgroundColor = normalizeColor(option?.color) || \"gray\";\r\n  colorDot.style.marginRight = \"8px\";\r\n  return colorDot;\r\n}\r\n\r\nfunction renderNameSpan(option: any, groupingField?: any): HTMLElement {\r\n  const nameSpan = createEl(\"span\");\r\n  nameSpan.className = \"group-name\";\r\n  nameSpan.style.fontWeight = \"600\";\r\n  nameSpan.style.marginRight = \"8px\";\r\n  const name = option && (option.name || option.title || option.label) ? String(option.name || option.title || option.label) : \"Unassigned\";\r\n  nameSpan.textContent = name;\r\n  return nameSpan;\r\n}\r\n\r\nfunction renderCountPill(count: number, option: any): HTMLElement {\r\n  const countPill = createEl(\"span\");\r\n  const color = normalizeColor(option?.color) || \"#848d97\";\r\n  countPill.className = \"gh-count-pill\";\r\n  countPill.style.background = addAlpha(color, 0.12) || \"transparent\";\r\n  countPill.style.color = color;\r\n  countPill.style.border = \"1px solid rgba(0,0,0,0.04)\";\r\n  countPill.style.borderRadius = \"10px\";\r\n  countPill.style.padding = \"2px 8px\";\r\n  countPill.style.fontSize = \"11px\";\r\n  countPill.style.fontWeight = \"600\";\r\n  countPill.textContent = String(count || 0);\r\n  return countPill;\r\n}\r\n\r\nfunction renderEstimateElement(fields: any[], itemsArr: any[]): HTMLElement | null {\r\n  if (!Array.isArray(fields)) return null;\r\n  const estimateField =\r\n    fields.find((f: any) => (f.dataType || f.type || \"\").toString().toLowerCase() === \"number\" && String(f.name || \"\").toLowerCase().includes(\"estimate\"),)\r\n    || fields.find((f: any) => (f.dataType || f.type || \"\").toString().toLowerCase() === \"number\");\r\n  if (!estimateField) return null;\r\n  const estimateFieldId = estimateField.id;\r\n  let sum = 0;\r\n  for (const gi of itemsArr || []) {\r\n    const it = gi && (gi.item || gi);\r\n    if (!it || !Array.isArray(it.fieldValues)) continue;\r\n    const fv = it.fieldValues.find((v: any) => (v.fieldId && String(v.fieldId) === String(estimateFieldId)) || (v.fieldName && String(v.fieldName).toLowerCase().includes(\"estimate\")) || v.type === \"number\",\r\n    );\r\n    if (fv) {\r\n      const num = Number(fv.number != null ? fv.number : fv.value != null ? fv.value : NaN);\r\n      if (!isNaN(num)) sum += num;\r\n    }\r\n  }\r\n  if (sum > 0) {\r\n    const el = createEl(\"div\");\r\n    el.style.display = \"inline-block\";\r\n    el.style.padding = \"2px 8px\";\r\n    el.style.borderRadius = \"999px\";\r\n    el.style.border = \"1px solid var(--vscode-panel-border)\";\r\n    el.style.background = \"var(--vscode-input-background)\";\r\n    el.style.color = \"var(--vscode-foreground)\";\r\n    el.style.fontSize = \"12px\";\r\n    el.style.lineHeight = \"18px\";\r\n    el.style.marginLeft = \"8px\";\r\n    el.textContent = \"Estimate: \" + String(sum);\r\n    return el;\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction renderNumericFieldSum(field: any, itemsArr: any[]): HTMLElement | null {\r\n  if (!field) return null;\r\n  const fieldId = field.id || field.name;\r\n  let sum = 0;\r\n  for (const gi of itemsArr || []) {\r\n    const it = gi && (gi.item || gi);\r\n    if (!it || !Array.isArray(it.fieldValues)) continue;\r\n    const fv = it.fieldValues.find((v: any) => (v.fieldId && String(v.fieldId) === String(fieldId)) || (v.fieldName && String(v.fieldName) === String(field.name)) || v.type === \"number\");\r\n    if (fv) {\r\n      const num = Number(fv.number != null ? fv.number : fv.value != null ? fv.value : NaN);\r\n      if (!isNaN(num)) sum += num;\r\n    }\r\n  }\r\n  if (sum !== 0) {\r\n    const el = createEl(\"div\");\r\n    el.style.display = \"inline-block\";\r\n    el.style.padding = \"2px 8px\";\r\n    el.style.borderRadius = \"999px\";\r\n    el.style.border = \"1px solid var(--vscode-panel-border)\";\r\n    el.style.background = \"var(--vscode-input-background)\";\r\n    el.style.color = \"var(--vscode-foreground)\";\r\n    el.style.fontSize = \"12px\";\r\n    el.style.lineHeight = \"18px\";\r\n    el.style.marginLeft = \"8px\";\r\n    el.textContent = String(field.name || fieldId) + \": \" + String(sum);\r\n    return el;\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction getEffectiveGroupDivisorsForFields(fields: any[]): string[] | null {\r\n  try {\r\n    const vs = (window as any).__viewStates || {};\r\n    for (const k of Object.keys(vs)) {\r\n      try {\r\n        const st = vs[k];\r\n        if (!st || !st.fields) continue;\r\n        const stIds = (st.fields || []).map((f: any) => String(f.id));\r\n        const fIds = (fields || []).map((f: any) => String(f.id));\r\n        const common = fIds.filter((id: string) => stIds.indexOf(id) >= 0).length;\r\n        if (common > 0) {\r\n          // found a likely matching view state\r\n          return st.groupDivisors === undefined ? null : st.groupDivisors;\r\n        }\r\n      } catch (e) { }\r\n    }\r\n  } catch (e) { }\r\n  return null;\r\n}\r\n\r\nfunction extractParentFromItem(it: any, groupingField: any): any {\r\n  if (!it) return null;\r\n  const candidates: any[] = [];\r\n  if (Array.isArray(it.fieldValues)) candidates.push(it.fieldValues);\r\n  if (it.content && Array.isArray(it.content.fieldValues)) candidates.push(it.content.fieldValues);\r\n  if (it.raw && it.raw.itemContent && Array.isArray(it.raw.itemContent.fieldValues)) candidates.push(it.raw.itemContent.fieldValues);\r\n  for (const cvs of candidates) {\r\n    const pfv = cvs.find((v: any) => String(v.fieldId) === String(groupingField?.id) || String(v.fieldName) === String(groupingField?.name) || String(v.type) === \"parent_issue\");\r\n    if (pfv) return pfv.parent || pfv.parentIssue || pfv.issue || pfv.item || pfv.value || null;\r\n  }\r\n  return it.parent || it.parentIssue || it.issue || it.item || it.value || null;\r\n}\r\n\r\nfunction renderParentProgress(group: any, groupingField: any, allItems: any[]): HTMLElement | null {\r\n  if (!groupingField || String((groupingField.dataType || groupingField.type) || \"\").toLowerCase() !== \"parent_issue\") return null;\r\n  try {\r\n    let parentMeta: any = null;\r\n    if (group && group.option) parentMeta = group.option.parent || group.option.parentIssue || group.option.issue || parentMeta;\r\n    if (!parentMeta && group.items && group.items.length > 0) {\r\n      const firstRaw = group.items[0];\r\n      const first = firstRaw && firstRaw.item ? firstRaw.item : firstRaw;\r\n      parentMeta = extractParentFromItem(first, groupingField) || parentMeta;\r\n    }\r\n    if (!parentMeta) return null;\r\n    const identifiers: string[] = [];\r\n    const pushIf = (v: any) => { if (v !== undefined && v !== null && v !== \"\") identifiers.push(String(v)); };\r\n    pushIf(parentMeta && parentMeta.number); pushIf(parentMeta && parentMeta.id); pushIf(parentMeta && parentMeta.url); pushIf(parentMeta && parentMeta.title);\r\n    if (group && group.option) { pushIf(group.option.id); pushIf(group.option.name); pushIf(group.option.title); }\r\n    const found = (allItems || []).find((A: any) => {\r\n      const d = (A && (A.content || (A.raw && A.raw.itemContent))) || A || null; if (!d) return false;\r\n      const M: string[] = []; const tryPush = (x: any) => { if (x !== undefined && x !== null && x !== \"\") M.push(String(x)); };\r\n      tryPush(d.number); tryPush(d.id); tryPush(d.url); tryPush(d.title); tryPush(d.name);\r\n      if (d.raw) { tryPush(d.raw.number); tryPush(d.raw.id); tryPush(d.raw.url); }\r\n      if (d.itemContent && typeof d.itemContent === 'object') { tryPush(d.itemContent.number); tryPush(d.itemContent.id); tryPush(d.itemContent.url); tryPush(d.itemContent.title); tryPush(d.itemContent.name); }\r\n      for (const o of identifiers) { for (const m of M) { if (o && m && String(o) === String(m)) return true; } }\r\n      return false;\r\n    });\r\n    // Progress bar calculation - don't require finding the parent in allItems,\r\n    // we can calculate progress directly from group items\r\n    let done = 0, total = 0; const itemsList = group.items || [];\r\n    const isDoneByHeuristics = (it: any) => {\r\n      try {\r\n        const content = it && (it.content || (it.raw && it.raw.itemContent));\r\n        if (content) {\r\n          const state = (content.state || (content.merged ? \"MERGED\" : undefined) || \"\").toString().toUpperCase(); if (state === \"CLOSED\" || state === \"MERGED\") return true;\r\n        }\r\n        if (Array.isArray(it.fieldValues)) {\r\n          const ss = it.fieldValues.find((v: any) => v && v.type === \"single_select\" && v.option && v.option.name && [\"done\", \"closed\", \"completed\", \"finished\"].includes(String(v.option.name).toLowerCase())); if (ss) return true;\r\n          const percentFV = it.fieldValues.find((v: any) => v && (String(v.fieldName || \"\").toLowerCase().includes(\"progress\") || String(v.fieldName || \"\").toLowerCase().includes(\"percent\")));\r\n          if (percentFV && percentFV.number != null) { const pct = Number(percentFV.number || 0); if (pct >= 100) return true; }\r\n        }\r\n      } catch (e) { }\r\n      return false;\r\n    };\r\n    for (const gi of itemsList) { const it = gi.item || gi; if (!it) continue; total++; if (isDoneByHeuristics(it)) done++; }\r\n    if (total > 0) { const pct = Math.round((done / total) * 100); const progWrapper = createEl(\"div\"); progWrapper.className = \"group-progress\"; progWrapper.style.display = \"inline-flex\"; progWrapper.style.alignItems = \"center\"; progWrapper.style.gap = \"8px\"; progWrapper.style.marginLeft = \"8px\"; const bar = createEl(\"div\"); bar.style.display = \"inline-block\"; bar.style.width = \"120px\"; bar.style.height = \"12px\"; bar.style.background = \"transparent\"; bar.style.border = \"1px solid var(--vscode-focusBorder)\"; bar.style.borderRadius = \"6px\"; bar.style.overflow = \"hidden\"; const fill = createEl(\"div\"); fill.style.height = \"100%\"; fill.style.width = String(pct) + \"%\"; fill.style.background = \"var(--vscode-focusBorder)\"; bar.appendChild(fill); progWrapper.appendChild(bar); return progWrapper; }\r\n  } catch (e) { }\r\n  return null;\r\n}\r\n\r\nfunction renderIterationElement(group: any, groupingField: any): HTMLElement | null {\r\n  if (!groupingField) return null;\r\n  try {\r\n    const dtype = String((groupingField.dataType || groupingField.type) || \"\").toLowerCase(); if (dtype !== \"iteration\") return null;\r\n    const opt = group.option || {}; let iterText: string | null = null; const start = opt.startDate || (opt.start && opt.startDate) || null; const duration = opt.duration || opt.length || null;\r\n    if (start && duration) { try { const s = new Date(start); const days = Number(duration) || 0; const e = new Date(s.getTime() + days * 24 * 60 * 60 * 1000); const sStr = s.toLocaleDateString(\"en-US\", { month: \"short\", day: \"numeric\" }); const eStr = e.toLocaleDateString(\"en-US\", { month: \"short\", day: \"numeric\" }); iterText = `${sStr} \u2014 ${eStr}`; } catch (e) { iterText = null; } }\r\n    if (!iterText) iterText = opt.title || opt.name ? String(opt.title || opt.name) : null;\r\n    if (iterText) { const iterEl = createEl(\"div\"); iterEl.style.color = \"var(--vscode-descriptionForeground)\"; iterEl.style.fontSize = \"12px\"; iterEl.style.marginLeft = \"8px\"; iterEl.textContent = String(iterText).slice(0, 120); return iterEl; }\r\n  } catch (e) { }\r\n  return null;\r\n}\r\n\r\nfunction getIconSvg(iconName: string, size: number = 14): string {\r\n  if ((window as any).getIconSvg) return (window as any).getIconSvg(iconName as any, { size });\r\n  return \"\";\r\n}\r\n\r\nexport function buildGroupHeaderElement(fields: any[], allItems: any[], group: any, groupingField: any, options?: { hideToggle?: boolean; viewKey?: string; groupDivisors?: string[] | null }): HTMLElement {\r\n  // Normalize grouping field: callers may pass a minimal field or an option-like object.\r\n  const groupingFieldDef = (groupingField && (groupingField.dataType || groupingField.type))\r\n    ? groupingField\r\n    : (Array.isArray(fields) ? fields.find((f: any) => String(f.id) === String(groupingField?.id) || String(f.name) === String(groupingField?.name)) : groupingField) || groupingField;\r\n  const header = document.createElement(\"div\");\r\n  // Provide both the legacy `group-header` class and the newer `group-header-div`\r\n  // so table/board/roadmap styles/selectors match the same element.\r\n  header.className = \"group-header group-header-div\";\r\n  header.style.display = \"flex\";\r\n  header.style.alignItems = \"center\";\r\n  header.style.padding = \"8px\";\r\n  header.style.background = \"var(--vscode-sideBar-background)\";\r\n\r\n  // Toggle placeholder (only render if hideToggle is not set)\r\n  if (!options?.hideToggle) {\r\n    const toggleSpan = document.createElement(\"span\");\r\n    toggleSpan.className = \"group-toggle\";\r\n    toggleSpan.style.cursor = \"pointer\";\r\n    toggleSpan.style.marginRight = \"8px\";\r\n    // Provide a visible default icon so board/roadmap show the toggle correctly\r\n    try { toggleSpan.innerHTML = getIconSvg('triangle-down', 16); } catch (e) { }\r\n    header.appendChild(toggleSpan);\r\n  }\r\n\r\n  // Color / Name / Count (use shared renderers)\r\n  const colorDot = renderColorDot(group.option || {});\r\n  // also add board-specific class for backward compatibility\r\n  colorDot.classList.add('board-card-color-dot');\r\n  header.appendChild(colorDot);\r\n  const nameSpan = renderNameSpan(group.option || {}, groupingFieldDef);\r\n  // add board title class for compatibility\r\n  nameSpan.classList.add('board-card-title');\r\n  header.appendChild(nameSpan);\r\n  // Determine group divisors configuration: explicit array = render selected pills; undefined/null = render nothing\r\n  let effectiveDivisors: string[] | null | undefined = undefined;\r\n  try {\r\n    if (options && Object.prototype.hasOwnProperty.call(options, 'groupDivisors')) {\r\n      effectiveDivisors = options!.groupDivisors;\r\n    } else if (options && options.viewKey) {\r\n      try {\r\n        const vs = (window as any).__viewStates || {};\r\n        effectiveDivisors = vs[options.viewKey] ? vs[options.viewKey].groupDivisors : undefined;\r\n      } catch (e) { effectiveDivisors = undefined; }\r\n    }\r\n  } catch (e) { effectiveDivisors = undefined; }\r\n\r\n  if (Array.isArray(effectiveDivisors)) {\r\n    // Only render Count if explicitly selected (__count__)\r\n    if (effectiveDivisors.find((x: any) => String(x) === '__count__')) {\r\n      const countPill = renderCountPill((group.items && group.items.length) || 0, group.option || {});\r\n      countPill.classList.add('board-card-count');\r\n      header.appendChild(countPill);\r\n    }\r\n    // For each selected numeric field, render a summed pill\r\n    try {\r\n      const numericFields = (fields || []).filter((f: any) => String((f.dataType || f.type || '').toLowerCase()) === 'number' || String(f.name || '').toLowerCase().includes('estimate'));\r\n      for (const sel of effectiveDivisors) {\r\n        if (String(sel) === '__count__') continue;\r\n        const f = numericFields.find((nf: any) => String(nf.id) === String(sel) || String(nf.name) === String(sel));\r\n        if (f) {\r\n          const el = renderNumericFieldSum(f, group.items || []);\r\n          if (el) {\r\n            el.classList.add('board-card-estimate');\r\n            header.appendChild(el);\r\n          }\r\n        }\r\n      }\r\n    } catch (e) { }\r\n  }\r\n\r\n  // Avatar handling: if option has avatar data or groupingField is assignees,\r\n  // try to replace the color dot with an avatar image (works for table/board/roadmap)\r\n  try {\r\n    const opt = group && group.option ? group.option : {};\r\n    const shouldShowAvatar = opt && (opt.avatarUrl || opt.avatar || opt.imageUrl || opt.login)\r\n      || (opt && opt.name && String((groupingFieldDef && (groupingFieldDef.dataType || groupingFieldDef.type) || \"\").toLowerCase()) === \"assignees\");\r\n    if (shouldShowAvatar) {\r\n      let avatarUrl = opt.avatarUrl || opt.avatar || opt.imageUrl || null;\r\n      if (!avatarUrl && Array.isArray(group.items)) {\r\n        for (const gi of group.items || []) {\r\n          const it = gi && (gi.item || gi);\r\n          if (!it || !Array.isArray(it.fieldValues)) continue;\r\n          const fv = it.fieldValues.find((v: any) => v && (v.type === \"assignees\" || String(v.fieldId) === String(groupingFieldDef && groupingFieldDef.id)));\r\n          if (fv && fv.assignees && Array.isArray(fv.assignees)) {\r\n            const match = fv.assignees.find((a: any) => String(a.login || a.name) === String(opt.name || opt.id));\r\n            if (match && (match.avatarUrl || match.avatar)) { avatarUrl = match.avatarUrl || match.avatar; break; }\r\n          }\r\n        }\r\n      }\r\n      if (avatarUrl && colorDot && colorDot.parentNode) {\r\n        const avatarEl = document.createElement(\"span\");\r\n        avatarEl.innerHTML = '<span title=\"' + escapeHtml((opt && (opt.login || opt.name)) || \"Assignee\") + '\" style=\"display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url(' + escapeHtml(avatarUrl) + ');border:2px solid var(--vscode-editor-background)\"></span>';\r\n        colorDot.parentNode.replaceChild(avatarEl, colorDot);\r\n      }\r\n    }\r\n  } catch (e) { }\r\n\r\n  // If this group corresponds to 'Unassigned', rename to 'No <fieldname>' for all views\r\n  try {\r\n    if (group && group.option && (group.option.name === \"Unassigned\" || group.option.title === \"Unassigned\")) {\r\n      if (nameSpan) nameSpan.textContent = \"No \" + (groupingFieldDef && (groupingFieldDef.name || groupingFieldDef.title) ? (groupingFieldDef.name || groupingFieldDef.title) : \"value\");\r\n    }\r\n  } catch (e) { }\r\n\r\n  try {\r\n    const parentEl = renderParentProgress(group, groupingFieldDef, allItems);\r\n    if (parentEl) header.appendChild(parentEl);\r\n  } catch (e) { }\r\n\r\n  try {\r\n    const iterEl = renderIterationElement(group, groupingFieldDef);\r\n    if (iterEl) header.appendChild(iterEl);\r\n  } catch (e) { }\r\n  return header;\r\n}\r\n", "import {\r\n  normalizeColor,\r\n  escapeHtml,\r\n  addAlpha,\r\n  getContrastColor,\r\n} from \"../utils\";\r\nimport { buildGroupHeaderElement } from \"./GroupRenderer\";\r\nimport { GroupDataService } from \"../services/GroupDataService\";\r\n\r\n/**\r\n * BoardCardRenderer - Renders board view cards grouped by column field\r\n * Each card represents a column option (from single_select or iteration field)\r\n */\r\nexport class BoardCardRenderer {\r\n  constructor(\r\n    private fields: any[],\r\n    private allItems: any[],\r\n    private visibleFieldIds?: string[],\r\n    private onFilter?: (filter: string) => void,\r\n    private onAction?: (action: string, item: any, args?: any) => void,\r\n    private groupDivisors?: string[] | null,\r\n  ) {\r\n    // Bind methods\r\n    this.handlePillClick = this.handlePillClick.bind(this);\r\n  }\r\n\r\n  /**\r\n   * Handle pill click for filtering\r\n   */\r\n  private handlePillClick(e: MouseEvent, field: string, value: string) {\r\n    e.stopPropagation(); // Prevent opening item\r\n    e.preventDefault();\r\n    if (this.onFilter) {\r\n      const safeValue = value.includes(\" \")\r\n        ? `\"${value.replace(/\"/g, '\\\\\"')}\"`\r\n        : value;\r\n      // Quote field if it contains spaces\r\n      const safeField = field.includes(\" \")\r\n        ? `\"${field.replace(/\"/g, '\\\\\"')}\"`\r\n        : field;\r\n      this.onFilter(`${safeField}:${safeValue}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Helper to get icon SVG from registry\r\n   */\r\n  private getIconSvg(\r\n    iconName: string,\r\n    size: number = 14,\r\n    fill?: string,\r\n  ): string {\r\n    if ((window as any).getIconSvg) {\r\n      return (window as any).getIconSvg(iconName, { size, fill });\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  /**\r\n   * Find estimate field (prioritize fields with \"estimate\" in name)\r\n   */\r\n  private getEstimateField(): any {\r\n    return (\r\n      this.fields.find(\r\n        (f) =>\r\n          f.dataType &&\r\n          String(f.dataType).toLowerCase() === \"number\" &&\r\n          String(f.name || \"\")\r\n            .toLowerCase()\r\n            .includes(\"estimate\"),\r\n      ) ||\r\n      this.fields.find(\r\n        (f) => f.dataType && String(f.dataType).toLowerCase() === \"number\",\r\n      )\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Sum estimate values for a list of items\r\n   */\r\n  public sumEstimate(items: any[]): number {\r\n    const estimateField = this.getEstimateField();\r\n    if (!estimateField) return 0;\r\n\r\n    let sum = 0;\r\n    for (const item of items) {\r\n      if (!item || !Array.isArray(item.fieldValues)) continue;\r\n      const fv = item.fieldValues.find(\r\n        (v: any) =>\r\n          (v.fieldId && String(v.fieldId) === String(estimateField.id)) ||\r\n          (v.fieldName &&\r\n            String(v.fieldName).toLowerCase().includes(\"estimate\")) ||\r\n          v.type === \"number\",\r\n      );\r\n      if (fv) {\r\n        const num = Number(\r\n          fv.number != null ? fv.number : fv.value != null ? fv.value : NaN,\r\n        );\r\n        if (!isNaN(num)) sum += num;\r\n      }\r\n    }\r\n    return sum;\r\n  }\r\n\r\n  /**\r\n   * Format estimate number for display\r\n   */\r\n  private formatEstimate(n: number): string {\r\n    if (!isFinite(n)) return \"\";\r\n    return String(n);\r\n  }\r\n\r\n  /**\r\n   * Group items by column field value\r\n   */\r\n  public groupItemsByColumn(\r\n    items: any[],\r\n    columnField: any,\r\n  ): Map<string, { option: any; items: any[] }> {\r\n    const groups = new Map<string, { option: any; items: any[] }>();\r\n    const dataType = String(columnField.dataType || \"\").toLowerCase();\r\n\r\n    // Get all options from the field configuration\r\n    let options: any[] = [];\r\n    if (dataType === \"single_select\" && Array.isArray(columnField.options)) {\r\n      options = columnField.options;\r\n    } else if (\r\n      dataType === \"iteration\" &&\r\n      columnField.configuration?.iterations\r\n    ) {\r\n      options = columnField.configuration.iterations.map((it: any) => ({\r\n        id: it.id,\r\n        name: it.title,\r\n        title: it.title,\r\n        color: it.color || null,\r\n        startDate: it.startDate,\r\n        duration: it.duration,\r\n      }));\r\n    }\r\n\r\n    // Initialize groups for each option in order\r\n    for (const opt of options) {\r\n      const key = String(opt.id || opt.name || \"\");\r\n      if (key) {\r\n        groups.set(key, { option: opt, items: [] });\r\n      }\r\n    }\r\n\r\n    // Add \"No value\" group\r\n    groups.set(\"__no_value__\", {\r\n      option: {\r\n        id: \"__no_value__\",\r\n        name: `No ${columnField.name}`,\r\n        color: null,\r\n      },\r\n      items: [],\r\n    });\r\n\r\n    // Assign items to groups\r\n    for (const item of items) {\r\n      if (!item || !Array.isArray(item.fieldValues)) {\r\n        groups.get(\"__no_value__\")!.items.push(item);\r\n        continue;\r\n      }\r\n\r\n      const fv = item.fieldValues.find(\r\n        (v: any) =>\r\n          String(v.fieldId) === String(columnField.id) ||\r\n          String(v.fieldName).toLowerCase() === String(columnField.name).toLowerCase()\r\n      );\r\n\r\n      let groupKey = \"__no_value__\";\r\n\r\n      if (fv) {\r\n        if (dataType === \"single_select\") {\r\n          const optId = fv.optionId || (fv.option && fv.option.id);\r\n          const optName = fv.name || (fv.option && fv.option.name);\r\n          if (optId && groups.has(String(optId))) {\r\n            groupKey = String(optId);\r\n          } else if (optName) {\r\n            for (const [key, group] of groups) {\r\n              if (String(group.option.name).toLowerCase() === String(optName).toLowerCase()) {\r\n                groupKey = key;\r\n                break;\r\n              }\r\n            }\r\n          }\r\n        } else if (dataType === \"iteration\") {\r\n          const itId = fv.iterationId || (fv.iteration && fv.iteration.id) || fv.id;\r\n          const itTitle = fv.title || (fv.iteration && fv.iteration.title);\r\n          if (itId && groups.has(String(itId))) {\r\n            groupKey = String(itId);\r\n          } else if (itTitle) {\r\n            for (const [key, group] of groups) {\r\n              if (String(group.option.title).toLowerCase() === String(itTitle).toLowerCase() ||\r\n                String(group.option.name).toLowerCase() === String(itTitle).toLowerCase()) {\r\n                groupKey = key;\r\n                break;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      if (groups.has(groupKey)) {\r\n        groups.get(groupKey)!.items.push(item);\r\n      } else {\r\n        groups.get(\"__no_value__\")!.items.push(item);\r\n      }\r\n    }\r\n\r\n    return groups;\r\n  }\r\n\r\n  /**\r\n   * Get iteration date range string\r\n   */\r\n  private getIterationRange(option: any): string | null {\r\n    const start = option.startDate || option.start;\r\n    const duration = option.duration || option.length;\r\n\r\n    if (!start || !duration) return null;\r\n\r\n    try {\r\n      const startDate = new Date(start);\r\n      const endDate = new Date(\r\n        startDate.getTime() + Number(duration) * 24 * 60 * 60 * 1000,\r\n      );\r\n\r\n      const formatDate = (d: Date) =>\r\n        d.toLocaleDateString(\"en-US\", { month: \"short\", day: \"numeric\" });\r\n\r\n      return `${formatDate(startDate)} \u2014 ${formatDate(endDate)}`;\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Render a single card for a column\r\n   */\r\n  public renderCard(option: any, items: any[], columnField: any): HTMLElement {\r\n    const card = document.createElement(\"div\");\r\n    card.className = \"board-card\";\r\n    card.setAttribute(\"data-column-id\", String(option.id || option.name || \"\"));\r\n    card.style.width = \"350px\";\r\n    card.style.minWidth = \"350px\";\r\n    card.style.maxWidth = \"350px\";\r\n    card.style.background = \"var(--vscode-editorWidget-background)\";\r\n    card.style.border = \"1px solid var(--vscode-editorWidget-border)\";\r\n    card.style.borderRadius = \"0\";\r\n    card.style.display = \"flex\";\r\n    card.style.flexDirection = \"column\";\r\n    card.style.flexShrink = \"0\";\r\n\r\n    // Card Header\r\n    const header = this.renderColumnHeaderOnly(option, items, columnField);\r\n    header.style.borderBottom = \"1px solid var(--vscode-editorWidget-border)\";\r\n    card.appendChild(header);\r\n\r\n    // Card Items - with scroll for overflow\r\n    const itemsContainer = document.createElement(\"div\");\r\n    itemsContainer.className = \"board-card-items\";\r\n    itemsContainer.style.padding = \"8px\";\r\n    itemsContainer.style.overflowY = \"auto\";\r\n    itemsContainer.style.flex = \"1\";\r\n    itemsContainer.style.minHeight = \"0\"; // Important for flex scroll\r\n\r\n    // Get the column option color for items\r\n    const columnColor = normalizeColor(option.color) || \"#666666\";\r\n\r\n    for (const item of items) {\r\n      const itemEl = this.renderItem(item, columnField, columnColor);\r\n      itemsContainer.appendChild(itemEl);\r\n    }\r\n\r\n    card.appendChild(itemsContainer);\r\n\r\n    // Card Footer - Add item button\r\n    const footer = this.renderColumnFooterOnly(option, columnField);\r\n    card.appendChild(footer);\r\n\r\n    return card;\r\n  }\r\n\r\n  /**\r\n   * Render only the column header\r\n   */\r\n  private renderColumnHeaderOnly(\r\n    option: any,\r\n    items: any[],\r\n    columnField: any,\r\n  ): HTMLElement {\r\n    const dataType = String(columnField.dataType || \"\").toLowerCase();\r\n    const header = document.createElement(\"div\");\r\n    header.className = \"board-card-header\";\r\n    header.style.padding = \"12px\";\r\n    header.style.background = \"var(--vscode-sideBar-background)\";\r\n    header.style.flexShrink = \"0\";\r\n\r\n    // Use shared header builder to ensure consistency with table/roadmap\r\n    const headerRow = buildGroupHeaderElement(this.fields, this.allItems, { option, items }, columnField, { hideToggle: true, groupDivisors: this.groupDivisors });\r\n    // Adjust classes to match board styles\r\n    headerRow.classList.add(\"board-card-header-row\");\r\n    // Mirror some class names expected by board tests and styles\r\n    const colorDot = headerRow.querySelector('.group-color-dot');\r\n    if (colorDot) colorDot.classList.add('board-card-color-dot');\r\n    const nameSpan = headerRow.querySelector('.group-name');\r\n    if (nameSpan) nameSpan.classList.add('board-card-title');\r\n    const countPill = headerRow.querySelector('.gh-count-pill');\r\n    if (countPill) countPill.classList.add('board-card-count');\r\n    // Add estimate class if builder created an estimate element with text 'Estimate:'\r\n    const children = Array.from(headerRow.children) as HTMLElement[];\r\n    for (const ch of children) {\r\n      try {\r\n        if (ch.textContent && ch.textContent.trim().startsWith('Estimate:')) {\r\n          ch.classList.add('board-card-estimate');\r\n        }\r\n      } catch (_) { }\r\n    }\r\n    // Note: We no longer strip \"Estimate:\" prefix to maintain consistency with table/roadmap views\r\n    header.appendChild(headerRow);\r\n\r\n    // Header Row 2: for single_select show option description (builder handles iteration)\r\n    if (dataType === \"single_select\" && option.description) {\r\n      const descRow = document.createElement(\"div\");\r\n      descRow.className = \"board-card-description\";\r\n      descRow.style.fontSize = \"12px\";\r\n      descRow.style.color = \"var(--vscode-descriptionForeground)\";\r\n      descRow.style.marginTop = \"4px\";\r\n      descRow.style.overflow = \"hidden\";\r\n      descRow.style.textOverflow = \"ellipsis\";\r\n      descRow.style.whiteSpace = \"nowrap\";\r\n      descRow.textContent = String(option.description).slice(0, 120);\r\n      header.appendChild(descRow);\r\n    }\r\n    // If iteration, builder may have appended an iteration element \u2014 ensure it has board description class\r\n    if (dataType === \"iteration\") {\r\n      const maybeIter = headerRow.lastElementChild as HTMLElement | null;\r\n      if (maybeIter && maybeIter.textContent && maybeIter.textContent.indexOf('\u2014') !== -1) {\r\n        maybeIter.classList.add('board-card-description');\r\n      }\r\n    }\r\n\r\n    return header;\r\n  }\r\n\r\n  /**\r\n   * Render only the column footer (Add item button)\r\n   */\r\n  private renderColumnFooterOnly(option: any, columnField: any): HTMLElement {\r\n    const footer = document.createElement(\"div\");\r\n    footer.className = \"board-card-footer\";\r\n    footer.style.padding = \"8px 12px\";\r\n    footer.style.borderTop = \"1px solid var(--vscode-editorWidget-border)\";\r\n    footer.style.cursor = \"pointer\";\r\n    footer.style.userSelect = \"none\";\r\n    footer.style.flexShrink = \"0\";\r\n    footer.style.transition = \"background-color 0.15s ease\";\r\n    footer.setAttribute(\"data-column-field-id\", String(columnField.id || \"\"));\r\n    footer.setAttribute(\"data-column-value-id\", String(option.id || \"\"));\r\n    footer.setAttribute(\r\n      \"data-column-value-name\",\r\n      String(option.name || option.title || \"\"),\r\n    );\r\n\r\n    const addLabel = document.createElement(\"span\");\r\n    addLabel.textContent = \"+ Add item\";\r\n    addLabel.style.opacity = \"0.9\";\r\n    addLabel.style.fontSize = \"13px\";\r\n    footer.appendChild(addLabel);\r\n\r\n    footer.addEventListener(\"mouseenter\", () => {\r\n      footer.style.backgroundColor = \"var(--vscode-list-hoverBackground)\";\r\n    });\r\n    footer.addEventListener(\"mouseleave\", () => {\r\n      footer.style.backgroundColor = \"transparent\";\r\n    });\r\n\r\n    footer.addEventListener(\"click\", (e) => {\r\n      e.stopPropagation();\r\n      if (this.onAction) {\r\n        this.onAction(\r\n          \"add-item-to-column\",\r\n          {\r\n            columnFieldId: columnField.id,\r\n            columnValueId: option.id,\r\n            columnValueName: option.name || option.title,\r\n          },\r\n          {\r\n            anchorElement: footer,\r\n          },\r\n        );\r\n      }\r\n    });\r\n\r\n    return footer;\r\n  }\r\n\r\n  /**\r\n   * Render a single item within a card with full details\r\n   */\r\n  private renderItem(\r\n    item: any,\r\n    columnField: any,\r\n    columnColor: string,\r\n  ): HTMLElement {\r\n    const el = document.createElement(\"div\");\r\n    el.className = \"board-item\";\r\n    el.setAttribute(\"data-gh-item-id\", String(item?.id || \"\"));\r\n    el.style.padding = \"10px\";\r\n    el.style.border = \"1px solid var(--vscode-editorWidget-border)\";\r\n    el.style.borderRadius = \"0\";\r\n    el.style.marginBottom = \"8px\";\r\n    el.style.background = \"var(--vscode-editor-background)\";\r\n    el.style.cursor = \"pointer\";\r\n    el.style.position = \"relative\";\r\n\r\n    // Extract content information\r\n    const content =\r\n      item?.content || (item?.raw && item.raw.itemContent) || null;\r\n    const titleText =\r\n      (item?.content && (item.content.title || item.content.name)) ||\r\n      item?.title ||\r\n      (item?.raw && item.raw.title) ||\r\n      \"Untitled\";\r\n\r\n    const number =\r\n      (item?.content && item.content.number) ||\r\n      (item?.raw && item.raw.itemContent && item.raw.itemContent.number) ||\r\n      null;\r\n\r\n    const url =\r\n      (item?.content && item.content.url) ||\r\n      (item?.raw && item.raw.itemContent && item.raw.itemContent.url) ||\r\n      null;\r\n\r\n    // Determine icon based on content type\r\n    let iconName = \"issue-opened\";\r\n    let isPR = false;\r\n    if (content) {\r\n      const typename = String(content.__typename || \"\").toLowerCase();\r\n      const state = String(content.state || \"\").toUpperCase();\r\n      isPR = typename.includes(\"pullrequest\");\r\n      const isClosed = state === \"CLOSED\";\r\n      const isMerged = content.merged === true;\r\n      const isDraft = content.isDraft === true;\r\n\r\n      if (isPR) {\r\n        if (isMerged) iconName = \"git-merge\";\r\n        else if (isClosed) iconName = \"git-pull-request-closed\";\r\n        else if (isDraft) iconName = \"git-pull-request-draft\";\r\n        else iconName = \"git-pull-request\";\r\n      } else {\r\n        if (isClosed) iconName = \"issue-closed\";\r\n        else if (isDraft) iconName = \"issue-draft\";\r\n        else iconName = \"issue-opened\";\r\n      }\r\n    }\r\n\r\n    // Determine blocked status\r\n    let isBlocked = false;\r\n    try {\r\n      const deps =\r\n        content && (content as any).issueDependenciesSummary\r\n          ? (content as any).issueDependenciesSummary\r\n          : null;\r\n      const blockedByCount =\r\n        deps && typeof deps.blockedBy === \"number\" ? deps.blockedBy : 0;\r\n      isBlocked = blockedByCount > 0;\r\n    } catch (_) { }\r\n\r\n    // Use column color for the icon (matches column header)\r\n    const iconColor = columnColor;\r\n\r\n    // Extract assignees for top-right corner\r\n    const assignees = this.extractAssignees(item);\r\n\r\n    // Build item HTML\r\n    const mainContent = document.createElement(\"div\");\r\n    mainContent.style.display = \"flex\";\r\n    mainContent.style.flexDirection = \"column\";\r\n    mainContent.style.gap = \"6px\";\r\n\r\n    // Row 1: Icon with column color and blocked overlay\r\n    const iconRow = document.createElement(\"div\");\r\n    iconRow.style.display = \"flex\";\r\n    iconRow.style.justifyContent = \"flex-start\";\r\n    iconRow.style.alignItems = \"center\";\r\n\r\n    const baseIcon = this.getIconSvg(iconName, 16, iconColor);\r\n    const blockedOverlay = isBlocked\r\n      ? `<span class='blocked-overlay' style='position:absolute;right:-3px;bottom:-3px;width:14px;height:14px;border-radius:999px;background:var(--vscode-editor-background);display:flex;align-items:center;justify-content:center;box-sizing:border-box;'>${this.getIconSvg(\"blocked\", 9, \"#dc3545\")}</span>`\r\n      : \"\";\r\n\r\n    iconRow.innerHTML = `<span style=\"position:relative;display:inline-flex;align-items:center;justify-content:center;color:${escapeHtml(iconColor)};\">${baseIcon}${blockedOverlay}</span>`;\r\n\r\n    // Add menu button\r\n    const menuBtn = document.createElement(\"span\");\r\n    menuBtn.className = \"board-item-menu-btn\";\r\n    menuBtn.setAttribute(\"data-item-id\", String(item?.id || \"\"));\r\n    menuBtn.style.marginLeft = \"6px\"; // Position after icon\r\n    menuBtn.style.color = \"var(--vscode-descriptionForeground)\";\r\n    menuBtn.innerHTML =\r\n      this.getIconSvg(\"kebab-horizontal\", 14) || \"<span>...</span>\";\r\n    iconRow.appendChild(menuBtn);\r\n\r\n    mainContent.appendChild(iconRow);\r\n\r\n    // Row 2: Title + #number\r\n    const titleRow = document.createElement(\"div\");\r\n    titleRow.style.fontWeight = \"500\";\r\n    titleRow.style.lineHeight = \"1.3\";\r\n    titleRow.innerHTML = `${escapeHtml(titleText)}${number ? ` <span style=\"color:var(--vscode-descriptionForeground);font-weight:400;\">#${escapeHtml(String(number))}</span>` : \"\"}`;\r\n    mainContent.appendChild(titleRow);\r\n\r\n    // Row 3: Field values (except sub_issues_progress and assignees)\r\n    const fieldsRow = this.renderFieldValues(item, columnField);\r\n    if (fieldsRow) {\r\n      mainContent.appendChild(fieldsRow);\r\n    }\r\n\r\n    // Row 4: Sub-issues progress (if applicable)\r\n    const subIssuesProgress = this.renderSubIssuesProgress(item);\r\n    if (subIssuesProgress) {\r\n      mainContent.appendChild(subIssuesProgress);\r\n    }\r\n\r\n    el.appendChild(mainContent);\r\n\r\n    // Top-right corner: Assignee avatars\r\n    if (assignees && assignees.length > 0) {\r\n      const avatarsContainer = this.renderAssigneeAvatars(assignees);\r\n      avatarsContainer.style.position = \"absolute\";\r\n      avatarsContainer.style.top = \"10px\";\r\n      avatarsContainer.style.right = \"10px\";\r\n      el.appendChild(avatarsContainer);\r\n    }\r\n\r\n    // Add click handler if URL available\r\n    if (url) {\r\n      el.setAttribute(\"data-gh-open\", url);\r\n      el.title = `${titleText}${number ? ` #${number}` : \"\"}`;\r\n    }\r\n\r\n    return el;\r\n  }\r\n\r\n  /**\r\n   * Helper: Get field name from value or lookup in fields definition\r\n   */\r\n  private getFieldName(fv: any): string {\r\n    if (fv.fieldName) return fv.fieldName;\r\n    if (fv.field?.name) return fv.field.name;\r\n    if (fv.fieldId && this.fields) {\r\n      const found = this.fields.find(\r\n        (f) => String(f.id) === String(fv.fieldId),\r\n      );\r\n      if (found && found.name) return found.name;\r\n    }\r\n    return \"Field\";\r\n  }\r\n\r\n  /**\r\n   * Extract assignees from item\r\n   */\r\n  private extractAssignees(item: any): any[] {\r\n    if (!item) return [];\r\n\r\n    // Try content.assignees first\r\n    if (item.content?.assignees?.nodes) {\r\n      return item.content.assignees.nodes;\r\n    }\r\n    if (item.content?.assignees && Array.isArray(item.content.assignees)) {\r\n      return item.content.assignees;\r\n    }\r\n\r\n    // Try fieldValues\r\n    if (Array.isArray(item.fieldValues)) {\r\n      const assigneesFv = item.fieldValues.find(\r\n        (v: any) => v?.type === \"assignees\" || v?.assignees,\r\n      );\r\n      if (assigneesFv?.assignees) {\r\n        return Array.isArray(assigneesFv.assignees)\r\n          ? assigneesFv.assignees\r\n          : [];\r\n      }\r\n    }\r\n\r\n    return [];\r\n  }\r\n\r\n  /**\r\n   * Extract linked pull requests from item\r\n   */\r\n  private extractLinkedPullRequests(item: any): any[] {\r\n    if (!item) return [];\r\n\r\n    // Try fieldValues first (most common location)\r\n    if (Array.isArray(item.fieldValues)) {\r\n      const prFv = item.fieldValues.find(\r\n        (v: any) =>\r\n          v?.type === \"linked_pull_requests\" || v?.type === \"pull_request\",\r\n      );\r\n      if (prFv) {\r\n        // Check for direct array first (matches table view)\r\n        if (Array.isArray(prFv.pullRequests)) {\r\n          return prFv.pullRequests;\r\n        }\r\n        // Then check for nodes structure\r\n        if (\r\n          prFv.pullRequests?.nodes &&\r\n          Array.isArray(prFv.pullRequests.nodes)\r\n        ) {\r\n          return prFv.pullRequests.nodes;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Try content.linkedPullRequests as fallback\r\n    if (item.content?.linkedPullRequests) {\r\n      if (Array.isArray(item.content.linkedPullRequests)) {\r\n        return item.content.linkedPullRequests;\r\n      }\r\n      if (Array.isArray(item.content.linkedPullRequests.nodes)) {\r\n        return item.content.linkedPullRequests.nodes;\r\n      }\r\n    }\r\n\r\n    return [];\r\n  }\r\n\r\n  /**\r\n   * Render assignee avatars for top-right corner\r\n   */\r\n  private renderAssigneeAvatars(assignees: any[]): HTMLElement {\r\n    const container = document.createElement(\"div\");\r\n    container.className = \"board-item-assignees\";\r\n    container.style.display = \"flex\";\r\n    container.style.alignItems = \"center\";\r\n\r\n    const maxAvatars = 3;\r\n    const displayed = assignees.slice(0, maxAvatars);\r\n\r\n    displayed.forEach((assignee, index) => {\r\n      const login = assignee.login || assignee.name || \"Unknown\";\r\n      const avatarUrl = assignee.avatarUrl || \"\";\r\n      if (!avatarUrl) return;\r\n\r\n      const img = document.createElement(\"img\");\r\n      img.src = avatarUrl;\r\n      img.className = \"board-pill\"; // Use board-pill class for click handling\r\n      img.setAttribute(\"data-filter-field\", \"Assignees\");\r\n      img.setAttribute(\"data-filter-value\", login);\r\n      img.title = login;\r\n      img.style.width = \"16px\";\r\n      img.style.height = \"16px\";\r\n      img.style.borderRadius = \"50%\";\r\n      img.style.border = \"1px solid var(--vscode-editorWidget-border)\";\r\n      img.style.cursor = \"pointer\";\r\n      img.style.marginLeft = index === 0 ? \"0\" : \"-6px\";\r\n      img.style.zIndex = String(maxAvatars - index);\r\n      img.style.position = \"relative\";\r\n\r\n      container.appendChild(img);\r\n    });\r\n\r\n    // If more assignees, show +N\r\n    if (assignees.length > maxAvatars) {\r\n      const more = document.createElement(\"span\");\r\n      more.className = \"board-pill\";\r\n      more.setAttribute(\"data-filter-field\", \"Assignees\"); // Can filter by \"Assignees\" generic? No, value missing.\r\n      // Maybe just cosmetic or filter by \"Assignees:HasAny\"?\r\n      // For now just cosmetic.\r\n      more.style.marginLeft = \"-6px\";\r\n      more.style.width = \"22px\";\r\n      more.style.height = \"22px\";\r\n      more.style.borderRadius = \"50%\";\r\n      more.style.background = \"var(--vscode-badge-background)\";\r\n      more.style.color = \"var(--vscode-badge-foreground)\";\r\n      more.style.fontSize = \"10px\";\r\n      more.style.display = \"flex\";\r\n      more.style.alignItems = \"center\";\r\n      more.style.justifyContent = \"center\";\r\n      more.style.fontWeight = \"bold\";\r\n      more.style.lineHeight = \"1\";\r\n      more.textContent = `+${assignees.length - maxAvatars}`;\r\n      more.title = \"More assignees\";\r\n      container.appendChild(more);\r\n    }\r\n\r\n    return container;\r\n  }\r\n\r\n  /**\r\n   * Render visible field values (excluding sub_issues_progress and assignees)\r\n   */\r\n  private renderFieldValues(item: any, columnField: any): HTMLElement | null {\r\n    if (!item || !Array.isArray(item.fieldValues)) return null;\r\n\r\n    const excludeTypes = [\r\n      \"sub_issues_progress\",\r\n      \"assignees\",\r\n      \"title\",\r\n      \"status\",\r\n    ];\r\n    const excludeFieldNames = [\"sub issues progress\", \"assignees\", \"title\"];\r\n    const columnFieldId = columnField?.id;\r\n\r\n    const valuePills: string[] = [];\r\n\r\n    // Add linked pull requests if they exist\r\n    const linkedPRs = this.extractLinkedPullRequests(item);\r\n    if (linkedPRs.length > 0) {\r\n      const prHtml = linkedPRs\r\n        .map((pr: any) => {\r\n          const num = escapeHtml(String(pr.number || \"\"));\r\n          const titleText = escapeHtml(pr.title || \"\");\r\n          const url = escapeHtml(pr.url || \"\");\r\n          const rawColor =\r\n            pr.state_color || pr.color || pr.colour || pr.state || null;\r\n          const normColor = normalizeColor(rawColor) || null;\r\n          const hasHex = !!(\r\n            normColor && /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(normColor)\r\n          );\r\n          const border = normColor || \"#999999\";\r\n          const bg =\r\n            (hasHex && addAlpha(normColor, 0.12)) || \"rgba(0,0,0,0.06)\";\r\n          const fg = getContrastColor(normColor) || \"#333333\";\r\n\r\n          const isDraft = !!pr.isDraft;\r\n          const state = (pr.state && String(pr.state).toUpperCase()) || \"\";\r\n          const isMerged = !!pr.merged;\r\n          const isClosed = !isMerged && state === \"CLOSED\";\r\n\r\n          let iconName = \"git-pull-request\";\r\n          if (isMerged) iconName = \"git-merge\";\r\n          else if (isClosed) iconName = \"git-pull-request-closed\";\r\n          else if (isDraft) iconName = \"git-pull-request-draft\";\r\n\r\n          const icon = this.getIconSvg(iconName, 12);\r\n          const tooltip = titleText\r\n            ? escapeHtml(`#${pr.number} ${pr.title}`)\r\n            : escapeHtml(`#${pr.number}`);\r\n\r\n          return `<a href=\"${url}\" title=\"${tooltip}\" data-gh-open=\"${url}\" style=\"cursor:pointer;text-decoration:none;color:inherit\"><span class=\"board-pill\" style=\"display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;border:1px solid ${escapeHtml(border)};background:${escapeHtml(bg)};color:${escapeHtml(fg)};font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;max-width:160px\"><span style=\"position:relative;display:inline-flex;align-items:center;justify-content:center\">${icon}</span><span style=\"flex:1 1 auto;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap\">#${num}</span></span></a>`;\r\n        })\r\n        .join(\"\");\r\n      valuePills.push(prHtml);\r\n    }\r\n\r\n    for (const fv of item.fieldValues) {\r\n      if (!fv) continue;\r\n\r\n      const fieldType = String(fv.type || \"\").toLowerCase();\r\n      const fieldName = String(\r\n        fv.fieldName || fv.field?.name || \"\",\r\n      ).toLowerCase();\r\n\r\n      // Skip excluded types\r\n      if (excludeTypes.includes(fieldType)) continue;\r\n      if (excludeFieldNames.includes(fieldName)) continue;\r\n\r\n      // Skip column field (already shown in grouping)\r\n      if (columnFieldId && String(fv.fieldId) === String(columnFieldId))\r\n        continue;\r\n\r\n      // Skip invisible fields (if visibility list is provided)\r\n      if (this.visibleFieldIds && this.visibleFieldIds.length > 0) {\r\n        const fid = fv.fieldId || (fv.field && fv.field.id);\r\n        if (fid && !this.visibleFieldIds.includes(String(fid))) {\r\n          continue;\r\n        }\r\n      }\r\n\r\n      // Skip empty values\r\n      const hasValue = this.hasFieldValue(fv);\r\n      if (!hasValue) continue;\r\n\r\n      // Render based on field type\r\n      const rendered = this.renderFieldValue(fv);\r\n      if (rendered) {\r\n        valuePills.push(rendered);\r\n      }\r\n    }\r\n\r\n    if (valuePills.length === 0) return null;\r\n\r\n    const container = document.createElement(\"div\");\r\n    container.className = \"board-item-fields\";\r\n    container.style.display = \"flex\";\r\n    container.style.flexWrap = \"wrap\";\r\n    container.style.gap = \"4px\";\r\n    container.style.marginTop = \"4px\";\r\n    container.innerHTML = valuePills.join(\"\");\r\n\r\n    return container;\r\n  }\r\n\r\n  /**\r\n   * Check if field value has content\r\n   */\r\n  private hasFieldValue(fv: any): boolean {\r\n    const type = String(fv.type || \"\").toLowerCase();\r\n\r\n    switch (type) {\r\n      case \"single_select\":\r\n        return !!(fv.option?.name || fv.name);\r\n      case \"iteration\":\r\n        return !!(fv.iteration?.title || fv.title);\r\n      case \"labels\":\r\n        return Array.isArray(fv.labels) && fv.labels.length > 0;\r\n      case \"milestone\":\r\n        return !!fv.milestone?.title;\r\n      case \"repository\":\r\n        return !!(fv.repository?.nameWithOwner || fv.repository?.name);\r\n      case \"parent_issue\":\r\n        return !!(fv.parent || fv.parentIssue);\r\n      case \"number\":\r\n        return fv.number != null && fv.number !== \"\";\r\n      case \"date\":\r\n        return !!(fv.date || fv.startDate);\r\n      case \"text\":\r\n        return !!fv.text;\r\n      case \"pull_request\":\r\n      case \"linked_pull_requests\":\r\n        return !!(\r\n          fv.pullRequests?.nodes?.length > 0 ||\r\n          (Array.isArray(fv.pullRequests) && fv.pullRequests.length > 0)\r\n        );\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Render a single field value as HTML\r\n   */\r\n  private renderFieldValue(fv: any): string {\r\n    const type = String(fv.type || \"\").toLowerCase();\r\n\r\n    switch (type) {\r\n      case \"single_select\":\r\n        return this.renderSingleSelectPill(fv);\r\n      case \"labels\":\r\n        return this.renderLabelsPills(fv);\r\n      case \"iteration\":\r\n        return this.renderIterationPill(fv);\r\n      case \"milestone\":\r\n        return this.renderMilestonePill(fv);\r\n      case \"repository\":\r\n        return this.renderRepositoryPill(fv);\r\n      case \"parent_issue\":\r\n        return this.renderParentIssuePill(fv);\r\n      case \"number\":\r\n        return this.renderNumberPill(fv);\r\n      case \"text\":\r\n        return this.renderTextPill(fv);\r\n      case \"date\":\r\n        return this.renderDatePill(fv);\r\n      case \"pull_request\":\r\n      case \"linked_pull_requests\":\r\n        return this.renderLinkedPullRequests(fv);\r\n      default:\r\n        return \"\";\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Render single select as colored pill\r\n   */\r\n  private renderSingleSelectPill(fv: any): string {\r\n    const name = fv.option?.name || fv.name || \"\";\r\n    if (!name) return \"\";\r\n\r\n    const rawColor = fv.option?.color || fv.color || null;\r\n    const p = normalizeColor(rawColor) || null;\r\n    const hasHex = !!(p && /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(p));\r\n    const border = p || \"#999999\";\r\n    const bg = (hasHex && addAlpha(p, 0.12)) || \"rgba(0,0,0,0.06)\";\r\n    const fg = p || \"#333333\";\r\n\r\n    const fName = this.getFieldName(fv);\r\n    return `<span class=\"board-pill\" data-filter-field=\"${escapeHtml(fName)}\" data-filter-value=\"${escapeHtml(name)}\" style=\"display:inline-block;padding:2px 6px;border-radius:999px;border:1px solid ${escapeHtml(border)};background:${escapeHtml(bg)};color:${escapeHtml(fg)};font-size:11px;line-height:16px;white-space:nowrap;max-width:100px;overflow:hidden;text-overflow:ellipsis;\" title=\"${escapeHtml(name)}\">${escapeHtml(name)}</span>`;\r\n  }\r\n\r\n  /**\r\n   * Render labels as colored pills\r\n   */\r\n  private renderLabelsPills(fv: any): string {\r\n    const labels = fv.labels || [];\r\n    if (!labels || labels.length === 0) return \"\";\r\n\r\n    return labels\r\n      .slice(0, 3) // Limit to 3 labels\r\n      .map((label: any) => {\r\n        const name = label.name || \"\";\r\n        const rawColor = label.color || label.colour || null;\r\n        const p = normalizeColor(rawColor) || null;\r\n        const hasHex = !!(p && /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(p));\r\n        const border = p || \"#999999\";\r\n        const bg = (hasHex && addAlpha(p, 0.12)) || \"rgba(0,0,0,0.06)\";\r\n        const fg = p || \"#333333\";\r\n\r\n        return `<span class=\"board-pill\" data-filter-field=\"Labels\" data-filter-value=\"${escapeHtml(name)}\" style=\"display:inline-block;padding:2px 6px;border-radius:999px;border:1px solid ${escapeHtml(border)};background:${escapeHtml(bg)};color:${escapeHtml(fg)};font-size:11px;line-height:16px;white-space:nowrap;max-width:80px;overflow:hidden;text-overflow:ellipsis;\">${escapeHtml(name)}</span>`;\r\n      })\r\n      .join(\"\");\r\n  }\r\n\r\n  /**\r\n   * Render iteration with icon\r\n   */\r\n  private renderIterationPill(fv: any): string {\r\n    const iteration = fv.iteration || fv;\r\n    const title = iteration?.title || \"\";\r\n    if (!title) return \"\";\r\n\r\n    const icon = this.getIconSvg(\"iterations\", 12);\r\n    return `<span class=\"board-pill\" data-filter-field=\"Iteration\" data-filter-value=\"${escapeHtml(title)}\" style=\"display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;max-width:100px;overflow:hidden;text-overflow:ellipsis;\" title=\"${escapeHtml(title)}\">${icon}<span>${escapeHtml(title)}</span></span>`;\r\n  }\r\n\r\n  /**\r\n   * Render milestone with icon\r\n   */\r\n  private renderMilestonePill(fv: any): string {\r\n    const title = fv.milestone?.title || \"\";\r\n    if (!title) return \"\";\r\n\r\n    const icon = this.getIconSvg(\"milestone\", 12);\r\n    return `<span class=\"board-pill\" data-filter-field=\"Milestone\" data-filter-value=\"${escapeHtml(title)}\" style=\"display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;max-width:100px;overflow:hidden;text-overflow:ellipsis;\" title=\"${escapeHtml(title)}\">${icon}<span>${escapeHtml(title)}</span></span>`;\r\n  }\r\n\r\n  /**\r\n   * Render repository with icon\r\n   */\r\n  private renderRepositoryPill(fv: any): string {\r\n    const repo = fv.repository || fv;\r\n    const name = repo?.nameWithOwner || repo?.name || \"\";\r\n    if (!name) return \"\";\r\n\r\n    const icon = this.getIconSvg(\"repo\", 12);\r\n    return `<span class=\"board-pill\" data-filter-field=\"repo\" data-filter-value=\"${escapeHtml(name)}\" style=\"display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;\" title=\"${escapeHtml(name)}\">${icon}<span style=\"max-width:100px;overflow:hidden;text-overflow:ellipsis;\">${escapeHtml(name)}</span></span>`;\r\n  }\r\n\r\n  /**\r\n   * Render number field with field name\r\n   */\r\n  private renderNumberPill(fv: any): string {\r\n    const value = fv.number;\r\n    if (value == null || value === \"\") return \"\";\r\n\r\n    const fieldName = this.getFieldName(fv);\r\n    return `<span class=\"board-pill\" data-filter-field=\"${escapeHtml(fieldName)}\" data-filter-value=\"${escapeHtml(String(value))}\" style=\"display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;\"><span style=\"color:var(--vscode-descriptionForeground);\">${escapeHtml(fieldName)}:</span><span>${escapeHtml(String(value))}</span></span>`;\r\n  }\r\n\r\n  /**\r\n   * Render text field with field name\r\n   */\r\n  private renderTextPill(fv: any): string {\r\n    const value = fv.text || \"\";\r\n    if (!value) return \"\";\r\n\r\n    const fieldName = this.getFieldName(fv);\r\n    const truncated = String(value).slice(0, 30);\r\n    return `<span class=\"board-pill\" data-filter-field=\"${escapeHtml(fieldName)}\" data-filter-value=\"${escapeHtml(value)}\" style=\"display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;max-width:150px;overflow:hidden;text-overflow:ellipsis;\" title=\"${escapeHtml(value)}\"><span style=\"color:var(--vscode-descriptionForeground);\">${escapeHtml(fieldName)}:</span><span>${escapeHtml(truncated)}</span></span>`;\r\n  }\r\n\r\n  /**\r\n   * Render date field with field name\r\n   */\r\n  private renderDatePill(fv: any): string {\r\n    const dateValue = fv.date || fv.startDate || null;\r\n    if (!dateValue) return \"\";\r\n\r\n    const fieldName = this.getFieldName(fv);\r\n    let formatted = dateValue;\r\n    let filterVal = dateValue;\r\n    try {\r\n      const d = new Date(dateValue);\r\n      if (!isNaN(d.getTime())) {\r\n        formatted = d.toLocaleDateString(\"en-US\", {\r\n          month: \"short\",\r\n          day: \"numeric\",\r\n        });\r\n        filterVal = d.toISOString().split(\"T\")[0]; // YYYY-MM-DD\r\n      }\r\n    } catch (e) {\r\n      // Use raw value\r\n    }\r\n\r\n    const icon = this.getIconSvg(\"calendar\", 12);\r\n    return `<span class=\"board-pill\" data-filter-field=\"${escapeHtml(fieldName)}\" data-filter-value=\"${escapeHtml(String(filterVal))}\" style=\"display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;\"><span style=\"color:var(--vscode-descriptionForeground);\">${escapeHtml(fieldName)}:</span>${icon}<span>${escapeHtml(String(formatted))}</span></span>`;\r\n  }\r\n\r\n  /**\r\n   * Render parent issue with colored pill (matching table view style)\r\n   */\r\n  private renderParentIssuePill(fv: any): string {\r\n    const parent = fv.parent || fv.parentIssue || fv.issue || null;\r\n    if (!parent) return \"\";\r\n\r\n    const title = parent.title || parent.name || \"\";\r\n    const number = parent.number || \"\";\r\n    const url = parent.url || parent.html_url || \"\";\r\n    if (!title && !number) return \"\";\r\n\r\n    // Get color - try to find status color from parent issue look up\r\n    let color = \"#999999\";\r\n    let parentIsDoneByStatus = false;\r\n    const completedNames = [\"done\", \"closed\", \"completed\", \"finished\"];\r\n\r\n    // Try to find the parent item in allItems to get its Status\r\n    let parentItem: any = null;\r\n    if (this.allItems && this.allItems.length > 0) {\r\n      const parentId = parent.id || (parent.raw && parent.raw.id);\r\n      const parentUrl =\r\n        parent.url || parent.html_url || (parent.raw && parent.raw.url);\r\n      const parentNum = parent.number || (parent.raw && parent.raw.number);\r\n\r\n      // Fuzzy match logic similar to strategies.ts\r\n      parentItem = this.allItems.find((item: any) => {\r\n        const c = item.content || (item.raw && item.raw.itemContent);\r\n        if (!c) return false;\r\n        if (parentId && String(c.id) === String(parentId)) return true;\r\n        if (parentUrl && String(c.url) === String(parentUrl)) return true;\r\n        if (parentNum && String(c.number) === String(parentNum)) {\r\n          // Check repo match if possible\r\n          const itemRepo = c.repository?.nameWithOwner || c.repository?.name;\r\n          const parentRepo =\r\n            parent.repository?.nameWithOwner || parent.repository?.name;\r\n          if (itemRepo && parentRepo && itemRepo !== parentRepo) return false;\r\n          return true;\r\n        }\r\n        return false;\r\n      });\r\n\r\n      if (parentItem && Array.isArray(parentItem.fieldValues)) {\r\n        // Find status field\r\n        // Find status field - robust check like strategies.ts\r\n        const statusFv = parentItem.fieldValues.find(\r\n          (d: any) =>\r\n            d &&\r\n            d.type === \"single_select\" &&\r\n            ((d.raw &&\r\n              d.raw.field &&\r\n              String(d.raw.field.name || \"\").toLowerCase() === \"status\") ||\r\n              (d.fieldName &&\r\n                String(d.fieldName || \"\").toLowerCase() === \"status\") ||\r\n              (d.field &&\r\n                d.field.name &&\r\n                String(d.field.name || \"\").toLowerCase() === \"status\")),\r\n        );\r\n\r\n        if (statusFv) {\r\n          const foundColor =\r\n            (statusFv.option &&\r\n              (statusFv.option.color ||\r\n                statusFv.option.id ||\r\n                statusFv.option.name)) ||\r\n            (statusFv.raw && statusFv.raw.color) ||\r\n            null;\r\n\r\n          if (foundColor) color = normalizeColor(foundColor) || color;\r\n\r\n          if (statusFv.option && statusFv.option.name) {\r\n            const optNameLower = String(statusFv.option.name).toLowerCase();\r\n            if (completedNames.includes(optNameLower)) {\r\n              parentIsDoneByStatus = true;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // Fallback to embedded color\r\n    if (color === \"#999999\") {\r\n      if (parent.statusColor) {\r\n        color = normalizeColor(parent.statusColor) || color;\r\n      } else if (parent.color) {\r\n        color = normalizeColor(parent.color) || color;\r\n      }\r\n    }\r\n\r\n    const p = color;\r\n    const hasHex = !!(p && /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(p));\r\n    const border = p || \"#999999\";\r\n    const bg = (hasHex && addAlpha(p, 0.12)) || \"rgba(0,0,0,0.06)\";\r\n    const fg = getContrastColor(p) || \"#333333\";\r\n\r\n    // Determine icon (assume issue)\r\n    let isClosed = String(parent.state || \"\").toUpperCase() === \"CLOSED\";\r\n    if (parentIsDoneByStatus) isClosed = true;\r\n\r\n    // Determine blocked status for parent\r\n    let isBlocked = false;\r\n    try {\r\n      // Check specific blocked label\r\n      const hasBlockedLabel = !!(\r\n        parent.labels &&\r\n        Array.isArray(parent.labels) &&\r\n        parent.labels.some(\r\n          (l: any) => String(l.name || \"\").toLowerCase() === \"blocked\",\r\n        )\r\n      );\r\n      // Check parentItem dependency summary if available\r\n      let blockedBy = 0;\r\n      if (\r\n        parentItem &&\r\n        parentItem.content &&\r\n        parentItem.content.issueDependenciesSummary\r\n      ) {\r\n        blockedBy = parentItem.content.issueDependenciesSummary.blockedBy || 0;\r\n      }\r\n      if (hasBlockedLabel || blockedBy > 0) isBlocked = true;\r\n    } catch (e) { }\r\n\r\n    const iconName = isClosed ? \"issue-closed\" : \"issue-opened\";\r\n    const icon = this.getIconSvg(iconName, 12, p);\r\n\r\n    const blockedOverlay = isBlocked\r\n      ? `<span class='blocked-overlay' style='position:absolute;right:-3px;bottom:-3px;width:14px;height:14px;border-radius:999px;background:var(--vscode-editor-background);display:flex;align-items:center;justify-content:center;box-sizing:border-box;'>${this.getIconSvg(\"blocked\", 9, \"#dc3545\")}</span>`\r\n      : \"\";\r\n\r\n    // Build pill similar to ParentIssueRenderer in strategies.ts\r\n    let html = `<span class=\"board-pill\" data-filter-field=\"parent\" data-filter-value=\"${escapeHtml(title)}\" style=\"display:inline-flex;align-items:center;gap:6px;padding:3px 8px;border:1px solid ${escapeHtml(border)};border-radius:999px;background:${escapeHtml(bg)};color:${escapeHtml(fg)};font-size:11px;line-height:16px;max-width:150px;\" title=\"${escapeHtml(title + (number ? \" #\" + number : \"\"))}\"${url ? ` data-gh-open=\"${escapeHtml(url)}\"` : \"\"}>`;\r\n    html += `<span style=\"position:relative;display:inline-flex;align-items:center;justify-content:center;flex-shrink:0;\">${icon}${blockedOverlay}</span>`;\r\n    html += `<span style=\"overflow:hidden;text-overflow:ellipsis;white-space:nowrap;\">${escapeHtml(title)}</span>`;\r\n    if (number) {\r\n      html += `<span style=\"flex-shrink:0;color:var(--vscode-descriptionForeground);\">#${escapeHtml(String(number))}</span>`;\r\n    }\r\n    html += `</span>`;\r\n    return html;\r\n  }\r\n\r\n  /**\r\n   * Render linked pull requests\r\n   */\r\n  private renderLinkedPullRequests(fv: any): string {\r\n    const prs = fv.pullRequests?.nodes || [];\r\n    if (!prs || prs.length === 0) return \"\";\r\n\r\n    return prs\r\n      .map((pr: any) => {\r\n        const title = pr.title || \"#\" + pr.number || \"PR\";\r\n        const icon = this.getIconSvg(\"git-pull-request\", 12);\r\n        // Use generic pill style\r\n        return `<span class=\"board-pill\" data-filter-field=\"Linked Pull Requests\" data-filter-value=\"${escapeHtml(title)}\" style=\"display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;margin-right:2px;max-width:100px;overflow:hidden;text-overflow:ellipsis;\" title=\"${escapeHtml(title)}\">${icon}<span>${escapeHtml(title)}</span></span>`;\r\n      })\r\n      .join(\"\");\r\n  }\r\n\r\n  /**\r\n   * Render sub-issues progress bar\r\n   */\r\n  private renderSubIssuesProgress(item: any): HTMLElement | null {\r\n    if (!item || !Array.isArray(item.fieldValues)) return null;\r\n\r\n    // Check visibility: Progress should be visible if \"Parent Issue\" OR \"Sub-issues\" is visible\r\n    const isVisible = this.fields && this.fields.some((f: any) => {\r\n      const type = String(f.dataType || f.type || \"\").toLowerCase();\r\n      const name = String(f.name || \"\").toLowerCase();\r\n      const isTarget = type === \"parent_issue\" ||\r\n        type === \"sub_issues_progress\" ||\r\n        name === \"parent issue\" ||\r\n        name === \"sub-issues\" ||\r\n        name === \"sub-issue\" ||\r\n        name === \"tracks\" ||\r\n        name === \"tracked by\";\r\n\r\n      if (!isTarget) return false;\r\n\r\n      // Ensure field is strictly visible\r\n      if (this.visibleFieldIds) {\r\n        return this.visibleFieldIds.includes(String(f.id));\r\n      }\r\n      return true;\r\n    });\r\n\r\n    if (!isVisible) return null; // Hide if neither is visible\r\n\r\n    const progressFv = item.fieldValues.find(\r\n      (v: any) => v?.type === \"sub_issues_progress\",\r\n    );\r\n\r\n    if (!progressFv || !progressFv.total || Number(progressFv.total) <= 0) {\r\n      return null;\r\n    }\r\n\r\n    const total = Math.max(0, Math.floor(Number(progressFv.total) || 0));\r\n    const done = Math.max(0, Math.floor(Number(progressFv.done || 0)));\r\n    if (total === 0) return null;\r\n\r\n    const pct = Math.round((done / total) * 100);\r\n\r\n    const container = document.createElement(\"div\");\r\n    container.className = \"board-item-progress board-pill\";\r\n    container.setAttribute(\"data-filter-field\", \"parent\");\r\n    // Use item title as value (assuming 'item.title' or content.title exists from renderItem context)\r\n    // renderItem extracts titleText. We need to access it here. item structure has title or content.title.\r\n    const titleText =\r\n      (item.content && (item.content.title || item.content.name)) ||\r\n      item.title ||\r\n      (item.raw && item.raw.title) ||\r\n      \"\";\r\n    container.setAttribute(\"data-filter-value\", titleText);\r\n\r\n    container.style.marginTop = \"6px\";\r\n    container.title = `${done} of ${total} sub-issues complete (${pct}%) -- Click to filter by this parent`;\r\n\r\n    container.innerHTML = `\r\n      <div style=\"display:flex;align-items:center;gap:6px;width:100%;\">\r\n        <span style=\"font-size:11px;color:var(--vscode-descriptionForeground);font-variant-numeric:tabular-nums;min-width:30px;\">${done}/${total}</span>\r\n        <div style=\"flex:1;height:8px;border-radius:4px;border:1px solid var(--vscode-focusBorder);overflow:hidden;background:transparent;\">\r\n          <div style=\"height:100%;width:${pct}%;background:var(--vscode-focusBorder);\"></div>\r\n        </div>\r\n        <span style=\"font-size:11px;color:var(--vscode-descriptionForeground);font-variant-numeric:tabular-nums;min-width:28px;text-align:right;\">${pct}%</span>\r\n      </div>\r\n    `;\r\n\r\n    return container;\r\n  }\r\n\r\n  /**\r\n   * Group items by swimlane field value\r\n   */\r\n  public groupItemsBySwimlane(\r\n    items: any[],\r\n    swimlaneField: any,\r\n  ): Map<string, { option: any; items: any[] }> {\r\n    // Delegate grouping to GroupDataService to ensure parity with table/roadmap.\r\n    const groupedArr = GroupDataService.groupItems(items, swimlaneField || {});\r\n    const map = new Map<string, { option: any; items: any[] }>();\r\n\r\n    for (const g of groupedArr) {\r\n      const opt = g.option || {};\r\n      const key = String(opt.id || opt.name || opt.title || Math.random());\r\n      // GroupDataService returns items as { item, index } pairs for some paths \u2014 normalize to raw items\r\n      const itemsList = Array.isArray(g.items)\r\n        ? g.items.map((it: any) => (it && it.item ? it.item : it))\r\n        : [];\r\n      map.set(key, { option: opt, items: itemsList });\r\n    }\r\n\r\n    return map;\r\n  }\r\n\r\n  /**\r\n   * Render a swimlane header (similar to GroupRenderer)\r\n   * Now uses buildGroupHeaderElement for consistency with table/roadmap views\r\n   */\r\n  private renderSwimlaneHeader(\r\n    option: any,\r\n    items: any[],\r\n    swimlaneField: any,\r\n  ): HTMLElement {\r\n    const header = document.createElement(\"div\");\r\n    header.className = \"board-swimlane-header\";\r\n    header.style.position = \"sticky\";\r\n    header.style.top = \"var(--board-headers-height, 72px)\";\r\n    header.style.zIndex = \"20\";\r\n    header.style.cursor = \"pointer\";\r\n    header.style.userSelect = \"none\";\r\n    header.style.background = \"var(--vscode-editor-background)\";\r\n\r\n    // Horizontal sticky container\r\n    const leftPane = document.createElement(\"div\");\r\n    leftPane.style.display = \"flex\";\r\n    leftPane.style.alignItems = \"center\";\r\n    leftPane.style.gap = \"8px\";\r\n    leftPane.style.padding = \"8px 16px\";\r\n    leftPane.style.position = \"sticky\";\r\n    leftPane.style.left = \"0\";\r\n    leftPane.style.width = \"max-content\";\r\n    leftPane.style.background = \"inherit\";\r\n\r\n    // Use shared buildGroupHeaderElement for consistent rendering with table/roadmap\r\n    // This ensures avatars for assignees, parent progress, iteration ranges, etc. all work\r\n    const builtHeader = buildGroupHeaderElement(this.fields, this.allItems, { option, items }, swimlaneField, { groupDivisors: this.groupDivisors });\r\n    builtHeader.classList.add(\"swimlane-header-content\");\r\n\r\n    // Override the toggle icon class for swimlane-specific styling\r\n    const toggleEl = builtHeader.querySelector('.group-toggle') as HTMLElement | null;\r\n    if (toggleEl) {\r\n      toggleEl.classList.add(\"swimlane-toggle-icon\");\r\n      toggleEl.style.opacity = \"0.7\";\r\n    }\r\n\r\n    // Apply swimlane-specific styling to integrate with the sticky left pane\r\n    builtHeader.style.display = \"flex\";\r\n    builtHeader.style.alignItems = \"center\";\r\n    builtHeader.style.gap = \"8px\";\r\n    builtHeader.style.padding = \"0\";\r\n    builtHeader.style.background = \"transparent\";\r\n\r\n    leftPane.appendChild(builtHeader);\r\n    header.appendChild(leftPane);\r\n\r\n    return header;\r\n  }\r\n\r\n  /**\r\n   * Render the full board with all cards\r\n   */\r\n  public renderBoard(\r\n    container: HTMLElement,\r\n    columnField: any,\r\n    swimlaneField?: any,\r\n  ): void {\r\n    // Inject styles for interactions\r\n    const style = document.createElement(\"style\");\r\n    style.textContent = `\r\n            * { box-sizing: border-box; }\r\n            .board-item-menu-btn { opacity: 0; transition: opacity 0.2s; cursor: pointer; padding: 2px; border-radius: 4px; }\r\n            .board-item-menu-btn:hover { background: var(--vscode-toolbar-hoverBackground); }\r\n            .board-item:hover .board-item-menu-btn { opacity: 1; }\r\n            .board-pill { cursor: pointer; transition: opacity 0.2s; }\r\n            .board-pill:hover { opacity: 0.8; }\r\n            .board-swimlane { display: flex; flex-direction: column; }\r\n            .board-swimlane-content { display: flex; gap: 16px; padding: 0 16px 16px 16px; align-items: stretch; }\r\n            .board-container { display: flex; flex-direction: column; overflow: auto; height: 100%; width: 100%; }\r\n            .board-column-headers { \r\n              display: flex; \r\n              gap: 16px; \r\n              padding: 16px 16px 0 16px; \r\n              position: sticky; \r\n              top: 0; \r\n              z-index: 30; \r\n              background: var(--vscode-editor-background); \r\n              align-items: stretch;\r\n              border-bottom: 1px solid var(--vscode-panel-border);\r\n            }\r\n            .board-column-header { \r\n              width: 350px; \r\n              min-width: 350px; \r\n              flex-shrink: 0; \r\n              background: var(--vscode-sideBar-background);\r\n              border: 1px solid var(--vscode-editorWidget-border);\r\n              display: flex;\r\n              flex-direction: column;\r\n            }\r\n            .board-column-items { \r\n              width: 350px; \r\n              min-width: 350px; \r\n              flex-shrink: 0; \r\n              display: flex; \r\n              flex-direction: column; \r\n              gap: 8px; \r\n              background: var(--vscode-editorWidget-background); \r\n              border: 1px solid var(--vscode-editorWidget-border); \r\n              padding: 8px; \r\n            }\r\n            .board-swimlane-header {\r\n              border-bottom: 1px solid var(--vscode-panel-border);\r\n              background: var(--vscode-editor-background);\r\n              position: sticky;\r\n              z-index: 20;\r\n              margin: 0;\r\n            }\r\n        `;\r\n    container.appendChild(style);\r\n\r\n    const board = document.createElement(\"div\");\r\n    board.className = \"board-container\";\r\n    board.style.background = \"var(--vscode-editor-background)\";\r\n\r\n    // Add event delegation for interactivity\r\n    board.addEventListener(\"click\", (e) => {\r\n      const target = e.target as HTMLElement;\r\n\r\n      // Toggle swimlane\r\n      const swimHeader = target.closest(\".board-swimlane-header\") as HTMLElement;\r\n      if (swimHeader) {\r\n        const swimlane = swimHeader.parentElement!;\r\n        const content = swimlane.querySelector(\r\n          \".board-swimlane-content\",\r\n        ) as HTMLElement;\r\n        const toggleIcon = swimHeader.querySelector(\".swimlane-toggle-icon\")!;\r\n        const isCollapsed = content.style.display === \"none\";\r\n        content.style.display = isCollapsed ? \"flex\" : \"none\";\r\n        toggleIcon.innerHTML = this.getIconSvg(\r\n          isCollapsed ? \"triangle-down\" : \"triangle-right\",\r\n          16,\r\n        );\r\n        return;\r\n      }\r\n\r\n      // Check for filterable pills\r\n      const pill = target.closest(\"[data-filter-field]\");\r\n      if (pill) {\r\n        const field = pill.getAttribute(\"data-filter-field\");\r\n        const value = pill.getAttribute(\"data-filter-value\");\r\n        if (field && value) {\r\n          this.handlePillClick(e, field, value);\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Check for menu button\r\n      const menuBtn = target.closest(\".board-item-menu-btn\");\r\n      if (menuBtn) {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n        const itemId = menuBtn.getAttribute(\"data-item-id\");\r\n        if (this.onAction && itemId) {\r\n          const item = this.allItems.find(\r\n            (i) => String(i.id) === String(itemId),\r\n          ) || { id: itemId };\r\n          const rect = menuBtn.getBoundingClientRect();\r\n          this.onAction(\"open-menu\", item, { x: rect.left, y: rect.bottom });\r\n        }\r\n        return;\r\n      }\r\n    });\r\n\r\n    const columnGroups = this.groupItemsByColumn(this.allItems, columnField);\r\n    const colOptions = Array.from(columnGroups.values());\r\n\r\n    if (swimlaneField) {\r\n      // Render TOP row of column headers\r\n      const headersRow = document.createElement(\"div\");\r\n      headersRow.className = \"board-column-headers js-board-headers\";\r\n\r\n      // Dynamic sticky top calculation\r\n      const observer = new ResizeObserver(entries => {\r\n        const height = entries[0]?.contentRect.height;\r\n        if (height) {\r\n          board.style.setProperty(\"--board-headers-height\", `${height + 16}px`); // 16 for top padding only\r\n        }\r\n      });\r\n      observer.observe(headersRow);\r\n\r\n      for (const colGroup of colOptions) {\r\n        if (\r\n          colGroup.option.id === \"__no_value__\" &&\r\n          colGroup.items.length === 0\r\n        )\r\n          continue;\r\n\r\n        const colHeader = document.createElement(\"div\");\r\n        colHeader.className = \"board-column-header\";\r\n\r\n        // Reuse card header logic but without the full card\r\n        const header = this.renderColumnHeaderOnly(colGroup.option, colGroup.items, columnField);\r\n        colHeader.appendChild(header);\r\n        headersRow.appendChild(colHeader);\r\n      }\r\n      board.appendChild(headersRow);\r\n\r\n      // Force initial style for divisors\r\n      board.style.setProperty(\"--board-headers-height\", \"72px\");\r\n\r\n      // Render Swimlanes\r\n      const swimlanes = this.groupItemsBySwimlane(this.allItems, swimlaneField);\r\n\r\n      for (const [sKey, swimlane] of swimlanes) {\r\n        if (sKey === \"__no_value__\" && swimlane.items.length === 0) continue;\r\n\r\n        const swimContainer = document.createElement(\"div\");\r\n        swimContainer.className = \"board-swimlane\";\r\n\r\n        const header = this.renderSwimlaneHeader(\r\n          swimlane.option,\r\n          swimlane.items,\r\n          swimlaneField,\r\n        );\r\n        swimContainer.appendChild(header);\r\n\r\n        const swimContent = document.createElement(\"div\");\r\n        swimContent.className = \"board-swimlane-content\";\r\n\r\n        // Group items within this swimlane by column, but ensure we use the SAME columns as the top row\r\n        const rowColumnItems = this.groupItemsByColumn(swimlane.items, columnField);\r\n\r\n        for (const colGroup of colOptions) {\r\n          if (\r\n            colGroup.option.id === \"__no_value__\" &&\r\n            colGroup.items.length === 0\r\n          )\r\n            continue;\r\n\r\n          const colKey = String(colGroup.option.id || colGroup.option.name || \"\");\r\n          const itemsInCol = rowColumnItems.get(colKey)?.items || [];\r\n\r\n          const colItemsContainer = document.createElement(\"div\");\r\n          colItemsContainer.className = \"board-column-items\";\r\n\r\n          // Container for items that will grow\r\n          const itemsList = document.createElement(\"div\");\r\n          itemsList.style.display = \"flex\";\r\n          itemsList.style.flexDirection = \"column\";\r\n          itemsList.style.gap = \"8px\";\r\n          itemsList.style.flex = \"1\";\r\n\r\n          const columnColor = normalizeColor(colGroup.option.color) || \"#666666\";\r\n          for (const item of itemsInCol) {\r\n            itemsList.appendChild(this.renderItem(item, columnField, columnColor));\r\n          }\r\n          colItemsContainer.appendChild(itemsList);\r\n\r\n          // Add footer (Add item button) to each column cell in the swimlane\r\n          const footer = this.renderColumnFooterOnly(colGroup.option, columnField);\r\n          footer.style.marginTop = \"8px\";\r\n          footer.style.margin = \"0 -8px -8px -8px\"; // Offset container padding\r\n          colItemsContainer.appendChild(footer);\r\n\r\n          swimContent.appendChild(colItemsContainer);\r\n        }\r\n\r\n        swimContainer.appendChild(swimContent);\r\n        board.appendChild(swimContainer);\r\n      }\r\n    } else {\r\n      // Regular board view (single row of columns)\r\n      const rowContent = document.createElement(\"div\");\r\n      rowContent.className = \"board-swimlane-content\";\r\n      rowContent.style.height = \"100%\";\r\n\r\n      for (const colGroup of colOptions) {\r\n        if (\r\n          colGroup.option.id === \"__no_value__\" &&\r\n          colGroup.items.length === 0\r\n        )\r\n          continue;\r\n        const card = this.renderCard(\r\n          colGroup.option,\r\n          colGroup.items,\r\n          columnField,\r\n        );\r\n        rowContent.appendChild(card);\r\n      }\r\n      board.appendChild(rowContent);\r\n    }\r\n\r\n    container.appendChild(board);\r\n  }\r\n}\r\n", "/**\r\n * Slice Panel Component\r\n * Shows unique values for a field with counts, allowing quick filtering\r\n */\r\n\r\nimport { normalizeColor, escapeHtml } from \"../utils\";\r\n\r\nexport class SlicePanel {\r\n  private container: HTMLElement;\r\n  private field: any;\r\n  private items: any[];\r\n  private panelElement: HTMLElement | null = null;\r\n  private onValueSelectCallback?: (value: any) => void;\r\n  private onFieldChangeCallback?: (field: any) => void;\r\n  private allFields: any[];\r\n\r\n  constructor(\r\n    container: HTMLElement,\r\n    field: any,\r\n    items: any[],\r\n    allFields?: any[],\r\n  ) {\r\n    this.container = container;\r\n    this.field = field;\r\n    this.items = items;\r\n    this.allFields = allFields || [];\r\n  }\r\n\r\n  /**\r\n   * Render the slice panel\r\n   */\r\n  public render(): void {\r\n    this.close(); // Close any existing panel\r\n\r\n    // Create panel\r\n    this.panelElement = document.createElement(\"div\");\r\n    this.panelElement.className = \"slice-panel\";\r\n    this.panelElement.style.position = \"relative\";\r\n    this.panelElement.style.float = \"left\";\r\n    // Restore persisted width if available\r\n    try {\r\n      const stored = localStorage.getItem(\"ghProjects.slicePanel.width\");\r\n      if (stored) this.panelElement.style.width = stored;\r\n      else this.panelElement.style.width = \"280px\";\r\n    } catch (e) {\r\n      this.panelElement.style.width = \"280px\";\r\n    }\r\n    this.panelElement.style.marginRight = \"12px\";\r\n    this.panelElement.style.background = \"var(--vscode-sideBar-background)\";\r\n    this.panelElement.style.border = \"1px solid var(--vscode-sideBar-border)\";\r\n    this.panelElement.style.borderRadius = \"6px\";\r\n    this.panelElement.style.display = \"flex\";\r\n    this.panelElement.style.flexDirection = \"column\";\r\n    this.panelElement.style.overflow = \"hidden\";\r\n    this.panelElement.style.maxHeight = \"600px\";\r\n\r\n    // Temporary debug overlay: shows last resolved parent metadata and progress\r\n    const debugOverlay = document.createElement(\"pre\");\r\n    debugOverlay.className = \"slice-panel-debug-overlay\";\r\n    debugOverlay.style.position = \"absolute\";\r\n    debugOverlay.style.left = \"8px\";\r\n    debugOverlay.style.bottom = \"8px\";\r\n    debugOverlay.style.right = \"8px\";\r\n    debugOverlay.style.maxHeight = \"120px\";\r\n    debugOverlay.style.overflow = \"auto\";\r\n    debugOverlay.style.background = \"rgba(0,0,0,0.6)\";\r\n    debugOverlay.style.color = \"white\";\r\n    debugOverlay.style.fontSize = \"11px\";\r\n    debugOverlay.style.padding = \"8px\";\r\n    debugOverlay.style.borderRadius = \"6px\";\r\n    debugOverlay.style.zIndex = \"200\";\r\n    debugOverlay.style.display = \"none\"; // hidden by default\r\n    debugOverlay.title = \"SlicePanel debug (click to show/hide)\";\r\n    debugOverlay.addEventListener(\"click\", () => {\r\n      debugOverlay.style.display =\r\n        debugOverlay.style.display === \"none\" ? \"block\" : \"none\";\r\n    });\r\n    this.panelElement.appendChild(debugOverlay);\r\n\r\n    // Add resizer on the right edge to allow adjusting panel width\r\n    const resizer = document.createElement(\"div\");\r\n    resizer.className = \"slice-panel-resizer\";\r\n    resizer.style.position = \"absolute\";\r\n    resizer.style.top = \"0\";\r\n    resizer.style.right = \"0\";\r\n    resizer.style.bottom = \"0\";\r\n    resizer.style.width = \"6px\";\r\n    resizer.style.cursor = \"col-resize\";\r\n    resizer.style.zIndex = \"100\";\r\n    this.panelElement.appendChild(resizer);\r\n\r\n    let startX: number | null = null;\r\n    let startWidth: number | null = null;\r\n\r\n    const onMouseMove = (e: MouseEvent) => {\r\n      if (startX == null || startWidth == null) return;\r\n      const dx = e.pageX - startX;\r\n      const newW = Math.max(160, startWidth + dx);\r\n      this.panelElement!.style.width = newW + \"px\";\r\n    };\r\n\r\n    const onMouseUp = () => {\r\n      if (startX == null) return;\r\n      document.removeEventListener(\"mousemove\", onMouseMove);\r\n      document.removeEventListener(\"mouseup\", onMouseUp);\r\n      try {\r\n        localStorage.setItem(\r\n          \"ghProjects.slicePanel.width\",\r\n          this.panelElement!.style.width,\r\n        );\r\n      } catch (e) {}\r\n      startX = null;\r\n      startWidth = null;\r\n    };\r\n\r\n    resizer.addEventListener(\"mousedown\", (ev: MouseEvent) => {\r\n      ev.preventDefault();\r\n      startX = ev.pageX;\r\n      startWidth = this.panelElement ? this.panelElement.offsetWidth : 280;\r\n      document.addEventListener(\"mousemove\", onMouseMove);\r\n      document.addEventListener(\"mouseup\", onMouseUp);\r\n    });\r\n\r\n    // Header with dropdown\r\n    const header = document.createElement(\"div\");\r\n    header.style.padding = \"12px\";\r\n    header.style.borderBottom = \"1px solid var(--vscode-sideBar-border)\";\r\n    header.style.display = \"flex\";\r\n    header.style.flexDirection = \"column\";\r\n    header.style.gap = \"8px\";\r\n\r\n    const headerTop = document.createElement(\"div\");\r\n    headerTop.style.display = \"flex\";\r\n    headerTop.style.alignItems = \"center\";\r\n    headerTop.style.gap = \"8px\";\r\n\r\n    const sliceLabel = document.createElement(\"span\");\r\n    sliceLabel.textContent = \"Slice by\";\r\n    sliceLabel.style.fontSize = \"11px\";\r\n    sliceLabel.style.fontWeight = \"600\";\r\n    sliceLabel.style.color = \"var(--vscode-descriptionForeground)\";\r\n    sliceLabel.style.textTransform = \"uppercase\";\r\n    sliceLabel.style.letterSpacing = \"0.5px\";\r\n    headerTop.appendChild(sliceLabel);\r\n\r\n    // Field dropdown/button\r\n    const fieldButton = document.createElement(\"button\");\r\n    fieldButton.textContent = this.field.name;\r\n    fieldButton.style.flex = \"1\";\r\n    fieldButton.style.padding = \"6px 12px\";\r\n    fieldButton.style.background = \"var(--vscode-button-secondaryBackground)\";\r\n    fieldButton.style.color = \"var(--vscode-button-secondaryForeground)\";\r\n    fieldButton.style.border = \"1px solid var(--vscode-button-border)\";\r\n    fieldButton.style.borderRadius = \"4px\";\r\n    fieldButton.style.cursor = \"pointer\";\r\n    fieldButton.style.fontSize = \"13px\";\r\n    fieldButton.style.fontWeight = \"500\";\r\n    fieldButton.style.textAlign = \"left\";\r\n    fieldButton.style.display = \"flex\";\r\n    fieldButton.style.justifyContent = \"space-between\";\r\n    fieldButton.style.alignItems = \"center\";\r\n\r\n    // Add dropdown arrow\r\n    const arrow = document.createElement(\"span\");\r\n    arrow.textContent = \"\u25BC\";\r\n    arrow.style.fontSize = \"10px\";\r\n    arrow.style.marginLeft = \"auto\";\r\n    fieldButton.appendChild(arrow);\r\n\r\n    // Add dropdown menu on click\r\n    fieldButton.addEventListener(\"click\", (e) => {\r\n      e.stopPropagation();\r\n      this.showFieldDropdown(fieldButton);\r\n    });\r\n\r\n    headerTop.appendChild(fieldButton);\r\n    header.appendChild(headerTop);\r\n\r\n    this.panelElement.appendChild(header);\r\n\r\n    // Content\r\n    const content = document.createElement(\"div\");\r\n    content.style.flex = \"1\";\r\n    content.style.overflow = \"auto\";\r\n    content.style.padding = \"8px\";\r\n\r\n    this.renderValues(content);\r\n\r\n    this.panelElement.appendChild(content);\r\n    this.container.appendChild(this.panelElement);\r\n  }\r\n\r\n  /**\r\n   * Show dropdown menu to select a different field\r\n   */\r\n  private showFieldDropdown(anchorButton: HTMLElement, anchorRectOverride?: DOMRect): void {\r\n    // Get sliceable fields\r\n    const sliceableTypes = new Set([\r\n      \"assignees\",\r\n      \"single_select\",\r\n      \"parent_issue\",\r\n      \"iteration\",\r\n      \"number\",\r\n      \"date\",\r\n      \"milestone\",\r\n      \"repository\",\r\n      \"labels\",\r\n      \"text\",\r\n      \"single_line_text\",\r\n    ]);\r\n\r\n    const sliceableFields = this.allFields.filter((f) => {\r\n      const dataType = (f.dataType || \"\").toLowerCase();\r\n      return sliceableTypes.has(dataType);\r\n    });\r\n\r\n    if (sliceableFields.length === 0) return;\r\n\r\n    // Create dropdown\r\n    const dropdown = document.createElement(\"div\");\r\n    dropdown.style.position = \"absolute\";\r\n    const rect = anchorRectOverride ? anchorRectOverride : anchorButton.getBoundingClientRect();\r\n    if (anchorRectOverride) {\r\n      // Accessed from ActiveTabMenu: position to the right\r\n      dropdown.style.top = `${rect.top}px`;\r\n      dropdown.style.left = `${rect.right + 4}px`;\r\n    } else {\r\n      // Accessed from sidepanel: position below\r\n      dropdown.style.top = `${rect.bottom + 4}px`;\r\n      dropdown.style.left = `${rect.left}px`;\r\n    }\r\n    dropdown.style.minWidth = `${anchorButton.offsetWidth}px`;\r\n    dropdown.style.background = \"var(--vscode-dropdown-background)\";\r\n    dropdown.style.border = \"1px solid var(--vscode-dropdown-border)\";\r\n    dropdown.style.borderRadius = \"4px\";\r\n    dropdown.style.boxShadow = \"0 4px 8px rgba(0,0,0,0.2)\";\r\n    dropdown.style.zIndex = \"1000\";\r\n    dropdown.style.maxHeight = \"300px\";\r\n    dropdown.style.overflowY = \"auto\";\r\n\r\n    sliceableFields.forEach((field) => {\r\n      const item = document.createElement(\"div\");\r\n      item.style.display = \"flex\";\r\n      item.style.alignItems = \"center\";\r\n\r\n      // Checkmark span (fixed width for alignment)\r\n      const checkSpan = document.createElement(\"span\");\r\n      checkSpan.style.display = \"inline-block\";\r\n      checkSpan.style.width = \"14px\";\r\n      checkSpan.style.marginRight = \"8px\";\r\n      checkSpan.style.textAlign = \"center\";\r\n      checkSpan.textContent = field.id === this.field.id ? \"\u2713\" : \"\";\r\n      checkSpan.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n      item.appendChild(checkSpan);\r\n\r\n      // Icon for field type\r\n      const iconSpan = document.createElement(\"span\");\r\n      iconSpan.style.display = \"inline-flex\";\r\n      iconSpan.style.alignItems = \"center\";\r\n      iconSpan.style.justifyContent = \"center\";\r\n      iconSpan.style.width = \"18px\";\r\n      iconSpan.style.marginRight = \"8px\";\r\n      iconSpan.innerHTML = this.getIconForDataType(\r\n        (field.dataType || \"\").toString().toLowerCase(),\r\n      );\r\n      item.appendChild(iconSpan);\r\n\r\n      const labelSpan = document.createElement(\"span\");\r\n      labelSpan.textContent = field.name;\r\n      item.appendChild(labelSpan);\r\n      item.style.padding = \"8px 12px\";\r\n      item.style.cursor = \"pointer\";\r\n      item.style.fontSize = \"13px\";\r\n      item.style.color = \"var(--vscode-dropdown-foreground)\";\r\n\r\n      if (field.id === this.field.id) {\r\n        item.style.background = \"var(--vscode-list-activeSelectionBackground)\";\r\n        item.style.color = \"var(--vscode-list-activeSelectionForeground)\";\r\n      }\r\n\r\n      item.addEventListener(\"mouseenter\", () => {\r\n        if (field.id !== this.field.id) {\r\n          item.style.background = \"var(--vscode-list-hoverBackground)\";\r\n        }\r\n      });\r\n\r\n      item.addEventListener(\"mouseleave\", () => {\r\n        if (field.id !== this.field.id) {\r\n          item.style.background = \"transparent\";\r\n        }\r\n      });\r\n\r\n      item.addEventListener(\"click\", () => {\r\n        this.field = field;\r\n        // Update checkmarks and styles in the dropdown\r\n        const items = dropdown.querySelectorAll('div');\r\n        sliceableFields.forEach((f, idx) => {\r\n          const itemEl = items[idx] as HTMLElement;\r\n          if (!itemEl) return;\r\n          const checkSpanEl = itemEl.querySelector('span:first-child') as HTMLElement;\r\n          if (f.id === this.field.id) {\r\n            checkSpanEl.textContent = '\u2713';\r\n            itemEl.style.background = 'var(--vscode-list-activeSelectionBackground)';\r\n            itemEl.style.color = 'var(--vscode-list-activeSelectionForeground)';\r\n          } else {\r\n            checkSpanEl.textContent = '';\r\n            itemEl.style.background = 'transparent';\r\n            itemEl.style.color = 'var(--vscode-dropdown-foreground)';\r\n          }\r\n        });\r\n        this.render();\r\n        if (this.onFieldChangeCallback) {\r\n          this.onFieldChangeCallback(field);\r\n        }\r\n        // Refresh the menu info\r\n        try { if ((window as any).__sliceMenuRefresh) (window as any).__sliceMenuRefresh(); } catch (e) { }\r\n      });\r\n\r\n      dropdown.appendChild(item);\r\n    });\r\n\r\n    // Backdrop to close dropdown\r\n    const backdrop = document.createElement(\"div\");\r\n    backdrop.style.position = \"fixed\";\r\n    backdrop.style.top = \"0\";\r\n    backdrop.style.left = \"0\";\r\n    backdrop.style.right = \"0\";\r\n    backdrop.style.bottom = \"0\";\r\n    backdrop.style.zIndex = \"999\";\r\n\r\n    backdrop.addEventListener(\"click\", () => {\r\n      dropdown.remove();\r\n      backdrop.remove();\r\n    });\r\n\r\n    document.body.appendChild(backdrop);\r\n    document.body.appendChild(dropdown);\r\n  }\r\n\r\n  /**\r\n   * Public helper: open the field dropdown. If `anchorRect` is provided the dropdown\r\n   * will be positioned using that rect (useful when opening from an external menu).\r\n   */\r\n  public openFieldDropdown(anchorRect?: DOMRect): void {\r\n    try {\r\n      if (!this.panelElement) return;\r\n      const btn = this.panelElement.querySelector('button');\r\n      if (!btn) return;\r\n      // call internal method with optional rect override\r\n      this.showFieldDropdown(btn as HTMLElement, anchorRect);\r\n    } catch (e) { }\r\n  }\r\n\r\n  /**\r\n   * Return inline SVG HTML for a given dataType using the icon registry.\r\n   */\r\n  private getIconForDataType(dataType: string): string {\r\n    // Use the icon registry if available (shared with FieldsMenu)\r\n    if (\r\n      typeof (window as any).getIconNameForDataType === \"function\" &&\r\n      typeof (window as any).getIconSvg === \"function\"\r\n    ) {\r\n      const iconName = (window as any).getIconNameForDataType(dataType);\r\n      return (window as any).getIconSvg(iconName);\r\n    }\r\n\r\n    // Fallback: empty span\r\n    return \"<span></span>\";\r\n  }\r\n\r\n  /**\r\n   * Render the list of unique values with counts\r\n   */\r\n  private renderValues(container: HTMLElement): void {\r\n    // Get unique values and their counts\r\n    const valueCounts = this.getValueCounts();\r\n\r\n    if (valueCounts.size === 0) {\r\n      const empty = document.createElement(\"div\");\r\n      empty.textContent = \"No values\";\r\n      empty.style.padding = \"8px\";\r\n      empty.style.color = \"var(--vscode-descriptionForeground)\";\r\n      container.appendChild(empty);\r\n      return;\r\n    }\r\n\r\n    // Sort by count (descending)\r\n    const sorted = Array.from(valueCounts.entries()).sort(\r\n      (a, b) => b[1].count - a[1].count,\r\n    );\r\n\r\n    // Helper: resolve parent item and compute progress (done/total/pct)\r\n    const resolveParentProgress = (parentMeta: any) => {\r\n      const result: any = {\r\n        resolved: null,\r\n        statusColor: null,\r\n        number: null,\r\n        title: null,\r\n        done: 0,\r\n        total: 0,\r\n        pct: 0,\r\n      };\r\n      if (!parentMeta) return result;\r\n\r\n      // Build identifier list from parentMeta\r\n      const identifiers: string[] = [];\r\n      if (parentMeta.number) identifiers.push(String(parentMeta.number));\r\n      if (parentMeta.id) identifiers.push(String(parentMeta.id));\r\n      if (parentMeta.url) identifiers.push(String(parentMeta.url));\r\n      if (parentMeta.title) identifiers.push(String(parentMeta.title));\r\n\r\n      // Try to find a matching item in this.items (same logic as grouping header resolution)\r\n      const found = this.items.find((A: any) => {\r\n        const d = (A && (A.content || (A.raw && A.raw.itemContent))) || null;\r\n        if (!d) return false;\r\n        const M: string[] = [];\r\n        if (d.number) M.push(String(d.number));\r\n        if (d.id) M.push(String(d.id));\r\n        if (d.url) M.push(String(d.url));\r\n        if (d.title) M.push(String(d.title));\r\n        if (d.name) M.push(String(d.name));\r\n        if (d.raw && d.raw.number) M.push(String(d.raw.number));\r\n        if (d.raw && d.raw.id) M.push(String(d.raw.id));\r\n        if (d.raw && d.raw.url) M.push(String(d.raw.url));\r\n        for (let o of identifiers) {\r\n          for (let m of M) {\r\n            if (o && m && String(o) === String(m)) return true;\r\n          }\r\n        }\r\n        return false;\r\n      });\r\n\r\n      if (!found) return result; // single strategy: only use resolved item in snapshot\r\n\r\n      result.resolved = found;\r\n      const content =\r\n        found.content || (found.raw && found.raw.itemContent) || null;\r\n      result.title =\r\n        content && (content.title || content.name)\r\n          ? content.title || content.name\r\n          : found.title || found.name || null;\r\n      result.number =\r\n        content && content.number\r\n          ? String(content.number)\r\n          : found.number || found.id || null;\r\n\r\n      // Determine status color from single_select field in parent (if present)\r\n      if (Array.isArray(found.fieldValues)) {\r\n        const statusFV = found.fieldValues.find(\r\n          (v: any) =>\r\n            v && v.type === \"single_select\" && v.option && v.option.name,\r\n        );\r\n        if (statusFV && statusFV.option) {\r\n          try {\r\n            const c =\r\n              statusFV.option.color ||\r\n              statusFV.option.id ||\r\n              statusFV.option.name ||\r\n              null;\r\n            result.statusColor = normalizeColor(c) || null;\r\n          } catch (e) {}\r\n        }\r\n\r\n        // Try to read aggregate progress field (sub_issues_progress or synthesized with total/done)\r\n        const agg = found.fieldValues.find(\r\n          (v: any) =>\r\n            v &&\r\n            (v.type === \"sub_issues_progress\" ||\r\n              (v.total != null && v.done != null)),\r\n        );\r\n        if (agg && agg.total != null) {\r\n          result.total = Number(agg.total || 0);\r\n          result.done = Number(agg.done || 0);\r\n          result.pct =\r\n            result.total > 0\r\n              ? Math.round((result.done / result.total) * 100)\r\n              : 0;\r\n        }\r\n      }\r\n\r\n      return result;\r\n    };\r\n\r\n    // Render each value with grouping-style presentation\r\n    sorted.forEach(([key, { value, count, rawValue }]) => {\r\n      const item = document.createElement(\"div\");\r\n      item.className = \"slice-value-item\";\r\n      item.style.padding = \"10px 12px\";\r\n      item.style.cursor = \"pointer\";\r\n      item.style.borderRadius = \"4px\";\r\n      item.style.marginBottom = \"4px\";\r\n      item.style.display = \"flex\";\r\n      item.style.alignItems = \"center\";\r\n      item.style.gap = \"8px\";\r\n      item.style.transition = \"background-color 0.15s ease\";\r\n\r\n      const dataType = (this.field.dataType || \"\").toLowerCase();\r\n\r\n      // Normalize parent meta for this iteration so both visual and label rendering use the same source\r\n      let parentMetaForIteration: any = null;\r\n      if (dataType === \"parent_issue\" && rawValue) {\r\n        parentMetaForIteration =\r\n          rawValue.parent ||\r\n          rawValue.parentIssue ||\r\n          rawValue.issue ||\r\n          rawValue.item ||\r\n          rawValue.value ||\r\n          rawValue;\r\n      }\r\n\r\n      // Left visual area: avatar / color dot / repo icon\r\n      const leftVisual = document.createElement(\"div\");\r\n      leftVisual.style.display = \"flex\";\r\n      leftVisual.style.alignItems = \"center\";\r\n      leftVisual.style.gap = \"8px\";\r\n      leftVisual.style.flex = \"0 0 auto\";\r\n\r\n      // Helper: create a color dot\r\n      const makeColorDot = (c: string | null) => {\r\n        const dot = document.createElement(\"span\");\r\n        dot.style.display = \"inline-block\";\r\n        dot.style.width = \"12px\";\r\n        dot.style.height = \"12px\";\r\n        dot.style.borderRadius = \"50%\";\r\n        dot.style.flexShrink = \"0\";\r\n        dot.style.backgroundColor = c || \"var(--vscode-descriptionForeground)\";\r\n        return dot;\r\n      };\r\n\r\n      let visualAppended = false;\r\n\r\n      // Assignees: rawValue may be an individual assignee object (from getValueCounts)\r\n      if (dataType === \"assignees\" && rawValue) {\r\n        const a = rawValue;\r\n        const avatarUrl =\r\n          a && (a.avatarUrl || a.avatar || a.imageUrl || a.avatar_url);\r\n        if (avatarUrl) {\r\n          const avatarEl = document.createElement(\"span\");\r\n          avatarEl.innerHTML =\r\n            '<span title=\"' +\r\n            escapeHtml(a.login || a.name || a.id || \"\") +\r\n            '\" style=\"display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url(' +\r\n            escapeHtml(avatarUrl) +\r\n            ');border:2px solid var(--vscode-editor-background)\"></span>';\r\n          leftVisual.appendChild(avatarEl);\r\n          visualAppended = true;\r\n        } else {\r\n          // fallback color dot\r\n          leftVisual.appendChild(makeColorDot(null));\r\n          visualAppended = true;\r\n        }\r\n      }\r\n\r\n      // Repository: show repo icon\r\n      if (!visualAppended && dataType === \"repository\") {\r\n        const repoIcon = document.createElement(\"span\");\r\n        repoIcon.innerHTML =\r\n          '<svg width=\"14\" height=\"14\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style=\"flex-shrink:0;color:var(--vscode-icon-foreground)\"><path fill=\"currentColor\" d=\"M2 2.5A1.5 1.5 0 0 1 3.5 1h9A1.5 1.5 0 0 1 14 2.5v11A1.5 1.5 0 0 1 12.5 15h-9A1.5 1.5 0 0 1 2 13.5v-11zM3.5 2A.5.5 0 0 0 3 2.5V4h10V2.5a.5.5 0 0 0-.5-.5h-9z\"/></svg>';\r\n        leftVisual.appendChild(repoIcon);\r\n        visualAppended = true;\r\n      }\r\n\r\n      // Parent issue: try to extract parent title and show a color dot (use resolved parent status color if possible)\r\n      if (!visualAppended && dataType === \"parent_issue\") {\r\n        const prog = parentMetaForIteration\r\n          ? resolveParentProgress(parentMetaForIteration)\r\n          : null;\r\n        // Prefer status color from resolved parent progress, then try parentMeta.option/color fields\r\n        let dotColor = prog && prog.statusColor ? prog.statusColor : null;\r\n        if (!dotColor && parentMetaForIteration) {\r\n          dotColor =\r\n            normalizeColor(\r\n              parentMetaForIteration.color ||\r\n                (parentMetaForIteration.option &&\r\n                  parentMetaForIteration.option.color) ||\r\n                parentMetaForIteration.statusColor ||\r\n                parentMetaForIteration.status?.color,\r\n            ) || null;\r\n        }\r\n\r\n        if (\r\n          parentMetaForIteration &&\r\n          (parentMetaForIteration.title ||\r\n            parentMetaForIteration.name ||\r\n            parentMetaForIteration.number ||\r\n            (prog && (prog.title || prog.number)))\r\n        ) {\r\n          const pd = makeColorDot(dotColor);\r\n          leftVisual.appendChild(pd);\r\n          visualAppended = true;\r\n        }\r\n      }\r\n\r\n      // Labels: ensure label color dot comes from label metadata\r\n      if (!visualAppended && dataType === \"labels\" && rawValue) {\r\n        // rawValue here is the individual label object\r\n        const lab = rawValue;\r\n        const colorCandidate =\r\n          lab && (lab.color || lab.colorName || lab.hex || lab.name);\r\n        const normalized = normalizeColor(colorCandidate);\r\n        leftVisual.appendChild(makeColorDot(normalized));\r\n        visualAppended = true;\r\n      }\r\n\r\n      // If still no specialized visual, fall back to normalized color from options/iterations\r\n      if (!visualAppended) {\r\n        let colorVal: any = null;\r\n        if (dataType === \"single_select\" && rawValue && rawValue.option) {\r\n          colorVal =\r\n            rawValue.option.color || rawValue.option.name || rawValue.option.id;\r\n        }\r\n        // If repository/parent/iteration/milestone provide color directly, prefer it\r\n        if (!colorVal && rawValue && (rawValue.color || rawValue.colorName)) {\r\n          colorVal = rawValue.color || rawValue.colorName;\r\n        }\r\n        if (!colorVal && Array.isArray(this.field.options)) {\r\n          try {\r\n            const found = (this.field.options || []).find(\r\n              (o: any) =>\r\n                String(o.name) === String(key) ||\r\n                String(o.id) ===\r\n                  String(\r\n                    rawValue &&\r\n                      (rawValue.optionId ||\r\n                        (rawValue.option && rawValue.option.id)),\r\n                  ),\r\n            );\r\n            if (found) colorVal = found.color || found.name || found.id;\r\n          } catch (e) {}\r\n        }\r\n        if (\r\n          !colorVal &&\r\n          this.field &&\r\n          this.field.configuration &&\r\n          Array.isArray(this.field.configuration.iterations)\r\n        ) {\r\n          try {\r\n            const iter = (this.field.configuration.iterations || []).find(\r\n              (it: any) =>\r\n                String(it.title) === String(key) ||\r\n                String(it.id) ===\r\n                  String(\r\n                    rawValue &&\r\n                      (rawValue.iterationId ||\r\n                        (rawValue.iteration && rawValue.iteration.id)),\r\n                  ),\r\n            );\r\n            if (iter)\r\n              colorVal = iter.color || iter.name || iter.title || iter.id;\r\n          } catch (e) {}\r\n        }\r\n        const normalized = normalizeColor(colorVal);\r\n        leftVisual.appendChild(makeColorDot(normalized));\r\n      }\r\n\r\n      item.appendChild(leftVisual);\r\n\r\n      // Label column\r\n      const labelColumn = document.createElement(\"div\");\r\n      labelColumn.style.flex = \"1\";\r\n      labelColumn.style.display = \"flex\";\r\n      labelColumn.style.flexDirection = \"column\";\r\n      labelColumn.style.minWidth = \"0\";\r\n\r\n      // For parent_issue we render a custom header below (avoid duplicating the generic label)\r\n      let label: HTMLElement | null = null;\r\n      if (dataType !== \"parent_issue\") {\r\n        label = document.createElement(\"span\");\r\n        label.textContent = key;\r\n        label.style.fontSize = \"13px\";\r\n        label.style.fontWeight = \"500\";\r\n        // Allow wrapping to next line instead of overflowing\r\n        label.style.whiteSpace = \"normal\";\r\n        label.style.wordBreak = \"break-word\";\r\n        label.style.overflow = \"hidden\";\r\n        labelColumn.appendChild(label);\r\n      }\r\n\r\n      // Add description for single_select\r\n      if (dataType === \"single_select\") {\r\n        // Prefer metadata description from field.options if available, else rawValue.option.description\r\n        let descText: string | null = null;\r\n        try {\r\n          if (rawValue && rawValue.option && rawValue.option.description)\r\n            descText = rawValue.option.description;\r\n          else if (Array.isArray(this.field.options)) {\r\n            const found = (this.field.options || []).find(\r\n              (o: any) =>\r\n                String(o.name) === String(key) ||\r\n                String(o.id) ===\r\n                  String(\r\n                    rawValue &&\r\n                      (rawValue.optionId ||\r\n                        (rawValue.option && rawValue.option.id)),\r\n                  ),\r\n            );\r\n            if (found && found.description) descText = found.description;\r\n          }\r\n        } catch (e) {}\r\n\r\n        if (descText) {\r\n          const desc = document.createElement(\"span\");\r\n          desc.textContent = descText;\r\n          desc.style.fontSize = \"11px\";\r\n          desc.style.color = \"var(--vscode-descriptionForeground)\";\r\n          desc.style.whiteSpace = \"normal\";\r\n          desc.style.wordBreak = \"break-word\";\r\n          desc.style.overflow = \"hidden\";\r\n          desc.style.maxHeight = \"3.6em\";\r\n          labelColumn.appendChild(desc);\r\n        }\r\n      }\r\n\r\n      // For parent_issue, show title snippet if available\r\n      if (dataType === \"parent_issue\" && rawValue) {\r\n        const p =\r\n          parentMetaForIteration ||\r\n          rawValue.parent ||\r\n          rawValue.parentIssue ||\r\n          rawValue.issue ||\r\n          rawValue.item ||\r\n          rawValue.value ||\r\n          null;\r\n        const prog = resolveParentProgress(p);\r\n        // Title + number\r\n        const titleText = prog.title || (p && (p.title || p.name)) || key;\r\n        const titleEl = document.createElement(\"div\");\r\n        titleEl.style.display = \"flex\";\r\n        titleEl.style.gap = \"8px\";\r\n        titleEl.style.alignItems = \"baseline\";\r\n        const tspan = document.createElement(\"span\");\r\n        // Append number inline into the title text so it appears immediately after the title\r\n        const displayedTitle = String(titleText).slice(0, 120);\r\n        tspan.textContent = prog.number\r\n          ? `${displayedTitle} #${String(prog.number)}`\r\n          : displayedTitle;\r\n        tspan.style.fontSize = \"13px\";\r\n        tspan.style.fontWeight = \"600\";\r\n        tspan.style.whiteSpace = \"normal\";\r\n        tspan.style.wordBreak = \"break-word\";\r\n        titleEl.appendChild(tspan);\r\n        labelColumn.appendChild(titleEl);\r\n\r\n        // Progress summary and bar\r\n        if (prog.total && prog.total > 0) {\r\n          const summary = document.createElement(\"div\");\r\n          summary.style.display = \"flex\";\r\n          summary.style.alignItems = \"center\";\r\n          summary.style.gap = \"8px\";\r\n          summary.style.marginTop = \"6px\";\r\n\r\n          const doneText = document.createElement(\"div\");\r\n          doneText.textContent = `${prog.done}/${prog.total}`;\r\n          doneText.style.color = \"var(--vscode-descriptionForeground)\";\r\n          doneText.style.fontSize = \"12px\";\r\n          doneText.style.fontVariantNumeric = \"tabular-nums\";\r\n          summary.appendChild(doneText);\r\n\r\n          const bar = document.createElement(\"div\");\r\n          bar.style.display = \"inline-block\";\r\n          bar.style.width = \"120px\";\r\n          bar.style.height = \"10px\";\r\n          bar.style.background = \"transparent\";\r\n          bar.style.border = \"1px solid var(--vscode-focusBorder)\";\r\n          bar.style.borderRadius = \"6px\";\r\n          bar.style.overflow = \"hidden\";\r\n          const fill = document.createElement(\"div\");\r\n          fill.style.height = \"100%\";\r\n          fill.style.width = String(prog.pct) + \"%\";\r\n          fill.style.background = \"var(--vscode-focusBorder)\";\r\n          bar.appendChild(fill);\r\n          summary.appendChild(bar);\r\n\r\n          labelColumn.appendChild(summary);\r\n        }\r\n      }\r\n\r\n      // Iteration: show date range if available\r\n      if (dataType === \"iteration\") {\r\n        try {\r\n          // rawValue may be an FV with iteration object, or we can look up field.configuration.iterations\r\n          const iterObj =\r\n            (rawValue &&\r\n              (rawValue.iteration || rawValue.configuration || rawValue)) ||\r\n            null;\r\n          let iterCandidate: any = null;\r\n          if (\r\n            iterObj &&\r\n            iterObj.startDate &&\r\n            (iterObj.duration || iterObj.length)\r\n          ) {\r\n            iterCandidate = iterObj;\r\n          } else if (\r\n            this.field &&\r\n            this.field.configuration &&\r\n            Array.isArray(this.field.configuration.iterations)\r\n          ) {\r\n            const found = (this.field.configuration.iterations || []).find(\r\n              (it: any) =>\r\n                String(it.title || it.name) === String(key) ||\r\n                String(it.id) ===\r\n                  String(\r\n                    rawValue &&\r\n                      (rawValue.iterationId ||\r\n                        (rawValue.iteration && rawValue.iteration.id)),\r\n                  ),\r\n            );\r\n            if (found) iterCandidate = found;\r\n          }\r\n\r\n          if (iterCandidate) {\r\n            const start = iterCandidate.startDate || iterCandidate.start;\r\n            const duration =\r\n              iterCandidate.duration ||\r\n              iterCandidate.length ||\r\n              iterCandidate.days;\r\n            if (start && duration) {\r\n              const s = new Date(start);\r\n              const e = new Date(\r\n                s.getTime() + Number(duration || 0) * 24 * 60 * 60 * 1000,\r\n              );\r\n              const sStr = s.toLocaleDateString(\"en-US\", {\r\n                month: \"short\",\r\n                day: \"numeric\",\r\n              });\r\n              const eStr = e.toLocaleDateString(\"en-US\", {\r\n                month: \"short\",\r\n                day: \"numeric\",\r\n              });\r\n              const rangeEl = document.createElement(\"div\");\r\n              rangeEl.textContent = `${sStr} \u2014 ${eStr}`;\r\n              rangeEl.style.fontSize = \"11px\";\r\n              rangeEl.style.color = \"var(--vscode-descriptionForeground)\";\r\n              rangeEl.style.marginTop = \"4px\";\r\n              labelColumn.appendChild(rangeEl);\r\n            }\r\n          }\r\n        } catch (e) {}\r\n      }\r\n\r\n      item.appendChild(labelColumn);\r\n\r\n      // Count circle (like grouping)\r\n      const countCircle = document.createElement(\"span\");\r\n      countCircle.style.display = \"inline-flex\";\r\n      countCircle.style.alignItems = \"center\";\r\n      countCircle.style.justifyContent = \"center\";\r\n      countCircle.style.minWidth = \"24px\";\r\n      countCircle.style.height = \"24px\";\r\n      countCircle.style.borderRadius = \"50%\";\r\n      countCircle.style.background = \"var(--vscode-input-background)\";\r\n      countCircle.style.border = \"1px solid var(--vscode-panel-border)\";\r\n      countCircle.style.color = \"var(--vscode-foreground)\";\r\n      countCircle.style.fontSize = \"12px\";\r\n      countCircle.style.fontWeight = \"600\";\r\n      countCircle.style.padding = \"0 6px\";\r\n      countCircle.style.boxSizing = \"border-box\";\r\n      countCircle.textContent = String(count);\r\n\r\n      item.appendChild(countCircle);\r\n\r\n      // Hover effect\r\n      item.addEventListener(\"mouseenter\", () => {\r\n        item.style.background = \"var(--vscode-list-hoverBackground)\";\r\n      });\r\n\r\n      item.addEventListener(\"mouseleave\", () => {\r\n        item.style.background = \"transparent\";\r\n      });\r\n\r\n      // Click handler\r\n      item.addEventListener(\"click\", () => {\r\n        if (this.onValueSelectCallback) {\r\n          this.onValueSelectCallback(value);\r\n        }\r\n      });\r\n\r\n      container.appendChild(item);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get unique values and their counts\r\n   */\r\n  private getValueCounts(): Map<\r\n    string,\r\n    { value: any; count: number; rawValue: any }\r\n  > {\r\n    const counts = new Map<\r\n      string,\r\n      { value: any; count: number; rawValue: any }\r\n    >();\r\n\r\n    const dataType = (this.field.dataType || \"\").toLowerCase();\r\n\r\n    this.items.forEach((item) => {\r\n      const fv = item.fieldValues?.find(\r\n        (f: any) =>\r\n          f.fieldId === this.field.id || f.fieldName === this.field.name,\r\n      );\r\n      if (!fv) {\r\n        const key = \"(empty)\";\r\n        const existing = counts.get(key);\r\n        if (existing) existing.count++;\r\n        else counts.set(key, { value: null, count: 1, rawValue: null });\r\n        return;\r\n      }\r\n\r\n      // Handle multi-value fields (labels, assignees)\r\n      if (dataType === \"labels\") {\r\n        // GitHub sometimes nests labels under .labels.nodes or .labels\r\n        const labelsArr =\r\n          fv.labels && Array.isArray(fv.labels.nodes)\r\n            ? fv.labels.nodes\r\n            : Array.isArray(fv.labels)\r\n              ? fv.labels\r\n              : null;\r\n        if (Array.isArray(labelsArr) && labelsArr.length > 0) {\r\n          labelsArr.forEach((lab: any) => {\r\n            const name =\r\n              lab && (lab.name || lab.title)\r\n                ? String(lab.name || lab.title)\r\n                : \"(empty)\";\r\n            const key = this.formatValue(name);\r\n            const existing = counts.get(key);\r\n            if (existing) existing.count++;\r\n            else counts.set(key, { value: name, count: 1, rawValue: lab });\r\n          });\r\n          return;\r\n        }\r\n      }\r\n\r\n      if (dataType === \"assignees\") {\r\n        const ass = fv.assignees || (fv.assignee ? [fv.assignee] : null);\r\n        if (Array.isArray(ass) && ass.length > 0) {\r\n          ass.forEach((a: any) => {\r\n            const name = String(a.login || a.name || a.id || \"(unknown)\");\r\n            const key = this.formatValue(name);\r\n            const existing = counts.get(key);\r\n            if (existing) existing.count++;\r\n            else counts.set(key, { value: a, count: 1, rawValue: a });\r\n          });\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Single-value fields and other complex types\r\n      let value: any = null;\r\n      let rawValue: any = null;\r\n\r\n      try {\r\n        if (dataType === \"single_select\") {\r\n          value = fv.option?.name || fv.name || fv.value;\r\n          rawValue = fv;\r\n        } else if (dataType === \"iteration\") {\r\n          value = fv.iteration?.title || fv.title || fv.value;\r\n          rawValue = fv;\r\n        } else if (dataType === \"parent_issue\") {\r\n          const p =\r\n            fv.parent ||\r\n            fv.parentIssue ||\r\n            fv.issue ||\r\n            fv.item ||\r\n            fv.value ||\r\n            null;\r\n          if (p) value = p.title || p.name || p.number || p.id || p.url || null;\r\n          rawValue = p || fv;\r\n        } else if (dataType === \"milestone\") {\r\n          value = fv.milestone?.title || fv.milestone?.name || fv.value || null;\r\n          rawValue = fv.milestone || fv;\r\n        } else if (dataType === \"repository\") {\r\n          value =\r\n            fv.repository?.nameWithOwner ||\r\n            fv.repository?.full_name ||\r\n            fv.repository?.name ||\r\n            fv.value ||\r\n            null;\r\n          rawValue = fv.repository || fv;\r\n        } else if (dataType === \"number\") {\r\n          value = fv.number != null ? fv.number : fv.value;\r\n          rawValue = fv;\r\n        } else if (dataType === \"date\") {\r\n          value = fv.date || fv.value || null;\r\n          rawValue = fv;\r\n        } else {\r\n          // fallback: text, title, other simple values\r\n          value = fv.text || fv.title || fv.value || null;\r\n          rawValue = fv;\r\n        }\r\n      } catch (e) {\r\n        value = fv.text || fv.title || fv.value || null;\r\n        rawValue = fv;\r\n      }\r\n\r\n      const key =\r\n        value === null || value === undefined || value === \"\"\r\n          ? \"(empty)\"\r\n          : this.formatValue(value);\r\n      const existing = counts.get(key);\r\n      if (existing) existing.count++;\r\n      else counts.set(key, { value, count: 1, rawValue });\r\n    });\r\n\r\n    return counts;\r\n  }\r\n\r\n  /**\r\n   * Extract value from field value object\r\n   */\r\n  private extractValue(fieldValue: any): any {\r\n    // Deprecated: primary logic moved into getValueCounts which handles multi-value types.\r\n    const dataType = (this.field.dataType || \"\").toLowerCase();\r\n    if (!fieldValue) return null;\r\n    if (dataType === \"single_select\")\r\n      return fieldValue.option?.name || fieldValue.name || fieldValue.value;\r\n    if (dataType === \"iteration\")\r\n      return (\r\n        fieldValue.iteration?.title || fieldValue.title || fieldValue.value\r\n      );\r\n    if (dataType === \"assignees\")\r\n      return fieldValue.assignees || fieldValue.assignee || null;\r\n    if (dataType === \"labels\") return fieldValue.labels || null;\r\n    if (dataType === \"parent_issue\")\r\n      return (\r\n        fieldValue.parent ||\r\n        fieldValue.parentIssue ||\r\n        fieldValue.issue ||\r\n        fieldValue.item ||\r\n        fieldValue.value ||\r\n        null\r\n      );\r\n    if (dataType === \"milestone\")\r\n      return fieldValue.milestone || fieldValue.value || null;\r\n    if (dataType === \"repository\")\r\n      return fieldValue.repository || fieldValue.value || null;\r\n    if (dataType === \"number\")\r\n      return fieldValue.number != null ? fieldValue.number : fieldValue.value;\r\n    if (dataType === \"date\") return fieldValue.date || fieldValue.value || null;\r\n    return fieldValue.text || fieldValue.title || fieldValue.value || null;\r\n  }\r\n\r\n  /**\r\n   * Format value for display\r\n   */\r\n  private formatValue(value: any): string {\r\n    if (value === null || value === undefined) {\r\n      return \"(empty)\";\r\n    }\r\n    return String(value);\r\n  }\r\n\r\n  /**\r\n   * Register callback for value selection\r\n   */\r\n  public onValueSelect(callback: (value: any) => void): void {\r\n    this.onValueSelectCallback = callback;\r\n  }\r\n\r\n  /**\r\n   * Register callback for field change\r\n   */\r\n  public onFieldChange(callback: (field: any) => void): void {\r\n    this.onFieldChangeCallback = callback;\r\n  }\r\n\r\n  /**\r\n   * Close and remove the panel\r\n   */\r\n  public close(): void {\r\n    if (this.panelElement) {\r\n      this.panelElement.remove();\r\n      this.panelElement = null;\r\n    }\r\n  }\r\n}\r\n", "import type { FieldConfig } from \"../../../lib/types\";\r\n\r\nexport interface SortConfig {\r\n  fieldId: string;\r\n  direction: \"ASC\" | \"DESC\";\r\n  secondary?: {\r\n    fieldId: string;\r\n    direction: \"ASC\" | \"DESC\";\r\n  };\r\n}\r\n\r\n/**\r\n * Parse sortByFields from GitHub GraphQL response into SortConfig\r\n */\r\nexport function parseSortByFields(sortByFields: any): SortConfig | null {\r\n  if (!sortByFields || !sortByFields.nodes || sortByFields.nodes.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  const primary = sortByFields.nodes[0];\r\n  if (!primary || !primary.field) {\r\n    return null;\r\n  }\r\n\r\n  const config: SortConfig = {\r\n    fieldId: primary.field.id || primary.field.name,\r\n    direction: primary.direction || \"ASC\",\r\n  };\r\n\r\n  // Add secondary sort if available\r\n  if (sortByFields.nodes.length > 1) {\r\n    const secondary = sortByFields.nodes[1];\r\n    if (secondary && secondary.field) {\r\n      config.secondary = {\r\n        fieldId: secondary.field.id || secondary.field.name,\r\n        direction: secondary.direction || \"ASC\",\r\n      };\r\n    }\r\n  }\r\n\r\n  return config;\r\n}\r\n\r\n/**\r\n * Sort items array based on sort configuration\r\n */\r\nexport function sortItems(\r\n  items: any[],\r\n  fields: FieldConfig[],\r\n  sortConfig: SortConfig,\r\n): any[] {\r\n  if (!sortConfig || items.length === 0) {\r\n    return items;\r\n  }\r\n\r\n  const field = fields.find(\r\n    (f) => f.id === sortConfig.fieldId || f.name === sortConfig.fieldId,\r\n  );\r\n  if (!field) {\r\n    return items;\r\n  }\r\n\r\n  // Create a copy to avoid mutating original\r\n  const sorted = [...items];\r\n\r\n  sorted.sort((a, b) => {\r\n    // Primary sort\r\n    const primaryResult = compareFieldValues(a, b, field, sortConfig.direction);\r\n\r\n    // If equal and secondary sort exists, use secondary\r\n    if (primaryResult === 0 && sortConfig.secondary) {\r\n      const secondaryField = fields.find(\r\n        (f) =>\r\n          f.id === sortConfig.secondary!.fieldId ||\r\n          f.name === sortConfig.secondary!.fieldId,\r\n      );\r\n      if (secondaryField) {\r\n        return compareFieldValues(\r\n          a,\r\n          b,\r\n          secondaryField,\r\n          sortConfig.secondary.direction,\r\n        );\r\n      }\r\n    }\r\n\r\n    return primaryResult;\r\n  });\r\n\r\n  return sorted;\r\n}\r\n\r\n/**\r\n * Compare two items by a specific field\r\n */\r\nexport function compareFieldValues(\r\n  a: any,\r\n  b: any,\r\n  field: FieldConfig,\r\n  direction: \"ASC\" | \"DESC\",\r\n): number {\r\n  // Find field values for both items\r\n  const aValue = getFieldValue(a, field);\r\n  const bValue = getFieldValue(b, field);\r\n\r\n  // Handle null/undefined\r\n  if (aValue === null && bValue === null) return 0;\r\n  if (aValue === null) return direction === \"ASC\" ? 1 : -1;\r\n  if (bValue === null) return direction === \"ASC\" ? -1 : 1;\r\n\r\n  let result = 0;\r\n  const dataType = (field.dataType || \"\").toLowerCase();\r\n\r\n  switch (dataType) {\r\n    case \"text\":\r\n    case \"title\":\r\n      result = compareText(aValue, bValue);\r\n      break;\r\n\r\n    case \"number\":\r\n      result = compareNumber(aValue, bValue);\r\n      break;\r\n\r\n    case \"date\":\r\n      result = compareDate(aValue, bValue);\r\n      break;\r\n\r\n    case \"single_select\":\r\n      result = compareSingleSelect(aValue, bValue, field);\r\n      break;\r\n\r\n    case \"iteration\":\r\n      result = compareIteration(aValue, bValue);\r\n      break;\r\n\r\n    case \"labels\":\r\n      result = compareLabels(aValue, bValue);\r\n      break;\r\n\r\n    case \"assignees\":\r\n    case \"repository\":\r\n    case \"milestone\":\r\n    case \"issue_type\":\r\n    case \"parent_issue\":\r\n    case \"tracked_by\":\r\n    case \"tracks\":\r\n    case \"reviewers\":\r\n      result = compareText(aValue, bValue);\r\n      break;\r\n\r\n    case \"linked_pull_requests\":\r\n    case \"sub_issues_progress\":\r\n      result = compareNumber(aValue, bValue);\r\n      break;\r\n\r\n    default:\r\n      // For unsupported data types, do not apply custom sorting\r\n      // and treat items as equal so their relative order is preserved.\r\n      result = 0;\r\n  }\r\n\r\n  return direction === \"ASC\" ? result : -result;\r\n}\r\n\r\n/**\r\n * Extract field value from item\r\n */\r\nfunction getFieldValue(item: any, field: FieldConfig): any {\r\n  const fieldValue = item.fieldValues?.find(\r\n    (fv: any) => fv.fieldId === field.id || fv.fieldName === field.name,\r\n  );\r\n\r\n  if (!fieldValue) return null;\r\n\r\n  const dataType = (field.dataType || \"\").toLowerCase();\r\n\r\n  switch (dataType) {\r\n    case \"text\": {\r\n      // Normal text fields use .text, but some Title-like fields may be\r\n      // mis-typed as TEXT while still carrying a structured title object.\r\n      if (fieldValue.text != null) return fieldValue.text;\r\n      return extractTitleLikeString(fieldValue, item);\r\n    }\r\n\r\n    case \"title\": {\r\n      // Title fields store a structured object; prefer a human-friendly string\r\n      return extractTitleLikeString(fieldValue, item);\r\n    }\r\n\r\n    case \"number\":\r\n      return fieldValue.number !== undefined ? fieldValue.number : null;\r\n\r\n    case \"date\":\r\n      return (\r\n        fieldValue.date || fieldValue.startDate || fieldValue.dueOn || null\r\n      );\r\n\r\n    case \"single_select\":\r\n      return fieldValue.option || fieldValue;\r\n\r\n    case \"iteration\":\r\n      return fieldValue;\r\n\r\n    case \"labels\":\r\n      return fieldValue.labels || [];\r\n\r\n    case \"assignees\": {\r\n      const list = fieldValue.assignees;\r\n      if (Array.isArray(list) && list.length > 0) {\r\n        const first = list[0];\r\n        return first.login || first.name || null;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    case \"repository\": {\r\n      const repo = fieldValue.repository;\r\n      if (!repo) return null;\r\n      return (\r\n        repo.nameWithOwner || repo.name || repo.full_name || repo.id || null\r\n      );\r\n    }\r\n\r\n    case \"milestone\": {\r\n      const m = fieldValue.milestone;\r\n      if (!m) return null;\r\n      // Prefer due date when present (ISO date strings sort lexicographically),\r\n      // otherwise fall back to title/name.\r\n      return m.dueOn || m.title || m.name || null;\r\n    }\r\n\r\n    case \"issue_type\": {\r\n      if (fieldValue.text) return fieldValue.text;\r\n      if (fieldValue.option) {\r\n        return fieldValue.option.name || fieldValue.option.title || null;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    case \"parent_issue\": {\r\n      const parent = fieldValue.parent;\r\n      if (!parent) return null;\r\n      if (parent.title) return parent.title;\r\n      if (typeof parent.number === \"number\") return String(parent.number);\r\n      return parent.id || null;\r\n    }\r\n\r\n    case \"linked_pull_requests\": {\r\n      const prs = fieldValue.pullRequests;\r\n      if (Array.isArray(prs) && prs.length > 0) {\r\n        const first = prs[0];\r\n        if (typeof first.number === \"number\") return first.number;\r\n        return first.title || null;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    case \"reviewers\": {\r\n      const list = fieldValue.reviewers;\r\n      if (Array.isArray(list) && list.length > 0) {\r\n        const first = list[0];\r\n        return first.login || first.name || first.id || null;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    case \"sub_issues_progress\": {\r\n      if (typeof fieldValue.percent === \"number\") return fieldValue.percent;\r\n      if (\r\n        typeof fieldValue.done === \"number\" &&\r\n        typeof fieldValue.total === \"number\" &&\r\n        fieldValue.total > 0\r\n      ) {\r\n        return (fieldValue.done / fieldValue.total) * 100;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    case \"tracked_by\":\r\n    case \"tracks\": {\r\n      const issues = fieldValue.issues;\r\n      if (Array.isArray(issues) && issues.length > 0) {\r\n        const first = issues[0];\r\n        if (first.title) return first.title;\r\n        if (typeof first.number === \"number\") return String(first.number);\r\n        return first.id || null;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    default:\r\n      return fieldValue;\r\n  }\r\n}\r\n\r\nfunction extractTitleLikeString(fieldValue: any, item: any): string | null {\r\n  if (!fieldValue) return null;\r\n\r\n  // Prefer the underlying raw node's text when present\r\n  const rawNode =\r\n    (fieldValue.title && fieldValue.title.raw) || fieldValue.raw || null;\r\n  if (rawNode && typeof rawNode.text === \"string\" && rawNode.text.trim()) {\r\n    return rawNode.text;\r\n  }\r\n\r\n  // Then look at the content object which often carries title/name\r\n  const content =\r\n    (fieldValue.title && fieldValue.title.content) ||\r\n    fieldValue.content ||\r\n    (rawNode && rawNode.itemContent) ||\r\n    (item && item.content) ||\r\n    null;\r\n\r\n  if (content) {\r\n    if (typeof content === \"string\" && content.trim()) {\r\n      return content;\r\n    }\r\n    if (typeof content.title === \"string\" && content.title.trim()) {\r\n      return content.title;\r\n    }\r\n    if (typeof content.name === \"string\" && content.name.trim()) {\r\n      return content.name;\r\n    }\r\n  }\r\n\r\n  // Fallbacks: occasionally a plain text field is reused\r\n  if (typeof fieldValue.text === \"string\" && fieldValue.text.trim()) {\r\n    return fieldValue.text;\r\n  }\r\n  if (rawNode && typeof rawNode.title === \"string\" && rawNode.title.trim()) {\r\n    return rawNode.title;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Compare text values\r\n */\r\nfunction compareText(a: any, b: any): number {\r\n  const aStr = String(a || \"\").toLowerCase();\r\n  const bStr = String(b || \"\").toLowerCase();\r\n  return aStr.localeCompare(bStr);\r\n}\r\n\r\n/**\r\n * Compare number values\r\n */\r\nfunction compareNumber(a: any, b: any): number {\r\n  const aNum = typeof a === \"number\" ? a : parseFloat(a);\r\n  const bNum = typeof b === \"number\" ? b : parseFloat(b);\r\n\r\n  if (isNaN(aNum) && isNaN(bNum)) return 0;\r\n  if (isNaN(aNum)) return 1;\r\n  if (isNaN(bNum)) return -1;\r\n\r\n  return aNum - bNum;\r\n}\r\n\r\n/**\r\n * Compare date values\r\n */\r\nfunction compareDate(a: any, b: any): number {\r\n  const aDate = new Date(a);\r\n  const bDate = new Date(b);\r\n\r\n  if (isNaN(aDate.getTime()) && isNaN(bDate.getTime())) return 0;\r\n  if (isNaN(aDate.getTime())) return 1;\r\n  if (isNaN(bDate.getTime())) return -1;\r\n\r\n  return aDate.getTime() - bDate.getTime();\r\n}\r\n\r\n/**\r\n * Compare single select values by option order\r\n */\r\nfunction compareSingleSelect(a: any, b: any, field: FieldConfig): number {\r\n  const aOption = a.option || a;\r\n  const bOption = b.option || b;\r\n\r\n  if (!aOption || !bOption) {\r\n    return compareText(aOption?.name || \"\", bOption?.name || \"\");\r\n  }\r\n\r\n  // If field has options array, sort by position in array\r\n  if (field.options && Array.isArray(field.options)) {\r\n    const aIndex = field.options.findIndex(\r\n      (opt: any) => opt.id === aOption.id || opt.name === aOption.name,\r\n    );\r\n    const bIndex = field.options.findIndex(\r\n      (opt: any) => opt.id === bOption.id || opt.name === bOption.name,\r\n    );\r\n\r\n    if (aIndex !== -1 && bIndex !== -1) {\r\n      return aIndex - bIndex;\r\n    }\r\n  }\r\n\r\n  // Fallback to name comparison\r\n  return compareText(aOption.name, bOption.name);\r\n}\r\n\r\n/**\r\n * Compare iteration values by start date\r\n */\r\nfunction compareIteration(a: any, b: any): number {\r\n  const aDate = a.startDate || a.iteration?.startDate;\r\n  const bDate = b.startDate || b.iteration?.startDate;\r\n\r\n  if (!aDate && !bDate) {\r\n    // Sort by title if no dates\r\n    return compareText(\r\n      a.title || a.iteration?.title,\r\n      b.title || b.iteration?.title,\r\n    );\r\n  }\r\n\r\n  return compareDate(aDate, bDate);\r\n}\r\n\r\n/**\r\n * Compare labels by first label name\r\n */\r\nfunction compareLabels(a: any, b: any): number {\r\n  const aLabels = Array.isArray(a) ? a : [];\r\n  const bLabels = Array.isArray(b) ? b : [];\r\n\r\n  if (aLabels.length === 0 && bLabels.length === 0) return 0;\r\n  if (aLabels.length === 0) return 1;\r\n  if (bLabels.length === 0) return -1;\r\n\r\n  return compareText(aLabels[0].name, bLabels[0].name);\r\n}\r\n", "export type RefreshFn = (() => void) | null;\r\n\r\nclass MenuManager {\r\n  private static menus = new Set<HTMLElement>();\r\n  private static refreshMap = new WeakMap<HTMLElement, RefreshFn>();\r\n\r\n  // Close and remove all registered menus\r\n  public static closeAll() {\r\n    try {\r\n      for (const el of Array.from(MenuManager.menus)) {\r\n        try {\r\n          // Remove any DOM elements that share the same data-menu-type (backdrops, helpers)\r\n          try {\r\n            const type = (el && el.dataset && el.dataset.menuType) || null;\r\n            if (type) {\r\n              const nodes = Array.from(document.querySelectorAll(`[data-menu-type=\"${type}\"]`));\r\n              for (const n of nodes) {\r\n                try { n.remove(); } catch (e) { }\r\n              }\r\n            }\r\n          } catch (e) { }\r\n\r\n          if (el && el.parentElement) el.parentElement.removeChild(el);\r\n        } catch (e) { }\r\n        MenuManager.refreshMap.delete(el);\r\n      }\r\n    } catch (e) { }\r\n    MenuManager.menus.clear();\r\n  }\r\n\r\n  // Register a menu element with an optional refresh callback\r\n  public static register(menuEl: HTMLElement, refreshFn?: RefreshFn) {\r\n    if (!menuEl) return;\r\n    MenuManager.menus.add(menuEl);\r\n    if (refreshFn) MenuManager.refreshMap.set(menuEl, refreshFn);\r\n  }\r\n\r\n  // Unregister without removing from DOM\r\n  public static unregister(menuEl: HTMLElement) {\r\n    if (!menuEl) return;\r\n    MenuManager.menus.delete(menuEl);\r\n    MenuManager.refreshMap.delete(menuEl);\r\n  }\r\n\r\n  // Refresh/reposition all registered menus by calling their refresh callbacks\r\n  public static refreshAll() {\r\n    try {\r\n      for (const el of Array.from(MenuManager.menus)) {\r\n        const fn = MenuManager.refreshMap.get(el);\r\n        try { if (fn) fn(); } catch (e) { }\r\n      }\r\n    } catch (e) { }\r\n  }\r\n}\r\n\r\nexport default MenuManager;\r\n", "export interface MenuItem {\r\n  id?: string;\r\n  label: string;\r\n  info?: string;\r\n  forceChevron?: boolean;\r\n  iconName?: string; // optional icon rendered to the left\r\n  onClick?: (anchor?: HTMLElement, anchorRect?: DOMRect) => any;\r\n  children?: MenuItem[];\r\n}\r\n\r\nexport interface ActiveTabMenuOptions {\r\n  anchorElement: HTMLElement;\r\n  items: MenuItem[] | (() => MenuItem[]);\r\n}\r\n\r\nimport MenuManager from './menuManager';\r\n\r\nexport class ActiveTabMenu {\r\n  private anchorElement: HTMLElement;\r\n  private itemsSource: MenuItem[] | (() => MenuItem[]);\r\n  private buttonEl: HTMLElement | null = null;\r\n  private menuEl: HTMLElement | null = null;\r\n  private backdropEl: HTMLElement | null = null;\r\n  private openSubmenuEl: HTMLElement | null = null;\r\n  // Optional refresh callback for externally created submenus (e.g., FieldsMenu instances)\r\n  private externalSubmenuRefresh: (() => void) | null = null;\r\n\r\n  constructor(options: ActiveTabMenuOptions) {\r\n    this.anchorElement = options.anchorElement;\r\n    this.itemsSource = options.items || [];\r\n    this.attachButton();\r\n  }\r\n\r\n  private attachButton() {\r\n    // Create small button to the right of the anchor element\r\n    const btn = document.createElement(\"button\");\r\n    btn.className = \"active-tab-menu-button\";\r\n    btn.type = \"button\";\r\n    btn.title = \"Open view menu\";\r\n    btn.style.border = \"none\";\r\n    btn.style.background = \"transparent\";\r\n    btn.style.padding = \"0 4px\";\r\n    btn.style.marginLeft = \"8px\";\r\n    btn.style.cursor = \"pointer\";\r\n    btn.style.display = \"inline-flex\";\r\n    btn.style.alignItems = \"center\";\r\n\r\n    // Match the icon color to the anchor text color\r\n    try {\r\n      const computed = window.getComputedStyle(this.anchorElement);\r\n      if (computed && computed.color) {\r\n        btn.style.color = computed.color;\r\n      }\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n\r\n    const iconSpan = document.createElement(\"span\");\r\n    iconSpan.style.display = \"inline-flex\";\r\n    iconSpan.style.alignItems = \"center\";\r\n    iconSpan.style.justifyContent = \"center\";\r\n    iconSpan.style.height = \"16px\";\r\n    iconSpan.style.width = \"16px\";\r\n    iconSpan.style.lineHeight = \"1\";\r\n    // Use global icon registry helper if available\r\n    iconSpan.innerHTML = (window as any).getIconSvg?.(\"triangle-down\") || \"\";\r\n    // Ensure svg inherits the current color\r\n    const svgs = iconSpan.querySelectorAll(\"svg\");\r\n    svgs.forEach((s) => s.setAttribute(\"fill\", \"currentColor\"));\r\n\r\n    btn.appendChild(iconSpan);\r\n    btn.addEventListener(\"click\", (e) => {\r\n      e.stopPropagation();\r\n      this.toggle();\r\n    });\r\n\r\n    this.buttonEl = btn;\r\n\r\n    // Insert button after the anchor element\r\n    if (this.anchorElement.parentElement) {\r\n      this.anchorElement.parentElement.insertBefore(btn, this.anchorElement.nextSibling);\r\n    }\r\n  }\r\n\r\n  public toggle() {\r\n    if (this.menuEl) {\r\n      this.hide();\r\n    } else {\r\n      this.show();\r\n    }\r\n  }\r\n\r\n  public show() {\r\n    // Close any other open menus before showing\r\n    try { MenuManager.closeAll(); } catch (e) { }\r\n    this.hide();\r\n\r\n    // backdrop to close when clicking outside\r\n    this.backdropEl = document.createElement(\"div\");\r\n    this.backdropEl.style.position = \"fixed\";\r\n    this.backdropEl.style.top = \"0\";\r\n    this.backdropEl.style.left = \"0\";\r\n    this.backdropEl.style.right = \"0\";\r\n    this.backdropEl.style.bottom = \"0\";\r\n    this.backdropEl.style.zIndex = \"998\";\r\n    this.backdropEl.addEventListener(\"click\", () => this.hide());\r\n    this.backdropEl.dataset.menuType = 'active-tab-menu';\r\n    document.body.appendChild(this.backdropEl);\r\n\r\n    this.menuEl = document.createElement(\"div\");\r\n    this.menuEl.className = \"active-tab-menu\";\r\n    this.menuEl.dataset.menuType = 'active-tab-menu';\r\n    this.menuEl.style.position = \"absolute\";\r\n    this.menuEl.style.background = \"var(--vscode-menu-background)\";\r\n    this.menuEl.style.border = \"1px solid var(--vscode-menu-border)\";\r\n    this.menuEl.style.borderRadius = \"4px\";\r\n    this.menuEl.style.boxShadow = \"0 2px 8px rgba(0,0,0,0.15)\";\r\n    this.menuEl.style.width = \"320px\";\r\n    this.menuEl.style.padding = \"4px 0\";\r\n    this.menuEl.style.zIndex = \"1000\";\r\n    this.menuEl.style.fontSize = \"13px\";\r\n\r\n    document.body.appendChild(this.menuEl);\r\n    const items = typeof this.itemsSource === 'function' ? this.itemsSource() : this.itemsSource;\r\n    this.buildMenu(this.menuEl, items);\r\n\r\n    const rect = (this.buttonEl || this.anchorElement).getBoundingClientRect();\r\n    const menuRect = this.menuEl.getBoundingClientRect();\r\n    const margin = 8;\r\n    const vw = window.innerWidth || document.documentElement.clientWidth;\r\n    const vh = window.innerHeight || document.documentElement.clientHeight;\r\n\r\n    let top = rect.bottom + margin;\r\n    if (rect.bottom + menuRect.height + margin > vh) {\r\n      if (rect.top - menuRect.height - margin >= 0) {\r\n        top = rect.top - menuRect.height - margin;\r\n      } else {\r\n        top = Math.max(margin, Math.min(vh - menuRect.height - margin, rect.bottom + margin));\r\n      }\r\n    }\r\n\r\n      try { MenuManager.register(this.menuEl, this.refresh.bind(this)); } catch (e) { }\r\n    let left = rect.left;\r\n    if (rect.left + menuRect.width + margin > vw) {\r\n      left = Math.max(margin, rect.right - menuRect.width);\r\n    }\r\n    left = Math.max(margin, Math.min(left, vw - menuRect.width - margin));\r\n\r\n    this.menuEl.style.top = `${Math.round(top)}px`;\r\n    this.menuEl.style.left = `${Math.round(left)}px`;\r\n  }\r\n\r\n  public hide() {\r\n    if (this.menuEl) {\r\n      this.menuEl.remove();\r\n      this.menuEl = null;\r\n    }\r\n    if (this.backdropEl) {\r\n      this.backdropEl.remove();\r\n      this.backdropEl = null;\r\n    }\r\n    this.closeOpenSubmenu();\r\n  }\r\n\r\n  // Refresh the menu content while it's open (for live updates)\r\n  public refresh() {\r\n    if (this.menuEl) {\r\n      this.menuEl.innerHTML = '';\r\n      const items = typeof this.itemsSource === 'function' ? this.itemsSource() : this.itemsSource;\r\n      this.buildMenu(this.menuEl, items);\r\n      // If an external submenu provided a refresh callback, invoke it so it can update too\r\n      try { if (this.externalSubmenuRefresh) this.externalSubmenuRefresh(); } catch (e) { }\r\n    }\r\n  }\r\n\r\n  // Remove all DOM elements created by this instance (button + menus)\r\n  public destroy() {\r\n    try {\r\n      this.hide();\r\n    } catch (e) { }\r\n    if (this.buttonEl) {\r\n      try {\r\n        this.buttonEl.remove();\r\n      } catch (e) { }\r\n      this.buttonEl = null;\r\n    }\r\n  }\r\n\r\n  private buildMenu(container: HTMLElement, items: MenuItem[]) {\r\n    // (removed top separator - not needed visually)\r\n\r\n    // If this menu is attached to a view tab, render a compact view-generator selector\r\n    try {\r\n      const tabEl = this.anchorElement && this.anchorElement.parentElement ? (this.anchorElement.parentElement as HTMLElement) : null;\r\n      const viewKey = tabEl ? tabEl.getAttribute('data-viewkey') : null;\r\n      if (viewKey) {\r\n        const sel = document.createElement('div');\r\n        sel.style.display = 'flex';\r\n        sel.style.gap = '8px';\r\n        sel.style.padding = '6px 12px';\r\n        sel.style.justifyContent = 'center';\r\n        sel.style.alignItems = 'center';\r\n\r\n        const currentLayout = tabEl ? tabEl.getAttribute('data-layout') : null;\r\n\r\n        const makeOption = (layout: string, icon: string, label: string) => {\r\n          const opt = document.createElement('div');\r\n          opt.style.display = 'inline-flex';\r\n          opt.style.alignItems = 'center';\r\n          opt.style.gap = '8px';\r\n          opt.style.padding = '6px 10px';\r\n          opt.style.borderRadius = '6px';\r\n          opt.style.cursor = 'pointer';\r\n          opt.style.fontWeight = '500';\r\n          opt.style.color = 'var(--vscode-menu-foreground)';\r\n          // If this option matches the current layout, mark it with the same\r\n          // background used by table/column headers for visual consistency.\r\n          if (currentLayout && currentLayout === layout) {\r\n            opt.style.background = 'var(--vscode-sideBar-background)';\r\n            opt.style.color = 'var(--vscode-foreground)';\r\n            opt.style.fontWeight = '600';\r\n          }\r\n          opt.onmouseenter = () => { opt.style.background = 'var(--vscode-menu-selectionBackground)'; opt.style.color = 'var(--vscode-menu-selectionForeground)'; };\r\n          opt.onmouseleave = () => { opt.style.background = 'transparent'; opt.style.color = 'var(--vscode-menu-foreground)'; };\r\n\r\n          const iconSpan = document.createElement('span');\r\n          iconSpan.style.display = 'inline-flex';\r\n          iconSpan.style.alignItems = 'center';\r\n          iconSpan.style.justifyContent = 'center';\r\n          iconSpan.style.width = '16px';\r\n          iconSpan.style.height = '16px';\r\n          iconSpan.innerHTML = (window as any).getIconSvg ? (window as any).getIconSvg(icon) : '';\r\n          try { iconSpan.querySelectorAll && iconSpan.querySelectorAll('svg').forEach((s: any) => s.setAttribute('fill', 'currentColor')); } catch (e) { }\r\n\r\n          const lbl = document.createElement('span');\r\n          lbl.style.fontSize = '13px';\r\n          lbl.textContent = label;\r\n\r\n          opt.appendChild(iconSpan);\r\n          opt.appendChild(lbl);\r\n\r\n          opt.addEventListener('click', (ev) => {\r\n            ev.stopPropagation();\r\n            try {\r\n              // Update in-memory project view layout so the inline showTab logic picks it up\r\n              try {\r\n                const pd = (window as any).__PROJECT_DATA__ || (window as any).__project_data__;\r\n                if (pd && Array.isArray(pd.views)) {\r\n                  const idx = parseInt(String(viewKey).split('-')[1]);\r\n                  if (!isNaN(idx) && pd.views[idx]) pd.views[idx].layout = layout;\r\n                }\r\n              } catch (e) { }\r\n\r\n              // Update the tab DOM attribute/icon and re-click the tab to re-render\r\n              try {\r\n                if (tabEl) {\r\n                  tabEl.setAttribute('data-layout', layout);\r\n                  const iconWrapper = tabEl.querySelector('.tab-icon');\r\n                  if (iconWrapper) {\r\n                    const iconName = layout === 'table' ? 'table' : (layout === 'board' ? 'project' : 'roadmap');\r\n                    iconWrapper.innerHTML = (window as any).getIconSvg ? (window as any).getIconSvg(iconName) : '';\r\n                  }\r\n                  // Trigger a click to cause the tab's fetcher to run (inline script showTab handler)\r\n                  try { (tabEl as HTMLElement).click(); } catch (e) { }\r\n                }\r\n              } catch (e) { }\r\n\r\n              // Close the ActiveTabMenu after changing\r\n              try { this.hide(); } catch (e) { }\r\n            } catch (e) { }\r\n          });\r\n\r\n          return opt;\r\n        };\r\n\r\n        sel.appendChild(makeOption('table', 'table', 'Table'));\r\n        sel.appendChild(makeOption('board', 'project', 'Board'));\r\n        sel.appendChild(makeOption('roadmap', 'roadmap', 'Roadmap'));\r\n\r\n        container.appendChild(sel);\r\n      }\r\n    } catch (e) { }\r\n\r\n    // Add a bottom separator after selector / before actual items\r\n    try {\r\n      const midLine = document.createElement('div');\r\n      midLine.style.height = '1px';\r\n      midLine.style.background = 'var(--vscode-panel-border)';\r\n      midLine.style.margin = '6px 0';\r\n      container.appendChild(midLine);\r\n    } catch (e) { }\r\n\r\n    items.forEach((item) => {\r\n      const row = document.createElement(\"div\");\r\n      row.className = \"active-tab-menu-item\";\r\n      row.style.display = \"flex\";\r\n      row.style.alignItems = \"center\";\r\n      row.style.padding = \"6px 12px\";\r\n      row.style.cursor = \"pointer\";\r\n      row.style.color = \"var(--vscode-menu-foreground)\";\r\n\r\n      // Left icon (if any)\r\n      if (item.iconName && (window as any).getIconSvg) {\r\n        const leftIcon = document.createElement('span');\r\n        leftIcon.style.display = 'inline-flex';\r\n        leftIcon.style.alignItems = 'center';\r\n        leftIcon.style.justifyContent = 'center';\r\n        leftIcon.style.marginRight = '8px';\r\n        leftIcon.innerHTML = (window as any).getIconSvg(item.iconName) || '';\r\n        // make sure svg inherits color\r\n        try { leftIcon.querySelectorAll && leftIcon.querySelectorAll('svg').forEach(s => s.setAttribute('fill', 'currentColor')); } catch (e) { }\r\n        row.appendChild(leftIcon);\r\n      }\r\n\r\n      const labelEl = document.createElement(\"div\");\r\n      labelEl.style.flex = \"1\";\r\n      labelEl.style.minWidth = \"0\";\r\n      labelEl.style.overflow = \"hidden\";\r\n      labelEl.style.whiteSpace = \"nowrap\";\r\n      labelEl.style.textOverflow = \"ellipsis\";\r\n      labelEl.style.marginRight = \"8px\";\r\n\r\n      if (item.info) {\r\n        const b = document.createElement(\"span\");\r\n        b.style.fontWeight = \"600\";\r\n        b.textContent = item.label + \": \";\r\n        labelEl.appendChild(b);\r\n\r\n        const i = document.createElement(\"span\");\r\n        i.style.opacity = \"0.7\";\r\n        i.textContent = item.info;\r\n        labelEl.appendChild(i);\r\n      } else {\r\n        labelEl.style.fontWeight = \"500\";\r\n        labelEl.textContent = item.label;\r\n      }\r\n      row.appendChild(labelEl);\r\n\r\n      if ((item.children && item.children.length) || item.forceChevron) {\r\n        const arrow = document.createElement(\"span\");\r\n        arrow.innerHTML = (window as any).getIconSvg?.(\"chevron-right\") || \"\u203A\";\r\n        arrow.style.marginLeft = \"auto\";\r\n        arrow.style.flex = \"0 0 auto\";\r\n        arrow.style.opacity = \"0.7\";\r\n        row.appendChild(arrow);\r\n\r\n        if (item.children && item.children.length) {\r\n          row.addEventListener(\"mouseenter\", (e) => {\r\n            this.openSubmenuForRow(row, item.children!);\r\n          });\r\n          row.addEventListener(\"mouseleave\", (e) => {\r\n            // submenu will be handled\r\n          });\r\n        }\r\n      }\r\n\r\n      if (item.children && item.children.length) {\r\n        // handled above\r\n        } else {\r\n        row.addEventListener(\"click\", (ev) => {\r\n          try { ev.stopPropagation(); } catch (e) { }\r\n          try {\r\n            // Close any hover-opened submenu and external dropdowns before invoking click handler\r\n            try { this.closeOpenSubmenu(); } catch (e) { }\r\n            try { document.querySelectorAll('.roadmap-dropdown-menu').forEach((n) => (n as HTMLElement).remove()); } catch (e) { }\r\n            const rect = row.getBoundingClientRect();\r\n            const res: any = item.onClick ? item.onClick(row, rect) : undefined;\r\n            // If handler returns a Promise, wait for it. If it resolves to true, keep parent open.\r\n            if (res && typeof res.then === \"function\") {\r\n              res\r\n                .then((keepOpen: any) => {\r\n                  if (!keepOpen) this.hide();\r\n                })\r\n                .catch(() => this.hide());\r\n            } else {\r\n              // If handler returned truthy true, keep open; otherwise close\r\n              if (!res) this.hide();\r\n            }\r\n          } catch (err) {\r\n            try {\r\n              this.hide();\r\n            } catch (e) { }\r\n          }\r\n        });\r\n      }\r\n\r\n      row.addEventListener(\"mouseenter\", () => {\r\n        row.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n        row.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n      });\r\n      row.addEventListener(\"mouseleave\", () => {\r\n        row.style.background = \"transparent\";\r\n        row.style.color = \"var(--vscode-menu-foreground)\";\r\n      });\r\n\r\n      container.appendChild(row);\r\n    });\r\n  }\r\n\r\n  private openSubmenuForRow(row: HTMLElement, children: MenuItem[]) {\r\n    // close any existing submenu\r\n    this.closeOpenSubmenu();\r\n\r\n    if (!this.menuEl) return;\r\n\r\n    const submenu = document.createElement(\"div\");\r\n    submenu.className = \"active-tab-submenu\";\r\n    submenu.style.position = \"absolute\";\r\n    submenu.style.background = \"var(--vscode-menu-background)\";\r\n    submenu.style.border = \"1px solid var(--vscode-menu-border)\";\r\n    submenu.style.borderRadius = \"4px\";\r\n    submenu.style.boxShadow = \"0 2px 8px rgba(0,0,0,0.15)\";\r\n    submenu.style.minWidth = \"160px\";\r\n    submenu.style.padding = \"4px 0\";\r\n    submenu.style.zIndex = \"1001\";\r\n    submenu.style.fontSize = \"13px\";\r\n\r\n    document.body.appendChild(submenu);\r\n    this.buildMenu(submenu, children);\r\n\r\n    const parentRect = row.getBoundingClientRect();\r\n    const submenuRect = submenu.getBoundingClientRect();\r\n    const menuRect = this.menuEl.getBoundingClientRect();\r\n    const vw = window.innerWidth || document.documentElement.clientWidth;\r\n    const vh = window.innerHeight || document.documentElement.clientHeight;\r\n    const margin = 4;\r\n\r\n    // Position to the right of the parent row\r\n    let top = parentRect.top;\r\n    if (top + submenuRect.height > vh) {\r\n      top = Math.max(margin, Math.min(vh - submenuRect.height - margin, top));\r\n    }\r\n\r\n    // Remove any externally created dropdowns so only this submenu shows\r\n    try { document.querySelectorAll('.roadmap-dropdown-menu').forEach(n => (n as HTMLElement).remove()); } catch (e) { }\r\n\r\n    // Anchor submenu to the option row's right edge so submenus align with the row\r\n    let left = parentRect.right + 4;\r\n    // If would overflow viewport, try open to the left of the parent row\r\n    if (left + submenuRect.width > vw) {\r\n      left = parentRect.left - submenuRect.width - 4;\r\n      // If still overflows, fall back to positioning against the parent menu\r\n      if (left < margin) {\r\n        left = Math.max(margin, Math.min(menuRect.right + 4, vw - submenuRect.width - margin));\r\n      }\r\n    }\r\n\r\n    submenu.style.top = `${Math.round(top)}px`;\r\n    submenu.style.left = `${Math.round(left)}px`;\r\n\r\n    this.openSubmenuEl = submenu;\r\n\r\n    // close submenu when mouse leaves it and parent menu\r\n    submenu.addEventListener(\"mouseleave\", () => {\r\n      // small timeout to allow entering a nested submenu\r\n      setTimeout(() => {\r\n        if (this.openSubmenuEl === submenu) {\r\n          this.closeOpenSubmenu();\r\n        }\r\n      }, 150);\r\n    });\r\n  }\r\n\r\n  private closeOpenSubmenu() {\r\n    if (this.openSubmenuEl) {\r\n      this.openSubmenuEl.remove();\r\n      this.openSubmenuEl = null;\r\n      this.externalSubmenuRefresh = null;\r\n    }\r\n  }\r\n\r\n  // Allow external submenus (created by other components) to be registered so\r\n  // the ActiveTabMenu can close or refresh them when needed.\r\n  public registerExternalSubmenu(el: HTMLElement | null, refreshFn?: () => void) {\r\n    try {\r\n      // Close any existing submenu first\r\n      this.closeOpenSubmenu();\r\n    } catch (e) { }\r\n    if (el) {\r\n      this.openSubmenuEl = el;\r\n      this.externalSubmenuRefresh = refreshFn || null;\r\n      try { MenuManager.register(el, refreshFn || null); } catch (e) { }\r\n    }\r\n  }\r\n}\r\n\r\nexport default ActiveTabMenu;\r\n", "import ActiveTabMenu from './ActiveTabMenu';\r\n\r\nfunction initOnce() {\r\n  const tabsContainer = document.getElementById('tabs-container');\r\n  if (!tabsContainer) return;\r\n\r\n  let currentLabel: HTMLElement | null = null;\r\n  const tabsContainerEl = tabsContainer as HTMLElement;\r\n\r\n  function removeMenuFromLabel(label: HTMLElement | null) {\r\n    if (!label) return;\r\n    const inst = (label as any).__activeTabMenu as ActiveTabMenu | undefined;\r\n    if (inst && typeof inst.destroy === 'function') {\r\n      try {\r\n        inst.destroy();\r\n      } catch (e) { }\r\n    }\r\n    try {\r\n      // remove any attached event listener for roadmap date changes\r\n      const listener = (label as any).__activeTabMenuDateListener as any;\r\n      if (listener) {\r\n        try { window.removeEventListener('roadmap:dateFieldsChanged', listener); } catch (e) { }\r\n        try { window.removeEventListener('roadmap:zoomChanged', listener); } catch (e) { }\r\n      }\r\n    } catch (e) { }\r\n    try { delete (label as any).__activeTabMenu; delete (label as any).__activeTabMenuDateListener; } catch (e) { }\r\n  }\r\n\r\n  function attachMenuToActive() {\r\n    // Find the currently active tab with data-layout (only view tabs should have menus)\r\n    const activeTab = tabsContainerEl.querySelector('.tab.active') as HTMLElement | null;\r\n    if (!activeTab) {\r\n      // no active tab -> remove existing\r\n      removeMenuFromLabel(currentLabel);\r\n      currentLabel = null;\r\n      return;\r\n    }\r\n    const layout = activeTab.getAttribute('data-layout');\r\n    if (!layout) {\r\n      // active tab is not a view tab\r\n      removeMenuFromLabel(currentLabel);\r\n      currentLabel = null;\r\n      return;\r\n    }\r\n\r\n    const label = activeTab.querySelector('.tab-label') as HTMLElement | null;\r\n    if (!label) return;\r\n\r\n    // If a menu is already attached to this label, mark it as current and skip\r\n    if ((label as any).__activeTabMenu) {\r\n      currentLabel = label;\r\n      return; // already attached\r\n    }\r\n\r\n    // remove previous\r\n    removeMenuFromLabel(currentLabel);\r\n\r\n    // create new menu for active label\r\n    const viewKey = activeTab.getAttribute('data-viewkey') || null;\r\n\r\n    const getItems = () => {\r\n      const vsLocal = viewKey && (window as any).__viewStates ? (window as any).__viewStates[viewKey] : null;\r\n\r\n      // Calculate fields info\r\n      let fieldsInfo = \"\";\r\n      if (vsLocal && vsLocal.fields) {\r\n        const visibleSet = new Set(Array.from(vsLocal.visibleFieldIds || [] as any));\r\n        const names = (vsLocal.fields as any[])\r\n          .filter((f: any) => visibleSet.has(String(f.id)))\r\n          .map((f: any) => f.name);\r\n        fieldsInfo = names.join(\", \");\r\n      }\r\n\r\n      // Calculate group info\r\n      let groupInfo = \"\";\r\n      if (vsLocal && vsLocal.current) {\r\n        groupInfo = vsLocal.current;\r\n      }\r\n\r\n      // Calculate column info (board only)\r\n      let columnInfo = \"\";\r\n      if (vsLocal && vsLocal.currentColumn) {\r\n        columnInfo = vsLocal.currentColumn;\r\n      }\r\n\r\n      const items: any[] = [];\r\n\r\n      // Fields - only for table and board layouts\r\n      if (layout === 'table' || layout === 'board') {\r\n        items.push({\r\n          label: 'Fields',\r\n          info: fieldsInfo,\r\n          forceChevron: true,\r\n          iconName: 'note',\r\n          onClick: (anchor?: HTMLElement, anchorRect?: DOMRect) => {\r\n            // Lazy-load the FieldsMenu component\r\n            return import('./FieldsMenu')\r\n              .then(({ FieldsMenu }) => {\r\n                try {\r\n                  // Close any open submenu in the parent ActiveTabMenu\r\n                  try { (label as any).__activeTabMenu && (label as any).__activeTabMenu.closeOpenSubmenu && (label as any).__activeTabMenu.closeOpenSubmenu(); } catch (e) { }\r\n                  const fields = (vsLocal && vsLocal.fields) || [];\r\n                  const visible = new Set<string>(\r\n                    vsLocal && vsLocal.visibleFieldIds\r\n                      ? Array.from(vsLocal.visibleFieldIds).map((x: any) => String(x))\r\n                      : []\r\n                  );\r\n                  const menu = new FieldsMenu({\r\n                    fields: (fields || []).map((f: any) => ({\r\n                      id: String(f.id),\r\n                      name: f.name,\r\n                      iconClass: f.iconClass,\r\n                      dataType: f.dataType,\r\n                      locked: f.name === \"Title\"\r\n                    })),\r\n                    visibleFieldIds: visible as unknown as Set<string>,\r\n                    onToggleVisibility: (fieldId: string, visibleFlag: boolean) => {\r\n                      try {\r\n                        if (vsLocal && typeof vsLocal.onToggleVisibility === 'function') {\r\n                          vsLocal.onToggleVisibility(String(fieldId), visibleFlag);\r\n                        }\r\n                        // Refresh parent menu to show updated info\r\n                        setTimeout(() => {\r\n                          const parentMenu = (label as any).__activeTabMenu;\r\n                          if (parentMenu && typeof parentMenu.refresh === 'function') {\r\n                            parentMenu.refresh();\r\n                          }\r\n                        }, 50);\r\n                      } catch (e) { }\r\n                    },\r\n                  });\r\n                  const created = menu.show((anchor as HTMLElement) || (label as HTMLElement), anchorRect as DOMRect | undefined);\r\n                  try {\r\n                    const parentMenuInst = (label as any).__activeTabMenu;\r\n                    if (parentMenuInst && typeof parentMenuInst.registerExternalSubmenu === 'function' && created && (created.el as HTMLElement)) {\r\n                      try { parentMenuInst.registerExternalSubmenu(created.el as HTMLElement, created.refresh); } catch (e) { }\r\n                    }\r\n                  } catch (e) { }\r\n                } catch (e) { }\r\n                return true;\r\n              })\r\n              .catch(() => false);\r\n          },\r\n        });\r\n      }\r\n\r\n      // (Table/board Field sum is added after Sort-by so it appears later)\r\n\r\n      // Column by - only for board layout\r\n      if (layout === 'board') {\r\n        items.push({\r\n          label: 'Column by',\r\n          info: columnInfo,\r\n          forceChevron: true,\r\n          iconName: 'columns',\r\n          onClick: (anchor?: HTMLElement, anchorRect?: DOMRect) => {\r\n            // Lazy-load GroupByMenu for column selection (reuse same component)\r\n            return import('./GroupByMenu')\r\n              .then(({ default: GroupByMenu }) => {\r\n                try {\r\n                  // Close any open submenu in the parent ActiveTabMenu\r\n                  try { (label as any).__activeTabMenu && (label as any).__activeTabMenu.closeOpenSubmenu && (label as any).__activeTabMenu.closeOpenSubmenu(); } catch (e) { }\r\n                  const fields = (vsLocal && vsLocal.fields) || [];\r\n                  // Only single_select and iteration fields for columns\r\n                  const columnFields = (fields || []).filter((f: any) => {\r\n                    const raw = String((f.dataType || f.type || '')).toLowerCase();\r\n                    return raw === 'single_select' || raw.includes('iteration');\r\n                  });\r\n                  const menu = new GroupByMenu({\r\n                    title: 'Column by',\r\n                    fields: (columnFields || []).map((f: any) => ({ id: String(f.id), name: f.name, iconClass: f.iconClass, dataType: f.dataType })),\r\n                    items: vsLocal && vsLocal.items ? vsLocal.items : [],\r\n                    current: vsLocal && vsLocal.currentColumn ? vsLocal.currentColumn : null,\r\n                    onSelect: (fieldName: string | null) => {\r\n                      try {\r\n                        if (vsLocal && typeof vsLocal.onSetColumnBy === 'function') {\r\n                          vsLocal.onSetColumnBy(fieldName);\r\n                        }\r\n                        // Refresh parent menu to show updated info\r\n                        setTimeout(() => {\r\n                          const parentMenu = (label as any).__activeTabMenu;\r\n                          if (parentMenu && typeof parentMenu.refresh === 'function') {\r\n                            parentMenu.refresh();\r\n                          }\r\n                        }, 50);\r\n                      } catch (e) { }\r\n                    },\r\n                  });\r\n                  const created = menu.show((anchor as HTMLElement) || (label as HTMLElement), anchorRect as DOMRect | undefined);\r\n                  try {\r\n                    const parentMenuInst = (label as any).__activeTabMenu;\r\n                    if (parentMenuInst && typeof parentMenuInst.registerExternalSubmenu === 'function' && created && (created.el as HTMLElement)) {\r\n                      try { parentMenuInst.registerExternalSubmenu(created.el as HTMLElement, created.refresh); } catch (e) { }\r\n                    }\r\n                  } catch (e) { }\r\n                } catch (e) { }\r\n                return true;\r\n              })\r\n              .catch(() => false);\r\n          },\r\n        });\r\n      }\r\n\r\n      \r\n\r\n      // Group by / Swimlanes - available for all views (3rd option)\r\n      items.push({\r\n        label: layout === 'board' ? 'Swimlanes' : 'Group by',\r\n        info: groupInfo,\r\n        forceChevron: true,\r\n        iconName: 'rows',\r\n        onClick: (anchor?: HTMLElement, anchorRect?: DOMRect) => {\r\n          // Lazy-load GroupByMenu\r\n          return import('./GroupByMenu')\r\n            .then(({ default: GroupByMenu }) => {\r\n              try {\r\n                // Close any open submenu in the parent ActiveTabMenu\r\n                try { (label as any).__activeTabMenu && (label as any).__activeTabMenu.closeOpenSubmenu && (label as any).__activeTabMenu.closeOpenSubmenu(); } catch (e) { }\r\n                const fields = (vsLocal && vsLocal.fields) || [];\r\n                const groupable = (fields || []).filter((f: any) => {\r\n                  const raw = String((f.dataType || f.type || f.name || '')).toLowerCase();\r\n                  if (raw.includes('assign') || raw.includes('assignee')) return true;\r\n                  if (raw.includes('repo') || raw.includes('repository')) return true;\r\n                  if (raw.includes('parent')) return true;\r\n                  if (raw.includes('num') || raw.includes('number') || raw.includes('numeric')) return true;\r\n                  if (raw.includes('iteration')) return true;\r\n                  if (raw.includes('single') && raw.includes('select')) return true;\r\n                  if (raw.includes('milestone')) return true;\r\n                  if (raw.includes('date')) return true;\r\n                  if (raw.includes('text')) return true;\r\n                  return false;\r\n                });\r\n                const menu = new GroupByMenu({\r\n                  title: layout === 'board' ? 'Swimlanes' : 'Group by',\r\n                  fields: (groupable || []).map((f: any) => ({ id: String(f.id), name: f.name, iconClass: f.iconClass, dataType: f.dataType })),\r\n                  items: vsLocal && vsLocal.items ? vsLocal.items : [],\r\n                  current: vsLocal && (vsLocal.current || vsLocal.currentGrouping) ? (vsLocal.current || vsLocal.currentGrouping) : null,\r\n                  onSelect: (fieldName: string | null) => {\r\n                    try {\r\n                      if (vsLocal && typeof vsLocal.onSetGroupBy === 'function') {\r\n                        vsLocal.onSetGroupBy(fieldName);\r\n                      }\r\n                      // Refresh parent menu to show updated info\r\n                      setTimeout(() => {\r\n                        const parentMenu = (label as any).__activeTabMenu;\r\n                        if (parentMenu && typeof parentMenu.refresh === 'function') {\r\n                          parentMenu.refresh();\r\n                        }\r\n                      }, 50);\r\n                    } catch (e) { }\r\n                  },\r\n                });\r\n                  const created = menu.show((anchor as HTMLElement) || (label as HTMLElement), anchorRect as DOMRect | undefined);\r\n                  try {\r\n                    const parentMenuInst = (label as any).__activeTabMenu;\r\n                    if (parentMenuInst && typeof parentMenuInst.registerExternalSubmenu === 'function' && created && (created.el as HTMLElement)) {\r\n                      try { parentMenuInst.registerExternalSubmenu(created.el as HTMLElement, created.refresh); } catch (e) { }\r\n                    }\r\n                  } catch (e) { }\r\n              } catch (e) { }\r\n              return true;\r\n            })\r\n            .catch(() => false);\r\n        },\r\n      });\r\n\r\n      // Markers - only for roadmap layout (4th option)\r\n      if (layout === 'roadmap') {\r\n        // Build info text showing currently active markers (Milestones + selected fields)\r\n        let markersInfo = '';\r\n        try {\r\n          const roadmapRenderer = vsLocal && vsLocal.roadmapRenderer;\r\n          if (roadmapRenderer && typeof roadmapRenderer.getActiveMarkers === 'function') {\r\n            const active = roadmapRenderer.getActiveMarkers();\r\n            if (Array.isArray(active) && active.length > 0) {\r\n              const names = active.map((id: any) => {\r\n                if (String(id) === 'milestones') return 'Milestones';\r\n                const f = (vsLocal && vsLocal.fields) ? (vsLocal.fields as any[]).find((ff: any) => String(ff.id) === String(id) || ff.name === id) : null;\r\n                return f ? f.name : String(id);\r\n              });\r\n              markersInfo = names.join(', ');\r\n            } else {\r\n              markersInfo = 'None';\r\n            }\r\n          }\r\n        } catch (e) { }\r\n\r\n        items.push({\r\n          label: 'Markers',\r\n          info: markersInfo,\r\n          forceChevron: true,\r\n          iconName: 'location',\r\n          onClick: (anchor?: HTMLElement, anchorRect?: DOMRect) => {\r\n            try {\r\n              // Use the RoadmapRenderer's showMarkersMenu directly\r\n              const roadmapRenderer = vsLocal && vsLocal.roadmapRenderer;\r\n              if (roadmapRenderer && typeof roadmapRenderer.showMarkersMenu === 'function') {\r\n                // Close any existing dropdowns/submenus so only one is open\r\n                try { document.querySelectorAll('.roadmap-dropdown-menu').forEach((n) => (n as HTMLElement).remove()); } catch (e) { }\r\n                try { (label as any).__activeTabMenu && (label as any).__activeTabMenu.closeOpenSubmenu && (label as any).__activeTabMenu.closeOpenSubmenu(); } catch (e) { }\r\n                // Create a synthetic MouseEvent with currentTarget (prefer the option row `anchor`)\r\n                // If an `anchorRect` was provided use a lightweight object with a `getBoundingClientRect`\r\n                // so the roadmap menu can re-position itself even if the original row DOM node is later removed.\r\n                const syntheticEvent = {\r\n                  currentTarget: anchorRect ? ({ getBoundingClientRect: () => anchorRect } as unknown as HTMLElement) : (anchor || label)\r\n                } as unknown as MouseEvent;\r\n                try {\r\n                  const created = roadmapRenderer.showMarkersMenu(syntheticEvent);\r\n                  const parentMenuInst = (label as any).__activeTabMenu;\r\n                  if (created && created.el && parentMenuInst && typeof parentMenuInst.registerExternalSubmenu === 'function') {\r\n                    try { parentMenuInst.registerExternalSubmenu(created.el as HTMLElement, created.refresh); } catch (e) { }\r\n                  }\r\n                } catch (e) { }\r\n              }\r\n            } catch (e) { }\r\n            return true;\r\n          },\r\n        });\r\n      }\r\n\r\n      // Sort by - available for table/board/roadmap (placed after Markers)\r\n      if (layout === 'table' || layout === 'board' || layout === 'roadmap') {\r\n        // Normalize sort info so invalid values (like a project id) show as 'None'\r\n        let sortInfo = 'None';\r\n        let sortCurrent: string | null = null;\r\n        try {\r\n          const cur = vsLocal && (vsLocal.currentSort || vsLocal.currentSortName);\r\n          if (cur) {\r\n            if (typeof cur === 'string') {\r\n              const f = (vsLocal && vsLocal.fields ? (vsLocal.fields as any[]) : []).find((ff: any) => String(ff.id) === String(cur) || ff.name === cur);\r\n              if (f) { sortInfo = f.name || String(f.id); sortCurrent = String(f.id); }\r\n              else { sortInfo = 'None'; sortCurrent = null; }\r\n            } else if (typeof cur === 'object' && cur.fieldId) {\r\n              const f = (vsLocal && vsLocal.fields ? (vsLocal.fields as any[]) : []).find((ff: any) => String(ff.id) === String(cur.fieldId));\r\n              if (f) { sortInfo = f.name || String(f.id); sortCurrent = String(f.id); }\r\n              else { sortInfo = 'None'; sortCurrent = null; }\r\n            } else {\r\n              sortInfo = 'None'; sortCurrent = null;\r\n            }\r\n          } else {\r\n            sortInfo = 'None'; sortCurrent = null;\r\n          }\r\n        } catch (e) { sortInfo = 'None'; sortCurrent = null; }\r\n\r\n        items.push({\r\n          label: 'Sort by',\r\n          info: sortInfo,\r\n          forceChevron: true,\r\n          iconName: 'arrow-up-down',\r\n          onClick: (anchor?: HTMLElement, anchorRect?: DOMRect) => {\r\n            return import('./SortByMenu')\r\n              .then(({ SortByMenu }) => {\r\n                try {\r\n                  // Close any open submenu in the parent ActiveTabMenu\r\n                  try { (label as any).__activeTabMenu && (label as any).__activeTabMenu.closeOpenSubmenu && (label as any).__activeTabMenu.closeOpenSubmenu(); } catch (e) { }\r\n                  const fields = (vsLocal && vsLocal.fields) || [];\r\n                  const menu = new SortByMenu({\r\n                    fields: (fields || []).map((f: any) => ({ id: String(f.id), name: f.name, iconClass: f.iconClass, dataType: f.dataType })),\r\n                    current: sortCurrent,\r\n                    onSelect: (fieldId: string | null) => {\r\n                      try {\r\n                        if (vsLocal && typeof vsLocal.onSetSort === 'function') {\r\n                          vsLocal.onSetSort(fieldId);\r\n                        }\r\n                        setTimeout(() => {\r\n                          const parentMenu = (label as any).__activeTabMenu;\r\n                          if (parentMenu && typeof parentMenu.refresh === 'function') {\r\n                            parentMenu.refresh();\r\n                          }\r\n                        }, 50);\r\n                      } catch (e) { }\r\n                    }\r\n                  });\r\n                  const created = menu.show((anchor as HTMLElement) || (label as HTMLElement), anchorRect as DOMRect | undefined);\r\n                  try {\r\n                    const parentMenuInst = (label as any).__activeTabMenu;\r\n                    if (parentMenuInst && typeof parentMenuInst.registerExternalSubmenu === 'function' && created && (created.el as HTMLElement)) {\r\n                      try { parentMenuInst.registerExternalSubmenu(created.el as HTMLElement, created.refresh); } catch (e) { }\r\n                    }\r\n                  } catch (e) { }\r\n                } catch (e) { }\r\n                return true;\r\n              })\r\n              .catch(() => false);\r\n          },\r\n        });\r\n      }\r\n\r\n      // Insert Field sum for table/board immediately after Sort-by (so it's later in the list)\r\n      if (layout === 'table' || layout === 'board') {\r\n        try {\r\n          // Compute info text from current selection\r\n          let fdInfo = '';\r\n          try {\r\n            const cur = (vsLocal && (vsLocal.groupDivisors || null));\r\n            if (Array.isArray(cur) && cur.length > 0) {\r\n              const fields = (vsLocal && vsLocal.fields) || [];\r\n              const names = cur.map((id: any) => {\r\n                if (String(id) === '__count__') return 'Count';\r\n                const f = (fields || []).find((ff: any) => String(ff.id) === String(id) || ff.name === id);\r\n                return f ? f.name : String(id);\r\n              });\r\n              fdInfo = names.join(', ');\r\n            } else if (cur === null) fdInfo = 'None';\r\n          } catch (e) { }\r\n\r\n          items.push({\r\n            label: 'Field sum',\r\n            info: fdInfo,\r\n            forceChevron: true,\r\n            iconName: 'number',\r\n            onClick: (anchor?: HTMLElement, anchorRect?: DOMRect) => {\r\n              return import('./FieldSumMenu')\r\n                .then(({ default: FieldSumMenu, FieldSumMenu: FieldSumMenuClass }) => {\r\n                  try {\r\n                    try { (label as any).__activeTabMenu && (label as any).__activeTabMenu.closeOpenSubmenu && (label as any).__activeTabMenu.closeOpenSubmenu(); } catch (e) { }\r\n                    const fields = (vsLocal && vsLocal.fields) || [];\r\n                    const current = (vsLocal && (vsLocal.groupDivisors || [])) || [];\r\n                    const menu = new (FieldSumMenuClass || FieldSumMenu)({\r\n                      fields: (fields || []).map((f: any) => ({ id: String(f.id), name: f.name, dataType: f.dataType })),\r\n                      current: Array.isArray(current) ? current : [],\r\n                      title: 'Field sum',\r\n                      onChange: (selected: string[]) => {\r\n                        try {\r\n                          if (vsLocal && typeof vsLocal.onSetGroupDivisors === 'function') {\r\n                            vsLocal.onSetGroupDivisors(selected && selected.length ? selected : null);\r\n                          }\r\n                          setTimeout(() => {\r\n                            const parentMenu = (label as any).__activeTabMenu;\r\n                            if (parentMenu && typeof parentMenu.refresh === 'function') parentMenu.refresh();\r\n                          }, 50);\r\n                        } catch (e) { }\r\n                      }\r\n                    });\r\n                    const created = menu.show((anchor as HTMLElement) || (label as HTMLElement), anchorRect as DOMRect | undefined);\r\n                    try {\r\n                      const parentMenuInst = (label as any).__activeTabMenu;\r\n                      if (parentMenuInst && typeof parentMenuInst.registerExternalSubmenu === 'function' && created && (created.el as HTMLElement)) {\r\n                        try { parentMenuInst.registerExternalSubmenu(created.el as HTMLElement, created.refresh); } catch (e) { }\r\n                      }\r\n                    } catch (e) { }\r\n                  } catch (e) { }\r\n                  return true;\r\n                })\r\n                .catch(() => false);\r\n            }\r\n          });\r\n        } catch (e) { }\r\n      }\r\n\r\n      // Date - only for roadmap layout (placed after Sort by)\r\n      if (layout === 'roadmap') {\r\n        // Build info text from roadmap renderer's selected start/end fields\r\n        let dateInfo = '';\r\n        try {\r\n          const roadmapRenderer = vsLocal && vsLocal.roadmapRenderer;\r\n          if (roadmapRenderer) {\r\n            const startId = (roadmapRenderer as any).startDateFieldId || (roadmapRenderer as any).startDateField || null;\r\n            const endId = (roadmapRenderer as any).endDateFieldId || (roadmapRenderer as any).endDateField || null;\r\n            const fields = (vsLocal && vsLocal.fields) || [];\r\n            const startName = startId ? (fields as any[]).find((f: any) => String(f.id) === String(startId))?.name : null;\r\n            const endName = endId ? (fields as any[]).find((f: any) => String(f.id) === String(endId))?.name : null;\r\n            if (startName && endName) {\r\n              dateInfo = startName === endName ? startName : `${startName} & ${endName}`;\r\n            } else if (startName) {\r\n              dateInfo = startName;\r\n            } else if (endName) {\r\n              dateInfo = endName;\r\n            }\r\n          }\r\n        } catch (e) { /* ignore */ }\r\n\r\n        items.push({\r\n          label: 'Date',\r\n          info: dateInfo,\r\n          forceChevron: true,\r\n          iconName: 'calendar',\r\n          onClick: (anchor?: HTMLElement, anchorRect?: DOMRect) => {\r\n            try {\r\n              const roadmapRenderer = vsLocal && vsLocal.roadmapRenderer;\r\n              if (roadmapRenderer && typeof roadmapRenderer.showDateFieldsMenu === 'function') {\r\n                // Close any existing dropdowns/submenus so only one is open\r\n                try { document.querySelectorAll('.roadmap-dropdown-menu').forEach((n) => (n as HTMLElement).remove()); } catch (e) { }\r\n                try { (label as any).__activeTabMenu && (label as any).__activeTabMenu.closeOpenSubmenu && (label as any).__activeTabMenu.closeOpenSubmenu(); } catch (e) { }\r\n                // Prefer the option row `anchor` as the anchor so submenu aligns to the row\r\n                const parentMenuEl = (label as any).__activeTabMenu && (label as any).__activeTabMenu.menuEl ? (label as any).__activeTabMenu.menuEl as HTMLElement : undefined;\r\n                const syntheticEvent = {\r\n                  currentTarget: anchorRect ? ({ getBoundingClientRect: () => anchorRect } as unknown as HTMLElement) : (anchor || parentMenuEl || label)\r\n                } as unknown as MouseEvent;\r\n                try {\r\n                  const created = roadmapRenderer.showDateFieldsMenu(syntheticEvent);\r\n                  const parentMenuInst = (label as any).__activeTabMenu;\r\n                  if (created && created.el && parentMenuInst && typeof parentMenuInst.registerExternalSubmenu === 'function') {\r\n                    try { parentMenuInst.registerExternalSubmenu(created.el as HTMLElement, created.refresh); } catch (e) { }\r\n                  }\r\n                } catch (e) { }\r\n              }\r\n            } catch (e) { }\r\n            return true;\r\n          },\r\n        });\r\n        // Zoom level - only for roadmap layout (placed after Date)\r\n        try {\r\n          let zoomInfo = '';\r\n          const roadmapRenderer = vsLocal && vsLocal.roadmapRenderer;\r\n          if (roadmapRenderer) {\r\n            const zl = (roadmapRenderer as any).zoomLevel || 'month';\r\n            zoomInfo = zl.charAt(0).toUpperCase() + zl.slice(1);\r\n          }\r\n          items.push({\r\n            label: 'Zoom level',\r\n            info: zoomInfo,\r\n            forceChevron: true,\r\n            iconName: 'zoom-in',\r\n            onClick: (anchor?: HTMLElement, anchorRect?: DOMRect) => {\r\n              try {\r\n                const roadmapRenderer = vsLocal && vsLocal.roadmapRenderer;\r\n                if (roadmapRenderer && typeof roadmapRenderer.showZoomMenu === 'function') {\r\n                  // Close existing dropdowns/submenus\r\n                  try { document.querySelectorAll('.roadmap-dropdown-menu').forEach((n) => (n as HTMLElement).remove()); } catch (e) { }\r\n                  try { (label as any).__activeTabMenu && (label as any).__activeTabMenu.closeOpenSubmenu && (label as any).__activeTabMenu.closeOpenSubmenu(); } catch (e) { }\r\n                  const parentMenuEl = (label as any).__activeTabMenu && (label as any).__activeTabMenu.menuEl ? (label as any).__activeTabMenu.menuEl as HTMLElement : undefined;\r\n                  const syntheticEvent = {\r\n                    currentTarget: anchorRect ? ({ getBoundingClientRect: () => anchorRect } as unknown as HTMLElement) : (anchor || parentMenuEl || label)\r\n                  } as unknown as MouseEvent;\r\n                  try {\r\n                    const created = roadmapRenderer.showZoomMenu(syntheticEvent);\r\n                    const parentMenuInst = (label as any).__activeTabMenu;\r\n                    if (created && created.el && parentMenuInst && typeof parentMenuInst.registerExternalSubmenu === 'function') {\r\n                      try { parentMenuInst.registerExternalSubmenu(created.el as HTMLElement, created.refresh); } catch (e) { }\r\n                    } else {\r\n                      // Fallback: some views render the slice panel directly into the\r\n                      // view container instead of returning it. Detect that DOM node\r\n                      // and register it so the ActiveTabMenu can manage it like other submenus.\r\n                      try {\r\n                        const el = document.querySelector('.slice-panel') as HTMLElement | null;\r\n                        if (el && parentMenuInst && typeof parentMenuInst.registerExternalSubmenu === 'function') {\r\n                          try { parentMenuInst.registerExternalSubmenu(el, () => { /* no-op */ }); } catch (e) { }\r\n                        }\r\n                      } catch (e) { }\r\n                    }\r\n                  } catch (e) { }\r\n                }\r\n              } catch (e) { }\r\n              return true;\r\n            }\r\n          });\r\n          } catch (e) { }\r\n\r\n          // Field sum - allow toggling count and numeric fields for group divisors (roadmap: placed after Zoom)\r\n          try {\r\n            let fdInfo = '';\r\n            try {\r\n              const cur = (vsLocal && (vsLocal.groupDivisors || null));\r\n              if (Array.isArray(cur) && cur.length > 0) {\r\n                const fields = (vsLocal && vsLocal.fields) || [];\r\n                const names = cur.map((id: any) => {\r\n                  if (String(id) === '__count__') return 'Count';\r\n                  const f = (fields || []).find((ff: any) => String(ff.id) === String(id) || ff.name === id);\r\n                  return f ? f.name : String(id);\r\n                });\r\n                fdInfo = names.join(', ');\r\n              } else if (cur === null) fdInfo = 'None';\r\n            } catch (e) { }\r\n\r\n            items.push({\r\n              label: 'Field sum',\r\n              info: fdInfo,\r\n              forceChevron: true,\r\n              iconName: 'number',\r\n              onClick: (anchor?: HTMLElement, anchorRect?: DOMRect) => {\r\n                return import('./FieldSumMenu')\r\n                  .then(({ default: FieldSumMenu, FieldSumMenu: FieldSumMenuClass }) => {\r\n                    try {\r\n                      try { (label as any).__activeTabMenu && (label as any).__activeTabMenu.closeOpenSubmenu && (label as any).__activeTabMenu.closeOpenSubmenu(); } catch (e) { }\r\n                      const fields = (vsLocal && vsLocal.fields) || [];\r\n                      const current = (vsLocal && (vsLocal.groupDivisors || [])) || [];\r\n                      const menu = new (FieldSumMenuClass || FieldSumMenu)({\r\n                        fields: (fields || []).map((f: any) => ({ id: String(f.id), name: f.name, dataType: f.dataType })),\r\n                        current: Array.isArray(current) ? current : [],\r\n                        title: 'Field sum',\r\n                        onChange: (selected: string[]) => {\r\n                          try {\r\n                            if (vsLocal && typeof vsLocal.onSetGroupDivisors === 'function') {\r\n                              vsLocal.onSetGroupDivisors(selected && selected.length ? selected : null);\r\n                            }\r\n                            setTimeout(() => {\r\n                              const parentMenu = (label as any).__activeTabMenu;\r\n                              if (parentMenu && typeof parentMenu.refresh === 'function') parentMenu.refresh();\r\n                            }, 50);\r\n                          } catch (e) { }\r\n                        }\r\n                      });\r\n                      const created = menu.show((anchor as HTMLElement) || (label as HTMLElement), anchorRect as DOMRect | undefined);\r\n                      try {\r\n                        const parentMenuInst = (label as any).__activeTabMenu;\r\n                        if (parentMenuInst && typeof parentMenuInst.registerExternalSubmenu === 'function' && created && (created.el as HTMLElement)) {\r\n                          try { parentMenuInst.registerExternalSubmenu(created.el as HTMLElement, created.refresh); } catch (e) { }\r\n                        }\r\n                      } catch (e) { }\r\n                    } catch (e) { }\r\n                    return true;\r\n                  })\r\n                  .catch(() => false);\r\n              }\r\n            });\r\n          } catch (e) { }\r\n\r\n        }\r\n\r\n      // Slice by - available for table/board/roadmap (last option)\r\n      try {\r\n        let sliceInfo = '';\r\n        try {\r\n          // vsLocal may expose a currentSlice or currentSliceField property\r\n          const cs = vsLocal && (vsLocal.currentSlice || vsLocal.currentSliceField || vsLocal.slice || null);\r\n          if (cs) {\r\n            if (typeof cs === 'string') sliceInfo = cs;\r\n            else if (cs && typeof cs === 'object') sliceInfo = cs.name || String(cs.fieldId || cs.id || '');\r\n          } else {\r\n            // try to read persisted slice from localStorage for table views\r\n            if (viewKey) {\r\n              try {\r\n                const stored = localStorage.getItem(`ghProjects.table.${viewKey}.slice`);\r\n                if (stored) {\r\n                  const parsed = JSON.parse(stored);\r\n                  if (parsed && parsed.fieldId) sliceInfo = String(parsed.fieldId);\r\n                }\r\n              } catch (e) { }\r\n            }\r\n          }\r\n        } catch (e) { }\r\n\r\n        if (layout === 'table' || layout === 'board' || layout === 'roadmap') {\r\n          items.push({\r\n            label: 'Slice by',\r\n            info: sliceInfo || 'None',\r\n            forceChevron: true,\r\n            iconName: 'sliceby',\r\n            onClick: (anchor?: HTMLElement, anchorRect?: DOMRect) => {\r\n              try {\r\n                // Prefer a view-provided API to show the slice UI. If the view returns\r\n                // a created element we register it as an external submenu so the\r\n                // ActiveTabMenu can manage closing/refresh like other menus.\r\n                // Note: For slice, the el is the persistent panel in the view, not a removable submenu,\r\n                // so we don't register it to avoid it being removed when the menu closes.\r\n                if (vsLocal && typeof vsLocal.showSlicePanel === 'function') {\r\n                  try {\r\n                    // Set a global refresh function for the slice menu to update info\r\n                    (window as any).__sliceMenuRefresh = () => {\r\n                      const parentMenuInst = (label as any).__activeTabMenu;\r\n                      if (parentMenuInst && typeof parentMenuInst.refresh === 'function') {\r\n                        parentMenuInst.refresh();\r\n                      }\r\n                    };\r\n                    const created = vsLocal.showSlicePanel(anchor, anchorRect);\r\n                    // Don't register the slice panel as it should remain in the view\r\n                    // The dropdown opened by showSlicePanel is handled separately\r\n                  } catch (e) { }\r\n                  return true;\r\n                }\r\n\r\n                // Fallback: if view exposes onSetSlice, try selecting the first sliceable field\r\n                try {\r\n                  const fields = (vsLocal && vsLocal.fields) || [];\r\n                  const sliceableTypes = new Set(['assignees','single_select','parent_issue','iteration','number','date','milestone','repository','labels','text','single_line_text']);\r\n                  const candidate = (fields || []).find((f: any) => sliceableTypes.has(String((f.dataType || '').toLowerCase())));\r\n                  if (candidate) {\r\n                    try {\r\n                      if (vsLocal && typeof vsLocal.onSetSlice === 'function') {\r\n                        vsLocal.onSetSlice(candidate.id || candidate.name || candidate);\r\n                        return true;\r\n                      }\r\n                    } catch (e) { }\r\n                  }\r\n                } catch (e) { }\r\n                  } catch (e) { }\r\n                  // Also create a small floating placeholder submenu on the right\r\n                  // side of the active menu row so the parent ActiveTabMenu treats\r\n                  // the Slice option like other dropdowns visually.\r\n                  try {\r\n                    const rect = anchorRect || (anchor && anchor.getBoundingClientRect && anchor.getBoundingClientRect());\r\n                    if (rect) {\r\n                      // Remove any existing placeholder\r\n                      try { document.querySelectorAll('.active-tab-slice-placeholder').forEach(n => n.remove()); } catch (e) { }\r\n                      const ph = document.createElement('div');\r\n                      ph.className = 'active-tab-slice-placeholder';\r\n                      ph.style.position = 'absolute';\r\n                      ph.style.top = (Math.round(rect.top)) + 'px';\r\n                      ph.style.left = (Math.round(rect.right) + 8) + 'px';\r\n                      ph.style.width = '8px';\r\n                      ph.style.height = '8px';\r\n                      ph.style.zIndex = '1001';\r\n                      ph.style.pointerEvents = 'none';\r\n                      document.body.appendChild(ph);\r\n                      try { const parentMenuInst = (label as any).__activeTabMenu; if (parentMenuInst && typeof parentMenuInst.registerExternalSubmenu === 'function') parentMenuInst.registerExternalSubmenu(ph as HTMLElement, () => { /* no-op */ }); } catch (e) { }\r\n                    }\r\n                  } catch (e) { }\r\n                  return true;\r\n            },\r\n          });\r\n        }\r\n      } catch (e) { }\r\n\r\n      return items;\r\n\r\n      };\r\n\r\n    try {\r\n      const menu = new ActiveTabMenu({ anchorElement: label, items: getItems });\r\n      (label as any).__activeTabMenu = menu;\r\n      // listen for roadmap date field changes so the menu's Date info can refresh\r\n      const dateListener = () => {\r\n        try {\r\n          const parentMenu = (label as any).__activeTabMenu;\r\n          if (parentMenu && typeof parentMenu.refresh === 'function') parentMenu.refresh();\r\n        } catch (e) { }\r\n      };\r\n      try {\r\n        window.addEventListener('roadmap:dateFieldsChanged', dateListener);\r\n        window.addEventListener('roadmap:zoomChanged', dateListener);\r\n        window.addEventListener('roadmap:markersChanged', dateListener);\r\n        (label as any).__activeTabMenuDateListener = dateListener;\r\n      } catch (e) { }\r\n      currentLabel = label;\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n  }\r\n  // Update on initial load\r\n  attachMenuToActive();\r\n\r\n  // Listen for clicks on tabs to update active attachment\r\n  tabsContainerEl.addEventListener('click', () => setTimeout(attachMenuToActive, 0));\r\n\r\n  // Observe class changes and added/removed tabs\r\n  const mo = new MutationObserver((mutations) => {\r\n    for (const m of mutations) {\r\n      if (m.type === 'attributes') {\r\n        // attribute change may indicate active class change\r\n        attachMenuToActive();\r\n      }\r\n      for (const n of Array.from(m.addedNodes || [])) {\r\n        if (n.nodeType === 1) attachMenuToActive();\r\n      }\r\n    }\r\n  });\r\n  mo.observe(tabsContainerEl, { childList: true, subtree: true, attributes: true, attributeFilter: ['class'] });\r\n}\r\n// Prevent multiple initializations when this module is imported multiple times\r\nif (!(window as any).__activeTabMenusInitialized) {\r\n  (window as any).__activeTabMenusInitialized = true;\r\n  if (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', initOnce);\r\n  } else {\r\n    setTimeout(initOnce, 0);\r\n  }\r\n}\r\n\r\nexport default initOnce;\r\n", "import { escapeHtml } from \"./utils\";\r\nimport {\r\n  logDebug,\r\n  setLoadingState,\r\n  setErrorState,\r\n  createLoadMoreButton,\r\n  initFilterBar,\r\n  applyFilterVisibility,\r\n} from \"./viewFetcherUtils\";\r\nimport { BoardCardRenderer } from \"./renderers/BoardCardRenderer\";\r\nimport { SlicePanel } from \"./components/SlicePanel\";\r\nimport { parseSortByFields, sortItems } from \"./utils/tableSorting\";\r\nimport type { SortConfig } from \"./utils/tableSorting\";\r\nimport type { Item, NormalizedValue, FieldConfig } from \"../../lib/types\";\r\n/// <reference path=\"./global.d.ts\" />\r\n\r\n// Initialize active tab menus only when view fetchers are loaded\r\nimport \"./components/initActiveTabMenus\";\r\n\r\n// signal that the board fetcher script executed\r\ntry {\r\n  logDebug(\"global\", \"boardViewFetcher.loaded\");\r\n} catch (e) { }\r\ntry {\r\n  console.log && console.log(\"boardViewFetcher script loaded\");\r\n} catch (e) { }\r\n\r\n// Expose a global fetcher: window.boardViewFetcher(view, container, viewKey)\r\nfunction createBoardFetcher() {\r\n  return function (view: any, container: HTMLElement, viewKey: string) {\r\n    const viewName =\r\n      view && (view.name || view.id) ? view.name || view.id : \"Board View\";\r\n\r\n    try {\r\n      setLoadingState(container, viewName);\r\n    } catch (e) { }\r\n\r\n    var first = 50;\r\n\r\n    // Persistent state for local overrides\r\n    let unsavedSort: SortConfig | null | undefined = undefined;\r\n\r\n    // undefined = no override (use payload)\r\n    // null = override to No Grouping\r\n    // string = override to Specific Grouping\r\n    let unsavedGrouping: string | null | undefined = undefined;\r\n    // group divisors (count / numeric fields) override\r\n    let unsavedGroupDivisors: string[] | null | undefined = undefined;\r\n\r\n    // Track unsaved slice changes\r\n    let unsavedSlice: { fieldId: string; value: any } | null = null;\r\n    // Active slice panel instance (if shown)\r\n    let activeSlicePanel: any = null;\r\n\r\n    // Column override (for board view column field)\r\n    // undefined = no override, null = no column (invalid but safe), string = column field name\r\n    let unsavedColumn: string | null | undefined = undefined;\r\n\r\n    let unsavedHiddenFields: Set<string> | null = null;\r\n    let lastPayload: any = null;\r\n    let lastEffectiveFilter: string | undefined = undefined;\r\n\r\n    function render(payload: any, effectiveFilter?: string) {\r\n      try {\r\n        lastPayload = payload;\r\n        // Update effective filter if provided, otherwise preserve previous\r\n        if (effectiveFilter !== undefined) lastEffectiveFilter = effectiveFilter;\r\n        else effectiveFilter = lastEffectiveFilter;\r\n\r\n          var items = (payload && payload.items) || [];\r\n          var fields = (payload && payload.fields) || [];\r\n          var allFields = (payload && payload.allFields) || fields;\r\n          // effectiveGroupDivisors is computed below inside the view-state block; declare here so it's\r\n          // available later when creating renderers outside that block.\r\n          let effectiveGroupDivisors: string[] | null | undefined = undefined;\r\n        const existingSlicePanel = container.querySelector('.slice-panel');\r\n        container.innerHTML = \"\";\r\n        if (existingSlicePanel) {\r\n          try { container.appendChild(existingSlicePanel); } catch (e) { }\r\n        }\r\n\r\n        // Apply local hidden fields override\r\n        if (unsavedHiddenFields !== null) {\r\n          fields = allFields.filter((f: any) => !unsavedHiddenFields!.has(String(f.id)));\r\n        }\r\n\r\n        // Set container layout like table view - flex column with height 100%\r\n        container.style.margin = \"0\";\r\n        container.style.padding = \"0\";\r\n        container.style.height = \"100%\";\r\n        container.style.display = \"flex\";\r\n        container.style.flexDirection = \"column\";\r\n        container.style.overflow = \"hidden\";\r\n\r\n        let barApi = initFilterBar(container, viewKey, {\r\n          suffix: viewKey,\r\n          step: first,\r\n          onLoadMore: function () {\r\n            first += 50;\r\n            requestFields();\r\n          },\r\n          onSave: (newFilter: any) => {\r\n            let dirty = false;\r\n            // Save sort if changed (persist local override only)\r\n            if (unsavedSort !== undefined) {\r\n              try {\r\n                const key = viewKey\r\n                  ? `ghProjects.table.${viewKey}.sortConfig`\r\n                  : null;\r\n                if (key) {\r\n                  if (unsavedSort === null) {\r\n                    localStorage.removeItem(key);\r\n                  } else {\r\n                    localStorage.setItem(key, JSON.stringify(unsavedSort));\r\n                  }\r\n                }\r\n              } catch (e) { }\r\n              unsavedSort = undefined;\r\n              dirty = true;\r\n            }\r\n\r\n            // Save Hidden Fields\r\n            if (unsavedHiddenFields !== null) {\r\n              const hiddenArr = Array.from(unsavedHiddenFields);\r\n              if (\r\n                (window as any).__APP_MESSAGING__ &&\r\n                typeof (window as any).__APP_MESSAGING__.postMessage ===\r\n                \"function\"\r\n              ) {\r\n                (window as any).__APP_MESSAGING__.postMessage({\r\n                  command: \"setViewHiddenFields\",\r\n                  viewKey: viewKey,\r\n                  hiddenFields: hiddenArr,\r\n                });\r\n              }\r\n              // Persist to localStorage\r\n              try {\r\n                const key = viewKey\r\n                  ? `ghProjects.table.${viewKey}.hiddenFields`\r\n                  : null;\r\n                if (key) localStorage.setItem(key, JSON.stringify(hiddenArr));\r\n              } catch (e) { }\r\n              unsavedHiddenFields = null;\r\n              dirty = true;\r\n            }\r\n\r\n            // Save Grouping\r\n            if (unsavedGrouping !== undefined) {\r\n              if (\r\n                (window as any).__APP_MESSAGING__ &&\r\n                typeof (window as any).__APP_MESSAGING__.postMessage ===\r\n                \"function\"\r\n              ) {\r\n                (window as any).__APP_MESSAGING__.postMessage({\r\n                  command: \"setViewGrouping\",\r\n                  viewKey: viewKey,\r\n                  grouping: unsavedGrouping,\r\n                });\r\n              }\r\n              unsavedGrouping = undefined;\r\n              dirty = true;\r\n            }\r\n\r\n            // Save group divisors if changed\r\n            if (unsavedGroupDivisors !== undefined) {\r\n              try {\r\n                if ((window as any).__APP_MESSAGING__ && typeof (window as any).__APP_MESSAGING__.postMessage === 'function') {\r\n                  (window as any).__APP_MESSAGING__.postMessage({ command: 'setViewGroupDivisors', viewKey: viewKey, groupDivisors: unsavedGroupDivisors });\r\n                }\r\n              } catch (e) { }\r\n              try { const key = viewKey ? `ghProjects.table.${viewKey}.groupDivisors` : null; if (key) { if (unsavedGroupDivisors === null) localStorage.removeItem(key); else localStorage.setItem(key, JSON.stringify(unsavedGroupDivisors)); } } catch (e) { }\r\n              unsavedGroupDivisors = undefined;\r\n              dirty = true;\r\n            }\r\n\r\n            // Save slice if changed\r\n            if (unsavedSlice !== null) {\r\n              try {\r\n                if ((window as any).__APP_MESSAGING__ && typeof (window as any).__APP_MESSAGING__.postMessage === 'function') {\r\n                  (window as any).__APP_MESSAGING__.postMessage({ command: 'setViewSlice', viewKey: viewKey, slice: unsavedSlice });\r\n                }\r\n              } catch (e) { }\r\n              try { const key = viewKey ? `ghProjects.table.${viewKey}.slice` : null; if (key) localStorage.setItem(key, JSON.stringify(unsavedSlice)); } catch (e) { }\r\n              unsavedSlice = null;\r\n              dirty = true;\r\n            }\r\n\r\n            if (dirty) {\r\n              // Request fields to refresh UI from server state\r\n              requestFields();\r\n            }\r\n          },\r\n          onDiscard: () => {\r\n            if (unsavedSort !== undefined || unsavedHiddenFields !== null || unsavedGrouping !== undefined || unsavedSlice !== null) {\r\n              unsavedSort = undefined;\r\n              unsavedHiddenFields = null;\r\n              unsavedGrouping = undefined;\r\n              unsavedSlice = null;\r\n\r\n              // Close any active slice panel\r\n              try { if (activeSlicePanel && typeof activeSlicePanel.close === 'function') activeSlicePanel.close(); activeSlicePanel = null; } catch (e) { }\r\n\r\n              // Re-render\r\n              if (lastPayload) render(lastPayload, lastEffectiveFilter);\r\n              else requestFields();\r\n            }\r\n          },\r\n        });\r\n\r\n        // If the server returned an effective filter, apply it via the bar API\r\n        try {\r\n          if (\r\n            effectiveFilter &&\r\n            barApi &&\r\n            typeof barApi.setEffectiveFilter === \"function\"\r\n          ) {\r\n            try {\r\n              barApi.setEffectiveFilter(effectiveFilter);\r\n            } catch (e) { }\r\n          }\r\n        } catch (e) { }\r\n\r\n        // Expose view state for ActiveTabMenu / FieldsMenu\r\n        try {\r\n          // Calculate effective sort config (unsaved override -> stored -> server)\r\n          let effectiveSortConfig: SortConfig | null = null;\r\n          if (unsavedSort !== undefined) {\r\n            effectiveSortConfig = unsavedSort || null;\r\n          } else if (viewKey) {\r\n            try {\r\n              const stored = localStorage.getItem(`ghProjects.table.${viewKey}.sortConfig`);\r\n              if (stored) effectiveSortConfig = JSON.parse(stored);\r\n            } catch (e) { }\r\n          }\r\n          if (!effectiveSortConfig) {\r\n            effectiveSortConfig = parseSortByFields(payload && payload.details && payload.details.sortByFields);\r\n          }\r\n\r\n          let currentSortName: string | null = null;\r\n          if (effectiveSortConfig && effectiveSortConfig.fieldId) {\r\n            const sortField = allFields.find((f: any) => String(f.id) === String(effectiveSortConfig!.fieldId));\r\n            currentSortName = sortField ? sortField.name : null;\r\n          }\r\n\r\n          // determine effective group divisors (unsaved override -> localStorage -> payload.details)\r\n          try {\r\n            if (unsavedGroupDivisors !== undefined) {\r\n              effectiveGroupDivisors = unsavedGroupDivisors === null ? null : (unsavedGroupDivisors || null);\r\n            } else if (viewKey) {\r\n              try { const stored = localStorage.getItem(`ghProjects.table.${viewKey}.groupDivisors`); if (stored) effectiveGroupDivisors = JSON.parse(stored); } catch (e) { }\r\n            }\r\n            try {\r\n              const maybe = (payload as any).details && (payload as any).details.groupDivisors && Array.isArray((payload as any).details.groupDivisors.nodes) ? (payload as any).details.groupDivisors.nodes.map((n: any) => String(n.id || n.name)) : null;\r\n              if (effectiveGroupDivisors === null && maybe) effectiveGroupDivisors = maybe;\r\n            } catch (e) { }\r\n          } catch (e) { }\r\n\r\n          (window as any).__viewStates = (window as any).__viewStates || {};\r\n          (window as any).__viewStates[viewKey] = {\r\n            fields: allFields,\r\n            items: items || [],\r\n            visibleFieldIds: new Set(fields.map((f: any) => String(f.id))),\r\n            currentSort: currentSortName,\r\n            groupDivisors: effectiveGroupDivisors,\r\n            onToggleVisibility: (fieldId: string, visible: boolean) => {\r\n              try {\r\n                // Initialize unsavedHiddenFields if null\r\n                if (unsavedHiddenFields === null) {\r\n                  unsavedHiddenFields = new Set<string>();\r\n                  // Populate with currently hidden fields (allFields - fields)\r\n                  const visibleSet = new Set(fields.map((f: any) => String(f.id)));\r\n                  allFields.forEach((f: any) => {\r\n                    if (!visibleSet.has(String(f.id))) unsavedHiddenFields!.add(String(f.id));\r\n                  });\r\n                }\r\n\r\n                const id = String(fieldId);\r\n                if (visible) unsavedHiddenFields.delete(id);\r\n                else unsavedHiddenFields.add(id);\r\n\r\n                // Re-render locally\r\n                if (lastPayload) render(lastPayload, lastEffectiveFilter);\r\n              } catch (e) { }\r\n            },\r\n            onSetGroupBy: (fieldName: string | null) => {\r\n              try {\r\n                unsavedGrouping = fieldName;\r\n                // Re-render locally\r\n                if (lastPayload) render(lastPayload, lastEffectiveFilter);\r\n              } catch (e) { }\r\n            },\r\n            onSetGroupDivisors: (selected: string[] | null) => {\r\n              try {\r\n                unsavedGroupDivisors = selected === null ? null : (selected || []);\r\n                if (lastPayload) render(lastPayload, lastEffectiveFilter);\r\n              } catch (e) { }\r\n            },\r\n            onSetColumnBy: (fieldName: string | null) => {\r\n              try {\r\n                unsavedColumn = fieldName;\r\n                // Re-render locally\r\n                if (lastPayload) render(lastPayload, lastEffectiveFilter);\r\n              } catch (e) { }\r\n            },\r\n            onSetSort: (fieldId: string | null) => {\r\n              try {\r\n                if (fieldId === null) {\r\n                  unsavedSort = null;\r\n                } else {\r\n                  unsavedSort = { fieldId, direction: 'ASC' };\r\n                }\r\n                // Re-render locally\r\n                if (lastPayload) render(lastPayload, lastEffectiveFilter);\r\n              } catch (e) { }\r\n            },\r\n            // Allow external callers to show a slice panel in the board view\r\n            onSetSlice: (fieldId: string | null) => {\r\n              try {\r\n                unsavedSlice = fieldId ? { fieldId, value: null } : null;\r\n                if (lastPayload) render(lastPayload, lastEffectiveFilter);\r\n              } catch (e) { }\r\n            },\r\n            showSlicePanel: (anchor?: HTMLElement, anchorRect?: DOMRect) => {\r\n              try {\r\n                // Close existing panel\r\n                try { if (activeSlicePanel && typeof activeSlicePanel.close === 'function') activeSlicePanel.close(); activeSlicePanel = null; } catch (e) { }\r\n                // Clean up any leftover slice panels\r\n                try { const existing = container.querySelector('.slice-panel'); if (existing) existing.remove(); } catch (e) { }\r\n                const sliceableTypes = new Set(['assignees','single_select','parent_issue','iteration','number','date','milestone','repository','labels','text','single_line_text']);\r\n                let field: any = null;\r\n                try {\r\n                  const sid = unsavedSlice ? String(unsavedSlice.fieldId) : null;\r\n                  if (sid) field = allFields.find((f: any) => String(f.id) === sid);\r\n                } catch (e) { }\r\n                if (!field) field = (allFields || []).find((f: any) => sliceableTypes.has(String((f.dataType || '').toLowerCase())));\r\n                if (!field) return;\r\n                try {\r\n                  activeSlicePanel = new SlicePanel(container, field, items || [], allFields || []);\r\n                  activeSlicePanel.render();\r\n                  // Ensure panel appears before main content. If the detected main element is\r\n                  // a direct child of `container` insert before it; otherwise fall back to\r\n                  // inserting as the first child of `container` so it becomes the left column.\r\n                  try {\r\n                    const main = container.querySelector('.board-container') || container.querySelector('.board-wrapper') || container.querySelector('.board-content') || container.firstElementChild || container;\r\n                    const el = container.querySelector('.slice-panel');\r\n                    if (el) {\r\n                      try {\r\n                        if (main && main.parentElement && main.parentElement.contains(main)) {\r\n                          main.parentElement.insertBefore(el, main as Element);\r\n                          // Set parent to flex row for side-by-side layout\r\n                          main.parentElement.style.flexDirection = \"row\";\r\n                        } else {\r\n                          // main is the container or not attached where expected - insert as first child\r\n                          container.insertBefore(el, container.firstChild);\r\n                        }\r\n                      } catch (ie) {\r\n                        try { container.insertBefore(el, container.firstChild); } catch (e) { }\r\n                      }\r\n                    }\r\n                  } catch (e) { }\r\n                  // If caller provided an anchorRect (from the ActiveTabMenu) open the\r\n                  // field dropdown anchored to that rect so the menu lines up visually.\r\n                  try { if (anchorRect && activeSlicePanel && typeof activeSlicePanel.openFieldDropdown === 'function') activeSlicePanel.openFieldDropdown(anchorRect); } catch (e) { }\r\n                  activeSlicePanel.onValueSelect((value: any) => {\r\n                    try {\r\n                      unsavedSlice = { fieldId: field.id, value };\r\n                      // enable Save/Discard if barApi exists\r\n                      try {\r\n                        if (barApi && barApi.saveBtn && barApi.discardBtn) {\r\n                          barApi.saveBtn.disabled = false; barApi.saveBtn.style.opacity = '1'; barApi.saveBtn.style.cursor = 'pointer';\r\n                          barApi.discardBtn.disabled = false; barApi.discardBtn.style.opacity = '1'; barApi.discardBtn.style.cursor = 'pointer';\r\n                        }\r\n                      } catch (e) { }\r\n                      // re-render to reflect slice state\r\n                      if (lastPayload) render(lastPayload, lastEffectiveFilter);\r\n                    } catch (e) { }\r\n                  });\r\n                  activeSlicePanel.onFieldChange((newField: any) => {\r\n                    try {\r\n                      // reopen panel for new field\r\n                      activeSlicePanel && activeSlicePanel.close && activeSlicePanel.close();\r\n                      activeSlicePanel = null;\r\n                      unsavedSlice = null;\r\n                      if (newField) {\r\n                        unsavedSlice = { fieldId: newField.id, value: null };\r\n                        // show panel again\r\n                        (window as any).__viewStates[viewKey] && (window as any).__viewStates[viewKey].showSlicePanel && (window as any).__viewStates[viewKey].showSlicePanel();\r\n                      }\r\n                    } catch (e) { }\r\n                  });\r\n\r\n                } catch (e) { }\r\n                // Return created element for parent to register as external submenu\r\n                try {\r\n                  const el = (activeSlicePanel as any) && (activeSlicePanel as any).panelElement ? (activeSlicePanel as any).panelElement as HTMLElement : null;\r\n                  if (el) return { el, refresh: () => { try { /* no-op */ } catch (e) {} } };\r\n                } catch (e) { }\r\n                return null;\r\n              } catch (e) { }\r\n            },\r\n            get currentSlice() {\r\n              try {\r\n                const sid = unsavedSlice ? String(unsavedSlice.fieldId) : null;\r\n                if (sid) {\r\n                  const f = (allFields || []).find((ff: any) => String(ff.id) === sid);\r\n                  return f ? f.name : sid;\r\n                }\r\n                if (viewKey) {\r\n                  try {\r\n                    const stored = localStorage.getItem(`ghProjects.table.${viewKey}.slice`);\r\n                    if (stored) {\r\n                      const parsed = JSON.parse(stored);\r\n                      if (parsed && parsed.fieldId) {\r\n                        const f = (allFields || []).find((ff: any) => String(ff.id) === String(parsed.fieldId));\r\n                        return f ? f.name : String(parsed.fieldId);\r\n                      }\r\n                    }\r\n                  } catch (e) { }\r\n                }\r\n              } catch (e) { }\r\n              return null;\r\n            },\r\n          };\r\n        } catch (e) { }\r\n\r\n        // After detecting column/swimlane fields later in render(), we may update current grouping name\r\n        try {\r\n          (window as any).__viewStates = (window as any).__viewStates || {};\r\n          (window as any).__viewStates[viewKey] = (window as any).__viewStates[viewKey] || {};\r\n        } catch (e) { }\r\n\r\n        if (!barApi) {\r\n          var header = document.createElement(\"div\");\r\n          header.style.display = \"flex\";\r\n          header.style.justifyContent = \"space-between\";\r\n          header.style.alignItems = \"center\";\r\n          header.style.marginBottom = \"8px\";\r\n\r\n          var title = document.createElement(\"div\");\r\n          title.style.fontWeight = \"600\";\r\n          title.style.padding = \"6px\";\r\n          title.textContent = viewName;\r\n\r\n          var right = document.createElement(\"div\");\r\n          var loadBtn = createLoadMoreButton(() => {\r\n            first += 50;\r\n            requestFields();\r\n          });\r\n\r\n          right.appendChild(loadBtn);\r\n          header.appendChild(title);\r\n          header.appendChild(right);\r\n          container.appendChild(header);\r\n        }\r\n\r\n        // Detect column field from view details (verticalGroupByFields)\r\n        let columnField: any = null;\r\n\r\n        // Check for local column override first\r\n        if (unsavedColumn !== undefined) {\r\n          if (unsavedColumn !== null) {\r\n            columnField = allFields.find((f: any) => f.name === unsavedColumn);\r\n          }\r\n        } else {\r\n          try {\r\n            const details = payload && payload.details;\r\n            const verticalGroupByFields =\r\n              details &&\r\n              details.verticalGroupByFields &&\r\n              details.verticalGroupByFields.nodes;\r\n\r\n            if (verticalGroupByFields && verticalGroupByFields.length > 0) {\r\n              // Find the field in allFields that matches the verticalGroupByField\r\n              const vgbField = verticalGroupByFields[0];\r\n              columnField = allFields.find(\r\n                (f: any) =>\r\n                  String(f.id) === String(vgbField.id) ||\r\n                  String(f.name) === String(vgbField.name),\r\n              );\r\n\r\n              // Validate it's a valid column field type (single_select or iteration)\r\n              if (columnField) {\r\n                const dataType = String(columnField.dataType || \"\").toLowerCase();\r\n                if (dataType !== \"single_select\" && dataType !== \"iteration\") {\r\n                  logDebug(viewKey, \"boardViewFetcher.invalidColumnFieldType\", {\r\n                    dataType,\r\n                    fieldName: columnField.name,\r\n                  });\r\n                  columnField = null;\r\n                }\r\n              }\r\n            }\r\n              } catch (e) { }\r\n        }\r\n\r\n        // Fallback: try to find Status field (common single_select field for boards)\r\n        if (!columnField) {\r\n          columnField = allFields.find(\r\n            (f: any) =>\r\n              String(f.dataType || \"\").toLowerCase() === \"single_select\" &&\r\n              String(f.name || \"\").toLowerCase() === \"status\",\r\n          );\r\n        }\r\n\r\n        // Fallback: use first single_select field\r\n        if (!columnField) {\r\n          columnField = allFields.find(\r\n            (f: any) =>\r\n              String(f.dataType || \"\").toLowerCase() === \"single_select\",\r\n          );\r\n        }\r\n\r\n        // Update currentColumn in __viewStates\r\n        try {\r\n          if ((window as any).__viewStates && (window as any).__viewStates[viewKey]) {\r\n            (window as any).__viewStates[viewKey].currentColumn = (columnField && columnField.name) || null;\r\n          }\r\n        } catch (e) { }\r\n\r\n        // Detect swimlane field from view details (regular groupByFields on board layouts)\r\n        let swimlaneField: any = null;\r\n\r\n        if (unsavedGrouping !== undefined) {\r\n          // Use local override\r\n          if (unsavedGrouping === null) {\r\n            swimlaneField = null;\r\n          } else {\r\n            swimlaneField = allFields.find((f: any) => f.name === unsavedGrouping);\r\n          }\r\n        } else {\r\n          try {\r\n            const details = payload && payload.details;\r\n            const groupByFields =\r\n              details &&\r\n              details.groupByFields &&\r\n              details.groupByFields.nodes;\r\n\r\n            if (groupByFields && groupByFields.length > 0) {\r\n              const gbField = groupByFields[0];\r\n              swimlaneField = allFields.find(\r\n                (f: any) =>\r\n                  String(f.id) === String(gbField.id) ||\r\n                  String(f.name) === String(gbField.name),\r\n              );\r\n            }\r\n          } catch (e) {\r\n            logDebug(viewKey, \"boardViewFetcher.swimlaneFieldDetection.error\", {\r\n              message: String((e as any)?.message || e),\r\n            });\r\n          }\r\n        }\r\n\r\n        // Ensure buttons are enabled if we have unsaved changes\r\n        if (barApi && (unsavedSort !== undefined || unsavedHiddenFields !== null || unsavedGrouping !== undefined)) {\r\n          try {\r\n            if (barApi.saveBtn) {\r\n              barApi.saveBtn.disabled = false;\r\n              barApi.saveBtn.style.opacity = \"1\";\r\n              barApi.saveBtn.style.cursor = \"pointer\";\r\n            }\r\n            if (barApi.discardBtn) {\r\n              barApi.discardBtn.disabled = false;\r\n              barApi.discardBtn.style.opacity = \"1\";\r\n              barApi.discardBtn.style.cursor = \"pointer\";\r\n            }\r\n          } catch (e) { }\r\n        }\r\n\r\n        // Update __viewStates current grouping after detection\r\n        try {\r\n          // Only use swimlaneField for 'Group By' menu status in Board View\r\n          const currentGrouping = (swimlaneField && swimlaneField.name) || null;\r\n          if ((window as any).__viewStates && (window as any).__viewStates[viewKey]) {\r\n            (window as any).__viewStates[viewKey].current = currentGrouping;\r\n          }\r\n        } catch (e) { }\r\n\r\n        // Create board content container - flex grow to fill remaining space\r\n        var content = document.createElement(\"div\");\r\n        content.style.flex = \"1 1 auto\";\r\n        content.style.overflow = \"hidden\";\r\n        content.style.position = \"relative\";\r\n        content.style.display = \"flex\";\r\n        content.style.flexDirection = \"column\";\r\n\r\n        // Callbacks for interactivity\r\n        const handleFilter = (filter: string) => {\r\n          if (barApi && barApi.inputEl) {\r\n            const current = String(barApi.inputEl.value || \"\").trim();\r\n            // Avoid duplicating if checking purely space separated, but simple append is standard\r\n            let newFilter = current ? `${current} ${filter}` : filter;\r\n            barApi.inputEl.value = newFilter;\r\n            barApi.inputEl.dispatchEvent(new Event(\"input\", { bubbles: true }));\r\n          }\r\n        };\r\n\r\n        // Determine sorting - consider unsaved override (already applied to effectiveSortConfig above)\r\n        let sortConfig = parseSortByFields(payload && payload.details && payload.details.sortByFields);\r\n        if (viewKey) {\r\n          try {\r\n            const stored = localStorage.getItem(`ghProjects.table.${viewKey}.sortConfig`);\r\n            if (stored) sortConfig = JSON.parse(stored);\r\n          } catch (e) { }\r\n        }\r\n        // If we have unsavedSort (user changed via menu) prefer that\r\n        if (unsavedSort !== undefined) {\r\n          sortConfig = unsavedSort || null;\r\n        }\r\n\r\n        // Apply sorting to items\r\n        let displayItems = items;\r\n        if (sortConfig) {\r\n          displayItems = sortItems(items, allFields, sortConfig);\r\n        }\r\n\r\n        // Apply slice filtering\r\n        if (unsavedSlice) {\r\n          displayItems = displayItems.filter((item: Item) => {\r\n            const fv = item.fieldValues.find((f: any) => String(f.fieldId) === String(unsavedSlice!.fieldId));\r\n        // Handle different field types\r\n        const field = allFields.find((f: FieldConfig) => f.id === unsavedSlice!.fieldId);\r\n        const dataType = field ? (field.dataType || field.type || '').toLowerCase() : '';\r\n\r\n        // Extract value from NormalizedValue\r\n        let val = null;\r\n        if (!fv) {\r\n          // No field value found\r\n          val = null;\r\n        } else {\r\n          if ((fv as any).text !== undefined) val = (fv as any).text;\r\n          else if ((fv as any).title !== undefined) val = (fv as any).title;\r\n          else if ((fv as any).number !== undefined) val = (fv as any).number;\r\n          else if ((fv as any).date !== undefined) val = (fv as any).date;\r\n          else if ((fv as any).option) val = (fv as any).option.name;\r\n          else if ((fv as any).iteration) val = (fv as any).iteration.title;\r\n          else if ((fv as any).assignees) val = (fv as any).assignees;\r\n          else if ((fv as any).labels) val = (fv as any).labels;\r\n          else if (dataType === 'parent_issue') {\r\n            const p = (fv as any).parent || (fv as any).parentIssue || (fv as any).issue || (fv as any).item || (fv as any).value || null;\r\n            if (p) val = p.title || p.name || p.number || p.id || p.url || null;\r\n          }\r\n          else if (dataType === 'milestone') {\r\n            val = (fv as any).milestone?.title || (fv as any).milestone?.name || (fv as any).value || null;\r\n          }\r\n          else if (dataType === 'repository') {\r\n            val = (fv as any).repository?.nameWithOwner || (fv as any).repository?.full_name || (fv as any).repository?.name || (fv as any).value || null;\r\n          }\r\n          else val = (fv as any).value; // fallback\r\n        }\r\n\r\n        if (unsavedSlice!.value === null) {\r\n          // For null slice value, show items that have no value for this field\r\n          if (dataType === 'assignees' || dataType === 'labels') {\r\n            return !val || (Array.isArray(val) && val.length === 0);\r\n          } else {\r\n            return val === null || val === undefined;\r\n          }\r\n        }\r\n            if (dataType === 'assignees' || dataType === 'labels') {\r\n              if (!Array.isArray(val)) return false;\r\n              if (dataType === 'assignees') {\r\n                // For assignees, val is array of objects, slice value is object\r\n                return val.some((assignee: any) => \r\n                  assignee && (assignee.login === unsavedSlice!.value?.login || assignee.id === unsavedSlice!.value?.id)\r\n                );\r\n              } else if (dataType === 'labels') {\r\n                // For labels, val is array of objects, slice value is string (name)\r\n                return val.some((label: any) => \r\n                  label && (label.name === unsavedSlice!.value || label.id === unsavedSlice!.value)\r\n                );\r\n              }\r\n            } else {\r\n              return val === unsavedSlice!.value;\r\n            }\r\n          });\r\n        }\r\n\r\n        const handleAction = (action: string, item: any, args: any) => {\r\n          if (action === \"open-menu\" && args) {\r\n            // Close existing menus\r\n            const ex = document.querySelectorAll(\".board-context-menu\");\r\n            ex.forEach((e) => e.remove());\r\n\r\n            const menu = document.createElement(\"div\");\r\n            menu.className = \"board-context-menu\";\r\n            menu.style.position = \"fixed\";\r\n            // Ensure menu doesn't overflow right edge\r\n            const x = Math.min(args.x, window.innerWidth - 180);\r\n            const y = Math.min(args.y, window.innerHeight - 150);\r\n\r\n            menu.style.left = x + \"px\";\r\n            menu.style.top = y + \"px\";\r\n            menu.style.background = \"var(--vscode-menu-background)\";\r\n            menu.style.color = \"var(--vscode-menu-foreground)\";\r\n            menu.style.border = \"1px solid var(--vscode-menu-border)\";\r\n            menu.style.borderRadius = \"4px\";\r\n            menu.style.zIndex = \"1000\";\r\n            menu.style.boxShadow = \"0 2px 8px rgba(0,0,0,0.15)\";\r\n            menu.style.minWidth = \"160px\";\r\n            menu.style.padding = \"4px 0\";\r\n\r\n            const addItem = (\r\n              text: string,\r\n              iconClass: string,\r\n              onClick: () => void,\r\n              isSep = false,\r\n            ) => {\r\n              if (isSep) {\r\n                const sep = document.createElement(\"div\");\r\n                sep.style.height = \"1px\";\r\n                sep.style.background = \"var(--vscode-menu-separatorBackground)\";\r\n                sep.style.margin = \"4px 0\";\r\n                menu.appendChild(sep);\r\n                return;\r\n              }\r\n              const el = document.createElement(\"div\");\r\n              el.style.padding = \"4px 8px\";\r\n              el.style.cursor = \"pointer\";\r\n              el.style.display = \"flex\";\r\n              el.style.alignItems = \"center\";\r\n              el.style.gap = \"8px\";\r\n              el.style.fontSize = \"13px\";\r\n\r\n              // Icon placeholder - ideally use octicons but text + unicode/css is backup\r\n              const ico = document.createElement(\"span\");\r\n              if (iconClass) {\r\n                ico.className = \"codicon codicon-\" + iconClass; // Assuming codicons available?\r\n                // If not, use simple emoji or text.\r\n                // User requested \"add-icon\" (probably meaning 'plus' or similar) and 'octicon-arrow-both'.\r\n                // We might not have codicon font loaded in webview unless injected.\r\n                // Fallback to text for now.\r\n                if (iconClass === \"link-external\") ico.textContent = \"\u2197\";\r\n                else if (iconClass === \"globe\") ico.textContent = \"\uD83C\uDF10\";\r\n                else if (iconClass === \"arrow-both\") ico.textContent = \"\u21C4\";\r\n              }\r\n\r\n              const span = document.createElement(\"span\");\r\n              span.textContent = text;\r\n\r\n              el.appendChild(ico);\r\n              el.appendChild(span);\r\n\r\n              el.addEventListener(\"click\", (e) => {\r\n                e.stopPropagation();\r\n                menu.remove();\r\n                onClick();\r\n              });\r\n\r\n              el.addEventListener(\r\n                \"mouseenter\",\r\n                () =>\r\n                (el.style.background =\r\n                  \"var(--vscode-menu-selectionBackground)\"),\r\n              );\r\n              el.addEventListener(\r\n                \"mouseleave\",\r\n                () => (el.style.background = \"transparent\"),\r\n              );\r\n              menu.appendChild(el);\r\n            };\r\n\r\n            addItem(\"Open issue\", \"link-external\", () => {\r\n              const url =\r\n                item.content?.url ||\r\n                item.url ||\r\n                (item.raw && item.raw.itemContent && item.raw.itemContent.url);\r\n              if (url && (window as any).__APP_MESSAGING__) {\r\n                (window as any).__APP_MESSAGING__.postMessage({\r\n                  command: \"openUrl\",\r\n                  url: url,\r\n                });\r\n              }\r\n            });\r\n\r\n            addItem(\"\", \"\", () => { }, true);\r\n\r\n            addItem(\"Move to column...\", \"arrow-both\", () => {\r\n              if ((window as any).__APP_MESSAGING__) {\r\n                // Extract column options\r\n                let options: any[] = [];\r\n                if (columnField) {\r\n                  const opts =\r\n                    columnField.options ||\r\n                    (columnField.configuration &&\r\n                      columnField.configuration.options);\r\n                  const iters =\r\n                    columnField.configuration &&\r\n                    columnField.configuration.iterations;\r\n\r\n                  // Helper to format iteration date range\r\n                  const getIterationRange = (\r\n                    start: string,\r\n                    duration: number,\r\n                  ) => {\r\n                    try {\r\n                      const startDate = new Date(start);\r\n                      const endDate = new Date(\r\n                        startDate.getTime() +\r\n                        Number(duration) * 24 * 60 * 60 * 1000,\r\n                      );\r\n                      const formatDate = (d: Date) =>\r\n                        d.toLocaleDateString(\"en-US\", {\r\n                          month: \"short\",\r\n                          day: \"numeric\",\r\n                        });\r\n                      return `${formatDate(startDate)} \u2014 ${formatDate(endDate)}`;\r\n                    } catch (e) {\r\n                      return \"\";\r\n                    }\r\n                  };\r\n\r\n                  if (opts && Array.isArray(opts)) {\r\n                    options = opts.map((o: any) => ({\r\n                      id: o.id,\r\n                      name: o.name,\r\n                      color: o.color,\r\n                      description: o.description,\r\n                    }));\r\n                  } else if (iters && Array.isArray(iters)) {\r\n                    options = iters.map((it: any) => ({\r\n                      id: it.id,\r\n                      name: it.title,\r\n                      color: it.color,\r\n                      description: getIterationRange(it.startDate, it.duration),\r\n                    }));\r\n                  }\r\n                }\r\n\r\n                (window as any).__APP_MESSAGING__.postMessage({\r\n                  command: \"moveItem\",\r\n                  viewKey: viewKey,\r\n                  itemId: item.id,\r\n                  projectId: payload && payload.id,\r\n                  fieldId: columnField ? columnField.id : null,\r\n                  options: options,\r\n                  currentValue: \"\", // Could check item.fieldValues to find current\r\n                });\r\n              }\r\n            });\r\n\r\n            document.body.appendChild(menu);\r\n\r\n            // Global click to close\r\n            const closeHandler = () => {\r\n              menu.remove();\r\n              document.removeEventListener(\"click\", closeHandler);\r\n            };\r\n            // Defer to avoid immediate trigger\r\n            setTimeout(\r\n              () => document.addEventListener(\"click\", closeHandler),\r\n              0,\r\n            );\r\n          } else if (action === \"add-item-to-column\" && item && args) {\r\n            // Import AddItemMenu if not already available\r\n            import(\"./components/AddItemMenu\")\r\n              .then(({ AddItemMenu }) => {\r\n                const menu = new AddItemMenu({\r\n                  anchorElement: args.anchorElement,\r\n                  onCreateIssue: () => {\r\n                    try {\r\n                      const messaging = (window as any).__APP_MESSAGING__;\r\n                      if (\r\n                        messaging &&\r\n                        typeof messaging.postMessage === \"function\"\r\n                      ) {\r\n                        messaging.postMessage({\r\n                          command: \"addItem:createIssue\",\r\n                          viewKey: viewKey,\r\n                          projectId: payload && payload.id,\r\n                          columnFieldId: item.columnFieldId,\r\n                          columnValueId: item.columnValueId,\r\n                          columnValueName: item.columnValueName,\r\n                        });\r\n                      }\r\n                    } catch (e) {\r\n                      console.error(\r\n                        \"[boardViewFetcher] create-issue action failed\",\r\n                        e,\r\n                      );\r\n                    }\r\n                  },\r\n                  onAddFromRepo: () => {\r\n                    try {\r\n                      const messaging = (window as any).__APP_MESSAGING__;\r\n                      if (\r\n                        messaging &&\r\n                        typeof messaging.postMessage === \"function\"\r\n                      ) {\r\n                        messaging.postMessage({\r\n                          command: \"addItem:addFromRepo\",\r\n                          viewKey: viewKey,\r\n                          projectId: payload && payload.id,\r\n                          columnFieldId: item.columnFieldId,\r\n                          columnValueId: item.columnValueId,\r\n                          columnValueName: item.columnValueName,\r\n                        });\r\n                      }\r\n                    } catch (e) {\r\n                      console.error(\r\n                        \"[boardViewFetcher] add-from-repo action failed\",\r\n                        e,\r\n                      );\r\n                    }\r\n                  },\r\n                });\r\n                menu.show();\r\n              })\r\n              .catch((e) => {\r\n                console.error(\"Failed to load AddItemMenu\", e);\r\n              });\r\n          }\r\n        };\r\n\r\n        // Use BoardCardRenderer if column field is found\r\n        if (columnField) {\r\n          try {\r\n            // Extract visible field IDs\r\n            const visibleFieldIds = fields.map((f: any) => String(f.id));\r\n            const cardRenderer = new BoardCardRenderer(\r\n              allFields,\r\n              displayItems,\r\n              visibleFieldIds,\r\n              handleFilter,\r\n              handleAction,\r\n              effectiveGroupDivisors,\r\n            );\r\n            cardRenderer.renderBoard(content, columnField, swimlaneField);\r\n          } catch (e) {\r\n            logDebug(viewKey, \"boardViewFetcher.cardRenderer.error\", {\r\n              message: String((e as any)?.message || e),\r\n            });\r\n            // Fallback to flat list on error\r\n            renderFlatList(content, items);\r\n          }\r\n        } else {\r\n          // No column field found - render flat list as fallback\r\n          logDebug(viewKey, \"boardViewFetcher.noColumnField\", {\r\n            fieldsCount: allFields.length,\r\n          });\r\n          renderFlatList(content, items);\r\n        }\r\n\r\n        container.appendChild(content);\r\n\r\n        // Reposition slice panel if present\r\n        try {\r\n          const sliceEl = container.querySelector('.slice-panel') as HTMLElement;\r\n          if (sliceEl) {\r\n            const main = content.querySelector('.board-container') || content.querySelector('.board-wrapper') || content.querySelector('.board-content') || content.firstElementChild;\r\n            if (main && main.parentElement === content) {\r\n              content.insertBefore(sliceEl, main);\r\n              content.style.display = \"flex\";\r\n              content.style.flexDirection = \"row\";\r\n            }\r\n          }\r\n        } catch (e) { }\r\n\r\n        try {\r\n          if (barApi && typeof barApi.setCount === \"function\")\r\n            barApi.setCount(items.length);\r\n          if (barApi && typeof barApi.setLoadState === \"function\")\r\n            barApi.setLoadState(\r\n              items.length < first,\r\n              items.length >= first ? \"Load more\" : \"All loaded\",\r\n            );\r\n\r\n          // Wire local preview filtering via centralized helper: register items and subscribe\r\n          if (barApi && barApi.inputEl) {\r\n            if (typeof barApi.registerItems === \"function\") {\r\n              barApi.registerItems(items, { fields: fields });\r\n            }\r\n            if (typeof barApi.onFilterChange === \"function\") {\r\n              barApi.onFilterChange(function (matchedIds: any, rawFilter: any) {\r\n                applyFilterVisibility(\r\n                  container,\r\n                  \"[data-gh-item-id]\",\r\n                  matchedIds,\r\n                  \"block\",\r\n                );\r\n\r\n                if (barApi && typeof barApi.setCount === \"function\")\r\n                  barApi.setCount(matchedIds.size);\r\n\r\n                logDebug(viewKey, \"filterInput\", {\r\n                  filter: rawFilter,\r\n                  matched: matchedIds.size,\r\n                  original: items.length,\r\n                });\r\n              });\r\n            }\r\n            if (typeof barApi.onSortChange === \"function\") {\r\n              barApi.onSortChange((config: SortConfig | null) => {\r\n                unsavedSort = config || null;\r\n                if (barApi && barApi.saveBtn && barApi.discardBtn) {\r\n                  barApi.saveBtn.disabled = false;\r\n                  barApi.discardBtn.disabled = false;\r\n                  barApi.saveBtn.style.opacity = \"1\";\r\n                  barApi.saveBtn.style.cursor = \"pointer\";\r\n                  barApi.discardBtn.style.opacity = \"1\";\r\n                  barApi.discardBtn.style.cursor = \"pointer\";\r\n                }\r\n              });\r\n            }\r\n          }\r\n        } catch (e) { }\r\n      } catch (err) {\r\n        logDebug(viewKey, \"boardViewFetcher.render.error\", {\r\n          message: String(err && (err as any).message),\r\n          stack: err && (err as any).stack,\r\n        });\r\n        setErrorState(\r\n          container,\r\n          viewName,\r\n          \"Error rendering board view: \" + String(err && (err as any).message),\r\n        );\r\n      }\r\n    }\r\n\r\n    // Fallback flat list rendering (used when no column field found)\r\n    function renderFlatList(content: HTMLElement, items: any[]) {\r\n      for (var i = 0; i < items.length; i++) {\r\n        var it = items[i];\r\n        var card = document.createElement(\"div\");\r\n        try {\r\n          card.setAttribute(\"data-gh-item-id\", String(it && it.id));\r\n        } catch (e) { }\r\n        card.style.padding = \"8px\";\r\n        card.style.border = \"1px solid var(--vscode-editorWidget-border)\";\r\n        card.style.marginBottom = \"8px\";\r\n        card.style.borderRadius = \"2px\";\r\n        var titleText =\r\n          (it && it.content && (it.content.title || it.content.name)) ||\r\n          (it && it.title) ||\r\n          (it && it.raw && it.raw.title) ||\r\n          \"#\" + (i + 1);\r\n        card.innerHTML =\r\n          '<div style=\"font-weight:600\">' +\r\n          escapeHtml(titleText) +\r\n          \"</div>\" +\r\n          (it && it.id\r\n            ? '<div style=\"color:var(--vscode-descriptionForeground);font-size:12px\">' +\r\n            escapeHtml(String(it.id)) +\r\n            \"</div>\"\r\n            : \"\");\r\n        content.appendChild(card);\r\n      }\r\n    }\r\n\r\n    function onMessage(ev: MessageEvent) {\r\n      var msg = ev && ev.data ? ev.data : ev;\r\n      try {\r\n        if (msg && msg.command === \"fields\") {\r\n          if (msg.viewKey && viewKey && String(msg.viewKey) !== String(viewKey))\r\n            return;\r\n          if (msg.error) {\r\n            setErrorState(container, viewName, String(msg.error));\r\n          } else {\r\n            render(\r\n              msg.payload || (msg.payload && msg.payload.data) || msg.payload,\r\n              msg.effectiveFilter,\r\n            );\r\n          }\r\n        }\r\n      } catch (e) { }\r\n    }\r\n\r\n    function requestFields() {\r\n      try {\r\n        if (\r\n          (window as any).__APP_MESSAGING__ &&\r\n          typeof (window as any).__APP_MESSAGING__.postMessage === \"function\"\r\n        ) {\r\n          (window as any).__APP_MESSAGING__.postMessage({\r\n            command: \"requestFields\",\r\n            first: first,\r\n            viewKey: viewKey,\r\n          });\r\n        }\r\n      } catch (e) { }\r\n    }\r\n    try {\r\n      (window as any).__APP_MESSAGING__.onMessage(onMessage);\r\n    } catch (e) {\r\n      window.addEventListener(\"message\", onMessage);\r\n    }\r\n    requestFields();\r\n  };\r\n}\r\ntry {\r\n  window.boardViewFetcher = createBoardFetcher();\r\n} catch (e) { }\r\n"],
  "mappings": "mJAAA,IAAaA,EAAbC,GAAAC,EAAA,kBAAaF,EAAN,KAAuB,CAC5B,OAAc,WAAWG,EAAcC,EAAmB,CAExD,IAAIC,EAAiB,CAAC,EAChBC,GAASF,EAAM,UAAY,IAAI,YAAY,EAOjD,GANIE,IAAU,gBACZD,EAAUD,EAAM,SAAW,CAAC,EACnBE,IAAU,cACnBD,EAAWD,EAAM,eAAiBA,EAAM,cAAc,YAAe,CAAC,GAGpEC,GAAWA,EAAQ,OAAS,EAAG,CACjC,IAAME,EAAgBF,EAAQ,IAAKG,IAAc,CAC/C,OAAQA,EACR,MAAO,CAAC,CACV,EAAE,EACIC,EAAoB,CAAC,EAE3B,OAAAN,EAAM,QAAQ,CAACO,EAAMC,IAAU,CAC7B,IAAMC,EAAKF,EAAK,YAAY,KACzBG,GACC,OAAOA,EAAE,OAAO,IAAM,OAAOT,EAAM,EAAE,GACrCS,EAAE,YAAcT,EAAM,IAC1B,EACIU,EAAS,GAEb,GAAIF,EAAI,CAEN,IAAIG,EAAyB,KACzBC,EAA2B,KAW/B,GATIV,IAAU,iBACZS,EAAUH,EAAG,UAAaA,EAAG,QAAUA,EAAG,OAAO,GACjDI,EAAYJ,EAAG,MAASA,EAAG,QAAUA,EAAG,OAAO,MACtCN,IAAU,cACnBS,EACEH,EAAG,aAAgBA,EAAG,WAAaA,EAAG,UAAU,IAAOA,EAAG,GAC5DI,EAAYJ,EAAG,OAAUA,EAAG,WAAaA,EAAG,UAAU,OAGpDG,GAAWC,EAAW,CACxB,IAAMC,EAAQV,EAAO,KAClBW,GACEH,GAAW,OAAOG,EAAE,OAAO,EAAE,IAAM,OAAOH,CAAO,GACjDC,IACE,OAAOE,EAAE,OAAO,IAAI,IAAM,OAAOF,CAAS,GACzC,OAAOE,EAAE,OAAO,KAAK,IAAM,OAAOF,CAAS,EACnD,EACIC,IACFA,EAAM,MAAM,KAAK,CAAE,KAAAP,EAAM,MAAAC,CAAM,CAAC,EAChCG,EAAS,GAEb,CACF,CAEKA,GACHL,EAAW,KAAK,CAAE,KAAAC,EAAM,MAAAC,CAAM,CAAC,CAEnC,CAAC,EAEGF,EAAW,OAAS,GACtBF,EAAO,KAAK,CACV,OAAQ,CAAE,KAAM,aAAc,MAAO,aAAc,MAAO,MAAO,EACjE,MAAOE,CACT,CAAC,EAKIF,EAAO,OAAQW,GAAWA,EAAE,MAAM,OAAS,CAAC,CACrD,CAGA,IAAMC,EAAM,IAAI,IACVC,EAA4B,CAAC,EAEnCjB,EAAM,QAAQ,CAACO,EAAMC,IAAU,CAC7B,IAAMC,EAAKF,EAAK,YAAY,KACzBG,GACC,OAAOA,EAAE,OAAO,IAAM,OAAOT,EAAM,EAAE,GAAKS,EAAE,YAAcT,EAAM,IACpE,EACIiB,EAAW,KACf,GAAIT,EAEF,GAAIA,EAAG,OAAS,OAAWS,EAAMT,EAAG,aAC3BA,EAAG,QAAU,OAAWS,EAAMT,EAAG,cACjCA,EAAG,SAAW,OAAWS,EAAMT,EAAG,eAClCA,EAAG,OAAS,OAAWS,EAAMT,EAAG,aAEhCA,EAAG,OACVS,EAAMT,EAAG,OAAO,MAAQA,EAAG,OAAO,OAASA,EAAG,OAAO,WAE9CA,EAAG,UAAWS,EAAMT,EAAG,UAAU,OAASA,EAAG,UAAU,WAG9DA,EAAG,QACHA,EAAG,aACHA,EAAG,OACHA,EAAG,MACHA,EAAG,MACH,CACA,IAAMU,EACJV,EAAG,QAAUA,EAAG,aAAeA,EAAG,OAASA,EAAG,MAAQA,EAAG,MACvDU,IAEFD,EACEC,EAAE,QACFA,EAAE,IACDA,EAAE,MAAQA,EAAE,IAAI,QAAUA,EAAE,IAAI,KACjCA,EAAE,KACFA,EAAE,OACFA,EAAE,MACF,KAEN,MAESV,EAAG,UACVS,EAAM,MAAM,QAAQT,EAAG,SAAS,EAC5BA,EAAG,UAAU,IAAKW,GAAWA,EAAE,OAASA,EAAE,IAAI,EAAE,KAAK,IAAI,EACzDX,EAAG,UAEAA,EAAG,WACVS,EACET,EAAG,WAAW,eACdA,EAAG,WAAW,MACdA,EAAG,WAAW,WACdA,EAAG,WAAW,GAETA,EAAG,UACVS,EAAMT,EAAG,UAAU,OAASA,EAAG,UAAU,IAAMA,EAAG,UAAU,KACzDS,EAAMT,EAAG,QAAU,OAAYA,EAAG,MAAQ,KAGjD,GAAIS,GAAQ,MAA6BA,IAAQ,GAAI,CACnDD,EAAmB,KAAK,CAAE,KAAAV,EAAM,MAAAC,CAAM,CAAC,EACvC,MACF,CAGA,IAAIa,EAAkBH,EACtB,GAAI,OAAOA,GAAQ,SAEjB,GAAI,CACFG,EAAa,OAAOH,CAAG,EAAE,KAAK,EAC9B,IAAMI,EAAQD,EAAW,MAAM,OAAO,EAClCC,EAAM,OAAS,IAAGD,EAAaC,EAAM,CAAC,EAAE,KAAK,GAE7CD,EAAW,OAAS,MAAKA,EAAaA,EAAW,MAAM,EAAG,GAAG,EACnE,MAAY,CAAC,CAGf,IAAME,EAAM,OAAO,OAAOF,GAAe,SAAWA,EAAW,YAAY,EAAIA,CAAU,EACpFL,EAAI,IAAIO,CAAG,GACdP,EAAI,IAAIO,EAAK,CAAE,OAAQ,CAAE,GAAIA,EAAK,KAAM,OAAOF,CAAU,EAAG,MAAO,OAAOA,CAAU,CAAE,EAAG,MAAO,CAAC,CAAE,CAAC,EAEtGL,EAAI,IAAIO,CAAG,EAAG,MAAM,KAAK,CAAE,KAAAhB,EAAM,MAAAC,CAAM,CAAC,CAC1C,CAAC,EAED,IAAMgB,EAAY,MAAM,KAAKR,EAAI,OAAO,CAAC,EACzC,OAAIC,EAAmB,OAAS,GAC9BO,EAAU,KAAK,CACb,OAAQ,CAAE,KAAM,aAAc,MAAO,aAAc,MAAO,MAAO,EACjE,MAAOP,CACT,CAAC,EAGIO,CACT,CACF,ICxKA,IAAAC,GAAA,GAAAC,GAAAD,GAAA,gBAAAE,GAAA,YAAAC,KAAA,IAqBaD,GA+UNC,GApWPC,GAAAC,EAAA,kBAqBaH,GAAN,KAAiB,CAOtB,YAAYI,EAA4B,CALxC,KAAQ,YAAkC,KAC1C,KAAQ,gBAAsC,KAC9C,KAAQ,iBAAuC,KAC/C,KAAQ,cAAqC,OAG3C,KAAK,QAAUA,CACjB,CAEO,KAAKC,EAA4BC,EAAsB,CAC5D,KAAK,KAAK,EACV,KAAK,iBAAmBD,EACxB,KAAK,cAAgBC,EAIrB,GAAI,CACF,SAAS,iBAAiB,kEAAkE,EAAE,QAASC,GAAMA,EAAE,OAAO,CAAC,CACzH,MAAY,CAAE,CAEd,KAAK,gBAAkB,SAAS,cAAc,KAAK,EACnD,KAAK,gBAAgB,MAAM,SAAW,QACtC,KAAK,gBAAgB,MAAM,IAAM,IACjC,KAAK,gBAAgB,MAAM,KAAO,IAClC,KAAK,gBAAgB,MAAM,MAAQ,IACnC,KAAK,gBAAgB,MAAM,OAAS,IACpC,KAAK,gBAAgB,MAAM,OAAS,MACpC,KAAK,gBAAgB,iBAAiB,QAAS,IAAM,KAAK,KAAK,CAAC,EAChE,KAAK,gBAAgB,QAAQ,SAAW,cACxC,SAAS,KAAK,YAAY,KAAK,eAAe,EAG9C,KAAK,YAAc,SAAS,cAAc,KAAK,EAC/C,KAAK,YAAY,UAAY,cAC7B,KAAK,YAAY,QAAQ,SAAW,cACpC,KAAK,YAAY,MAAM,SAAW,WAClC,KAAK,YAAY,MAAM,WAAa,SACpC,KAAK,YAAY,MAAM,KAAO,MAC9B,KAAK,YAAY,MAAM,IAAM,MAC7B,KAAK,YAAY,MAAM,WAAa,gCACpC,KAAK,YAAY,MAAM,OAAS,sCAChC,KAAK,YAAY,MAAM,aAAe,MACtC,KAAK,YAAY,MAAM,UAAY,6BACnC,KAAK,YAAY,MAAM,SAAW,QAClC,KAAK,YAAY,MAAM,QAAU,QAEjC,KAAK,YAAY,MAAM,UAAY,OACnC,KAAK,YAAY,MAAM,UAAY,OACnC,KAAK,YAAY,MAAM,UAAY,aACnC,KAAK,YAAY,MAAM,OAAS,OAChC,KAAK,YAAY,MAAM,SAAW,OAGlC,SAAS,KAAK,YAAY,KAAK,WAAW,EAC1C,KAAK,UAAU,EAEf,IAAIC,EAAOF,EACNE,IAAMA,EAAOH,EAAc,sBAAsB,GACtD,GAAI,CAAE,QAAQ,MAAM,6BAA8B,CAAE,IAAKG,EAAK,IAAK,KAAMA,EAAK,KAAM,MAAOA,EAAK,MAAO,OAAQA,EAAK,MAAO,CAAC,CAAG,MAAY,CAAE,CAC7I,IAAMC,EAAW,KAAK,YAAY,sBAAsB,EAClDC,EAAS,EACTC,EAAK,OAAO,YAAc,SAAS,gBAAgB,YACnDC,EAAK,OAAO,aAAe,SAAS,gBAAgB,aAGtDC,EAAML,EAAK,OAASE,EACpBF,EAAK,OAASC,EAAS,OAASC,EAASE,IAEvCJ,EAAK,IAAMC,EAAS,OAASC,GAAU,EACzCG,EAAML,EAAK,IAAMC,EAAS,OAASC,EAGnCG,EAAM,KAAK,IACTH,EACA,KAAK,IAAIE,EAAKH,EAAS,OAASC,EAAQF,EAAK,OAASE,CAAM,CAC9D,GAMJ,IAAII,EAAON,EAAK,KAChB,GAAI,CAEF,IAAMF,EAAaE,EAEnBM,EAAO,KAAK,MAAMR,EAAW,MAAQ,CAAC,EAClCQ,EAAOL,EAAS,MAAQE,IAC1BG,EAAO,KAAK,MAAMR,EAAW,KAAOG,EAAS,MAAQ,CAAC,EAClDK,EAAOJ,IAAQI,EAAO,KAAK,IAAIJ,EAAQC,EAAKF,EAAS,MAAQC,CAAM,GAE3E,MAAY,CACVI,EAAON,EAAK,IACd,CAEAM,EAAO,KAAK,IAAIJ,EAAQ,KAAK,IAAII,EAAMH,EAAKF,EAAS,MAAQC,CAAM,CAAC,EAIpE,IAAIK,EAAW,KAAK,MAAMP,EAAK,KAAOA,EAAK,OAASC,EAAS,QAAU,CAAC,EACxEM,EAAW,KAAK,IAAIL,EAAQ,KAAK,IAAIK,EAAU,KAAK,IAAIL,EAAQE,EAAKH,EAAS,OAASC,CAAM,CAAC,CAAC,EAC/F,KAAK,YAAY,MAAM,IAAM,GAAG,KAAK,MAAMK,CAAQ,CAAC,KACpD,KAAK,YAAY,MAAM,KAAO,GAAG,KAAK,MAAMD,CAAI,CAAC,KACjD,KAAK,YAAY,MAAM,WAAa,UACpC,GAAI,CAAE,QAAQ,MAAM,wBAAyB,CAAE,IAAK,KAAK,MAAMC,CAAQ,EAAG,KAAM,KAAK,MAAMD,CAAI,CAAE,CAAC,CAAG,MAAY,CAAE,CACnH,MAAO,CAAE,GAAI,KAAK,YAAa,QAAS,KAAK,QAAQ,KAAK,IAAI,CAAE,CAClE,CAEO,SAAU,CACf,GAAK,KAAK,YAEV,MAAK,YAAY,UAAY,GAC7B,KAAK,UAAU,EAEf,GAAI,CACF,IAAIN,EAAO,KAAK,cAEhB,GADI,CAACA,GAAQ,KAAK,mBAAkBA,EAAO,KAAK,iBAAiB,sBAAsB,GACnF,CAACA,EAAM,OACX,IAAMC,EAAW,KAAK,YAAY,sBAAsB,EAClDC,EAAS,EACTC,EAAK,OAAO,YAAc,SAAS,gBAAgB,YACnDC,EAAK,OAAO,aAAe,SAAS,gBAAgB,aAEtDE,EAAO,KAAK,MAAMN,EAAK,MAAQ,CAAC,EAChCM,EAAOL,EAAS,MAAQE,IAC1BG,EAAO,KAAK,MAAMN,EAAK,KAAOC,EAAS,MAAQ,CAAC,EAC5CK,EAAOJ,IAAQI,EAAO,KAAK,IAAIJ,EAAQC,EAAKF,EAAS,MAAQC,CAAM,IAEzEI,EAAO,KAAK,IAAIJ,EAAQ,KAAK,IAAII,EAAMH,EAAKF,EAAS,MAAQC,CAAM,CAAC,EAEpE,IAAIK,EAAW,KAAK,MAAMP,EAAK,KAAOA,EAAK,OAASC,EAAS,QAAU,CAAC,EACxEM,EAAW,KAAK,IAAIL,EAAQ,KAAK,IAAIK,EAAU,KAAK,IAAIL,EAAQE,EAAKH,EAAS,OAASC,CAAM,CAAC,CAAC,EAC/F,KAAK,YAAY,MAAM,IAAM,GAAG,KAAK,MAAMK,CAAQ,CAAC,KACpD,KAAK,YAAY,MAAM,KAAO,GAAG,KAAK,MAAMD,CAAI,CAAC,IACnD,MAAY,CAAE,EAChB,CAEO,MAAO,CACR,KAAK,cACP,KAAK,YAAY,OAAO,EACxB,KAAK,YAAc,MAEjB,KAAK,kBACP,KAAK,gBAAgB,OAAO,EAC5B,KAAK,gBAAkB,KAE3B,CAEQ,WAAY,CAClB,GAAI,CAAC,KAAK,YAAa,OAGvB,IAAME,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,MAAM,QAAU,OACtBA,EAAM,MAAM,WAAa,SACzBA,EAAM,MAAM,QAAU,WACtBA,EAAM,MAAM,WAAa,MACzBA,EAAM,MAAM,MAAQ,sCACpBA,EAAM,MAAM,SAAW,OACvBA,EAAM,MAAM,cAAgB,YAE5B,IAAMC,EAAO,SAAS,cAAc,GAAG,EACvCA,EAAK,UAAY,uBACjBA,EAAK,MAAM,YAAc,MACzBD,EAAM,YAAYC,CAAI,EAEtB,IAAMC,EAAQ,SAAS,cAAc,MAAM,EAC3CA,EAAM,YAAc,SACpBF,EAAM,YAAYE,CAAK,EAEvB,KAAK,YAAY,YAAYF,CAAK,EAClC,KAAK,aAAa,EAGlB,IAAMG,EAAW,SAAS,cAAc,KAAK,EAC7CA,EAAS,MAAM,QAAU,OACzBA,EAAS,MAAM,WAAa,SAC5BA,EAAS,MAAM,QAAU,WACzBA,EAAS,MAAM,OAAS,UACxBA,EAAS,MAAM,MAAQ,gCACvBA,EAAS,UAAY,gFACrBA,EAAS,iBAAiB,aAAc,IAAM,CAC5CA,EAAS,MAAM,WAAa,yCAC5BA,EAAS,MAAM,MAAQ,wCACzB,CAAC,EACDA,EAAS,iBAAiB,aAAc,IAAM,CAC5CA,EAAS,MAAM,WAAa,cAC5BA,EAAS,MAAM,MAAQ,+BACzB,CAAC,EACDA,EAAS,iBAAiB,QAAS,IAAM,CACvC,KAAK,QAAQ,gBAAgB,EAC7B,KAAK,KAAK,CACZ,CAAC,EACD,KAAK,YAAY,YAAYA,CAAQ,EAErC,KAAK,aAAa,EAElB,IAAMC,EAAU,KAAK,QAAQ,OAAO,OAAQC,GAC1C,KAAK,QAAQ,gBAAgB,IAAIA,EAAE,EAAE,CACvC,EACMC,EAAS,KAAK,QAAQ,OAAO,OAChCD,GAAM,CAAC,KAAK,QAAQ,gBAAgB,IAAIA,EAAE,EAAE,CAC/C,EAEA,KAAK,iBAAiB,gBAAgB,EAClCD,EAAQ,SAAW,EAAG,KAAK,YAAY,mBAAmB,EACzDA,EAAQ,QAASC,GAAM,KAAK,YAAYA,EAAG,EAAI,CAAC,EAErD,KAAK,aAAa,EAElB,KAAK,iBAAiB,eAAe,EACjCC,EAAO,SAAW,EAAG,KAAK,YAAY,kBAAkB,EACvDA,EAAO,QAASD,GAAM,KAAK,YAAYA,EAAG,EAAK,CAAC,CACvD,CAEQ,iBAAiBE,EAAc,CACrC,GAAI,CAAC,KAAK,YAAa,OACvB,IAAMC,EAAI,SAAS,cAAc,KAAK,EACtCA,EAAE,YAAcD,EAChBC,EAAE,MAAM,QAAU,WAClBA,EAAE,MAAM,SAAW,OACnBA,EAAE,MAAM,WAAa,MACrBA,EAAE,MAAM,MAAQ,sCAChBA,EAAE,MAAM,cAAgB,YACxB,KAAK,YAAY,YAAYA,CAAC,CAChC,CACQ,YAAYD,EAAc,CAChC,GAAI,CAAC,KAAK,YAAa,OACvB,IAAME,EAAI,SAAS,cAAc,KAAK,EACtCA,EAAE,YAAcF,EAChBE,EAAE,MAAM,QAAU,WAClBA,EAAE,MAAM,MAAQ,gCAChBA,EAAE,MAAM,QAAU,MAClB,KAAK,YAAY,YAAYA,CAAC,CAChC,CAEQ,YAAYC,EAAkBN,EAAkB,CACtD,GAAI,CAAC,KAAK,YAAa,OACvB,IAAMO,EAAM,SAAS,cAAc,KAAK,EAUxC,GATAA,EAAI,MAAM,QAAU,OACpBA,EAAI,MAAM,WAAa,SACvBA,EAAI,MAAM,QAAU,WACpBA,EAAI,MAAM,OAASD,EAAM,OAAS,UAAY,UAC9CC,EAAI,MAAM,MAAQ,gCACdD,EAAM,SACRC,EAAI,MAAM,QAAU,OAGlBP,EAAS,CACX,IAAMQ,EAAI,SAAS,cAAc,MAAM,EACvCA,EAAE,YAAc,SAChBA,EAAE,MAAM,YAAc,MACtBA,EAAE,MAAM,MAAQ,yCAChBD,EAAI,YAAYC,CAAC,CACnB,KAAO,CACL,IAAMC,EAAI,SAAS,cAAc,MAAM,EACvCA,EAAE,MAAM,QAAU,eAClBA,EAAE,MAAM,MAAQ,OAChBA,EAAE,MAAM,YAAc,MACtBF,EAAI,YAAYE,CAAC,CACnB,CAGA,IAAMC,EAAW,KAAK,gBAAgBJ,CAAK,EACrCT,EAAO,SAAS,cAAc,MAAM,EAC1CA,EAAK,UAAYa,EACjBb,EAAK,MAAM,YAAc,MACzBA,EAAK,MAAM,QAAU,cACrBA,EAAK,MAAM,WAAa,SACxBU,EAAI,YAAYV,CAAI,EACpB,IAAMC,EAAQ,SAAS,cAAc,MAAM,EAC3CA,EAAM,YAAcQ,EAAM,KAC1BR,EAAM,MAAM,KAAO,IACnBA,EAAM,MAAM,WAAa,SACzBA,EAAM,MAAM,SAAW,SACvBA,EAAM,MAAM,aAAe,WAC3BS,EAAI,YAAYT,CAAK,EAEhBQ,EAAM,SACTC,EAAI,iBAAiB,aAAc,IAAM,CACvCA,EAAI,MAAM,WAAa,yCACvBA,EAAI,MAAM,MAAQ,wCACpB,CAAC,EACDA,EAAI,iBAAiB,aAAc,IAAM,CACvCA,EAAI,MAAM,WAAa,cACvBA,EAAI,MAAM,MAAQ,+BACpB,CAAC,EACDA,EAAI,iBAAiB,QAAS,IAAM,CAClC,IAAMI,EAAa,CAACX,EACpB,KAAK,QAAQ,qBAAqBM,EAAM,GAAIK,CAAU,EAClDA,EAAY,KAAK,QAAQ,gBAAgB,IAAIL,EAAM,EAAE,EACpD,KAAK,QAAQ,gBAAgB,OAAOA,EAAM,EAAE,EACjD,KAAK,cAAiB,KAAK,YAAY,UAAY,GAAK,KAAK,UAAU,EACzE,CAAC,GAGH,KAAK,YAAY,YAAYC,CAAG,CAClC,CAEQ,cAAe,CACrB,GAAI,CAAC,KAAK,YAAa,OACvB,IAAME,EAAI,SAAS,cAAc,KAAK,EACtCA,EAAE,MAAM,OAAS,MACjBA,EAAE,MAAM,WAAa,yCACrBA,EAAE,MAAM,OAAS,QACjB,KAAK,YAAY,YAAYA,CAAC,CAChC,CAKQ,gBAAgBH,EAA0B,CAChD,IAAMM,GAAYN,EAAM,UAAY,IAAI,SAAS,EAAE,YAAY,EAG/D,GACE,OAAQ,OAAe,wBAA2B,YAClD,OAAQ,OAAe,YAAe,WACtC,CACA,IAAMO,EAAY,OAAe,uBAAuBD,CAAQ,EAChE,OAAQ,OAAe,WAAWC,CAAQ,CAC5C,CAGA,OAAIP,EAAM,UACD,aAAaA,EAAM,SAAS,SAI9B,eACT,CACF,EAEOzB,GAAQD,KCpWf,IAAAkC,GAAA,GAAAC,GAAAD,GAAA,iBAAAE,GAAA,YAAAC,KAAA,IAUaD,GA8ONC,GAxPPC,GAAAC,EAAA,kBAAAC,KAUaJ,GAAN,KAAkB,CAOvB,YAAYK,EAA6B,CALzC,KAAQ,OAA6B,KACrC,KAAQ,WAAiC,KACzC,KAAQ,OAA6B,KACrC,KAAQ,WAAkC,OAGxC,KAAK,QAAUA,CACjB,CAEO,KAAKC,EAAqBC,EAAuE,CACtG,KAAK,KAAK,EACV,KAAK,OAASD,EACd,KAAK,WAAaC,EAElB,KAAK,WAAa,SAAS,cAAc,KAAK,EAC9C,KAAK,WAAW,MAAM,SAAW,QACjC,KAAK,WAAW,MAAM,IAAM,IAC5B,KAAK,WAAW,MAAM,KAAO,IAC7B,KAAK,WAAW,MAAM,MAAQ,IAC9B,KAAK,WAAW,MAAM,OAAS,IAC/B,KAAK,WAAW,MAAM,OAAS,MAC/B,KAAK,WAAW,iBAAiB,QAAS,IAAM,KAAK,KAAK,CAAC,EAC3D,SAAS,KAAK,YAAY,KAAK,UAAU,EAGzC,GAAI,CACF,SAAS,iBAAiB,kEAAkE,EAAE,QAAS,GAAM,EAAE,OAAO,CAAC,CACzH,MAAY,CAAE,CAEd,YAAK,OAAS,SAAS,cAAc,KAAK,EAC1C,KAAK,OAAO,UAAY,gBACxB,KAAK,OAAO,QAAQ,SAAW,gBAC/B,KAAK,OAAO,MAAM,SAAW,WAC7B,KAAK,OAAO,MAAM,WAAa,gCAC/B,KAAK,OAAO,MAAM,OAAS,sCAC3B,KAAK,OAAO,MAAM,aAAe,MACjC,KAAK,OAAO,MAAM,UAAY,6BAC9B,KAAK,OAAO,MAAM,SAAW,QAC7B,KAAK,OAAO,MAAM,UAAY,OAC9B,KAAK,OAAO,MAAM,UAAY,OAC9B,KAAK,OAAO,MAAM,UAAY,aAC9B,KAAK,OAAO,MAAM,QAAU,QAC5B,KAAK,OAAO,MAAM,OAAS,OAC3B,KAAK,OAAO,MAAM,SAAW,OAC7B,SAAS,KAAK,YAAY,KAAK,MAAM,EAErC,KAAK,iBAAiB,EACtB,KAAK,aAAa,EACX,CAAE,GAAI,KAAK,OAAQ,QAAS,KAAK,QAAQ,KAAK,IAAI,CAAE,CAC7D,CAEQ,kBAAmB,CACzB,GAAI,CAAC,KAAK,OAAQ,OAClB,KAAK,OAAO,UAAY,GAExB,IAAMC,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,YAAc,KAAK,QAAQ,OAAS,WAC1CA,EAAM,MAAM,QAAU,WACtBA,EAAM,MAAM,WAAa,MACzBA,EAAM,MAAM,MAAQ,sCACpBA,EAAM,MAAM,SAAW,OACvB,KAAK,OAAO,YAAYA,CAAK,EAE7B,KAAK,aAAa,EAGlB,IAAMC,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,MAAM,QAAU,OACxBA,EAAQ,MAAM,WAAa,SAC3BA,EAAQ,MAAM,QAAU,WACxBA,EAAQ,MAAM,OAAS,UAEvB,IAAMC,EAAY,SAAS,cAAc,MAAM,EAC/CA,EAAU,MAAM,QAAU,cAC1BA,EAAU,MAAM,MAAQ,OACxBA,EAAU,MAAM,YAAc,MAC9BA,EAAU,MAAM,WAAa,SAC7BA,EAAU,MAAM,eAAiB,SAC5B,KAAK,QAAQ,UAChBA,EAAU,YAAc,SACxBA,EAAU,MAAM,MAAQ,0CAE1BD,EAAQ,YAAYC,CAAS,EAE7B,IAAMC,EAAY,SAAS,cAAc,MAAM,EAC/CA,EAAU,YAAc,cACxBF,EAAQ,YAAYE,CAAS,EAE7BF,EAAQ,iBAAiB,aAAc,IAAM,CAC3CA,EAAQ,MAAM,WAAa,yCAC3BA,EAAQ,MAAM,MAAQ,wCACxB,CAAC,EACDA,EAAQ,iBAAiB,aAAc,IAAM,CAC3CA,EAAQ,MAAM,WAAa,cAC3BA,EAAQ,MAAM,MAAQ,+BACxB,CAAC,EACDA,EAAQ,iBAAiB,QAAS,IAAM,CACtC,KAAK,QAAQ,QAAU,KACvB,KAAK,QAAQ,WAAW,IAAI,EAC5B,KAAK,QAAQ,CACf,CAAC,EACD,KAAK,OAAO,YAAYA,CAAO,EAE/B,KAAK,aAAa,EAGlB,IAAIG,EAAkB,KAAK,QAAQ,QAAU,CAAC,EAC9C,GAAI,CACE,KAAK,QAAQ,OAAS,MAAM,QAAQ,KAAK,QAAQ,KAAK,GAAK,KAAK,QAAQ,MAAM,OAAS,IACzFA,GAAmB,KAAK,QAAQ,QAAU,CAAC,GAAG,OAAQC,GAAW,CAC/D,GAAI,CACF,IAAMC,EAASC,EAAiB,WAAW,KAAK,QAAQ,OAAS,CAAC,EAAGF,CAAC,EACtE,OAAO,MAAM,QAAQC,CAAM,GAAKA,EAAO,OAAS,CAClD,MAAY,CACV,MAAO,EACT,CACF,CAAC,EAEL,MAAY,CAAE,EAEbF,GAAmB,CAAC,GAAG,QAAQC,GAAK,CACnC,IAAMG,EAAI,SAAS,cAAc,KAAK,EACtCA,EAAE,MAAM,QAAU,OAClBA,EAAE,MAAM,WAAa,SACrBA,EAAE,MAAM,QAAU,WAClBA,EAAE,MAAM,OAAS,UAGjB,IAAMC,EAAQ,SAAS,cAAc,MAAM,EAC3CA,EAAM,MAAM,QAAU,cACtBA,EAAM,MAAM,MAAQ,OACpBA,EAAM,MAAM,YAAc,MAC1BA,EAAM,MAAM,WAAa,SACzBA,EAAM,MAAM,eAAiB,SAC7B,IAAMC,EAAa,KAAK,QAAQ,QAAU,OAAO,KAAK,QAAQ,OAAO,EAAE,YAAY,EAAI,KAChEA,IAAe,OAAOL,EAAE,EAAE,EAAE,YAAY,IAAMK,GAAc,OAAOL,EAAE,MAAQ,EAAE,EAAE,YAAY,IAAMK,KAExHD,EAAM,YAAc,SACpBA,EAAM,MAAM,MAAQ,0CAEtBD,EAAE,YAAYC,CAAK,EAGnB,IAAME,EAAO,SAAS,cAAc,MAAM,EAC1CA,EAAK,MAAM,QAAU,cACrBA,EAAK,MAAM,WAAa,SACxBA,EAAK,MAAM,eAAiB,SAC5BA,EAAK,MAAM,YAAc,MACzB,GAAI,CACF,IAAMC,GAAMP,EAAE,UAAY,IAAI,SAAS,EAAE,YAAY,EACrD,GAAI,OAAQ,OAAe,wBAA2B,YAAc,OAAQ,OAAe,YAAe,WAAY,CACpH,IAAMQ,EAAY,OAAe,uBAAuBD,CAAE,EAC1DD,EAAK,UAAa,OAAe,WAAWE,CAAQ,GAAK,GACzDF,EAAK,kBAAoBA,EAAK,iBAAiB,KAAK,EAAE,QAASG,GAAWA,EAAE,cAAgBA,EAAE,aAAa,OAAQ,cAAc,CAAC,CACpI,MAAWT,EAAE,YACXM,EAAK,UAAY,aAAaN,EAAE,SAAS,SAE7C,MAAY,CAAE,CACdG,EAAE,YAAYG,CAAI,EAElB,IAAMI,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,YAAcV,EAAE,KACtBU,EAAM,MAAM,KAAO,IACnBP,EAAE,YAAYO,CAAK,EAGnBP,EAAE,iBAAiB,aAAc,IAAM,CACrCA,EAAE,MAAM,WAAa,yCACrBA,EAAE,MAAM,MAAQ,wCAClB,CAAC,EACDA,EAAE,iBAAiB,aAAc,IAAM,CACrCA,EAAE,MAAM,WAAa,cACrBA,EAAE,MAAM,MAAQ,+BAClB,CAAC,EAGDA,EAAE,iBAAiB,QAAS,IAAM,CAChC,KAAK,QAAQ,QAAU,OAAOH,EAAE,IAAI,EACpC,KAAK,QAAQ,WAAW,OAAOA,EAAE,IAAI,CAAC,EACtC,KAAK,QAAQ,CACf,CAAC,EAED,KAAK,OAAQ,YAAYG,CAAC,CAC5B,CAAC,CACH,CAEQ,cAAe,CACrB,GAAI,CAAC,KAAK,OAAQ,OAElB,IAAIQ,EAAa,KAAK,WAEtB,GADI,CAACA,GAAc,KAAK,SAAQA,EAAa,KAAK,OAAO,sBAAsB,GAC3E,CAACA,EAAY,OAEjB,IAAMC,EAAQ,KAAK,OAAO,sBAAsB,EAC1CC,EAAK,OAAO,YAAc,SAAS,gBAAgB,YACnDC,EAAK,OAAO,aAAe,SAAS,gBAAgB,aACpDC,EAAS,EAEXC,EAAM,KAAK,MAAML,EAAW,KAAOA,EAAW,OAASC,EAAM,QAAU,CAAC,EACtEK,EAAS,KAAK,IAAIF,EAAQD,EAAKF,EAAM,OAASG,CAAM,EAC1DC,EAAM,KAAK,IAAID,EAAQ,KAAK,IAAIC,EAAKC,CAAM,CAAC,EAE5C,IAAIX,EAAO,KAAK,MAAMK,EAAW,MAAQ,CAAC,EACtCL,EAAOM,EAAM,MAAQC,IACvBP,EAAO,KAAK,MAAMK,EAAW,KAAOC,EAAM,MAAQ,CAAC,EAC/CN,EAAOS,IACTT,EAAO,KAAK,IAAIS,EAAQF,EAAKD,EAAM,MAAQG,CAAM,IAIrD,KAAK,OAAO,MAAM,IAAM,GAAGC,CAAG,KAC9B,KAAK,OAAO,MAAM,KAAO,GAAGV,CAAI,IAClC,CAGO,SAAU,CACX,KAAK,QACP,KAAK,iBAAiB,CAE1B,CAEQ,cAAe,CACrB,GAAI,CAAC,KAAK,OAAQ,OAClB,IAAMG,EAAI,SAAS,cAAc,KAAK,EACtCA,EAAE,MAAM,OAAS,MACjBA,EAAE,MAAM,WAAa,yCACrBA,EAAE,MAAM,OAAS,QACjB,KAAK,OAAO,YAAYA,CAAC,CAC3B,CAEO,MAAO,CACR,KAAK,SAAU,KAAK,OAAO,OAAO,EAAG,KAAK,OAAS,MACnD,KAAK,aAAc,KAAK,WAAW,OAAO,EAAG,KAAK,WAAa,KACrE,CACF,EAEOrB,GAAQD,KCxPf,IAAA+B,GAAA,GAAAC,GAAAD,GAAA,gBAAAE,GAAA,YAAAC,KAMA,SAASC,GAAWC,EAAkBC,EAAe,GAAY,CAC7D,OAAK,OAAe,WAAoB,OAAe,WAAWD,EAAiB,CAAE,KAAAC,CAAK,CAAC,EACpF,EACX,CAEA,SAASC,GAAuBC,EAA0B,CACtD,OAAK,OAAe,uBAAgC,OAAe,uBAAuBA,CAAQ,EAC3F,MACX,CAdA,IAgBaN,GAiMNC,GAjNPM,GAAAC,EAAA,kBAgBaR,GAAN,KAAiB,CAOpB,YAAYS,EAA4B,CALxC,KAAQ,OAA6B,KACrC,KAAQ,WAAiC,KACzC,KAAQ,OAA6B,KACrC,KAAQ,WAAkC,OAGtC,KAAK,QAAUA,CACnB,CAEO,KAAKC,EAAqBC,EAAuE,CACpG,KAAK,KAAK,EACV,KAAK,OAASD,EACd,KAAK,WAAaC,EAElB,KAAK,WAAa,SAAS,cAAc,KAAK,EAC9C,KAAK,WAAW,MAAM,SAAW,QACjC,KAAK,WAAW,MAAM,IAAM,IAC5B,KAAK,WAAW,MAAM,KAAO,IAC7B,KAAK,WAAW,MAAM,MAAQ,IAC9B,KAAK,WAAW,MAAM,OAAS,IAC/B,KAAK,WAAW,MAAM,OAAS,MAC/B,KAAK,WAAW,iBAAiB,QAAS,IAAM,KAAK,KAAK,CAAC,EAC3D,SAAS,KAAK,YAAY,KAAK,UAAU,EAGzC,GAAI,CACA,SAAS,iBAAiB,iCAAiC,EAAE,QAAS,GAAM,EAAE,OAAO,CAAC,CAC1F,MAAY,CAAE,CAEd,YAAK,OAAS,SAAS,cAAc,KAAK,EAC1C,KAAK,OAAO,UAAY,eACxB,KAAK,OAAO,QAAQ,SAAW,eAC/B,KAAK,OAAO,MAAM,SAAW,WAC7B,KAAK,OAAO,MAAM,WAAa,gCAC/B,KAAK,OAAO,MAAM,OAAS,sCAC3B,KAAK,OAAO,MAAM,aAAe,MACjC,KAAK,OAAO,MAAM,UAAY,6BAC9B,KAAK,OAAO,MAAM,SAAW,QAC7B,KAAK,OAAO,MAAM,UAAY,OAC9B,KAAK,OAAO,MAAM,UAAY,OAC9B,KAAK,OAAO,MAAM,UAAY,aAC9B,KAAK,OAAO,MAAM,QAAU,QAC5B,KAAK,OAAO,MAAM,OAAS,OAC3B,KAAK,OAAO,MAAM,SAAW,OAC7B,SAAS,KAAK,YAAY,KAAK,MAAM,EAErC,KAAK,iBAAiB,EACtB,KAAK,aAAa,EACX,CAAE,GAAI,KAAK,OAAQ,QAAS,KAAK,QAAQ,KAAK,IAAI,CAAE,CAC/D,CAEQ,kBAAmB,CACvB,GAAI,CAAC,KAAK,OAAQ,OAClB,KAAK,OAAO,UAAY,GAExB,IAAMC,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,YAAc,UACpBA,EAAM,MAAM,QAAU,WACtBA,EAAM,MAAM,WAAa,MACzBA,EAAM,MAAM,MAAQ,sCACpBA,EAAM,MAAM,SAAW,OACvB,KAAK,OAAO,YAAYA,CAAK,EAE7B,KAAK,aAAa,EAGlB,KAAK,WAAW,KAAM,aAAc,KAAM,CAAC,KAAK,QAAQ,OAAO,EAE/D,KAAK,aAAa,GAGjB,KAAK,QAAQ,QAAU,CAAC,GAAG,QAAQC,GAAK,CACrC,IAAMV,EAAWE,GAAuBQ,EAAE,UAAY,EAAE,EAClDC,EAAW,KAAK,QAAQ,UAAYD,EAAE,IAAM,KAAK,QAAQ,UAAYA,EAAE,KAC7E,KAAK,WAAWA,EAAE,GAAIA,EAAE,KAAMV,EAAUW,CAAQ,CACpD,CAAC,CACL,CAEQ,WAAWC,EAAmBC,EAAeb,EAAyBW,EAAmB,CAC7F,GAAI,CAAC,KAAK,OAAQ,OAElB,IAAMG,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,MAAM,QAAU,OACpBA,EAAI,MAAM,WAAa,SACvBA,EAAI,MAAM,QAAU,WACpBA,EAAI,MAAM,OAAS,UAGnB,IAAMC,EAAQ,SAAS,cAAc,MAAM,EAa3C,GAZAA,EAAM,MAAM,QAAU,cACtBA,EAAM,MAAM,MAAQ,OACpBA,EAAM,MAAM,YAAc,MAC1BA,EAAM,MAAM,WAAa,SACzBA,EAAM,MAAM,eAAiB,SACzBJ,IACAI,EAAM,YAAc,SACpBA,EAAM,MAAM,MAAQ,0CAExBD,EAAI,YAAYC,CAAK,EAGjBf,EAAU,CACV,IAAMgB,EAAS,SAAS,cAAc,MAAM,EAC5CA,EAAO,MAAM,QAAU,cACvBA,EAAO,MAAM,WAAa,SAC1BA,EAAO,MAAM,eAAiB,SAC9BA,EAAO,MAAM,YAAc,MAC3B,GAAI,CACAA,EAAO,UAAYjB,GAAWC,EAAU,EAAE,EAC1CgB,EAAO,iBAAiB,KAAK,EAAE,QAASC,GAAWA,EAAE,cAAgBA,EAAE,aAAa,OAAQ,cAAc,CAAC,CAC/G,MAAY,CAAE,CACdH,EAAI,YAAYE,CAAM,CAC1B,CAGA,IAAME,EAAU,SAAS,cAAc,MAAM,EAC7CA,EAAQ,YAAcL,EACtBK,EAAQ,MAAM,KAAO,IACrBJ,EAAI,YAAYI,CAAO,EAGvBJ,EAAI,iBAAiB,aAAc,IAAM,CACrCA,EAAI,MAAM,WAAa,yCACvBA,EAAI,MAAM,MAAQ,wCACtB,CAAC,EACDA,EAAI,iBAAiB,aAAc,IAAM,CACrCA,EAAI,MAAM,WAAa,cACvBA,EAAI,MAAM,MAAQ,+BACtB,CAAC,EAGDA,EAAI,iBAAiB,QAAS,IAAM,CAChC,KAAK,QAAQ,QAAUF,EACnB,KAAK,QAAQ,UACb,KAAK,QAAQ,SAASA,CAAE,EAE5B,KAAK,QAAQ,CACjB,CAAC,EAED,KAAK,OAAO,YAAYE,CAAG,CAC/B,CAEQ,cAAe,CACnB,GAAI,CAAC,KAAK,OAAQ,OAElB,IAAIK,EAAa,KAAK,WAEtB,GADI,CAACA,GAAc,KAAK,SAAQA,EAAa,KAAK,OAAO,sBAAsB,GAC3E,CAACA,EAAY,OAEjB,IAAMC,EAAQ,KAAK,OAAO,sBAAsB,EAC1CC,EAAK,OAAO,YAAc,SAAS,gBAAgB,YACnDC,EAAK,OAAO,aAAe,SAAS,gBAAgB,aACpDC,EAAS,EAEXC,EAAM,KAAK,MAAML,EAAW,KAAOA,EAAW,OAASC,EAAM,QAAU,CAAC,EACtEK,EAAS,KAAK,IAAIF,EAAQD,EAAKF,EAAM,OAASG,CAAM,EAC1DC,EAAM,KAAK,IAAID,EAAQ,KAAK,IAAIC,EAAKC,CAAM,CAAC,EAE5C,IAAIC,EAAO,KAAK,MAAMP,EAAW,MAAQ,CAAC,EACtCO,EAAON,EAAM,MAAQC,IACrBK,EAAO,KAAK,MAAMP,EAAW,KAAOC,EAAM,MAAQ,CAAC,EAC/CM,EAAOH,IACPG,EAAO,KAAK,IAAIH,EAAQF,EAAKD,EAAM,MAAQG,CAAM,IAIzD,KAAK,OAAO,MAAM,IAAM,GAAGC,CAAG,KAC9B,KAAK,OAAO,MAAM,KAAO,GAAGE,CAAI,IACpC,CAEO,SAAU,CACT,KAAK,QACL,KAAK,iBAAiB,CAE9B,CAEQ,cAAe,CACnB,GAAI,CAAC,KAAK,OAAQ,OAClB,IAAMT,EAAI,SAAS,cAAc,KAAK,EACtCA,EAAE,MAAM,OAAS,MACjBA,EAAE,MAAM,WAAa,yCACrBA,EAAE,MAAM,OAAS,QACjB,KAAK,OAAO,YAAYA,CAAC,CAC7B,CAEO,MAAO,CACN,KAAK,SAAU,KAAK,OAAO,OAAO,EAAG,KAAK,OAAS,MACnD,KAAK,aAAc,KAAK,WAAW,OAAO,EAAG,KAAK,WAAa,KACvE,CACJ,EAEOnB,GAAQD,KCjNf,IAAA8B,GAAA,GAAAC,GAAAD,GAAA,kBAAAE,GAAA,YAAAC,KAAA,IAOaD,GA6INC,GApJPC,GAAAC,EAAA,kBAOaH,GAAN,KAAmB,CAMxB,YAAYI,EAA8B,CAJ1C,KAAQ,OAA6B,KACrC,KAAQ,WAAiC,KACzC,KAAQ,OAA6B,KAGnC,KAAK,QAAUA,CACjB,CAEO,KAAKC,EAAqBC,EAAuE,CACtG,YAAK,KAAK,EACV,KAAK,OAASD,EAEd,KAAK,WAAa,SAAS,cAAc,KAAK,EAC9C,KAAK,WAAW,MAAM,SAAW,QACjC,KAAK,WAAW,MAAM,IAAM,IAC5B,KAAK,WAAW,MAAM,KAAO,IAC7B,KAAK,WAAW,MAAM,MAAQ,IAC9B,KAAK,WAAW,MAAM,OAAS,IAC/B,KAAK,WAAW,MAAM,OAAS,MAC/B,KAAK,WAAW,iBAAiB,QAAS,IAAM,KAAK,KAAK,CAAC,EAC3D,SAAS,KAAK,YAAY,KAAK,UAAU,EAEzC,KAAK,OAAS,SAAS,cAAc,KAAK,EAC1C,KAAK,OAAO,UAAY,iBACxB,KAAK,OAAO,QAAQ,SAAW,iBAC/B,KAAK,OAAO,MAAM,SAAW,WAC7B,KAAK,OAAO,MAAM,WAAa,gCAC/B,KAAK,OAAO,MAAM,OAAS,sCAC3B,KAAK,OAAO,MAAM,aAAe,MACjC,KAAK,OAAO,MAAM,UAAY,6BAC9B,KAAK,OAAO,MAAM,SAAW,QAC7B,KAAK,OAAO,MAAM,UAAY,OAC9B,KAAK,OAAO,MAAM,UAAY,OAC9B,KAAK,OAAO,MAAM,QAAU,QAC5B,KAAK,OAAO,MAAM,OAAS,OAC3B,KAAK,OAAO,MAAM,SAAW,OAC7B,SAAS,KAAK,YAAY,KAAK,MAAM,EAErC,KAAK,UAAU,EACf,KAAK,aAAaC,CAAU,EACrB,CAAE,GAAI,KAAK,OAAQ,QAAS,KAAK,QAAQ,KAAK,IAAI,CAAE,CAC7D,CAEQ,WAAY,CAClB,GAAI,CAAC,KAAK,OAAQ,OAClB,KAAK,OAAO,UAAY,GAExB,IAAMC,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,YAAc,KAAK,QAAQ,OAAS,YAC1CA,EAAM,MAAM,QAAU,WACtBA,EAAM,MAAM,WAAa,MACzBA,EAAM,MAAM,MAAQ,sCACpBA,EAAM,MAAM,SAAW,OACvB,KAAK,OAAO,YAAYA,CAAK,EAE7B,IAAMC,EAAS,CAACC,EAAYC,EAAeC,EAAeC,IAAuB,CAC/E,IAAMC,EAAI,SAAS,cAAc,KAAK,EACtCA,EAAE,MAAM,QAAU,OAClBA,EAAE,MAAM,WAAa,SACrBA,EAAE,MAAM,QAAU,WAClBA,EAAE,MAAM,OAAS,UAEjB,IAAMC,EAAQ,SAAS,cAAc,MAAM,EAS3C,GARAA,EAAM,MAAM,QAAU,cACtBA,EAAM,MAAM,MAAQ,OACpBA,EAAM,MAAM,YAAc,MAC1BA,EAAM,MAAM,WAAa,SACzBA,EAAM,MAAM,eAAiB,SACzBF,IAAYE,EAAM,YAAc,SAAKA,EAAM,MAAM,MAAQ,0CAC7DD,EAAE,YAAYC,CAAK,EAEfH,EAAM,CACR,IAAMI,EAAO,SAAS,cAAc,MAAM,EAC1CA,EAAK,MAAM,QAAU,cAAeA,EAAK,MAAM,YAAc,MAC7D,GAAI,CAAEA,EAAK,UAAa,OAAe,aAAaJ,CAAI,GAAK,GAAII,EAAK,kBAAoBA,EAAK,iBAAiB,KAAK,EAAE,QAASC,GAAWA,EAAE,cAAgBA,EAAE,aAAa,OAAO,cAAc,CAAC,CAAG,MAAY,CAAC,CAClNH,EAAE,YAAYE,CAAI,CACpB,CAEA,IAAME,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,YAAcP,EAClBO,EAAI,MAAM,KAAO,IACjBJ,EAAE,YAAYI,CAAG,EAEjBJ,EAAE,iBAAiB,aAAc,IAAM,CAAEA,EAAE,MAAM,WAAa,yCAA0CA,EAAE,MAAM,MAAQ,wCAA0C,CAAC,EACnKA,EAAE,iBAAiB,aAAc,IAAM,CAAEA,EAAE,MAAM,WAAa,cAAeA,EAAE,MAAM,MAAQ,+BAAiC,CAAC,EAE/HA,EAAE,iBAAiB,QAAUK,GAAO,CAClCA,EAAG,gBAAgB,EACnB,IAAMC,EAAM,IAAI,IAAI,KAAK,QAAQ,SAAW,CAAC,CAAC,EAC1CA,EAAI,IAAIV,CAAE,EAAGU,EAAI,OAAOV,CAAE,EAAQU,EAAI,IAAIV,CAAE,EAChD,KAAK,QAAQ,QAAU,MAAM,KAAKU,CAAG,EACrC,GAAI,CAAM,OAAO,KAAK,QAAQ,UAAa,YAAY,KAAK,QAAQ,SAAS,KAAK,QAAQ,OAAO,CAAG,MAAY,CAAC,CAEjH,KAAK,QAAQ,CACf,CAAC,EAED,KAAK,OAAQ,YAAYN,CAAC,CAC5B,EAGMO,EAAa,IAAI,IAAI,KAAK,QAAQ,SAAW,CAAC,CAAC,EACrDZ,EAAO,YAAa,QAAS,QAASY,EAAW,IAAI,WAAW,CAAC,GAGhE,KAAK,QAAQ,QAAU,CAAC,GAAG,QAAQC,GAAK,CACvC,IAAMC,EAAK,OAAOD,EAAE,UAAY,EAAE,EAAE,YAAY,GAC5CC,IAAO,UAAYA,IAAO,WAAaA,EAAG,SAAS,KAAK,IAC1Dd,EAAO,OAAOa,EAAE,EAAE,EAAGA,EAAE,KAAM,SAAUD,EAAW,IAAI,OAAOC,EAAE,EAAE,CAAC,CAAC,CAEvE,CAAC,CACH,CAEQ,aAAaf,EAAsB,CACzC,GAAI,CAAC,KAAK,QAAU,CAAC,KAAK,OAAQ,OAClC,IAAIiB,EAAOjB,EACNiB,IAAMA,EAAO,KAAK,OAAO,sBAAsB,GAEpD,IAAMC,EAAW,KAAK,OAAO,sBAAsB,EAC7CC,EAAK,OAAO,YAAc,SAAS,gBAAgB,YACnDC,EAAK,OAAO,aAAe,SAAS,gBAAgB,aACtDX,EAAOQ,EAAK,MAAQ,EACpBR,EAAOS,EAAS,MAAQC,IAC1BV,EAAOQ,EAAK,KAAOC,EAAS,MAAQ,EAChCT,EAAO,IAAGA,EAAO,KAAK,IAAI,EAAG,KAAK,IAAIU,EAAKD,EAAS,MAAQ,EAAGD,EAAK,MAAQC,EAAS,KAAK,CAAC,IAEjG,KAAK,OAAO,MAAM,IAAM,GAAG,KAAK,MAAMD,EAAK,OAAS,CAAC,CAAC,KACtD,KAAK,OAAO,MAAM,KAAO,GAAG,KAAK,MAAMR,CAAI,CAAC,IAC9C,CAEO,SAAU,CACX,KAAK,QAAQ,KAAK,UAAU,CAClC,CAEO,MAAO,CACR,KAAK,SAAU,KAAK,OAAO,OAAO,EAAG,KAAK,OAAS,MACnD,KAAK,aAAc,KAAK,WAAW,OAAO,EAAG,KAAK,WAAa,KACrE,CACF,EAEOd,GAAQD,KCpJf,IAAA2B,GAAA,GAAAC,GAAAD,GAAA,iBAAAE,KAAA,IAMaA,GANbC,GAAAC,EAAA,kBAMaF,GAAN,KAAkB,CAKvB,YAAYG,EAA6B,CAHzC,KAAQ,YAAkC,KAC1C,KAAQ,gBAAsC,KAG5C,KAAK,QAAUA,CACjB,CAEO,MAAO,CACZ,KAAK,KAAK,EAEV,KAAK,gBAAkB,SAAS,cAAc,KAAK,EACnD,KAAK,gBAAgB,MAAM,SAAW,QACtC,KAAK,gBAAgB,MAAM,IAAM,IACjC,KAAK,gBAAgB,MAAM,KAAO,IAClC,KAAK,gBAAgB,MAAM,MAAQ,IACnC,KAAK,gBAAgB,MAAM,OAAS,IACpC,KAAK,gBAAgB,MAAM,OAAS,MACpC,KAAK,gBAAgB,iBAAiB,QAAS,IAAM,KAAK,KAAK,CAAC,EAChE,SAAS,KAAK,YAAY,KAAK,eAAe,EAE9C,KAAK,YAAc,SAAS,cAAc,KAAK,EAC/C,KAAK,YAAY,UAAY,gBAC7B,KAAK,YAAY,MAAM,SAAW,WAClC,KAAK,YAAY,MAAM,WAAa,gCACpC,KAAK,YAAY,MAAM,OAAS,sCAChC,KAAK,YAAY,MAAM,aAAe,MACtC,KAAK,YAAY,MAAM,UAAY,6BACnC,KAAK,YAAY,MAAM,SAAW,QAClC,KAAK,YAAY,MAAM,QAAU,QACjC,KAAK,YAAY,MAAM,OAAS,OAChC,KAAK,YAAY,MAAM,SAAW,OAElC,SAAS,KAAK,YAAY,KAAK,WAAW,EAC1C,KAAK,UAAU,EAEf,IAAMC,EAAO,KAAK,QAAQ,cAAc,sBAAsB,EACxDC,EAAW,KAAK,YAAY,sBAAsB,EAClDC,EAAS,EACTC,EAAK,OAAO,YAAc,SAAS,gBAAgB,YACnDC,EAAK,OAAO,aAAe,SAAS,gBAAgB,aAEtDC,EAAML,EAAK,OAASE,EACpBF,EAAK,OAASC,EAAS,OAASC,EAASE,IACvCJ,EAAK,IAAMC,EAAS,OAASC,GAAU,EACzCG,EAAML,EAAK,IAAMC,EAAS,OAASC,EAEnCG,EAAM,KAAK,IACTH,EACA,KAAK,IAAIE,EAAKH,EAAS,OAASC,EAAQF,EAAK,OAASE,CAAM,CAC9D,GAIJ,IAAII,EAAON,EAAK,KACZA,EAAK,KAAOC,EAAS,MAAQC,EAASC,IACxCG,EAAO,KAAK,IAAIJ,EAAQF,EAAK,MAAQC,EAAS,KAAK,GAErDK,EAAO,KAAK,IAAIJ,EAAQ,KAAK,IAAII,EAAMH,EAAKF,EAAS,MAAQC,CAAM,CAAC,EAEpE,KAAK,YAAY,MAAM,IAAM,GAAG,KAAK,MAAMG,CAAG,CAAC,KAC/C,KAAK,YAAY,MAAM,KAAO,GAAG,KAAK,MAAMC,CAAI,CAAC,IACnD,CAEO,MAAO,CACR,KAAK,cACP,KAAK,YAAY,OAAO,EACxB,KAAK,YAAc,MAEjB,KAAK,kBACP,KAAK,gBAAgB,OAAO,EAC5B,KAAK,gBAAkB,KAE3B,CAEQ,WAAY,CAClB,GAAI,CAAC,KAAK,YAAa,OAEvB,IAAMC,EAAS,CACbC,EACAC,EACAC,EACAC,IACG,CACH,IAAMC,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,UAAY,qBAChBA,EAAI,MAAM,QAAU,OACpBA,EAAI,MAAM,WAAa,SACvBA,EAAI,MAAM,QAAU,WACpBA,EAAI,MAAM,OAAS,UACnBA,EAAI,MAAM,MAAQ,gCAElB,IAAMC,EAAW,SAAS,cAAc,MAAM,EAC9CA,EAAS,MAAM,QAAU,cACzBA,EAAS,MAAM,WAAa,SAC5BA,EAAS,MAAM,eAAiB,SAChCA,EAAS,MAAM,YAAc,MAC7BA,EAAS,UAAa,OAAe,aAAaL,CAAe,GAAK,GACtEI,EAAI,YAAYC,CAAQ,EAExB,IAAMC,EAAgB,SAAS,cAAc,KAAK,EAClDA,EAAc,MAAM,QAAU,OAC9BA,EAAc,MAAM,cAAgB,SACpCA,EAAc,MAAM,KAAO,IAE3B,IAAMC,EAAU,SAAS,cAAc,KAAK,EAK5C,GAJAA,EAAQ,YAAcN,EACtBM,EAAQ,MAAM,WAAa,MAC3BD,EAAc,YAAYC,CAAO,EAE7BL,EAAa,CACf,IAAMM,EAAS,SAAS,cAAc,KAAK,EAC3CA,EAAO,YAAcN,EACrBM,EAAO,MAAM,SAAW,OACxBA,EAAO,MAAM,MAAQ,sCACrBF,EAAc,YAAYE,CAAM,CAClC,CAEAJ,EAAI,YAAYE,CAAa,EAE7BF,EAAI,iBAAiB,aAAc,IAAM,CACvCA,EAAI,MAAM,WAAa,yCACvBA,EAAI,MAAM,MAAQ,wCACpB,CAAC,EACDA,EAAI,iBAAiB,aAAc,IAAM,CACvCA,EAAI,MAAM,WAAa,cACvBA,EAAI,MAAM,MAAQ,+BACpB,CAAC,EAEDA,EAAI,iBAAiB,QAAS,IAAM,CAClCD,EAAQ,EACR,KAAK,KAAK,CACZ,CAAC,EAED,KAAK,YAAa,YAAYC,CAAG,CACnC,EAEAL,EACE,eACA,mBACA,0CACA,KAAK,QAAQ,aACf,EAEAA,EACE,OACA,2BACA,wDACA,KAAK,QAAQ,aACf,CACF,CACF,IC9JO,SAASU,EAAWC,EAAgB,CACzC,OAAOA,EACH,OAAOA,CAAC,EACL,QAAQ,KAAM,OAAO,EACrB,QAAQ,KAAM,MAAM,EACpB,QAAQ,KAAM,MAAM,EACvB,EACN,CAEO,SAASC,EAAeC,EAA2B,CACxD,GAAI,CAACA,EAAO,OAAO,KACnB,IAAIC,EAAI,OAAOD,CAAK,EAAE,KAAK,EAC3B,GACE,mBAAmB,KAAKC,CAAC,GACzB,mBAAmB,KAAKA,CAAC,GACzB,mBAAmB,KAAKA,CAAC,EACzB,CACA,IAAIC,EAAID,EAAE,CAAC,IAAM,IAAMA,EAAE,MAAM,CAAC,EAAIA,EACpC,MAAO,KAAOC,EAAE,SAAW,EAAIA,EAAE,UAAU,EAAG,CAAC,EAAIA,EACrD,CACA,IAAIJ,EAAI,CACN,KAAM,UACN,IAAK,UACL,OAAQ,UACR,OAAQ,UACR,MAAO,UACP,KAAM,UACN,OAAQ,UACR,KAAM,UACN,MAAO,UACP,MAAO,SACT,EACIK,EAAIF,EAAE,YAAY,EACtB,OAAQH,EAAUK,CAAC,GAAK,IAC1B,CAEO,SAASC,EAASJ,EAAYK,EAA2B,CAC9D,GAAI,CAACL,EAAO,OAAO,KACnB,IAAIF,EAAIE,EAAM,QAAQ,IAAK,EAAE,EACzBG,EAAKD,GAAW,SAASA,EAAG,EAAE,EAClC,GAAIJ,EAAE,SAAW,EAAG,CAClB,IAAII,EAAIC,EAAEL,EAAE,CAAC,EAAIA,EAAE,CAAC,CAAC,EACnBQ,EAAIH,EAAEL,EAAE,CAAC,EAAIA,EAAE,CAAC,CAAC,EACjBS,EAAIJ,EAAEL,EAAE,CAAC,EAAIA,EAAE,CAAC,CAAC,EACnB,MAAO,QAAUI,EAAI,IAAMI,EAAI,IAAMC,EAAI,IAAMF,EAAQ,GACzD,CACA,GAAIP,EAAE,SAAW,GAAKA,EAAE,SAAW,EAAG,CACpC,IAAII,EAAIJ,EAAE,SAAW,EAAIA,EAAE,UAAU,EAAG,CAAC,EAAIA,EAC3CQ,EAAIH,EAAEL,EAAE,UAAU,EAAG,CAAC,CAAC,EACvBS,EAAIJ,EAAED,EAAE,UAAU,EAAG,CAAC,CAAC,EACvBM,EAAIL,EAAED,EAAE,UAAU,EAAG,CAAC,CAAC,EACzB,MAAO,QAAUI,EAAI,IAAMC,EAAI,IAAMC,EAAI,IAAMH,EAAQ,GACzD,CACA,OAAO,IACT,CAEO,SAASI,GAAiBT,EAAoB,CACnD,GAAI,CAACA,EAAO,MAAO,UACnB,IAAIC,EAAID,EAAM,QAAQ,IAAK,EAAE,EACzBF,EAAKU,GAAW,SAASA,EAAG,EAAE,EAC9BL,EAAGD,EAAGI,EACV,GAAIL,EAAE,SAAW,EACbE,EAAIL,EAAEG,EAAE,CAAC,EAAIA,EAAE,CAAC,CAAC,EAAKC,EAAIJ,EAAEG,EAAE,CAAC,EAAIA,EAAE,CAAC,CAAC,EAAKK,EAAIR,EAAEG,EAAE,CAAC,EAAIA,EAAE,CAAC,CAAC,UACxDA,EAAE,SAAW,GAAKA,EAAE,SAAW,EAAG,CACzC,IAAIO,EAAIP,EAAE,SAAW,EAAIA,EAAE,UAAU,EAAG,CAAC,EAAIA,EAC3CE,EAAIL,EAAEU,EAAE,UAAU,EAAG,CAAC,CAAC,EACtBN,EAAIJ,EAAEU,EAAE,UAAU,EAAG,CAAC,CAAC,EACvBF,EAAIR,EAAEU,EAAE,UAAU,EAAG,CAAC,CAAC,CAC5B,KAAO,OAAO,UACd,MAAO,QAAUL,EAAI,KAAO,OAAUD,EAAI,KAAO,OAAUI,EAAI,KAAO,GAClE,UACA,SACN,CCtEO,SAASI,EAASC,EAAiBC,EAAiBC,EAAY,CACrE,GAAI,CAEC,OAAe,mBAChB,OAAQ,OAAe,kBAAkB,aAAgB,YAExD,OAAe,kBAAkB,YAAY,CAC5C,QAAS,WACT,MAAO,QACP,QAASF,EACT,QAASC,EACT,KAAMC,CACR,CAAC,CAEL,MAAY,CAAC,CACb,GAAI,CACE,SAAW,QAAQ,KACrB,QAAQ,IAAID,EAASC,CAAI,CAE7B,MAAY,CAAC,CACf,CCtBO,SAASC,GAAgBC,EAAwBC,EAAmB,CACzED,EAAU,UACR,sBACAC,EACA,sDACJ,CAEO,SAASC,GACdF,EACAC,EACAE,EACA,CACAH,EAAU,UACR,sBACAC,EACA,4DACAE,EACA,QACJ,CAEO,SAASC,GAAqBC,EAAwC,CAC3E,IAAMC,EAAM,SAAS,cAAc,QAAQ,EAC3C,OAAAA,EAAI,KAAO,SACXA,EAAI,YAAc,YAClBA,EAAI,MAAM,WAAa,MACvBA,EAAI,MAAM,OAAS,8CACnBA,EAAI,iBAAiB,QAAS,IAAM,CAClCD,EAAQ,EACRC,EAAI,SAAW,GACfA,EAAI,YAAc,YACpB,CAAC,EACMA,CACT,CClBO,SAASC,GACdC,EACAC,EACAC,EAQK,CACL,GACE,OAAO,iBACP,OAAO,OAAO,gBAAgB,QAAW,WAEzC,GAAI,CACF,OAAO,OAAO,gBAAgB,OAAO,CACnC,OAAQF,EACR,OAAQE,EAAQ,QAAUD,EAC1B,UACE,OAAOC,EAAQ,WAAc,SAAWA,EAAQ,UAAY,OAC9D,QAASD,EACT,KAAMC,EAAQ,MAAQ,GACtB,WAAYA,EAAQ,WACpB,OAAQA,EAAQ,OAChB,UAAWA,EAAQ,SACrB,CAAC,CACH,MAAY,CACV,OAAO,IACT,CAEF,OAAO,IACT,CAKO,SAASC,GACdC,EACAC,EACAC,EACAC,EAAuB,QACvB,CACA,GAAI,CACF,IAAMC,EAAW,MAAM,KAAKJ,EAAK,iBAAiBC,CAAQ,CAAC,EAC3D,QAASI,EAAI,EAAGA,EAAID,EAAS,OAAQC,IACnC,GAAI,CACF,IAAMC,EAAKF,EAASC,CAAC,EACfE,EAAKD,EAAG,aAAa,iBAAiB,EAC5CA,EAAG,MAAM,QAAUJ,EAAW,IAAI,OAAOK,CAAE,CAAC,EAAIJ,EAAe,MACjE,MAAY,CAAC,CAEjB,MAAY,CAAC,CACf,CC2CA,SAASK,EAASC,EAAM,MAAO,CAAE,OAAO,SAAS,cAAcA,CAAG,CAAG,CAErE,SAASC,GAAeC,EAA0B,CAChD,IAAMC,EAAWJ,EAAS,KAAK,EAC/B,OAAAI,EAAS,UAAY,kBACrBA,EAAS,MAAM,MAAQ,OACvBA,EAAS,MAAM,OAAS,OACxBA,EAAS,MAAM,aAAe,MAC9BA,EAAS,MAAM,gBAAkBC,EAAeF,GAAQ,KAAK,GAAK,OAClEC,EAAS,MAAM,YAAc,MACtBA,CACT,CAEA,SAASE,GAAeH,EAAaI,EAAkC,CACrE,IAAMC,EAAWR,EAAS,MAAM,EAChCQ,EAAS,UAAY,aACrBA,EAAS,MAAM,WAAa,MAC5BA,EAAS,MAAM,YAAc,MAC7B,IAAMC,EAAON,IAAWA,EAAO,MAAQA,EAAO,OAASA,EAAO,OAAS,OAAOA,EAAO,MAAQA,EAAO,OAASA,EAAO,KAAK,EAAI,aAC7H,OAAAK,EAAS,YAAcC,EAChBD,CACT,CAEA,SAASE,GAAgBC,EAAeR,EAA0B,CAChE,IAAMS,EAAYZ,EAAS,MAAM,EAC3Ba,EAAQR,EAAeF,GAAQ,KAAK,GAAK,UAC/C,OAAAS,EAAU,UAAY,gBACtBA,EAAU,MAAM,WAAaE,EAASD,EAAO,GAAI,GAAK,cACtDD,EAAU,MAAM,MAAQC,EACxBD,EAAU,MAAM,OAAS,6BACzBA,EAAU,MAAM,aAAe,OAC/BA,EAAU,MAAM,QAAU,UAC1BA,EAAU,MAAM,SAAW,OAC3BA,EAAU,MAAM,WAAa,MAC7BA,EAAU,YAAc,OAAOD,GAAS,CAAC,EAClCC,CACT,CAqCA,SAASG,GAAsBC,EAAYC,EAAqC,CAC9E,GAAI,CAACD,EAAO,OAAO,KACnB,IAAME,EAAUF,EAAM,IAAMA,EAAM,KAC9BG,EAAM,EACV,QAAWC,KAAMH,GAAY,CAAC,EAAG,CAC/B,IAAMI,EAAKD,IAAOA,EAAG,MAAQA,GAC7B,GAAI,CAACC,GAAM,CAAC,MAAM,QAAQA,EAAG,WAAW,EAAG,SAC3C,IAAMC,EAAKD,EAAG,YAAY,KAAME,GAAYA,EAAE,SAAW,OAAOA,EAAE,OAAO,IAAM,OAAOL,CAAO,GAAOK,EAAE,WAAa,OAAOA,EAAE,SAAS,IAAM,OAAOP,EAAM,IAAI,GAAMO,EAAE,OAAS,QAAQ,EACrL,GAAID,EAAI,CACN,IAAME,EAAM,OAAOF,EAAG,QAAU,KAAOA,EAAG,OAASA,EAAG,OAAS,KAAOA,EAAG,MAAQ,GAAG,EAC/E,MAAME,CAAG,IAAGL,GAAOK,EAC1B,CACF,CACA,GAAIL,IAAQ,EAAG,CACb,IAAMM,EAAKC,EAAS,KAAK,EACzB,OAAAD,EAAG,MAAM,QAAU,eACnBA,EAAG,MAAM,QAAU,UACnBA,EAAG,MAAM,aAAe,QACxBA,EAAG,MAAM,OAAS,uCAClBA,EAAG,MAAM,WAAa,iCACtBA,EAAG,MAAM,MAAQ,2BACjBA,EAAG,MAAM,SAAW,OACpBA,EAAG,MAAM,WAAa,OACtBA,EAAG,MAAM,WAAa,MACtBA,EAAG,YAAc,OAAOT,EAAM,MAAQE,CAAO,EAAI,KAAO,OAAOC,CAAG,EAC3DM,CACT,CACA,OAAO,IACT,CAsBA,SAASE,GAAsBC,EAASC,EAAyB,CAC/D,GAAI,CAACD,EAAI,OAAO,KAChB,IAAME,EAAoB,CAAC,EACvB,MAAM,QAAQF,EAAG,WAAW,GAAGE,EAAW,KAAKF,EAAG,WAAW,EAC7DA,EAAG,SAAW,MAAM,QAAQA,EAAG,QAAQ,WAAW,GAAGE,EAAW,KAAKF,EAAG,QAAQ,WAAW,EAC3FA,EAAG,KAAOA,EAAG,IAAI,aAAe,MAAM,QAAQA,EAAG,IAAI,YAAY,WAAW,GAAGE,EAAW,KAAKF,EAAG,IAAI,YAAY,WAAW,EACjI,QAAWG,KAAOD,EAAY,CAC5B,IAAME,EAAMD,EAAI,KAAME,GAAW,OAAOA,EAAE,OAAO,IAAM,OAAOJ,GAAe,EAAE,GAAK,OAAOI,EAAE,SAAS,IAAM,OAAOJ,GAAe,IAAI,GAAK,OAAOI,EAAE,IAAI,IAAM,cAAc,EAC5K,GAAID,EAAK,OAAOA,EAAI,QAAUA,EAAI,aAAeA,EAAI,OAASA,EAAI,MAAQA,EAAI,OAAS,IACzF,CACA,OAAOJ,EAAG,QAAUA,EAAG,aAAeA,EAAG,OAASA,EAAG,MAAQA,EAAG,OAAS,IAC3E,CAEA,SAASM,GAAqBC,EAAYN,EAAoBO,EAAqC,CACjG,GAAI,CAACP,GAAiB,OAAQA,EAAc,UAAYA,EAAc,MAAS,EAAE,EAAE,YAAY,IAAM,eAAgB,OAAO,KAC5H,GAAI,CACF,IAAIQ,EAAkB,KAEtB,GADIF,GAASA,EAAM,SAAQE,EAAaF,EAAM,OAAO,QAAUA,EAAM,OAAO,aAAeA,EAAM,OAAO,OAASE,GAC7G,CAACA,GAAcF,EAAM,OAASA,EAAM,MAAM,OAAS,EAAG,CACxD,IAAMG,EAAWH,EAAM,MAAM,CAAC,EACxBI,EAAQD,GAAYA,EAAS,KAAOA,EAAS,KAAOA,EAC1DD,EAAaV,GAAsBY,EAAOV,CAAa,GAAKQ,CAC9D,CACA,GAAI,CAACA,EAAY,OAAO,KACxB,IAAMG,EAAwB,CAAC,EACzBC,EAAUR,GAAW,CAAyBA,GAAM,MAAQA,IAAM,IAAIO,EAAY,KAAK,OAAOP,CAAC,CAAC,CAAG,EACzGQ,EAAOJ,GAAcA,EAAW,MAAM,EAAGI,EAAOJ,GAAcA,EAAW,EAAE,EAAGI,EAAOJ,GAAcA,EAAW,GAAG,EAAGI,EAAOJ,GAAcA,EAAW,KAAK,EACrJF,GAASA,EAAM,SAAUM,EAAON,EAAM,OAAO,EAAE,EAAGM,EAAON,EAAM,OAAO,IAAI,EAAGM,EAAON,EAAM,OAAO,KAAK,GAC1G,IAAMO,GAASN,GAAY,CAAC,GAAG,KAAMO,GAAW,CAC9C,IAAMC,EAAKD,IAAMA,EAAE,SAAYA,EAAE,KAAOA,EAAE,IAAI,cAAkBA,GAAK,KAAM,GAAI,CAACC,EAAG,MAAO,GAC1F,IAAMC,EAAc,CAAC,EAASC,EAAWC,GAAW,CAAyBA,GAAM,MAAQA,IAAM,IAAIF,EAAE,KAAK,OAAOE,CAAC,CAAC,CAAG,EACxHD,EAAQF,EAAE,MAAM,EAAGE,EAAQF,EAAE,EAAE,EAAGE,EAAQF,EAAE,GAAG,EAAGE,EAAQF,EAAE,KAAK,EAAGE,EAAQF,EAAE,IAAI,EAC9EA,EAAE,MAAOE,EAAQF,EAAE,IAAI,MAAM,EAAGE,EAAQF,EAAE,IAAI,EAAE,EAAGE,EAAQF,EAAE,IAAI,GAAG,GACpEA,EAAE,aAAe,OAAOA,EAAE,aAAgB,WAAYE,EAAQF,EAAE,YAAY,MAAM,EAAGE,EAAQF,EAAE,YAAY,EAAE,EAAGE,EAAQF,EAAE,YAAY,GAAG,EAAGE,EAAQF,EAAE,YAAY,KAAK,EAAGE,EAAQF,EAAE,YAAY,IAAI,GACxM,QAAWI,KAAKR,EAAe,QAAWS,KAAKJ,EAAK,GAAIG,GAAKC,GAAK,OAAOD,CAAC,IAAM,OAAOC,CAAC,EAAG,MAAO,GAClG,MAAO,EACT,CAAC,EAGGC,EAAO,EAAGC,EAAQ,EAASC,EAAYjB,EAAM,OAAS,CAAC,EACrDkB,EAAsBzB,GAAY,CACtC,GAAI,CACF,IAAM0B,EAAU1B,IAAOA,EAAG,SAAYA,EAAG,KAAOA,EAAG,IAAI,aACvD,GAAI0B,EAAS,CACX,IAAMC,GAASD,EAAQ,QAAUA,EAAQ,OAAS,SAAW,SAAc,IAAI,SAAS,EAAE,YAAY,EAAG,GAAIC,IAAU,UAAYA,IAAU,SAAU,MAAO,EAChK,CACA,GAAI,MAAM,QAAQ3B,EAAG,WAAW,EAAG,CACsK,GAA5LA,EAAG,YAAY,KAAMK,GAAWA,GAAKA,EAAE,OAAS,iBAAmBA,EAAE,QAAUA,EAAE,OAAO,MAAQ,CAAC,OAAQ,SAAU,YAAa,UAAU,EAAE,SAAS,OAAOA,EAAE,OAAO,IAAI,EAAE,YAAY,CAAC,CAAC,EAAW,MAAO,GACtN,IAAMuB,EAAY5B,EAAG,YAAY,KAAMK,GAAWA,IAAM,OAAOA,EAAE,WAAa,EAAE,EAAE,YAAY,EAAE,SAAS,UAAU,GAAK,OAAOA,EAAE,WAAa,EAAE,EAAE,YAAY,EAAE,SAAS,SAAS,EAAE,EACpL,GAAIuB,GAAaA,EAAU,QAAU,MAAoB,OAAOA,EAAU,QAAU,CAAC,GAAc,IAAK,MAAO,EACjH,CACF,MAAY,CAAE,CACd,MAAO,EACT,EACA,QAAWC,KAAML,EAAW,CAAE,IAAMxB,EAAK6B,EAAG,MAAQA,EAAS7B,IAAcuB,IAAaE,EAAmBzB,CAAE,GAAGsB,IAAQ,CACxH,GAAIC,EAAQ,EAAG,CAAE,IAAMO,EAAM,KAAK,MAAOR,EAAOC,EAAS,GAAG,EAASQ,EAAcC,EAAS,KAAK,EAAGD,EAAY,UAAY,iBAAkBA,EAAY,MAAM,QAAU,cAAeA,EAAY,MAAM,WAAa,SAAUA,EAAY,MAAM,IAAM,MAAOA,EAAY,MAAM,WAAa,MAAO,IAAME,EAAMD,EAAS,KAAK,EAAGC,EAAI,MAAM,QAAU,eAAgBA,EAAI,MAAM,MAAQ,QAASA,EAAI,MAAM,OAAS,OAAQA,EAAI,MAAM,WAAa,cAAeA,EAAI,MAAM,OAAS,sCAAuCA,EAAI,MAAM,aAAe,MAAOA,EAAI,MAAM,SAAW,SAAU,IAAMC,EAAOF,EAAS,KAAK,EAAG,OAAAE,EAAK,MAAM,OAAS,OAAQA,EAAK,MAAM,MAAQ,OAAOJ,CAAG,EAAI,IAAKI,EAAK,MAAM,WAAa,4BAA6BD,EAAI,YAAYC,CAAI,EAAGH,EAAY,YAAYE,CAAG,EAAUF,CAAa,CAC7xB,MAAY,CAAE,CACd,OAAO,IACT,CAEA,SAASI,GAAuB5B,EAAYN,EAAwC,CAClF,GAAI,CAACA,EAAe,OAAO,KAC3B,GAAI,CACwF,GAA5E,OAAQA,EAAc,UAAYA,EAAc,MAAS,EAAE,EAAE,YAAY,IAAiB,YAAa,OAAO,KAC5H,IAAMmC,EAAM7B,EAAM,QAAU,CAAC,EAAO8B,EAA0B,KAAYC,EAAQF,EAAI,WAAcA,EAAI,OAASA,EAAI,WAAc,KAAYG,EAAWH,EAAI,UAAYA,EAAI,QAAU,KACxL,GAAIE,GAASC,EAAY,GAAI,CAAE,IAAMC,EAAI,IAAI,KAAKF,CAAK,EAASG,EAAO,OAAOF,CAAQ,GAAK,EAASG,EAAI,IAAI,KAAKF,EAAE,QAAQ,EAAIC,EAAO,GAAK,GAAK,GAAK,GAAI,EAASE,EAAOH,EAAE,mBAAmB,QAAS,CAAE,MAAO,QAAS,IAAK,SAAU,CAAC,EAASI,EAAOF,EAAE,mBAAmB,QAAS,CAAE,MAAO,QAAS,IAAK,SAAU,CAAC,EAAGL,EAAW,GAAGM,CAAI,WAAMC,CAAI,EAAI,MAAY,CAAEP,EAAW,IAAM,CAE3X,GADKA,IAAUA,EAAWD,EAAI,OAASA,EAAI,KAAO,OAAOA,EAAI,OAASA,EAAI,IAAI,EAAI,MAC9EC,EAAU,CAAE,IAAMQ,EAASb,EAAS,KAAK,EAAG,OAAAa,EAAO,MAAM,MAAQ,sCAAuCA,EAAO,MAAM,SAAW,OAAQA,EAAO,MAAM,WAAa,MAAOA,EAAO,YAAc,OAAOR,CAAQ,EAAE,MAAM,EAAG,GAAG,EAAUQ,CAAQ,CACnP,MAAY,CAAE,CACd,OAAO,IACT,CAEA,SAASC,GAAWC,EAAkBC,EAAe,GAAY,CAC/D,OAAK,OAAe,WAAoB,OAAe,WAAWD,EAAiB,CAAE,KAAAC,CAAK,CAAC,EACpF,EACT,CAEO,SAASC,GAAwBC,EAAe1C,EAAiBD,EAAYN,EAAoBkD,EAAoG,CAE1M,IAAMC,EAAoBnD,IAAkBA,EAAc,UAAYA,EAAc,MAChFA,GACC,MAAM,QAAQiD,CAAM,EAAIA,EAAO,KAAMG,GAAW,OAAOA,EAAE,EAAE,IAAM,OAAOpD,GAAe,EAAE,GAAK,OAAOoD,EAAE,IAAI,IAAM,OAAOpD,GAAe,IAAI,CAAC,EAAIA,IAAkBA,EACjKqD,EAAS,SAAS,cAAc,KAAK,EAU3C,GAPAA,EAAO,UAAY,gCACnBA,EAAO,MAAM,QAAU,OACvBA,EAAO,MAAM,WAAa,SAC1BA,EAAO,MAAM,QAAU,MACvBA,EAAO,MAAM,WAAa,mCAGtB,CAACH,GAAS,WAAY,CACxB,IAAMI,EAAa,SAAS,cAAc,MAAM,EAChDA,EAAW,UAAY,eACvBA,EAAW,MAAM,OAAS,UAC1BA,EAAW,MAAM,YAAc,MAE/B,GAAI,CAAEA,EAAW,UAAYT,GAAW,gBAAiB,EAAE,CAAG,MAAY,CAAE,CAC5EQ,EAAO,YAAYC,CAAU,CAC/B,CAGA,IAAMC,EAAWC,GAAelD,EAAM,QAAU,CAAC,CAAC,EAElDiD,EAAS,UAAU,IAAI,sBAAsB,EAC7CF,EAAO,YAAYE,CAAQ,EAC3B,IAAME,EAAWC,GAAepD,EAAM,QAAU,CAAC,EAAG6C,CAAgB,EAEpEM,EAAS,UAAU,IAAI,kBAAkB,EACzCJ,EAAO,YAAYI,CAAQ,EAE3B,IAAIE,EACJ,GAAI,CACF,GAAIT,GAAW,OAAO,UAAU,eAAe,KAAKA,EAAS,eAAe,EAC1ES,EAAoBT,EAAS,sBACpBA,GAAWA,EAAQ,QAC5B,GAAI,CACF,IAAMU,EAAM,OAAe,cAAgB,CAAC,EAC5CD,EAAoBC,EAAGV,EAAQ,OAAO,EAAIU,EAAGV,EAAQ,OAAO,EAAE,cAAgB,MAChF,MAAY,CAAES,EAAoB,MAAW,CAEjD,MAAY,CAAEA,EAAoB,MAAW,CAE7C,GAAI,MAAM,QAAQA,CAAiB,EAAG,CAEpC,GAAIA,EAAkB,KAAMzC,GAAW,OAAOA,CAAC,IAAM,WAAW,EAAG,CACjE,IAAM2C,EAAYC,GAAiBxD,EAAM,OAASA,EAAM,MAAM,QAAW,EAAGA,EAAM,QAAU,CAAC,CAAC,EAC9FuD,EAAU,UAAU,IAAI,kBAAkB,EAC1CR,EAAO,YAAYQ,CAAS,CAC9B,CAEA,GAAI,CACF,IAAME,GAAiBd,GAAU,CAAC,GAAG,OAAQG,GAAW,QAAQA,EAAE,UAAYA,EAAE,MAAQ,IAAI,YAAY,CAAC,IAAM,UAAY,OAAOA,EAAE,MAAQ,EAAE,EAAE,YAAY,EAAE,SAAS,UAAU,CAAC,EAClL,QAAWY,KAAOL,EAAmB,CACnC,GAAI,OAAOK,CAAG,IAAM,YAAa,SACjC,IAAMZ,EAAIW,EAAc,KAAME,GAAY,OAAOA,EAAG,EAAE,IAAM,OAAOD,CAAG,GAAK,OAAOC,EAAG,IAAI,IAAM,OAAOD,CAAG,CAAC,EAC1G,GAAIZ,EAAG,CACL,IAAMc,EAAKC,GAAsBf,EAAG9C,EAAM,OAAS,CAAC,CAAC,EACjD4D,IACFA,EAAG,UAAU,IAAI,qBAAqB,EACtCb,EAAO,YAAYa,CAAE,EAEzB,CACF,CACF,MAAY,CAAE,CAChB,CAIA,GAAI,CACF,IAAM/B,EAAM7B,GAASA,EAAM,OAASA,EAAM,OAAS,CAAC,EAGpD,GAFyB6B,IAAQA,EAAI,WAAaA,EAAI,QAAUA,EAAI,UAAYA,EAAI,QAC9EA,GAAOA,EAAI,MAAQ,QAAQgB,IAAqBA,EAAiB,UAAYA,EAAiB,OAAS,IAAI,YAAY,CAAC,IAAM,YAC9G,CACpB,IAAIiB,EAAYjC,EAAI,WAAaA,EAAI,QAAUA,EAAI,UAAY,KAC/D,GAAI,CAACiC,GAAa,MAAM,QAAQ9D,EAAM,KAAK,EACzC,QAAWsB,KAAMtB,EAAM,OAAS,CAAC,EAAG,CAClC,IAAMP,EAAK6B,IAAOA,EAAG,MAAQA,GAC7B,GAAI,CAAC7B,GAAM,CAAC,MAAM,QAAQA,EAAG,WAAW,EAAG,SAC3C,IAAMsE,EAAKtE,EAAG,YAAY,KAAMK,GAAWA,IAAMA,EAAE,OAAS,aAAe,OAAOA,EAAE,OAAO,IAAM,OAAO+C,GAAoBA,EAAiB,EAAE,EAAE,EACjJ,GAAIkB,GAAMA,EAAG,WAAa,MAAM,QAAQA,EAAG,SAAS,EAAG,CACrD,IAAMC,EAAQD,EAAG,UAAU,KAAME,GAAW,OAAOA,EAAE,OAASA,EAAE,IAAI,IAAM,OAAOpC,EAAI,MAAQA,EAAI,EAAE,CAAC,EACpG,GAAImC,IAAUA,EAAM,WAAaA,EAAM,QAAS,CAAEF,EAAYE,EAAM,WAAaA,EAAM,OAAQ,KAAO,CACxG,CACF,CAEF,GAAIF,GAAab,GAAYA,EAAS,WAAY,CAChD,IAAMiB,EAAW,SAAS,cAAc,MAAM,EAC9CA,EAAS,UAAY,gBAAkBC,EAAYtC,IAAQA,EAAI,OAASA,EAAI,OAAU,UAAU,EAAI,gKAAkKsC,EAAWL,CAAS,EAAI,8DAC9Rb,EAAS,WAAW,aAAaiB,EAAUjB,CAAQ,CACrD,CACF,CACF,MAAY,CAAE,CAGd,GAAI,CACEjD,GAASA,EAAM,SAAWA,EAAM,OAAO,OAAS,cAAgBA,EAAM,OAAO,QAAU,eACrFmD,IAAUA,EAAS,YAAc,OAASN,IAAqBA,EAAiB,MAAQA,EAAiB,OAAUA,EAAiB,MAAQA,EAAiB,MAAS,SAE9K,MAAY,CAAE,CAEd,GAAI,CACF,IAAMuB,EAAWrE,GAAqBC,EAAO6C,EAAkB5C,CAAQ,EACnEmE,GAAUrB,EAAO,YAAYqB,CAAQ,CAC3C,MAAY,CAAE,CAEd,GAAI,CACF,IAAM9B,EAASV,GAAuB5B,EAAO6C,CAAgB,EACzDP,GAAQS,EAAO,YAAYT,CAAM,CACvC,MAAY,CAAE,CACd,OAAOS,CACT,CCnaAsB,KAMO,IAAMC,GAAN,KAAwB,CAC7B,YACUC,EACAC,EACAC,EACAC,EACAC,EACAC,EACR,CANQ,YAAAL,EACA,cAAAC,EACA,qBAAAC,EACA,cAAAC,EACA,cAAAC,EACA,mBAAAC,EAGR,KAAK,gBAAkB,KAAK,gBAAgB,KAAK,IAAI,CACvD,CAKQ,gBAAgB,EAAeC,EAAeC,EAAe,CAGnE,GAFA,EAAE,gBAAgB,EAClB,EAAE,eAAe,EACb,KAAK,SAAU,CACjB,IAAMC,EAAYD,EAAM,SAAS,GAAG,EAChC,IAAIA,EAAM,QAAQ,KAAM,KAAK,CAAC,IAC9BA,EAEEE,EAAYH,EAAM,SAAS,GAAG,EAChC,IAAIA,EAAM,QAAQ,KAAM,KAAK,CAAC,IAC9BA,EACJ,KAAK,SAAS,GAAGG,CAAS,IAAID,CAAS,EAAE,CAC3C,CACF,CAKQ,WACNE,EACAC,EAAe,GACfC,EACQ,CACR,OAAK,OAAe,WACV,OAAe,WAAWF,EAAU,CAAE,KAAAC,EAAM,KAAAC,CAAK,CAAC,EAErD,EACT,CAKQ,kBAAwB,CAC9B,OACE,KAAK,OAAO,KACTC,GACCA,EAAE,UACF,OAAOA,EAAE,QAAQ,EAAE,YAAY,IAAM,UACrC,OAAOA,EAAE,MAAQ,EAAE,EAChB,YAAY,EACZ,SAAS,UAAU,CAC1B,GACA,KAAK,OAAO,KACTA,GAAMA,EAAE,UAAY,OAAOA,EAAE,QAAQ,EAAE,YAAY,IAAM,QAC5D,CAEJ,CAKO,YAAYC,EAAsB,CACvC,IAAMC,EAAgB,KAAK,iBAAiB,EAC5C,GAAI,CAACA,EAAe,MAAO,GAE3B,IAAIC,EAAM,EACV,QAAWC,KAAQH,EAAO,CACxB,GAAI,CAACG,GAAQ,CAAC,MAAM,QAAQA,EAAK,WAAW,EAAG,SAC/C,IAAMC,EAAKD,EAAK,YAAY,KACzBE,GACEA,EAAE,SAAW,OAAOA,EAAE,OAAO,IAAM,OAAOJ,EAAc,EAAE,GAC1DI,EAAE,WACD,OAAOA,EAAE,SAAS,EAAE,YAAY,EAAE,SAAS,UAAU,GACvDA,EAAE,OAAS,QACf,EACA,GAAID,EAAI,CACN,IAAME,EAAM,OACVF,EAAG,QAAU,KAAOA,EAAG,OAASA,EAAG,OAAS,KAAOA,EAAG,MAAQ,GAChE,EACK,MAAME,CAAG,IAAGJ,GAAOI,EAC1B,CACF,CACA,OAAOJ,CACT,CAKQ,eAAeK,EAAmB,CACxC,OAAK,SAASA,CAAC,EACR,OAAOA,CAAC,EADU,EAE3B,CAKO,mBACLP,EACAQ,EAC4C,CAC5C,IAAMC,EAAS,IAAI,IACbC,EAAW,OAAOF,EAAY,UAAY,EAAE,EAAE,YAAY,EAG5DG,EAAiB,CAAC,EAClBD,IAAa,iBAAmB,MAAM,QAAQF,EAAY,OAAO,EACnEG,EAAUH,EAAY,QAEtBE,IAAa,aACbF,EAAY,eAAe,aAE3BG,EAAUH,EAAY,cAAc,WAAW,IAAKI,IAAa,CAC/D,GAAIA,EAAG,GACP,KAAMA,EAAG,MACT,MAAOA,EAAG,MACV,MAAOA,EAAG,OAAS,KACnB,UAAWA,EAAG,UACd,SAAUA,EAAG,QACf,EAAE,GAIJ,QAAWC,KAAOF,EAAS,CACzB,IAAMG,EAAM,OAAOD,EAAI,IAAMA,EAAI,MAAQ,EAAE,EACvCC,GACFL,EAAO,IAAIK,EAAK,CAAE,OAAQD,EAAK,MAAO,CAAC,CAAE,CAAC,CAE9C,CAGAJ,EAAO,IAAI,eAAgB,CACzB,OAAQ,CACN,GAAI,eACJ,KAAM,MAAMD,EAAY,IAAI,GAC5B,MAAO,IACT,EACA,MAAO,CAAC,CACV,CAAC,EAGD,QAAWL,KAAQH,EAAO,CACxB,GAAI,CAACG,GAAQ,CAAC,MAAM,QAAQA,EAAK,WAAW,EAAG,CAC7CM,EAAO,IAAI,cAAc,EAAG,MAAM,KAAKN,CAAI,EAC3C,QACF,CAEA,IAAMC,EAAKD,EAAK,YAAY,KACzBE,GACC,OAAOA,EAAE,OAAO,IAAM,OAAOG,EAAY,EAAE,GAC3C,OAAOH,EAAE,SAAS,EAAE,YAAY,IAAM,OAAOG,EAAY,IAAI,EAAE,YAAY,CAC/E,EAEIO,EAAW,eAEf,GAAIX,GACF,GAAIM,IAAa,gBAAiB,CAChC,IAAMM,EAAQZ,EAAG,UAAaA,EAAG,QAAUA,EAAG,OAAO,GAC/Ca,EAAUb,EAAG,MAASA,EAAG,QAAUA,EAAG,OAAO,KACnD,GAAIY,GAASP,EAAO,IAAI,OAAOO,CAAK,CAAC,EACnCD,EAAW,OAAOC,CAAK,UACdC,GACT,OAAW,CAACH,EAAKI,CAAK,IAAKT,EACzB,GAAI,OAAOS,EAAM,OAAO,IAAI,EAAE,YAAY,IAAM,OAAOD,CAAO,EAAE,YAAY,EAAG,CAC7EF,EAAWD,EACX,KACF,EAGN,SAAWJ,IAAa,YAAa,CACnC,IAAMS,EAAOf,EAAG,aAAgBA,EAAG,WAAaA,EAAG,UAAU,IAAOA,EAAG,GACjEgB,EAAUhB,EAAG,OAAUA,EAAG,WAAaA,EAAG,UAAU,MAC1D,GAAIe,GAAQV,EAAO,IAAI,OAAOU,CAAI,CAAC,EACjCJ,EAAW,OAAOI,CAAI,UACbC,GACT,OAAW,CAACN,EAAKI,CAAK,IAAKT,EACzB,GAAI,OAAOS,EAAM,OAAO,KAAK,EAAE,YAAY,IAAM,OAAOE,CAAO,EAAE,YAAY,GAC3E,OAAOF,EAAM,OAAO,IAAI,EAAE,YAAY,IAAM,OAAOE,CAAO,EAAE,YAAY,EAAG,CAC3EL,EAAWD,EACX,KACF,EAGN,EAGEL,EAAO,IAAIM,CAAQ,EACrBN,EAAO,IAAIM,CAAQ,EAAG,MAAM,KAAKZ,CAAI,EAErCM,EAAO,IAAI,cAAc,EAAG,MAAM,KAAKN,CAAI,CAE/C,CAEA,OAAOM,CACT,CAKQ,kBAAkBY,EAA4B,CACpD,IAAMC,EAAQD,EAAO,WAAaA,EAAO,MACnCE,EAAWF,EAAO,UAAYA,EAAO,OAE3C,GAAI,CAACC,GAAS,CAACC,EAAU,OAAO,KAEhC,GAAI,CACF,IAAMC,EAAY,IAAI,KAAKF,CAAK,EAC1BG,EAAU,IAAI,KAClBD,EAAU,QAAQ,EAAI,OAAOD,CAAQ,EAAI,GAAK,GAAK,GAAK,GAC1D,EAEMG,EAAcC,GAClBA,EAAE,mBAAmB,QAAS,CAAE,MAAO,QAAS,IAAK,SAAU,CAAC,EAElE,MAAO,GAAGD,EAAWF,CAAS,CAAC,WAAME,EAAWD,CAAO,CAAC,EAC1D,MAAY,CACV,OAAO,IACT,CACF,CAKO,WAAWJ,EAAarB,EAAcQ,EAA+B,CAC1E,IAAMoB,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAY,aACjBA,EAAK,aAAa,iBAAkB,OAAOP,EAAO,IAAMA,EAAO,MAAQ,EAAE,CAAC,EAC1EO,EAAK,MAAM,MAAQ,QACnBA,EAAK,MAAM,SAAW,QACtBA,EAAK,MAAM,SAAW,QACtBA,EAAK,MAAM,WAAa,wCACxBA,EAAK,MAAM,OAAS,8CACpBA,EAAK,MAAM,aAAe,IAC1BA,EAAK,MAAM,QAAU,OACrBA,EAAK,MAAM,cAAgB,SAC3BA,EAAK,MAAM,WAAa,IAGxB,IAAMC,EAAS,KAAK,uBAAuBR,EAAQrB,EAAOQ,CAAW,EACrEqB,EAAO,MAAM,aAAe,8CAC5BD,EAAK,YAAYC,CAAM,EAGvB,IAAMC,EAAiB,SAAS,cAAc,KAAK,EACnDA,EAAe,UAAY,mBAC3BA,EAAe,MAAM,QAAU,MAC/BA,EAAe,MAAM,UAAY,OACjCA,EAAe,MAAM,KAAO,IAC5BA,EAAe,MAAM,UAAY,IAGjC,IAAMC,EAAcC,EAAeX,EAAO,KAAK,GAAK,UAEpD,QAAWlB,KAAQH,EAAO,CACxB,IAAMiC,EAAS,KAAK,WAAW9B,EAAMK,EAAauB,CAAW,EAC7DD,EAAe,YAAYG,CAAM,CACnC,CAEAL,EAAK,YAAYE,CAAc,EAG/B,IAAMI,EAAS,KAAK,uBAAuBb,EAAQb,CAAW,EAC9D,OAAAoB,EAAK,YAAYM,CAAM,EAEhBN,CACT,CAKQ,uBACNP,EACArB,EACAQ,EACa,CACb,IAAME,EAAW,OAAOF,EAAY,UAAY,EAAE,EAAE,YAAY,EAC1DqB,EAAS,SAAS,cAAc,KAAK,EAC3CA,EAAO,UAAY,oBACnBA,EAAO,MAAM,QAAU,OACvBA,EAAO,MAAM,WAAa,mCAC1BA,EAAO,MAAM,WAAa,IAG1B,IAAMM,EAAYC,GAAwB,KAAK,OAAQ,KAAK,SAAU,CAAE,OAAAf,EAAQ,MAAArB,CAAM,EAAGQ,EAAa,CAAE,WAAY,GAAM,cAAe,KAAK,aAAc,CAAC,EAE7J2B,EAAU,UAAU,IAAI,uBAAuB,EAE/C,IAAME,EAAWF,EAAU,cAAc,kBAAkB,EACvDE,GAAUA,EAAS,UAAU,IAAI,sBAAsB,EAC3D,IAAMC,EAAWH,EAAU,cAAc,aAAa,EAClDG,GAAUA,EAAS,UAAU,IAAI,kBAAkB,EACvD,IAAMC,EAAYJ,EAAU,cAAc,gBAAgB,EACtDI,GAAWA,EAAU,UAAU,IAAI,kBAAkB,EAEzD,IAAMC,EAAW,MAAM,KAAKL,EAAU,QAAQ,EAC9C,QAAWM,KAAMD,EACf,GAAI,CACEC,EAAG,aAAeA,EAAG,YAAY,KAAK,EAAE,WAAW,WAAW,GAChEA,EAAG,UAAU,IAAI,qBAAqB,CAE1C,MAAY,CAAE,CAMhB,GAHAZ,EAAO,YAAYM,CAAS,EAGxBzB,IAAa,iBAAmBW,EAAO,YAAa,CACtD,IAAMqB,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,UAAY,yBACpBA,EAAQ,MAAM,SAAW,OACzBA,EAAQ,MAAM,MAAQ,sCACtBA,EAAQ,MAAM,UAAY,MAC1BA,EAAQ,MAAM,SAAW,SACzBA,EAAQ,MAAM,aAAe,WAC7BA,EAAQ,MAAM,WAAa,SAC3BA,EAAQ,YAAc,OAAOrB,EAAO,WAAW,EAAE,MAAM,EAAG,GAAG,EAC7DQ,EAAO,YAAYa,CAAO,CAC5B,CAEA,GAAIhC,IAAa,YAAa,CAC5B,IAAMiC,EAAYR,EAAU,iBACxBQ,GAAaA,EAAU,aAAeA,EAAU,YAAY,QAAQ,QAAG,IAAM,IAC/EA,EAAU,UAAU,IAAI,wBAAwB,CAEpD,CAEA,OAAOd,CACT,CAKQ,uBAAuBR,EAAab,EAA+B,CACzE,IAAM0B,EAAS,SAAS,cAAc,KAAK,EAC3CA,EAAO,UAAY,oBACnBA,EAAO,MAAM,QAAU,WACvBA,EAAO,MAAM,UAAY,8CACzBA,EAAO,MAAM,OAAS,UACtBA,EAAO,MAAM,WAAa,OAC1BA,EAAO,MAAM,WAAa,IAC1BA,EAAO,MAAM,WAAa,8BAC1BA,EAAO,aAAa,uBAAwB,OAAO1B,EAAY,IAAM,EAAE,CAAC,EACxE0B,EAAO,aAAa,uBAAwB,OAAOb,EAAO,IAAM,EAAE,CAAC,EACnEa,EAAO,aACL,yBACA,OAAOb,EAAO,MAAQA,EAAO,OAAS,EAAE,CAC1C,EAEA,IAAMuB,EAAW,SAAS,cAAc,MAAM,EAC9C,OAAAA,EAAS,YAAc,aACvBA,EAAS,MAAM,QAAU,MACzBA,EAAS,MAAM,SAAW,OAC1BV,EAAO,YAAYU,CAAQ,EAE3BV,EAAO,iBAAiB,aAAc,IAAM,CAC1CA,EAAO,MAAM,gBAAkB,oCACjC,CAAC,EACDA,EAAO,iBAAiB,aAAc,IAAM,CAC1CA,EAAO,MAAM,gBAAkB,aACjC,CAAC,EAEDA,EAAO,iBAAiB,QAAUW,GAAM,CACtCA,EAAE,gBAAgB,EACd,KAAK,UACP,KAAK,SACH,qBACA,CACE,cAAerC,EAAY,GAC3B,cAAea,EAAO,GACtB,gBAAiBA,EAAO,MAAQA,EAAO,KACzC,EACA,CACE,cAAea,CACjB,CACF,CAEJ,CAAC,EAEMA,CACT,CAKQ,WACN/B,EACAK,EACAuB,EACa,CACb,IAAMe,EAAK,SAAS,cAAc,KAAK,EACvCA,EAAG,UAAY,aACfA,EAAG,aAAa,kBAAmB,OAAO3C,GAAM,IAAM,EAAE,CAAC,EACzD2C,EAAG,MAAM,QAAU,OACnBA,EAAG,MAAM,OAAS,8CAClBA,EAAG,MAAM,aAAe,IACxBA,EAAG,MAAM,aAAe,MACxBA,EAAG,MAAM,WAAa,kCACtBA,EAAG,MAAM,OAAS,UAClBA,EAAG,MAAM,SAAW,WAGpB,IAAMC,EACJ5C,GAAM,SAAYA,GAAM,KAAOA,EAAK,IAAI,aAAgB,KACpD6C,EACH7C,GAAM,UAAYA,EAAK,QAAQ,OAASA,EAAK,QAAQ,OACtDA,GAAM,OACLA,GAAM,KAAOA,EAAK,IAAI,OACvB,WAEI8C,EACH9C,GAAM,SAAWA,EAAK,QAAQ,QAC9BA,GAAM,KAAOA,EAAK,IAAI,aAAeA,EAAK,IAAI,YAAY,QAC3D,KAEI+C,EACH/C,GAAM,SAAWA,EAAK,QAAQ,KAC9BA,GAAM,KAAOA,EAAK,IAAI,aAAeA,EAAK,IAAI,YAAY,KAC3D,KAGEP,EAAW,eACXuD,EAAO,GACX,GAAIJ,EAAS,CACX,IAAMK,EAAW,OAAOL,EAAQ,YAAc,EAAE,EAAE,YAAY,EACxDM,EAAQ,OAAON,EAAQ,OAAS,EAAE,EAAE,YAAY,EACtDI,EAAOC,EAAS,SAAS,aAAa,EACtC,IAAME,EAAWD,IAAU,SACrBE,EAAWR,EAAQ,SAAW,GAC9BS,EAAUT,EAAQ,UAAY,GAEhCI,EACEI,EAAU3D,EAAW,YAChB0D,EAAU1D,EAAW,0BACrB4D,EAAS5D,EAAW,yBACxBA,EAAW,mBAEZ0D,EAAU1D,EAAW,eAChB4D,EAAS5D,EAAW,cACxBA,EAAW,cAEpB,CAGA,IAAI6D,EAAY,GAChB,GAAI,CACF,IAAMC,EACJX,GAAYA,EAAgB,yBACvBA,EAAgB,yBACjB,KAGNU,GADEC,GAAQ,OAAOA,EAAK,WAAc,SAAWA,EAAK,UAAY,GACnC,CAC/B,MAAY,CAAE,CAGd,IAAMC,EAAY5B,EAGZ6B,EAAY,KAAK,iBAAiBzD,CAAI,EAGtC0D,EAAc,SAAS,cAAc,KAAK,EAChDA,EAAY,MAAM,QAAU,OAC5BA,EAAY,MAAM,cAAgB,SAClCA,EAAY,MAAM,IAAM,MAGxB,IAAMC,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,MAAM,QAAU,OACxBA,EAAQ,MAAM,eAAiB,aAC/BA,EAAQ,MAAM,WAAa,SAE3B,IAAMC,EAAW,KAAK,WAAWnE,EAAU,GAAI+D,CAAS,EAClDK,EAAiBP,EACnB,sPAAsP,KAAK,WAAW,UAAW,EAAG,SAAS,CAAC,UAC9R,GAEJK,EAAQ,UAAY,sGAAsGG,EAAWN,CAAS,CAAC,MAAMI,CAAQ,GAAGC,CAAc,UAG9K,IAAME,EAAU,SAAS,cAAc,MAAM,EAC7CA,EAAQ,UAAY,sBACpBA,EAAQ,aAAa,eAAgB,OAAO/D,GAAM,IAAM,EAAE,CAAC,EAC3D+D,EAAQ,MAAM,WAAa,MAC3BA,EAAQ,MAAM,MAAQ,sCACtBA,EAAQ,UACN,KAAK,WAAW,mBAAoB,EAAE,GAAK,mBAC7CJ,EAAQ,YAAYI,CAAO,EAE3BL,EAAY,YAAYC,CAAO,EAG/B,IAAMK,EAAW,SAAS,cAAc,KAAK,EAC7CA,EAAS,MAAM,WAAa,MAC5BA,EAAS,MAAM,WAAa,MAC5BA,EAAS,UAAY,GAAGF,EAAWjB,CAAS,CAAC,GAAGC,EAAS,8EAA8EgB,EAAW,OAAOhB,CAAM,CAAC,CAAC,UAAY,EAAE,GAC/KY,EAAY,YAAYM,CAAQ,EAGhC,IAAMC,EAAY,KAAK,kBAAkBjE,EAAMK,CAAW,EACtD4D,GACFP,EAAY,YAAYO,CAAS,EAInC,IAAMC,EAAoB,KAAK,wBAAwBlE,CAAI,EAQ3D,GAPIkE,GACFR,EAAY,YAAYQ,CAAiB,EAG3CvB,EAAG,YAAYe,CAAW,EAGtBD,GAAaA,EAAU,OAAS,EAAG,CACrC,IAAMU,EAAmB,KAAK,sBAAsBV,CAAS,EAC7DU,EAAiB,MAAM,SAAW,WAClCA,EAAiB,MAAM,IAAM,OAC7BA,EAAiB,MAAM,MAAQ,OAC/BxB,EAAG,YAAYwB,CAAgB,CACjC,CAGA,OAAIpB,IACFJ,EAAG,aAAa,eAAgBI,CAAG,EACnCJ,EAAG,MAAQ,GAAGE,CAAS,GAAGC,EAAS,KAAKA,CAAM,GAAK,EAAE,IAGhDH,CACT,CAKQ,aAAa1C,EAAiB,CACpC,GAAIA,EAAG,UAAW,OAAOA,EAAG,UAC5B,GAAIA,EAAG,OAAO,KAAM,OAAOA,EAAG,MAAM,KACpC,GAAIA,EAAG,SAAW,KAAK,OAAQ,CAC7B,IAAMmE,EAAQ,KAAK,OAAO,KACvBxE,GAAM,OAAOA,EAAE,EAAE,IAAM,OAAOK,EAAG,OAAO,CAC3C,EACA,GAAImE,GAASA,EAAM,KAAM,OAAOA,EAAM,IACxC,CACA,MAAO,OACT,CAKQ,iBAAiBpE,EAAkB,CACzC,GAAI,CAACA,EAAM,MAAO,CAAC,EAGnB,GAAIA,EAAK,SAAS,WAAW,MAC3B,OAAOA,EAAK,QAAQ,UAAU,MAEhC,GAAIA,EAAK,SAAS,WAAa,MAAM,QAAQA,EAAK,QAAQ,SAAS,EACjE,OAAOA,EAAK,QAAQ,UAItB,GAAI,MAAM,QAAQA,EAAK,WAAW,EAAG,CACnC,IAAMqE,EAAcrE,EAAK,YAAY,KAClCE,GAAWA,GAAG,OAAS,aAAeA,GAAG,SAC5C,EACA,GAAImE,GAAa,UACf,OAAO,MAAM,QAAQA,EAAY,SAAS,EACtCA,EAAY,UACZ,CAAC,CAET,CAEA,MAAO,CAAC,CACV,CAKQ,0BAA0BrE,EAAkB,CAClD,GAAI,CAACA,EAAM,MAAO,CAAC,EAGnB,GAAI,MAAM,QAAQA,EAAK,WAAW,EAAG,CACnC,IAAMsE,EAAOtE,EAAK,YAAY,KAC3BE,GACCA,GAAG,OAAS,wBAA0BA,GAAG,OAAS,cACtD,EACA,GAAIoE,EAAM,CAER,GAAI,MAAM,QAAQA,EAAK,YAAY,EACjC,OAAOA,EAAK,aAGd,GACEA,EAAK,cAAc,OACnB,MAAM,QAAQA,EAAK,aAAa,KAAK,EAErC,OAAOA,EAAK,aAAa,KAE7B,CACF,CAGA,GAAItE,EAAK,SAAS,mBAAoB,CACpC,GAAI,MAAM,QAAQA,EAAK,QAAQ,kBAAkB,EAC/C,OAAOA,EAAK,QAAQ,mBAEtB,GAAI,MAAM,QAAQA,EAAK,QAAQ,mBAAmB,KAAK,EACrD,OAAOA,EAAK,QAAQ,mBAAmB,KAE3C,CAEA,MAAO,CAAC,CACV,CAKQ,sBAAsByD,EAA+B,CAC3D,IAAMc,EAAY,SAAS,cAAc,KAAK,EAC9CA,EAAU,UAAY,uBACtBA,EAAU,MAAM,QAAU,OAC1BA,EAAU,MAAM,WAAa,SAE7B,IAAMC,EAAa,EA2BnB,GA1BkBf,EAAU,MAAM,EAAGe,CAAU,EAErC,QAAQ,CAACC,EAAUC,IAAU,CACrC,IAAMC,EAAQF,EAAS,OAASA,EAAS,MAAQ,UAC3CG,EAAYH,EAAS,WAAa,GACxC,GAAI,CAACG,EAAW,OAEhB,IAAMC,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,IAAMD,EACVC,EAAI,UAAY,aAChBA,EAAI,aAAa,oBAAqB,WAAW,EACjDA,EAAI,aAAa,oBAAqBF,CAAK,EAC3CE,EAAI,MAAQF,EACZE,EAAI,MAAM,MAAQ,OAClBA,EAAI,MAAM,OAAS,OACnBA,EAAI,MAAM,aAAe,MACzBA,EAAI,MAAM,OAAS,8CACnBA,EAAI,MAAM,OAAS,UACnBA,EAAI,MAAM,WAAaH,IAAU,EAAI,IAAM,OAC3CG,EAAI,MAAM,OAAS,OAAOL,EAAaE,CAAK,EAC5CG,EAAI,MAAM,SAAW,WAErBN,EAAU,YAAYM,CAAG,CAC3B,CAAC,EAGGpB,EAAU,OAASe,EAAY,CACjC,IAAMM,EAAO,SAAS,cAAc,MAAM,EAC1CA,EAAK,UAAY,aACjBA,EAAK,aAAa,oBAAqB,WAAW,EAGlDA,EAAK,MAAM,WAAa,OACxBA,EAAK,MAAM,MAAQ,OACnBA,EAAK,MAAM,OAAS,OACpBA,EAAK,MAAM,aAAe,MAC1BA,EAAK,MAAM,WAAa,iCACxBA,EAAK,MAAM,MAAQ,iCACnBA,EAAK,MAAM,SAAW,OACtBA,EAAK,MAAM,QAAU,OACrBA,EAAK,MAAM,WAAa,SACxBA,EAAK,MAAM,eAAiB,SAC5BA,EAAK,MAAM,WAAa,OACxBA,EAAK,MAAM,WAAa,IACxBA,EAAK,YAAc,IAAIrB,EAAU,OAASe,CAAU,GACpDM,EAAK,MAAQ,iBACbP,EAAU,YAAYO,CAAI,CAC5B,CAEA,OAAOP,CACT,CAKQ,kBAAkBvE,EAAWK,EAAsC,CACzE,GAAI,CAACL,GAAQ,CAAC,MAAM,QAAQA,EAAK,WAAW,EAAG,OAAO,KAEtD,IAAM+E,EAAe,CACnB,sBACA,YACA,QACA,QACF,EACMC,EAAoB,CAAC,sBAAuB,YAAa,OAAO,EAChEC,EAAgB5E,GAAa,GAE7B6E,EAAuB,CAAC,EAGxBC,EAAY,KAAK,0BAA0BnF,CAAI,EACrD,GAAImF,EAAU,OAAS,EAAG,CACxB,IAAMC,EAASD,EACZ,IAAKE,GAAY,CAChB,IAAMlF,EAAM2D,EAAW,OAAOuB,EAAG,QAAU,EAAE,CAAC,EACxCxC,EAAYiB,EAAWuB,EAAG,OAAS,EAAE,EACrCtC,EAAMe,EAAWuB,EAAG,KAAO,EAAE,EAC7BC,EACJD,EAAG,aAAeA,EAAG,OAASA,EAAG,QAAUA,EAAG,OAAS,KACnDE,EAAY1D,EAAeyD,CAAQ,GAAK,KACxCE,EAAS,CAAC,EACdD,GAAa,gCAAgC,KAAKA,CAAS,GAEvDE,EAASF,GAAa,UACtBG,EACHF,GAAUG,EAASJ,EAAW,GAAI,GAAM,mBACrCK,EAAKC,GAAiBN,CAAS,GAAK,UAEpClC,EAAU,CAAC,CAACgC,EAAG,QACfnC,EAASmC,EAAG,OAAS,OAAOA,EAAG,KAAK,EAAE,YAAY,GAAM,GACxDjC,EAAW,CAAC,CAACiC,EAAG,OAChBlC,EAAW,CAACC,GAAYF,IAAU,SAEpCzD,EAAW,mBACX2D,EAAU3D,EAAW,YAChB0D,EAAU1D,EAAW,0BACrB4D,IAAS5D,EAAW,0BAE7B,IAAMqG,EAAO,KAAK,WAAWrG,EAAU,EAAE,EACnCsG,EAAUlD,EACZiB,EAAW,IAAIuB,EAAG,MAAM,IAAIA,EAAG,KAAK,EAAE,EACtCvB,EAAW,IAAIuB,EAAG,MAAM,EAAE,EAE9B,MAAO,YAAYtC,CAAG,YAAYgD,CAAO,mBAAmBhD,CAAG,mMAAmMe,EAAW2B,CAAM,CAAC,eAAe3B,EAAW4B,CAAE,CAAC,UAAU5B,EAAW8B,CAAE,CAAC,yLAAyLE,CAAI,6GAA6G3F,CAAG,oBACxnB,CAAC,EACA,KAAK,EAAE,EACV+E,EAAW,KAAKE,CAAM,CACxB,CAEA,QAAWnF,KAAMD,EAAK,YAAa,CACjC,GAAI,CAACC,EAAI,SAET,IAAM+F,EAAY,OAAO/F,EAAG,MAAQ,EAAE,EAAE,YAAY,EAC9CgG,EAAY,OAChBhG,EAAG,WAAaA,EAAG,OAAO,MAAQ,EACpC,EAAE,YAAY,EAOd,GAJI8E,EAAa,SAASiB,CAAS,GAC/BhB,EAAkB,SAASiB,CAAS,GAGpChB,GAAiB,OAAOhF,EAAG,OAAO,IAAM,OAAOgF,CAAa,EAC9D,SAGF,GAAI,KAAK,iBAAmB,KAAK,gBAAgB,OAAS,EAAG,CAC3D,IAAMiB,EAAMjG,EAAG,SAAYA,EAAG,OAASA,EAAG,MAAM,GAChD,GAAIiG,GAAO,CAAC,KAAK,gBAAgB,SAAS,OAAOA,CAAG,CAAC,EACnD,QAEJ,CAIA,GAAI,CADa,KAAK,cAAcjG,CAAE,EACvB,SAGf,IAAMkG,EAAW,KAAK,iBAAiBlG,CAAE,EACrCkG,GACFjB,EAAW,KAAKiB,CAAQ,CAE5B,CAEA,GAAIjB,EAAW,SAAW,EAAG,OAAO,KAEpC,IAAMX,EAAY,SAAS,cAAc,KAAK,EAC9C,OAAAA,EAAU,UAAY,oBACtBA,EAAU,MAAM,QAAU,OAC1BA,EAAU,MAAM,SAAW,OAC3BA,EAAU,MAAM,IAAM,MACtBA,EAAU,MAAM,UAAY,MAC5BA,EAAU,UAAYW,EAAW,KAAK,EAAE,EAEjCX,CACT,CAKQ,cAActE,EAAkB,CAGtC,OAFa,OAAOA,EAAG,MAAQ,EAAE,EAAE,YAAY,EAEjC,CACZ,IAAK,gBACH,MAAO,CAAC,EAAEA,EAAG,QAAQ,MAAQA,EAAG,MAClC,IAAK,YACH,MAAO,CAAC,EAAEA,EAAG,WAAW,OAASA,EAAG,OACtC,IAAK,SACH,OAAO,MAAM,QAAQA,EAAG,MAAM,GAAKA,EAAG,OAAO,OAAS,EACxD,IAAK,YACH,MAAO,CAAC,CAACA,EAAG,WAAW,MACzB,IAAK,aACH,MAAO,CAAC,EAAEA,EAAG,YAAY,eAAiBA,EAAG,YAAY,MAC3D,IAAK,eACH,MAAO,CAAC,EAAEA,EAAG,QAAUA,EAAG,aAC5B,IAAK,SACH,OAAOA,EAAG,QAAU,MAAQA,EAAG,SAAW,GAC5C,IAAK,OACH,MAAO,CAAC,EAAEA,EAAG,MAAQA,EAAG,WAC1B,IAAK,OACH,MAAO,CAAC,CAACA,EAAG,KACd,IAAK,eACL,IAAK,uBACH,MAAO,CAAC,EACNA,EAAG,cAAc,OAAO,OAAS,GAChC,MAAM,QAAQA,EAAG,YAAY,GAAKA,EAAG,aAAa,OAAS,GAEhE,QACE,MAAO,EACX,CACF,CAKQ,iBAAiBA,EAAiB,CAGxC,OAFa,OAAOA,EAAG,MAAQ,EAAE,EAAE,YAAY,EAEjC,CACZ,IAAK,gBACH,OAAO,KAAK,uBAAuBA,CAAE,EACvC,IAAK,SACH,OAAO,KAAK,kBAAkBA,CAAE,EAClC,IAAK,YACH,OAAO,KAAK,oBAAoBA,CAAE,EACpC,IAAK,YACH,OAAO,KAAK,oBAAoBA,CAAE,EACpC,IAAK,aACH,OAAO,KAAK,qBAAqBA,CAAE,EACrC,IAAK,eACH,OAAO,KAAK,sBAAsBA,CAAE,EACtC,IAAK,SACH,OAAO,KAAK,iBAAiBA,CAAE,EACjC,IAAK,OACH,OAAO,KAAK,eAAeA,CAAE,EAC/B,IAAK,OACH,OAAO,KAAK,eAAeA,CAAE,EAC/B,IAAK,eACL,IAAK,uBACH,OAAO,KAAK,yBAAyBA,CAAE,EACzC,QACE,MAAO,EACX,CACF,CAKQ,uBAAuBA,EAAiB,CAC9C,IAAMmG,EAAOnG,EAAG,QAAQ,MAAQA,EAAG,MAAQ,GAC3C,GAAI,CAACmG,EAAM,MAAO,GAElB,IAAMd,EAAWrF,EAAG,QAAQ,OAASA,EAAG,OAAS,KAC3CoG,EAAIxE,EAAeyD,CAAQ,GAAK,KAChCE,EAAS,CAAC,EAAEa,GAAK,gCAAgC,KAAKA,CAAC,GACvDZ,EAASY,GAAK,UACdX,EAAMF,GAAUG,EAASU,EAAG,GAAI,GAAM,mBACtCT,EAAKS,GAAK,UAEVC,EAAQ,KAAK,aAAarG,CAAE,EAClC,MAAO,+CAA+C6D,EAAWwC,CAAK,CAAC,wBAAwBxC,EAAWsC,CAAI,CAAC,sFAAsFtC,EAAW2B,CAAM,CAAC,eAAe3B,EAAW4B,CAAE,CAAC,UAAU5B,EAAW8B,CAAE,CAAC,uHAAuH9B,EAAWsC,CAAI,CAAC,KAAKtC,EAAWsC,CAAI,CAAC,SAC1a,CAKQ,kBAAkBnG,EAAiB,CACzC,IAAMsG,EAAStG,EAAG,QAAU,CAAC,EAC7B,MAAI,CAACsG,GAAUA,EAAO,SAAW,EAAU,GAEpCA,EACJ,MAAM,EAAG,CAAC,EACV,IAAKC,GAAe,CACnB,IAAMJ,EAAOI,EAAM,MAAQ,GACrBlB,EAAWkB,EAAM,OAASA,EAAM,QAAU,KAC1CH,EAAIxE,EAAeyD,CAAQ,GAAK,KAChCE,EAAS,CAAC,EAAEa,GAAK,gCAAgC,KAAKA,CAAC,GACvDZ,EAASY,GAAK,UACdX,EAAMF,GAAUG,EAASU,EAAG,GAAI,GAAM,mBACtCT,EAAKS,GAAK,UAEhB,MAAO,0EAA0EvC,EAAWsC,CAAI,CAAC,sFAAsFtC,EAAW2B,CAAM,CAAC,eAAe3B,EAAW4B,CAAE,CAAC,UAAU5B,EAAW8B,CAAE,CAAC,+GAA+G9B,EAAWsC,CAAI,CAAC,SAC/X,CAAC,EACA,KAAK,EAAE,CACZ,CAKQ,oBAAoBnG,EAAiB,CAE3C,IAAMwG,GADYxG,EAAG,WAAaA,IACT,OAAS,GAClC,GAAI,CAACwG,EAAO,MAAO,GAEnB,IAAMX,EAAO,KAAK,WAAW,aAAc,EAAE,EAC7C,MAAO,6EAA6EhC,EAAW2C,CAAK,CAAC,+SAA+S3C,EAAW2C,CAAK,CAAC,KAAKX,CAAI,SAAShC,EAAW2C,CAAK,CAAC,gBAC1c,CAKQ,oBAAoBxG,EAAiB,CAC3C,IAAMwG,EAAQxG,EAAG,WAAW,OAAS,GACrC,GAAI,CAACwG,EAAO,MAAO,GAEnB,IAAMX,EAAO,KAAK,WAAW,YAAa,EAAE,EAC5C,MAAO,6EAA6EhC,EAAW2C,CAAK,CAAC,+SAA+S3C,EAAW2C,CAAK,CAAC,KAAKX,CAAI,SAAShC,EAAW2C,CAAK,CAAC,gBAC1c,CAKQ,qBAAqBxG,EAAiB,CAC5C,IAAMyG,EAAOzG,EAAG,YAAcA,EACxBmG,EAAOM,GAAM,eAAiBA,GAAM,MAAQ,GAClD,GAAI,CAACN,EAAM,MAAO,GAElB,IAAMN,EAAO,KAAK,WAAW,OAAQ,EAAE,EACvC,MAAO,wEAAwEhC,EAAWsC,CAAI,CAAC,wPAAwPtC,EAAWsC,CAAI,CAAC,KAAKN,CAAI,yEAAyEhC,EAAWsC,CAAI,CAAC,gBAC3c,CAKQ,iBAAiBnG,EAAiB,CACxC,IAAMX,EAAQW,EAAG,OACjB,GAAIX,GAAS,MAAQA,IAAU,GAAI,MAAO,GAE1C,IAAM2G,EAAY,KAAK,aAAahG,CAAE,EACtC,MAAO,+CAA+C6D,EAAWmC,CAAS,CAAC,wBAAwBnC,EAAW,OAAOxE,CAAK,CAAC,CAAC,0SAA0SwE,EAAWmC,CAAS,CAAC,iBAAiBnC,EAAW,OAAOxE,CAAK,CAAC,CAAC,gBACve,CAKQ,eAAeW,EAAiB,CACtC,IAAMX,EAAQW,EAAG,MAAQ,GACzB,GAAI,CAACX,EAAO,MAAO,GAEnB,IAAM2G,EAAY,KAAK,aAAahG,CAAE,EAChC0G,EAAY,OAAOrH,CAAK,EAAE,MAAM,EAAG,EAAE,EAC3C,MAAO,+CAA+CwE,EAAWmC,CAAS,CAAC,wBAAwBnC,EAAWxE,CAAK,CAAC,+SAA+SwE,EAAWxE,CAAK,CAAC,8DAA8DwE,EAAWmC,CAAS,CAAC,iBAAiBnC,EAAW6C,CAAS,CAAC,gBAC/iB,CAKQ,eAAe1G,EAAiB,CACtC,IAAM2G,EAAY3G,EAAG,MAAQA,EAAG,WAAa,KAC7C,GAAI,CAAC2G,EAAW,MAAO,GAEvB,IAAMX,EAAY,KAAK,aAAahG,CAAE,EAClC4G,EAAYD,EACZE,EAAYF,EAChB,GAAI,CACF,IAAMpF,EAAI,IAAI,KAAKoF,CAAS,EACvB,MAAMpF,EAAE,QAAQ,CAAC,IACpBqF,EAAYrF,EAAE,mBAAmB,QAAS,CACxC,MAAO,QACP,IAAK,SACP,CAAC,EACDsF,EAAYtF,EAAE,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC,EAE5C,MAAY,CAEZ,CAEA,IAAMsE,EAAO,KAAK,WAAW,WAAY,EAAE,EAC3C,MAAO,+CAA+ChC,EAAWmC,CAAS,CAAC,wBAAwBnC,EAAW,OAAOgD,CAAS,CAAC,CAAC,0SAA0ShD,EAAWmC,CAAS,CAAC,WAAWH,CAAI,SAAShC,EAAW,OAAO+C,CAAS,CAAC,CAAC,gBACtf,CAKQ,sBAAsB5G,EAAiB,CAC7C,IAAM8G,EAAS9G,EAAG,QAAUA,EAAG,aAAeA,EAAG,OAAS,KAC1D,GAAI,CAAC8G,EAAQ,MAAO,GAEpB,IAAMN,EAAQM,EAAO,OAASA,EAAO,MAAQ,GACvCjE,EAASiE,EAAO,QAAU,GAC1BhE,EAAMgE,EAAO,KAAOA,EAAO,UAAY,GAC7C,GAAI,CAACN,GAAS,CAAC3D,EAAQ,MAAO,GAG9B,IAAIkE,EAAQ,UACRC,EAAuB,GACrBC,EAAiB,CAAC,OAAQ,SAAU,YAAa,UAAU,EAG7DC,EAAkB,KACtB,GAAI,KAAK,UAAY,KAAK,SAAS,OAAS,EAAG,CAC7C,IAAMC,EAAWL,EAAO,IAAOA,EAAO,KAAOA,EAAO,IAAI,GAClDM,EACJN,EAAO,KAAOA,EAAO,UAAaA,EAAO,KAAOA,EAAO,IAAI,IACvDO,EAAYP,EAAO,QAAWA,EAAO,KAAOA,EAAO,IAAI,OAmB7D,GAhBAI,EAAa,KAAK,SAAS,KAAMnH,GAAc,CAC7C,IAAMuH,EAAIvH,EAAK,SAAYA,EAAK,KAAOA,EAAK,IAAI,YAChD,GAAI,CAACuH,EAAG,MAAO,GAEf,GADIH,GAAY,OAAOG,EAAE,EAAE,IAAM,OAAOH,CAAQ,GAC5CC,GAAa,OAAOE,EAAE,GAAG,IAAM,OAAOF,CAAS,EAAG,MAAO,GAC7D,GAAIC,GAAa,OAAOC,EAAE,MAAM,IAAM,OAAOD,CAAS,EAAG,CAEvD,IAAME,EAAWD,EAAE,YAAY,eAAiBA,EAAE,YAAY,KACxDE,EACJV,EAAO,YAAY,eAAiBA,EAAO,YAAY,KACzD,MAAI,EAAAS,GAAYC,GAAcD,IAAaC,EAE7C,CACA,MAAO,EACT,CAAC,EAEGN,GAAc,MAAM,QAAQA,EAAW,WAAW,EAAG,CAGvD,IAAMO,EAAWP,EAAW,YAAY,KACrC3F,GACCA,GACAA,EAAE,OAAS,kBACTA,EAAE,KACFA,EAAE,IAAI,OACN,OAAOA,EAAE,IAAI,MAAM,MAAQ,EAAE,EAAE,YAAY,IAAM,UAChDA,EAAE,WACD,OAAOA,EAAE,WAAa,EAAE,EAAE,YAAY,IAAM,UAC7CA,EAAE,OACDA,EAAE,MAAM,MACR,OAAOA,EAAE,MAAM,MAAQ,EAAE,EAAE,YAAY,IAAM,SACrD,EAEA,GAAIkG,EAAU,CACZ,IAAMC,EACHD,EAAS,SACPA,EAAS,OAAO,OACfA,EAAS,OAAO,IAChBA,EAAS,OAAO,OACnBA,EAAS,KAAOA,EAAS,IAAI,OAC9B,KAIF,GAFIC,IAAYX,EAAQnF,EAAe8F,CAAU,GAAKX,GAElDU,EAAS,QAAUA,EAAS,OAAO,KAAM,CAC3C,IAAME,EAAe,OAAOF,EAAS,OAAO,IAAI,EAAE,YAAY,EAC1DR,EAAe,SAASU,CAAY,IACtCX,EAAuB,GAE3B,CACF,CACF,CACF,CAGID,IAAU,YACRD,EAAO,YACTC,EAAQnF,EAAekF,EAAO,WAAW,GAAKC,EACrCD,EAAO,QAChBC,EAAQnF,EAAekF,EAAO,KAAK,GAAKC,IAI5C,IAAMX,EAAIW,EACJxB,EAAS,CAAC,EAAEa,GAAK,gCAAgC,KAAKA,CAAC,GACvDZ,EAASY,GAAK,UACdX,EAAMF,GAAUG,EAASU,EAAG,GAAI,GAAM,mBACtCT,EAAKC,GAAiBQ,CAAC,GAAK,UAG9BlD,EAAW,OAAO4D,EAAO,OAAS,EAAE,EAAE,YAAY,IAAM,SACxDE,IAAsB9D,EAAW,IAGrC,IAAIG,EAAY,GAChB,GAAI,CAEF,IAAMuE,EAAkB,CAAC,EACvBd,EAAO,QACP,MAAM,QAAQA,EAAO,MAAM,GAC3BA,EAAO,OAAO,KACXe,GAAW,OAAOA,EAAE,MAAQ,EAAE,EAAE,YAAY,IAAM,SACrD,GAGEC,EAAY,EAEdZ,GACAA,EAAW,SACXA,EAAW,QAAQ,2BAEnBY,EAAYZ,EAAW,QAAQ,yBAAyB,WAAa,IAEnEU,GAAmBE,EAAY,KAAGzE,EAAY,GACpD,MAAY,CAAE,CAEd,IAAM7D,EAAW0D,EAAW,eAAiB,eACvC2C,EAAO,KAAK,WAAWrG,EAAU,GAAI4G,CAAC,EAEtCxC,EAAiBP,EACnB,sPAAsP,KAAK,WAAW,UAAW,EAAG,SAAS,CAAC,UAC9R,GAGA0E,EAAO,0EAA0ElE,EAAW2C,CAAK,CAAC,4FAA4F3C,EAAW2B,CAAM,CAAC,mCAAmC3B,EAAW4B,CAAE,CAAC,UAAU5B,EAAW8B,CAAE,CAAC,6DAA6D9B,EAAW2C,GAAS3D,EAAS,KAAOA,EAAS,GAAG,CAAC,IAAIC,EAAM,kBAAkBe,EAAWf,CAAG,CAAC,IAAM,EAAE,IAC9b,OAAAiF,GAAQ,gHAAgHlC,CAAI,GAAGjC,CAAc,UAC7ImE,GAAQ,4EAA4ElE,EAAW2C,CAAK,CAAC,UACjG3D,IACFkF,GAAQ,2EAA2ElE,EAAW,OAAOhB,CAAM,CAAC,CAAC,WAE/GkF,GAAQ,UACDA,CACT,CAKQ,yBAAyB/H,EAAiB,CAChD,IAAMgI,EAAMhI,EAAG,cAAc,OAAS,CAAC,EACvC,MAAI,CAACgI,GAAOA,EAAI,SAAW,EAAU,GAE9BA,EACJ,IAAK5C,GAAY,CAChB,IAAMoB,EAAQpB,EAAG,OAAS,IAAMA,EAAG,QAAU,KACvCS,EAAO,KAAK,WAAW,mBAAoB,EAAE,EAEnD,MAAO,wFAAwFhC,EAAW2C,CAAK,CAAC,gUAAgU3C,EAAW2C,CAAK,CAAC,KAAKX,CAAI,SAAShC,EAAW2C,CAAK,CAAC,gBACte,CAAC,EACA,KAAK,EAAE,CACZ,CAKQ,wBAAwBzG,EAA+B,CAwB7D,GAvBI,CAACA,GAAQ,CAAC,MAAM,QAAQA,EAAK,WAAW,GAuBxC,EApBc,KAAK,QAAU,KAAK,OAAO,KAAMJ,GAAW,CAC5D,IAAMsI,EAAO,OAAOtI,EAAE,UAAYA,EAAE,MAAQ,EAAE,EAAE,YAAY,EACtDwG,EAAO,OAAOxG,EAAE,MAAQ,EAAE,EAAE,YAAY,EAS9C,OARiBsI,IAAS,gBACxBA,IAAS,uBACT9B,IAAS,gBACTA,IAAS,cACTA,IAAS,aACTA,IAAS,UACTA,IAAS,aAKP,KAAK,gBACA,KAAK,gBAAgB,SAAS,OAAOxG,EAAE,EAAE,CAAC,EAE5C,GANe,EAOxB,CAAC,GAEe,OAAO,KAEvB,IAAMuI,EAAanI,EAAK,YAAY,KACjCE,GAAWA,GAAG,OAAS,qBAC1B,EAEA,GAAI,CAACiI,GAAc,CAACA,EAAW,OAAS,OAAOA,EAAW,KAAK,GAAK,EAClE,OAAO,KAGT,IAAMC,EAAQ,KAAK,IAAI,EAAG,KAAK,MAAM,OAAOD,EAAW,KAAK,GAAK,CAAC,CAAC,EAC7DE,EAAO,KAAK,IAAI,EAAG,KAAK,MAAM,OAAOF,EAAW,MAAQ,CAAC,CAAC,CAAC,EACjE,GAAIC,IAAU,EAAG,OAAO,KAExB,IAAME,EAAM,KAAK,MAAOD,EAAOD,EAAS,GAAG,EAErC7D,EAAY,SAAS,cAAc,KAAK,EAC9CA,EAAU,UAAY,iCACtBA,EAAU,aAAa,oBAAqB,QAAQ,EAGpD,IAAM1B,EACH7C,EAAK,UAAYA,EAAK,QAAQ,OAASA,EAAK,QAAQ,OACrDA,EAAK,OACJA,EAAK,KAAOA,EAAK,IAAI,OACtB,GACF,OAAAuE,EAAU,aAAa,oBAAqB1B,CAAS,EAErD0B,EAAU,MAAM,UAAY,MAC5BA,EAAU,MAAQ,GAAG8D,CAAI,OAAOD,CAAK,yBAAyBE,CAAG,uCAEjE/D,EAAU,UAAY;AAAA;AAAA,mIAEyG8D,CAAI,IAAID,CAAK;AAAA;AAAA,0CAEtGE,CAAG;AAAA;AAAA,oJAEuGA,CAAG;AAAA;AAAA,MAI5I/D,CACT,CAKO,qBACL1E,EACA0I,EAC4C,CAE5C,IAAMC,EAAaC,EAAiB,WAAW5I,EAAO0I,GAAiB,CAAC,CAAC,EACnEG,EAAM,IAAI,IAEhB,QAAWC,KAAKH,EAAY,CAC1B,IAAM9H,EAAMiI,EAAE,QAAU,CAAC,EACnBhI,EAAM,OAAOD,EAAI,IAAMA,EAAI,MAAQA,EAAI,OAAS,KAAK,OAAO,CAAC,EAE7DkI,EAAY,MAAM,QAAQD,EAAE,KAAK,EACnCA,EAAE,MAAM,IAAKlI,GAAaA,GAAMA,EAAG,KAAOA,EAAG,KAAOA,CAAG,EACvD,CAAC,EACLiI,EAAI,IAAI/H,EAAK,CAAE,OAAQD,EAAK,MAAOkI,CAAU,CAAC,CAChD,CAEA,OAAOF,CACT,CAMQ,qBACNxH,EACArB,EACA0I,EACa,CACb,IAAM7G,EAAS,SAAS,cAAc,KAAK,EAC3CA,EAAO,UAAY,wBACnBA,EAAO,MAAM,SAAW,SACxBA,EAAO,MAAM,IAAM,oCACnBA,EAAO,MAAM,OAAS,KACtBA,EAAO,MAAM,OAAS,UACtBA,EAAO,MAAM,WAAa,OAC1BA,EAAO,MAAM,WAAa,kCAG1B,IAAMmH,EAAW,SAAS,cAAc,KAAK,EAC7CA,EAAS,MAAM,QAAU,OACzBA,EAAS,MAAM,WAAa,SAC5BA,EAAS,MAAM,IAAM,MACrBA,EAAS,MAAM,QAAU,WACzBA,EAAS,MAAM,SAAW,SAC1BA,EAAS,MAAM,KAAO,IACtBA,EAAS,MAAM,MAAQ,cACvBA,EAAS,MAAM,WAAa,UAI5B,IAAMC,EAAc7G,GAAwB,KAAK,OAAQ,KAAK,SAAU,CAAE,OAAAf,EAAQ,MAAArB,CAAM,EAAG0I,EAAe,CAAE,cAAe,KAAK,aAAc,CAAC,EAC/IO,EAAY,UAAU,IAAI,yBAAyB,EAGnD,IAAMC,EAAWD,EAAY,cAAc,eAAe,EAC1D,OAAIC,IACFA,EAAS,UAAU,IAAI,sBAAsB,EAC7CA,EAAS,MAAM,QAAU,OAI3BD,EAAY,MAAM,QAAU,OAC5BA,EAAY,MAAM,WAAa,SAC/BA,EAAY,MAAM,IAAM,MACxBA,EAAY,MAAM,QAAU,IAC5BA,EAAY,MAAM,WAAa,cAE/BD,EAAS,YAAYC,CAAW,EAChCpH,EAAO,YAAYmH,CAAQ,EAEpBnH,CACT,CAKO,YACL6C,EACAlE,EACAkI,EACM,CAEN,IAAMS,EAAQ,SAAS,cAAc,OAAO,EAC5CA,EAAM,YAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAiDpBzE,EAAU,YAAYyE,CAAK,EAE3B,IAAMC,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,UAAY,kBAClBA,EAAM,MAAM,WAAa,kCAGzBA,EAAM,iBAAiB,QAAUvG,GAAM,CACrC,IAAMwG,EAASxG,EAAE,OAGXyG,EAAaD,EAAO,QAAQ,wBAAwB,EAC1D,GAAIC,EAAY,CAEd,IAAMvG,EADWuG,EAAW,cACH,cACvB,yBACF,EACMC,EAAaD,EAAW,cAAc,uBAAuB,EAC7DE,EAAczG,EAAQ,MAAM,UAAY,OAC9CA,EAAQ,MAAM,QAAUyG,EAAc,OAAS,OAC/CD,EAAW,UAAY,KAAK,WAC1BC,EAAc,gBAAkB,iBAChC,EACF,EACA,MACF,CAGA,IAAMC,EAAOJ,EAAO,QAAQ,qBAAqB,EACjD,GAAII,EAAM,CACR,IAAMjK,EAAQiK,EAAK,aAAa,mBAAmB,EAC7ChK,EAAQgK,EAAK,aAAa,mBAAmB,EACnD,GAAIjK,GAASC,EAAO,CAClB,KAAK,gBAAgBoD,EAAGrD,EAAOC,CAAK,EACpC,MACF,CACF,CAGA,IAAMyE,EAAUmF,EAAO,QAAQ,sBAAsB,EACrD,GAAInF,EAAS,CACXrB,EAAE,gBAAgB,EAClBA,EAAE,eAAe,EACjB,IAAM6G,EAASxF,EAAQ,aAAa,cAAc,EAClD,GAAI,KAAK,UAAYwF,EAAQ,CAC3B,IAAMvJ,EAAO,KAAK,SAAS,KACxBwJ,GAAM,OAAOA,EAAE,EAAE,IAAM,OAAOD,CAAM,CACvC,GAAK,CAAE,GAAIA,CAAO,EACZE,EAAO1F,EAAQ,sBAAsB,EAC3C,KAAK,SAAS,YAAa/D,EAAM,CAAE,EAAGyJ,EAAK,KAAM,EAAGA,EAAK,MAAO,CAAC,CACnE,CACA,MACF,CACF,CAAC,EAED,IAAMC,EAAe,KAAK,mBAAmB,KAAK,SAAUrJ,CAAW,EACjEsJ,EAAa,MAAM,KAAKD,EAAa,OAAO,CAAC,EAEnD,GAAInB,EAAe,CAEjB,IAAMqB,EAAa,SAAS,cAAc,KAAK,EAC/CA,EAAW,UAAY,wCAGN,IAAI,eAAeC,GAAW,CAC7C,IAAMC,EAASD,EAAQ,CAAC,GAAG,YAAY,OACnCC,GACFb,EAAM,MAAM,YAAY,yBAA0B,GAAGa,EAAS,EAAE,IAAI,CAExE,CAAC,EACQ,QAAQF,CAAU,EAE3B,QAAWG,KAAYJ,EAAY,CACjC,GACEI,EAAS,OAAO,KAAO,gBACvBA,EAAS,MAAM,SAAW,EAE1B,SAEF,IAAMC,EAAY,SAAS,cAAc,KAAK,EAC9CA,EAAU,UAAY,sBAGtB,IAAMtI,EAAS,KAAK,uBAAuBqI,EAAS,OAAQA,EAAS,MAAO1J,CAAW,EACvF2J,EAAU,YAAYtI,CAAM,EAC5BkI,EAAW,YAAYI,CAAS,CAClC,CACAf,EAAM,YAAYW,CAAU,EAG5BX,EAAM,MAAM,YAAY,yBAA0B,MAAM,EAGxD,IAAMgB,EAAY,KAAK,qBAAqB,KAAK,SAAU1B,CAAa,EAExE,OAAW,CAAC2B,EAAMC,CAAQ,IAAKF,EAAW,CACxC,GAAIC,IAAS,gBAAkBC,EAAS,MAAM,SAAW,EAAG,SAE5D,IAAMC,EAAgB,SAAS,cAAc,KAAK,EAClDA,EAAc,UAAY,iBAE1B,IAAM1I,EAAS,KAAK,qBAClByI,EAAS,OACTA,EAAS,MACT5B,CACF,EACA6B,EAAc,YAAY1I,CAAM,EAEhC,IAAM2I,EAAc,SAAS,cAAc,KAAK,EAChDA,EAAY,UAAY,yBAGxB,IAAMC,EAAiB,KAAK,mBAAmBH,EAAS,MAAO9J,CAAW,EAE1E,QAAW0J,KAAYJ,EAAY,CACjC,GACEI,EAAS,OAAO,KAAO,gBACvBA,EAAS,MAAM,SAAW,EAE1B,SAEF,IAAMQ,EAAS,OAAOR,EAAS,OAAO,IAAMA,EAAS,OAAO,MAAQ,EAAE,EAChES,EAAaF,EAAe,IAAIC,CAAM,GAAG,OAAS,CAAC,EAEnDE,EAAoB,SAAS,cAAc,KAAK,EACtDA,EAAkB,UAAY,qBAG9B,IAAM7B,EAAY,SAAS,cAAc,KAAK,EAC9CA,EAAU,MAAM,QAAU,OAC1BA,EAAU,MAAM,cAAgB,SAChCA,EAAU,MAAM,IAAM,MACtBA,EAAU,MAAM,KAAO,IAEvB,IAAMhH,EAAcC,EAAekI,EAAS,OAAO,KAAK,GAAK,UAC7D,QAAW/J,KAAQwK,EACjB5B,EAAU,YAAY,KAAK,WAAW5I,EAAMK,EAAauB,CAAW,CAAC,EAEvE6I,EAAkB,YAAY7B,CAAS,EAGvC,IAAM7G,EAAS,KAAK,uBAAuBgI,EAAS,OAAQ1J,CAAW,EACvE0B,EAAO,MAAM,UAAY,MACzBA,EAAO,MAAM,OAAS,mBACtB0I,EAAkB,YAAY1I,CAAM,EAEpCsI,EAAY,YAAYI,CAAiB,CAC3C,CAEAL,EAAc,YAAYC,CAAW,EACrCpB,EAAM,YAAYmB,CAAa,CACjC,CACF,KAAO,CAEL,IAAMM,EAAa,SAAS,cAAc,KAAK,EAC/CA,EAAW,UAAY,yBACvBA,EAAW,MAAM,OAAS,OAE1B,QAAWX,KAAYJ,EAAY,CACjC,GACEI,EAAS,OAAO,KAAO,gBACvBA,EAAS,MAAM,SAAW,EAE1B,SACF,IAAMtI,EAAO,KAAK,WAChBsI,EAAS,OACTA,EAAS,MACT1J,CACF,EACAqK,EAAW,YAAYjJ,CAAI,CAC7B,CACAwH,EAAM,YAAYyB,CAAU,CAC9B,CAEAnG,EAAU,YAAY0E,CAAK,CAC7B,CACF,ECx/CO,IAAM0B,GAAN,KAAiB,CAStB,YACEC,EACAC,EACAC,EACAC,EACA,CAVF,KAAQ,aAAmC,KAWzC,KAAK,UAAYH,EACjB,KAAK,MAAQC,EACb,KAAK,MAAQC,EACb,KAAK,UAAYC,GAAa,CAAC,CACjC,CAKO,QAAe,CACpB,KAAK,MAAM,EAGX,KAAK,aAAe,SAAS,cAAc,KAAK,EAChD,KAAK,aAAa,UAAY,cAC9B,KAAK,aAAa,MAAM,SAAW,WACnC,KAAK,aAAa,MAAM,MAAQ,OAEhC,GAAI,CACF,IAAMC,EAAS,aAAa,QAAQ,6BAA6B,EAC7DA,EAAQ,KAAK,aAAa,MAAM,MAAQA,EACvC,KAAK,aAAa,MAAM,MAAQ,OACvC,MAAY,CACV,KAAK,aAAa,MAAM,MAAQ,OAClC,CACA,KAAK,aAAa,MAAM,YAAc,OACtC,KAAK,aAAa,MAAM,WAAa,mCACrC,KAAK,aAAa,MAAM,OAAS,yCACjC,KAAK,aAAa,MAAM,aAAe,MACvC,KAAK,aAAa,MAAM,QAAU,OAClC,KAAK,aAAa,MAAM,cAAgB,SACxC,KAAK,aAAa,MAAM,SAAW,SACnC,KAAK,aAAa,MAAM,UAAY,QAGpC,IAAMC,EAAe,SAAS,cAAc,KAAK,EACjDA,EAAa,UAAY,4BACzBA,EAAa,MAAM,SAAW,WAC9BA,EAAa,MAAM,KAAO,MAC1BA,EAAa,MAAM,OAAS,MAC5BA,EAAa,MAAM,MAAQ,MAC3BA,EAAa,MAAM,UAAY,QAC/BA,EAAa,MAAM,SAAW,OAC9BA,EAAa,MAAM,WAAa,kBAChCA,EAAa,MAAM,MAAQ,QAC3BA,EAAa,MAAM,SAAW,OAC9BA,EAAa,MAAM,QAAU,MAC7BA,EAAa,MAAM,aAAe,MAClCA,EAAa,MAAM,OAAS,MAC5BA,EAAa,MAAM,QAAU,OAC7BA,EAAa,MAAQ,wCACrBA,EAAa,iBAAiB,QAAS,IAAM,CAC3CA,EAAa,MAAM,QACjBA,EAAa,MAAM,UAAY,OAAS,QAAU,MACtD,CAAC,EACD,KAAK,aAAa,YAAYA,CAAY,EAG1C,IAAMC,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,UAAY,sBACpBA,EAAQ,MAAM,SAAW,WACzBA,EAAQ,MAAM,IAAM,IACpBA,EAAQ,MAAM,MAAQ,IACtBA,EAAQ,MAAM,OAAS,IACvBA,EAAQ,MAAM,MAAQ,MACtBA,EAAQ,MAAM,OAAS,aACvBA,EAAQ,MAAM,OAAS,MACvB,KAAK,aAAa,YAAYA,CAAO,EAErC,IAAIC,EAAwB,KACxBC,EAA4B,KAE1BC,EAAeC,GAAkB,CACrC,GAAIH,GAAU,MAAQC,GAAc,KAAM,OAC1C,IAAMG,EAAKD,EAAE,MAAQH,EACfK,EAAO,KAAK,IAAI,IAAKJ,EAAaG,CAAE,EAC1C,KAAK,aAAc,MAAM,MAAQC,EAAO,IAC1C,EAEMC,EAAY,IAAM,CACtB,GAAIN,GAAU,KACd,UAAS,oBAAoB,YAAaE,CAAW,EACrD,SAAS,oBAAoB,UAAWI,CAAS,EACjD,GAAI,CACF,aAAa,QACX,8BACA,KAAK,aAAc,MAAM,KAC3B,CACF,MAAY,CAAC,CACbN,EAAS,KACTC,EAAa,KACf,EAEAF,EAAQ,iBAAiB,YAAcQ,GAAmB,CACxDA,EAAG,eAAe,EAClBP,EAASO,EAAG,MACZN,EAAa,KAAK,aAAe,KAAK,aAAa,YAAc,IACjE,SAAS,iBAAiB,YAAaC,CAAW,EAClD,SAAS,iBAAiB,UAAWI,CAAS,CAChD,CAAC,EAGD,IAAME,EAAS,SAAS,cAAc,KAAK,EAC3CA,EAAO,MAAM,QAAU,OACvBA,EAAO,MAAM,aAAe,yCAC5BA,EAAO,MAAM,QAAU,OACvBA,EAAO,MAAM,cAAgB,SAC7BA,EAAO,MAAM,IAAM,MAEnB,IAAMC,EAAY,SAAS,cAAc,KAAK,EAC9CA,EAAU,MAAM,QAAU,OAC1BA,EAAU,MAAM,WAAa,SAC7BA,EAAU,MAAM,IAAM,MAEtB,IAAMC,EAAa,SAAS,cAAc,MAAM,EAChDA,EAAW,YAAc,WACzBA,EAAW,MAAM,SAAW,OAC5BA,EAAW,MAAM,WAAa,MAC9BA,EAAW,MAAM,MAAQ,sCACzBA,EAAW,MAAM,cAAgB,YACjCA,EAAW,MAAM,cAAgB,QACjCD,EAAU,YAAYC,CAAU,EAGhC,IAAMC,EAAc,SAAS,cAAc,QAAQ,EACnDA,EAAY,YAAc,KAAK,MAAM,KACrCA,EAAY,MAAM,KAAO,IACzBA,EAAY,MAAM,QAAU,WAC5BA,EAAY,MAAM,WAAa,2CAC/BA,EAAY,MAAM,MAAQ,2CAC1BA,EAAY,MAAM,OAAS,wCAC3BA,EAAY,MAAM,aAAe,MACjCA,EAAY,MAAM,OAAS,UAC3BA,EAAY,MAAM,SAAW,OAC7BA,EAAY,MAAM,WAAa,MAC/BA,EAAY,MAAM,UAAY,OAC9BA,EAAY,MAAM,QAAU,OAC5BA,EAAY,MAAM,eAAiB,gBACnCA,EAAY,MAAM,WAAa,SAG/B,IAAMC,EAAQ,SAAS,cAAc,MAAM,EAC3CA,EAAM,YAAc,SACpBA,EAAM,MAAM,SAAW,OACvBA,EAAM,MAAM,WAAa,OACzBD,EAAY,YAAYC,CAAK,EAG7BD,EAAY,iBAAiB,QAAUR,GAAM,CAC3CA,EAAE,gBAAgB,EAClB,KAAK,kBAAkBQ,CAAW,CACpC,CAAC,EAEDF,EAAU,YAAYE,CAAW,EACjCH,EAAO,YAAYC,CAAS,EAE5B,KAAK,aAAa,YAAYD,CAAM,EAGpC,IAAMK,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,MAAM,KAAO,IACrBA,EAAQ,MAAM,SAAW,OACzBA,EAAQ,MAAM,QAAU,MAExB,KAAK,aAAaA,CAAO,EAEzB,KAAK,aAAa,YAAYA,CAAO,EACrC,KAAK,UAAU,YAAY,KAAK,YAAY,CAC9C,CAKQ,kBAAkBC,EAA2BC,EAAoC,CAEvF,IAAMC,EAAiB,IAAI,IAAI,CAC7B,YACA,gBACA,eACA,YACA,SACA,OACA,YACA,aACA,SACA,OACA,kBACF,CAAC,EAEKC,EAAkB,KAAK,UAAU,OAAQC,GAAM,CACnD,IAAMC,GAAYD,EAAE,UAAY,IAAI,YAAY,EAChD,OAAOF,EAAe,IAAIG,CAAQ,CACpC,CAAC,EAED,GAAIF,EAAgB,SAAW,EAAG,OAGlC,IAAMG,EAAW,SAAS,cAAc,KAAK,EAC7CA,EAAS,MAAM,SAAW,WAC1B,IAAMC,EAAON,GAA0CD,EAAa,sBAAsB,EACtFC,GAEFK,EAAS,MAAM,IAAM,GAAGC,EAAK,GAAG,KAChCD,EAAS,MAAM,KAAO,GAAGC,EAAK,MAAQ,CAAC,OAGvCD,EAAS,MAAM,IAAM,GAAGC,EAAK,OAAS,CAAC,KACvCD,EAAS,MAAM,KAAO,GAAGC,EAAK,IAAI,MAEpCD,EAAS,MAAM,SAAW,GAAGN,EAAa,WAAW,KACrDM,EAAS,MAAM,WAAa,oCAC5BA,EAAS,MAAM,OAAS,0CACxBA,EAAS,MAAM,aAAe,MAC9BA,EAAS,MAAM,UAAY,4BAC3BA,EAAS,MAAM,OAAS,OACxBA,EAAS,MAAM,UAAY,QAC3BA,EAAS,MAAM,UAAY,OAE3BH,EAAgB,QAASvB,GAAU,CACjC,IAAM4B,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,MAAM,QAAU,OACrBA,EAAK,MAAM,WAAa,SAGxB,IAAMC,EAAY,SAAS,cAAc,MAAM,EAC/CA,EAAU,MAAM,QAAU,eAC1BA,EAAU,MAAM,MAAQ,OACxBA,EAAU,MAAM,YAAc,MAC9BA,EAAU,MAAM,UAAY,SAC5BA,EAAU,YAAc7B,EAAM,KAAO,KAAK,MAAM,GAAK,SAAM,GAC3D6B,EAAU,MAAM,MAAQ,yCACxBD,EAAK,YAAYC,CAAS,EAG1B,IAAMC,EAAW,SAAS,cAAc,MAAM,EAC9CA,EAAS,MAAM,QAAU,cACzBA,EAAS,MAAM,WAAa,SAC5BA,EAAS,MAAM,eAAiB,SAChCA,EAAS,MAAM,MAAQ,OACvBA,EAAS,MAAM,YAAc,MAC7BA,EAAS,UAAY,KAAK,oBACvB9B,EAAM,UAAY,IAAI,SAAS,EAAE,YAAY,CAChD,EACA4B,EAAK,YAAYE,CAAQ,EAEzB,IAAMC,EAAY,SAAS,cAAc,MAAM,EAC/CA,EAAU,YAAc/B,EAAM,KAC9B4B,EAAK,YAAYG,CAAS,EAC1BH,EAAK,MAAM,QAAU,WACrBA,EAAK,MAAM,OAAS,UACpBA,EAAK,MAAM,SAAW,OACtBA,EAAK,MAAM,MAAQ,oCAEf5B,EAAM,KAAO,KAAK,MAAM,KAC1B4B,EAAK,MAAM,WAAa,+CACxBA,EAAK,MAAM,MAAQ,gDAGrBA,EAAK,iBAAiB,aAAc,IAAM,CACpC5B,EAAM,KAAO,KAAK,MAAM,KAC1B4B,EAAK,MAAM,WAAa,qCAE5B,CAAC,EAEDA,EAAK,iBAAiB,aAAc,IAAM,CACpC5B,EAAM,KAAO,KAAK,MAAM,KAC1B4B,EAAK,MAAM,WAAa,cAE5B,CAAC,EAEDA,EAAK,iBAAiB,QAAS,IAAM,CACnC,KAAK,MAAQ5B,EAEb,IAAMC,EAAQyB,EAAS,iBAAiB,KAAK,EAC7CH,EAAgB,QAAQ,CAAC,EAAGS,IAAQ,CAClC,IAAMC,EAAShC,EAAM+B,CAAG,EACxB,GAAI,CAACC,EAAQ,OACb,IAAMC,EAAcD,EAAO,cAAc,kBAAkB,EACvD,EAAE,KAAO,KAAK,MAAM,IACtBC,EAAY,YAAc,SAC1BD,EAAO,MAAM,WAAa,+CAC1BA,EAAO,MAAM,MAAQ,iDAErBC,EAAY,YAAc,GAC1BD,EAAO,MAAM,WAAa,cAC1BA,EAAO,MAAM,MAAQ,oCAEzB,CAAC,EACD,KAAK,OAAO,EACR,KAAK,uBACP,KAAK,sBAAsBjC,CAAK,EAGlC,GAAI,CAAO,OAAe,oBAAqB,OAAe,mBAAmB,CAAG,MAAY,CAAE,CACpG,CAAC,EAED0B,EAAS,YAAYE,CAAI,CAC3B,CAAC,EAGD,IAAMO,EAAW,SAAS,cAAc,KAAK,EAC7CA,EAAS,MAAM,SAAW,QAC1BA,EAAS,MAAM,IAAM,IACrBA,EAAS,MAAM,KAAO,IACtBA,EAAS,MAAM,MAAQ,IACvBA,EAAS,MAAM,OAAS,IACxBA,EAAS,MAAM,OAAS,MAExBA,EAAS,iBAAiB,QAAS,IAAM,CACvCT,EAAS,OAAO,EAChBS,EAAS,OAAO,CAClB,CAAC,EAED,SAAS,KAAK,YAAYA,CAAQ,EAClC,SAAS,KAAK,YAAYT,CAAQ,CACpC,CAMO,kBAAkBU,EAA4B,CACnD,GAAI,CACF,GAAI,CAAC,KAAK,aAAc,OACxB,IAAMC,EAAM,KAAK,aAAa,cAAc,QAAQ,EACpD,GAAI,CAACA,EAAK,OAEV,KAAK,kBAAkBA,EAAoBD,CAAU,CACvD,MAAY,CAAE,CAChB,CAKQ,mBAAmBX,EAA0B,CAEnD,GACE,OAAQ,OAAe,wBAA2B,YAClD,OAAQ,OAAe,YAAe,WACtC,CACA,IAAMa,EAAY,OAAe,uBAAuBb,CAAQ,EAChE,OAAQ,OAAe,WAAWa,CAAQ,CAC5C,CAGA,MAAO,eACT,CAKQ,aAAavC,EAA8B,CAEjD,IAAMwC,EAAc,KAAK,eAAe,EAExC,GAAIA,EAAY,OAAS,EAAG,CAC1B,IAAMC,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,YAAc,YACpBA,EAAM,MAAM,QAAU,MACtBA,EAAM,MAAM,MAAQ,sCACpBzC,EAAU,YAAYyC,CAAK,EAC3B,MACF,CAGA,IAAMC,EAAS,MAAM,KAAKF,EAAY,QAAQ,CAAC,EAAE,KAC/C,CAACG,EAAGC,IAAMA,EAAE,CAAC,EAAE,MAAQD,EAAE,CAAC,EAAE,KAC9B,EAGME,EAAyBC,GAAoB,CACjD,IAAMC,EAAc,CAClB,SAAU,KACV,YAAa,KACb,OAAQ,KACR,MAAO,KACP,KAAM,EACN,MAAO,EACP,IAAK,CACP,EACA,GAAI,CAACD,EAAY,OAAOC,EAGxB,IAAMC,EAAwB,CAAC,EAC3BF,EAAW,QAAQE,EAAY,KAAK,OAAOF,EAAW,MAAM,CAAC,EAC7DA,EAAW,IAAIE,EAAY,KAAK,OAAOF,EAAW,EAAE,CAAC,EACrDA,EAAW,KAAKE,EAAY,KAAK,OAAOF,EAAW,GAAG,CAAC,EACvDA,EAAW,OAAOE,EAAY,KAAK,OAAOF,EAAW,KAAK,CAAC,EAG/D,IAAMG,EAAQ,KAAK,MAAM,KAAMC,GAAW,CACxC,IAAMC,EAAKD,IAAMA,EAAE,SAAYA,EAAE,KAAOA,EAAE,IAAI,cAAkB,KAChE,GAAI,CAACC,EAAG,MAAO,GACf,IAAMC,EAAc,CAAC,EACjBD,EAAE,QAAQC,EAAE,KAAK,OAAOD,EAAE,MAAM,CAAC,EACjCA,EAAE,IAAIC,EAAE,KAAK,OAAOD,EAAE,EAAE,CAAC,EACzBA,EAAE,KAAKC,EAAE,KAAK,OAAOD,EAAE,GAAG,CAAC,EAC3BA,EAAE,OAAOC,EAAE,KAAK,OAAOD,EAAE,KAAK,CAAC,EAC/BA,EAAE,MAAMC,EAAE,KAAK,OAAOD,EAAE,IAAI,CAAC,EAC7BA,EAAE,KAAOA,EAAE,IAAI,QAAQC,EAAE,KAAK,OAAOD,EAAE,IAAI,MAAM,CAAC,EAClDA,EAAE,KAAOA,EAAE,IAAI,IAAIC,EAAE,KAAK,OAAOD,EAAE,IAAI,EAAE,CAAC,EAC1CA,EAAE,KAAOA,EAAE,IAAI,KAAKC,EAAE,KAAK,OAAOD,EAAE,IAAI,GAAG,CAAC,EAChD,QAASE,KAAKL,EACZ,QAASM,KAAKF,EACZ,GAAIC,GAAKC,GAAK,OAAOD,CAAC,IAAM,OAAOC,CAAC,EAAG,MAAO,GAGlD,MAAO,EACT,CAAC,EAED,GAAI,CAACL,EAAO,OAAOF,EAEnBA,EAAO,SAAWE,EAClB,IAAM7B,EACJ6B,EAAM,SAAYA,EAAM,KAAOA,EAAM,IAAI,aAAgB,KAW3D,GAVAF,EAAO,MACL3B,IAAYA,EAAQ,OAASA,EAAQ,MACjCA,EAAQ,OAASA,EAAQ,KACzB6B,EAAM,OAASA,EAAM,MAAQ,KACnCF,EAAO,OACL3B,GAAWA,EAAQ,OACf,OAAOA,EAAQ,MAAM,EACrB6B,EAAM,QAAUA,EAAM,IAAM,KAG9B,MAAM,QAAQA,EAAM,WAAW,EAAG,CACpC,IAAMM,EAAWN,EAAM,YAAY,KAChCO,GACCA,GAAKA,EAAE,OAAS,iBAAmBA,EAAE,QAAUA,EAAE,OAAO,IAC5D,EACA,GAAID,GAAYA,EAAS,OACvB,GAAI,CACF,IAAME,EACJF,EAAS,OAAO,OAChBA,EAAS,OAAO,IAChBA,EAAS,OAAO,MAChB,KACFR,EAAO,YAAcW,EAAeD,CAAC,GAAK,IAC5C,MAAY,CAAC,CAIf,IAAME,EAAMV,EAAM,YAAY,KAC3BO,GACCA,IACCA,EAAE,OAAS,uBACTA,EAAE,OAAS,MAAQA,EAAE,MAAQ,KACpC,EACIG,GAAOA,EAAI,OAAS,OACtBZ,EAAO,MAAQ,OAAOY,EAAI,OAAS,CAAC,EACpCZ,EAAO,KAAO,OAAOY,EAAI,MAAQ,CAAC,EAClCZ,EAAO,IACLA,EAAO,MAAQ,EACX,KAAK,MAAOA,EAAO,KAAOA,EAAO,MAAS,GAAG,EAC7C,EAEV,CAEA,OAAOA,CACT,EAGAL,EAAO,QAAQ,CAAC,CAACkB,EAAK,CAAE,MAAAC,EAAO,MAAAC,EAAO,SAAAC,CAAS,CAAC,IAAM,CACpD,IAAMlC,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAY,mBACjBA,EAAK,MAAM,QAAU,YACrBA,EAAK,MAAM,OAAS,UACpBA,EAAK,MAAM,aAAe,MAC1BA,EAAK,MAAM,aAAe,MAC1BA,EAAK,MAAM,QAAU,OACrBA,EAAK,MAAM,WAAa,SACxBA,EAAK,MAAM,IAAM,MACjBA,EAAK,MAAM,WAAa,8BAExB,IAAMH,GAAY,KAAK,MAAM,UAAY,IAAI,YAAY,EAGrDsC,EAA8B,KAC9BtC,IAAa,gBAAkBqC,IACjCC,EACED,EAAS,QACTA,EAAS,aACTA,EAAS,OACTA,EAAS,MACTA,EAAS,OACTA,GAIJ,IAAME,EAAa,SAAS,cAAc,KAAK,EAC/CA,EAAW,MAAM,QAAU,OAC3BA,EAAW,MAAM,WAAa,SAC9BA,EAAW,MAAM,IAAM,MACvBA,EAAW,MAAM,KAAO,WAGxB,IAAMC,EAAgBT,GAAqB,CACzC,IAAMU,EAAM,SAAS,cAAc,MAAM,EACzC,OAAAA,EAAI,MAAM,QAAU,eACpBA,EAAI,MAAM,MAAQ,OAClBA,EAAI,MAAM,OAAS,OACnBA,EAAI,MAAM,aAAe,MACzBA,EAAI,MAAM,WAAa,IACvBA,EAAI,MAAM,gBAAkBV,GAAK,sCAC1BU,CACT,EAEIC,EAAiB,GAGrB,GAAI1C,IAAa,aAAeqC,EAAU,CACxC,IAAMpB,EAAIoB,EACJM,EACJ1B,IAAMA,EAAE,WAAaA,EAAE,QAAUA,EAAE,UAAYA,EAAE,YACnD,GAAI0B,EAAW,CACb,IAAMC,EAAW,SAAS,cAAc,MAAM,EAC9CA,EAAS,UACP,gBACAC,EAAW5B,EAAE,OAASA,EAAE,MAAQA,EAAE,IAAM,EAAE,EAC1C,gKACA4B,EAAWF,CAAS,EACpB,8DACFJ,EAAW,YAAYK,CAAQ,EAC/BF,EAAiB,EACnB,MAEEH,EAAW,YAAYC,EAAa,IAAI,CAAC,EACzCE,EAAiB,EAErB,CAGA,GAAI,CAACA,GAAkB1C,IAAa,aAAc,CAChD,IAAM8C,EAAW,SAAS,cAAc,MAAM,EAC9CA,EAAS,UACP,8VACFP,EAAW,YAAYO,CAAQ,EAC/BJ,EAAiB,EACnB,CAGA,GAAI,CAACA,GAAkB1C,IAAa,eAAgB,CAClD,IAAM+C,EAAOT,EACTnB,EAAsBmB,CAAsB,EAC5C,KAEAU,EAAWD,GAAQA,EAAK,YAAcA,EAAK,YAAc,KAY7D,GAXI,CAACC,GAAYV,IACfU,EACEhB,EACEM,EAAuB,OACpBA,EAAuB,QACtBA,EAAuB,OAAO,OAChCA,EAAuB,aACvBA,EAAuB,QAAQ,KACnC,GAAK,MAIPA,IACCA,EAAuB,OACtBA,EAAuB,MACvBA,EAAuB,QACtBS,IAASA,EAAK,OAASA,EAAK,SAC/B,CACA,IAAME,EAAKT,EAAaQ,CAAQ,EAChCT,EAAW,YAAYU,CAAE,EACzBP,EAAiB,EACnB,CACF,CAGA,GAAI,CAACA,GAAkB1C,IAAa,UAAYqC,EAAU,CAExD,IAAMa,EAAMb,EACNc,EACJD,IAAQA,EAAI,OAASA,EAAI,WAAaA,EAAI,KAAOA,EAAI,MACjDE,EAAapB,EAAemB,CAAc,EAChDZ,EAAW,YAAYC,EAAaY,CAAU,CAAC,EAC/CV,EAAiB,EACnB,CAGA,GAAI,CAACA,EAAgB,CACnB,IAAIW,EAAgB,KASpB,GARIrD,IAAa,iBAAmBqC,GAAYA,EAAS,SACvDgB,EACEhB,EAAS,OAAO,OAASA,EAAS,OAAO,MAAQA,EAAS,OAAO,IAGjE,CAACgB,GAAYhB,IAAaA,EAAS,OAASA,EAAS,aACvDgB,EAAWhB,EAAS,OAASA,EAAS,WAEpC,CAACgB,GAAY,MAAM,QAAQ,KAAK,MAAM,OAAO,EAC/C,GAAI,CACF,IAAM9B,GAAS,KAAK,MAAM,SAAW,CAAC,GAAG,KACtCI,GACC,OAAOA,EAAE,IAAI,IAAM,OAAOO,CAAG,GAC7B,OAAOP,EAAE,EAAE,IACT,OACEU,IACGA,EAAS,UACPA,EAAS,QAAUA,EAAS,OAAO,GAC1C,CACN,EACId,IAAO8B,EAAW9B,EAAM,OAASA,EAAM,MAAQA,EAAM,GAC3D,MAAY,CAAC,CAEf,GACE,CAAC8B,GACD,KAAK,OACL,KAAK,MAAM,eACX,MAAM,QAAQ,KAAK,MAAM,cAAc,UAAU,EAEjD,GAAI,CACF,IAAMC,GAAQ,KAAK,MAAM,cAAc,YAAc,CAAC,GAAG,KACtDC,GACC,OAAOA,EAAG,KAAK,IAAM,OAAOrB,CAAG,GAC/B,OAAOqB,EAAG,EAAE,IACV,OACElB,IACGA,EAAS,aACPA,EAAS,WAAaA,EAAS,UAAU,GAChD,CACN,EACIiB,IACFD,EAAWC,EAAK,OAASA,EAAK,MAAQA,EAAK,OAASA,EAAK,GAC7D,MAAY,CAAC,CAEf,IAAMF,EAAapB,EAAeqB,CAAQ,EAC1Cd,EAAW,YAAYC,EAAaY,CAAU,CAAC,CACjD,CAEAjD,EAAK,YAAYoC,CAAU,EAG3B,IAAMiB,EAAc,SAAS,cAAc,KAAK,EAChDA,EAAY,MAAM,KAAO,IACzBA,EAAY,MAAM,QAAU,OAC5BA,EAAY,MAAM,cAAgB,SAClCA,EAAY,MAAM,SAAW,IAG7B,IAAIC,EAA4B,KAchC,GAbIzD,IAAa,iBACfyD,EAAQ,SAAS,cAAc,MAAM,EACrCA,EAAM,YAAcvB,EACpBuB,EAAM,MAAM,SAAW,OACvBA,EAAM,MAAM,WAAa,MAEzBA,EAAM,MAAM,WAAa,SACzBA,EAAM,MAAM,UAAY,aACxBA,EAAM,MAAM,SAAW,SACvBD,EAAY,YAAYC,CAAK,GAI3BzD,IAAa,gBAAiB,CAEhC,IAAI0D,EAA0B,KAC9B,GAAI,CACF,GAAIrB,GAAYA,EAAS,QAAUA,EAAS,OAAO,YACjDqB,EAAWrB,EAAS,OAAO,oBACpB,MAAM,QAAQ,KAAK,MAAM,OAAO,EAAG,CAC1C,IAAMd,GAAS,KAAK,MAAM,SAAW,CAAC,GAAG,KACtCI,GACC,OAAOA,EAAE,IAAI,IAAM,OAAOO,CAAG,GAC7B,OAAOP,EAAE,EAAE,IACT,OACEU,IACGA,EAAS,UACPA,EAAS,QAAUA,EAAS,OAAO,GAC1C,CACN,EACId,GAASA,EAAM,cAAamC,EAAWnC,EAAM,YACnD,CACF,MAAY,CAAC,CAEb,GAAImC,EAAU,CACZ,IAAMC,EAAO,SAAS,cAAc,MAAM,EAC1CA,EAAK,YAAcD,EACnBC,EAAK,MAAM,SAAW,OACtBA,EAAK,MAAM,MAAQ,sCACnBA,EAAK,MAAM,WAAa,SACxBA,EAAK,MAAM,UAAY,aACvBA,EAAK,MAAM,SAAW,SACtBA,EAAK,MAAM,UAAY,QACvBH,EAAY,YAAYG,CAAI,CAC9B,CACF,CAGA,GAAI3D,IAAa,gBAAkBqC,EAAU,CAC3C,IAAMuB,EACJtB,GACAD,EAAS,QACTA,EAAS,aACTA,EAAS,OACTA,EAAS,MACTA,EAAS,OACT,KACIU,EAAO5B,EAAsByC,CAAC,EAE9BC,EAAYd,EAAK,OAAUa,IAAMA,EAAE,OAASA,EAAE,OAAU1B,EACxD4B,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,MAAM,QAAU,OACxBA,EAAQ,MAAM,IAAM,MACpBA,EAAQ,MAAM,WAAa,WAC3B,IAAMC,EAAQ,SAAS,cAAc,MAAM,EAErCC,EAAiB,OAAOH,CAAS,EAAE,MAAM,EAAG,GAAG,EAYrD,GAXAE,EAAM,YAAchB,EAAK,OACrB,GAAGiB,CAAc,KAAK,OAAOjB,EAAK,MAAM,CAAC,GACzCiB,EACJD,EAAM,MAAM,SAAW,OACvBA,EAAM,MAAM,WAAa,MACzBA,EAAM,MAAM,WAAa,SACzBA,EAAM,MAAM,UAAY,aACxBD,EAAQ,YAAYC,CAAK,EACzBP,EAAY,YAAYM,CAAO,EAG3Bf,EAAK,OAASA,EAAK,MAAQ,EAAG,CAChC,IAAMkB,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,MAAM,QAAU,OACxBA,EAAQ,MAAM,WAAa,SAC3BA,EAAQ,MAAM,IAAM,MACpBA,EAAQ,MAAM,UAAY,MAE1B,IAAMC,EAAW,SAAS,cAAc,KAAK,EAC7CA,EAAS,YAAc,GAAGnB,EAAK,IAAI,IAAIA,EAAK,KAAK,GACjDmB,EAAS,MAAM,MAAQ,sCACvBA,EAAS,MAAM,SAAW,OAC1BA,EAAS,MAAM,mBAAqB,eACpCD,EAAQ,YAAYC,CAAQ,EAE5B,IAAMC,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,MAAM,QAAU,eACpBA,EAAI,MAAM,MAAQ,QAClBA,EAAI,MAAM,OAAS,OACnBA,EAAI,MAAM,WAAa,cACvBA,EAAI,MAAM,OAAS,sCACnBA,EAAI,MAAM,aAAe,MACzBA,EAAI,MAAM,SAAW,SACrB,IAAMC,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,MAAM,OAAS,OACpBA,EAAK,MAAM,MAAQ,OAAOrB,EAAK,GAAG,EAAI,IACtCqB,EAAK,MAAM,WAAa,4BACxBD,EAAI,YAAYC,CAAI,EACpBH,EAAQ,YAAYE,CAAG,EAEvBX,EAAY,YAAYS,CAAO,CACjC,CACF,CAGA,GAAIjE,IAAa,YACf,GAAI,CAEF,IAAMqE,EACHhC,IACEA,EAAS,WAAaA,EAAS,eAAiBA,IACnD,KACEiC,EAAqB,KACzB,GACED,GACAA,EAAQ,YACPA,EAAQ,UAAYA,EAAQ,QAE7BC,EAAgBD,UAEhB,KAAK,OACL,KAAK,MAAM,eACX,MAAM,QAAQ,KAAK,MAAM,cAAc,UAAU,EACjD,CACA,IAAM9C,GAAS,KAAK,MAAM,cAAc,YAAc,CAAC,GAAG,KACvDgC,GACC,OAAOA,EAAG,OAASA,EAAG,IAAI,IAAM,OAAOrB,CAAG,GAC1C,OAAOqB,EAAG,EAAE,IACV,OACElB,IACGA,EAAS,aACPA,EAAS,WAAaA,EAAS,UAAU,GAChD,CACN,EACId,IAAO+C,EAAgB/C,EAC7B,CAEA,GAAI+C,EAAe,CACjB,IAAMC,EAAQD,EAAc,WAAaA,EAAc,MACjDE,EACJF,EAAc,UACdA,EAAc,QACdA,EAAc,KAChB,GAAIC,GAASC,EAAU,CACrB,IAAMC,EAAI,IAAI,KAAKF,CAAK,EAClBvF,EAAI,IAAI,KACZyF,EAAE,QAAQ,EAAI,OAAOD,GAAY,CAAC,EAAI,GAAK,GAAK,GAAK,GACvD,EACME,EAAOD,EAAE,mBAAmB,QAAS,CACzC,MAAO,QACP,IAAK,SACP,CAAC,EACKE,EAAO3F,EAAE,mBAAmB,QAAS,CACzC,MAAO,QACP,IAAK,SACP,CAAC,EACK4F,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,YAAc,GAAGF,CAAI,WAAMC,CAAI,GACvCC,EAAQ,MAAM,SAAW,OACzBA,EAAQ,MAAM,MAAQ,sCACtBA,EAAQ,MAAM,UAAY,MAC1BpB,EAAY,YAAYoB,CAAO,CACjC,CACF,CACF,MAAY,CAAC,CAGfzE,EAAK,YAAYqD,CAAW,EAG5B,IAAMqB,EAAc,SAAS,cAAc,MAAM,EACjDA,EAAY,MAAM,QAAU,cAC5BA,EAAY,MAAM,WAAa,SAC/BA,EAAY,MAAM,eAAiB,SACnCA,EAAY,MAAM,SAAW,OAC7BA,EAAY,MAAM,OAAS,OAC3BA,EAAY,MAAM,aAAe,MACjCA,EAAY,MAAM,WAAa,iCAC/BA,EAAY,MAAM,OAAS,uCAC3BA,EAAY,MAAM,MAAQ,2BAC1BA,EAAY,MAAM,SAAW,OAC7BA,EAAY,MAAM,WAAa,MAC/BA,EAAY,MAAM,QAAU,QAC5BA,EAAY,MAAM,UAAY,aAC9BA,EAAY,YAAc,OAAOzC,CAAK,EAEtCjC,EAAK,YAAY0E,CAAW,EAG5B1E,EAAK,iBAAiB,aAAc,IAAM,CACxCA,EAAK,MAAM,WAAa,oCAC1B,CAAC,EAEDA,EAAK,iBAAiB,aAAc,IAAM,CACxCA,EAAK,MAAM,WAAa,aAC1B,CAAC,EAGDA,EAAK,iBAAiB,QAAS,IAAM,CAC/B,KAAK,uBACP,KAAK,sBAAsBgC,CAAK,CAEpC,CAAC,EAED7D,EAAU,YAAY6B,CAAI,CAC5B,CAAC,CACH,CAKQ,gBAGN,CACA,IAAM2E,EAAS,IAAI,IAKb9E,GAAY,KAAK,MAAM,UAAY,IAAI,YAAY,EAEzD,YAAK,MAAM,QAASG,GAAS,CAC3B,IAAM4E,EAAK5E,EAAK,aAAa,KAC1BJ,GACCA,EAAE,UAAY,KAAK,MAAM,IAAMA,EAAE,YAAc,KAAK,MAAM,IAC9D,EACA,GAAI,CAACgF,EAAI,CACP,IAAM7C,EAAM,UACN8C,EAAWF,EAAO,IAAI5C,CAAG,EAC3B8C,EAAUA,EAAS,QAClBF,EAAO,IAAI5C,EAAK,CAAE,MAAO,KAAM,MAAO,EAAG,SAAU,IAAK,CAAC,EAC9D,MACF,CAGA,GAAIlC,IAAa,SAAU,CAEzB,IAAMiF,EACJF,EAAG,QAAU,MAAM,QAAQA,EAAG,OAAO,KAAK,EACtCA,EAAG,OAAO,MACV,MAAM,QAAQA,EAAG,MAAM,EACrBA,EAAG,OACH,KACR,GAAI,MAAM,QAAQE,CAAS,GAAKA,EAAU,OAAS,EAAG,CACpDA,EAAU,QAAS/B,GAAa,CAC9B,IAAMgC,EACJhC,IAAQA,EAAI,MAAQA,EAAI,OACpB,OAAOA,EAAI,MAAQA,EAAI,KAAK,EAC5B,UACAhB,EAAM,KAAK,YAAYgD,CAAI,EAC3BF,EAAWF,EAAO,IAAI5C,CAAG,EAC3B8C,EAAUA,EAAS,QAClBF,EAAO,IAAI5C,EAAK,CAAE,MAAOgD,EAAM,MAAO,EAAG,SAAUhC,CAAI,CAAC,CAC/D,CAAC,EACD,MACF,CACF,CAEA,GAAIlD,IAAa,YAAa,CAC5B,IAAMmF,EAAMJ,EAAG,YAAcA,EAAG,SAAW,CAACA,EAAG,QAAQ,EAAI,MAC3D,GAAI,MAAM,QAAQI,CAAG,GAAKA,EAAI,OAAS,EAAG,CACxCA,EAAI,QAASlE,GAAW,CACtB,IAAMiE,EAAO,OAAOjE,EAAE,OAASA,EAAE,MAAQA,EAAE,IAAM,WAAW,EACtDiB,EAAM,KAAK,YAAYgD,CAAI,EAC3BF,EAAWF,EAAO,IAAI5C,CAAG,EAC3B8C,EAAUA,EAAS,QAClBF,EAAO,IAAI5C,EAAK,CAAE,MAAOjB,EAAG,MAAO,EAAG,SAAUA,CAAE,CAAC,CAC1D,CAAC,EACD,MACF,CACF,CAGA,IAAIkB,EAAa,KACbE,EAAgB,KAEpB,GAAI,CACF,GAAIrC,IAAa,gBACfmC,EAAQ4C,EAAG,QAAQ,MAAQA,EAAG,MAAQA,EAAG,MACzC1C,EAAW0C,UACF/E,IAAa,YACtBmC,EAAQ4C,EAAG,WAAW,OAASA,EAAG,OAASA,EAAG,MAC9C1C,EAAW0C,UACF/E,IAAa,eAAgB,CACtC,IAAM4D,EACJmB,EAAG,QACHA,EAAG,aACHA,EAAG,OACHA,EAAG,MACHA,EAAG,OACH,KACEnB,IAAGzB,EAAQyB,EAAE,OAASA,EAAE,MAAQA,EAAE,QAAUA,EAAE,IAAMA,EAAE,KAAO,MACjEvB,EAAWuB,GAAKmB,CAClB,MAAW/E,IAAa,aACtBmC,EAAQ4C,EAAG,WAAW,OAASA,EAAG,WAAW,MAAQA,EAAG,OAAS,KACjE1C,EAAW0C,EAAG,WAAaA,GAClB/E,IAAa,cACtBmC,EACE4C,EAAG,YAAY,eACfA,EAAG,YAAY,WACfA,EAAG,YAAY,MACfA,EAAG,OACH,KACF1C,EAAW0C,EAAG,YAAcA,GACnB/E,IAAa,UACtBmC,EAAQ4C,EAAG,QAAU,KAAOA,EAAG,OAASA,EAAG,MAC3C1C,EAAW0C,GACF/E,IAAa,QACtBmC,EAAQ4C,EAAG,MAAQA,EAAG,OAAS,KAC/B1C,EAAW0C,IAGX5C,EAAQ4C,EAAG,MAAQA,EAAG,OAASA,EAAG,OAAS,KAC3C1C,EAAW0C,EAEf,MAAY,CACV5C,EAAQ4C,EAAG,MAAQA,EAAG,OAASA,EAAG,OAAS,KAC3C1C,EAAW0C,CACb,CAEA,IAAM7C,EACJC,GAAU,MAA+BA,IAAU,GAC/C,UACA,KAAK,YAAYA,CAAK,EACtB6C,EAAWF,EAAO,IAAI5C,CAAG,EAC3B8C,EAAUA,EAAS,QAClBF,EAAO,IAAI5C,EAAK,CAAE,MAAAC,EAAO,MAAO,EAAG,SAAAE,CAAS,CAAC,CACpD,CAAC,EAEMyC,CACT,CAKQ,aAAaM,EAAsB,CAEzC,IAAMpF,GAAY,KAAK,MAAM,UAAY,IAAI,YAAY,EACzD,OAAKoF,EACDpF,IAAa,gBACRoF,EAAW,QAAQ,MAAQA,EAAW,MAAQA,EAAW,MAC9DpF,IAAa,YAEboF,EAAW,WAAW,OAASA,EAAW,OAASA,EAAW,MAE9DpF,IAAa,YACRoF,EAAW,WAAaA,EAAW,UAAY,KACpDpF,IAAa,SAAiBoF,EAAW,QAAU,KACnDpF,IAAa,eAEboF,EAAW,QACXA,EAAW,aACXA,EAAW,OACXA,EAAW,MACXA,EAAW,OACX,KAEApF,IAAa,YACRoF,EAAW,WAAaA,EAAW,OAAS,KACjDpF,IAAa,aACRoF,EAAW,YAAcA,EAAW,OAAS,KAClDpF,IAAa,SACRoF,EAAW,QAAU,KAAOA,EAAW,OAASA,EAAW,MAChEpF,IAAa,OAAeoF,EAAW,MAAQA,EAAW,OAAS,KAChEA,EAAW,MAAQA,EAAW,OAASA,EAAW,OAAS,KA1B1C,IA2B1B,CAKQ,YAAYjD,EAAoB,CACtC,OAAIA,GAAU,KACL,UAEF,OAAOA,CAAK,CACrB,CAKO,cAAckD,EAAsC,CACzD,KAAK,sBAAwBA,CAC/B,CAKO,cAAcA,EAAsC,CACzD,KAAK,sBAAwBA,CAC/B,CAKO,OAAc,CACf,KAAK,eACP,KAAK,aAAa,OAAO,EACzB,KAAK,aAAe,KAExB,CACF,ECpiCO,SAASC,GAAkBC,EAAsC,CACtE,GAAI,CAACA,GAAgB,CAACA,EAAa,OAASA,EAAa,MAAM,SAAW,EACxE,OAAO,KAGT,IAAMC,EAAUD,EAAa,MAAM,CAAC,EACpC,GAAI,CAACC,GAAW,CAACA,EAAQ,MACvB,OAAO,KAGT,IAAMC,EAAqB,CACzB,QAASD,EAAQ,MAAM,IAAMA,EAAQ,MAAM,KAC3C,UAAWA,EAAQ,WAAa,KAClC,EAGA,GAAID,EAAa,MAAM,OAAS,EAAG,CACjC,IAAMG,EAAYH,EAAa,MAAM,CAAC,EAClCG,GAAaA,EAAU,QACzBD,EAAO,UAAY,CACjB,QAASC,EAAU,MAAM,IAAMA,EAAU,MAAM,KAC/C,UAAWA,EAAU,WAAa,KACpC,EAEJ,CAEA,OAAOD,CACT,CAKO,SAASE,GACdC,EACAC,EACAC,EACO,CACP,GAAI,CAACA,GAAcF,EAAM,SAAW,EAClC,OAAOA,EAGT,IAAMG,EAAQF,EAAO,KAClBG,GAAMA,EAAE,KAAOF,EAAW,SAAWE,EAAE,OAASF,EAAW,OAC9D,EACA,GAAI,CAACC,EACH,OAAOH,EAIT,IAAMK,EAAS,CAAC,GAAGL,CAAK,EAExB,OAAAK,EAAO,KAAK,CAACC,EAAGC,IAAM,CAEpB,IAAMC,EAAgBC,GAAmBH,EAAGC,EAAGJ,EAAOD,EAAW,SAAS,EAG1E,GAAIM,IAAkB,GAAKN,EAAW,UAAW,CAC/C,IAAMQ,EAAiBT,EAAO,KAC3BG,GACCA,EAAE,KAAOF,EAAW,UAAW,SAC/BE,EAAE,OAASF,EAAW,UAAW,OACrC,EACA,GAAIQ,EACF,OAAOD,GACLH,EACAC,EACAG,EACAR,EAAW,UAAU,SACvB,CAEJ,CAEA,OAAOM,CACT,CAAC,EAEMH,CACT,CAKO,SAASI,GACdH,EACAC,EACAJ,EACAQ,EACQ,CAER,IAAMC,EAASC,GAAcP,EAAGH,CAAK,EAC/BW,EAASD,GAAcN,EAAGJ,CAAK,EAGrC,GAAIS,IAAW,MAAQE,IAAW,KAAM,MAAO,GAC/C,GAAIF,IAAW,KAAM,OAAOD,IAAc,MAAQ,EAAI,GACtD,GAAIG,IAAW,KAAM,OAAOH,IAAc,MAAQ,GAAK,EAEvD,IAAII,EAAS,EAGb,QAFkBZ,EAAM,UAAY,IAAI,YAAY,EAElC,CAChB,IAAK,OACL,IAAK,QACHY,EAASC,GAAYJ,EAAQE,CAAM,EACnC,MAEF,IAAK,SACHC,EAASE,GAAcL,EAAQE,CAAM,EACrC,MAEF,IAAK,OACHC,EAASG,GAAYN,EAAQE,CAAM,EACnC,MAEF,IAAK,gBACHC,EAASI,GAAoBP,EAAQE,EAAQX,CAAK,EAClD,MAEF,IAAK,YACHY,EAASK,GAAiBR,EAAQE,CAAM,EACxC,MAEF,IAAK,SACHC,EAASM,GAAcT,EAAQE,CAAM,EACrC,MAEF,IAAK,YACL,IAAK,aACL,IAAK,YACL,IAAK,aACL,IAAK,eACL,IAAK,aACL,IAAK,SACL,IAAK,YACHC,EAASC,GAAYJ,EAAQE,CAAM,EACnC,MAEF,IAAK,uBACL,IAAK,sBACHC,EAASE,GAAcL,EAAQE,CAAM,EACrC,MAEF,QAGEC,EAAS,CACb,CAEA,OAAOJ,IAAc,MAAQI,EAAS,CAACA,CACzC,CAKA,SAASF,GAAcS,EAAWnB,EAAyB,CACzD,IAAMoB,EAAaD,EAAK,aAAa,KAClCE,GAAYA,EAAG,UAAYrB,EAAM,IAAMqB,EAAG,YAAcrB,EAAM,IACjE,EAEA,GAAI,CAACoB,EAAY,OAAO,KAIxB,QAFkBpB,EAAM,UAAY,IAAI,YAAY,EAElC,CAChB,IAAK,OAGH,OAAIoB,EAAW,MAAQ,KAAaA,EAAW,KACxCE,GAAuBF,EAAYD,CAAI,EAGhD,IAAK,QAEH,OAAOG,GAAuBF,EAAYD,CAAI,EAGhD,IAAK,SACH,OAAOC,EAAW,SAAW,OAAYA,EAAW,OAAS,KAE/D,IAAK,OACH,OACEA,EAAW,MAAQA,EAAW,WAAaA,EAAW,OAAS,KAGnE,IAAK,gBACH,OAAOA,EAAW,QAAUA,EAE9B,IAAK,YACH,OAAOA,EAET,IAAK,SACH,OAAOA,EAAW,QAAU,CAAC,EAE/B,IAAK,YAAa,CAChB,IAAMG,EAAOH,EAAW,UACxB,GAAI,MAAM,QAAQG,CAAI,GAAKA,EAAK,OAAS,EAAG,CAC1C,IAAMC,EAAQD,EAAK,CAAC,EACpB,OAAOC,EAAM,OAASA,EAAM,MAAQ,IACtC,CACA,OAAO,IACT,CAEA,IAAK,aAAc,CACjB,IAAMC,EAAOL,EAAW,WACxB,OAAKK,IAEHA,EAAK,eAAiBA,EAAK,MAAQA,EAAK,WAAaA,EAAK,KAAM,IAEpE,CAEA,IAAK,YAAa,CAChB,IAAMC,EAAIN,EAAW,UACrB,OAAKM,IAGEA,EAAE,OAASA,EAAE,OAASA,EAAE,OAAQ,IACzC,CAEA,IAAK,aACH,OAAIN,EAAW,KAAaA,EAAW,KACnCA,EAAW,SACNA,EAAW,OAAO,MAAQA,EAAW,OAAO,QAAS,KAKhE,IAAK,eAAgB,CACnB,IAAMO,EAASP,EAAW,OAC1B,OAAKO,EACDA,EAAO,MAAcA,EAAO,MAC5B,OAAOA,EAAO,QAAW,SAAiB,OAAOA,EAAO,MAAM,EAC3DA,EAAO,IAAM,KAHA,IAItB,CAEA,IAAK,uBAAwB,CAC3B,IAAMC,EAAMR,EAAW,aACvB,GAAI,MAAM,QAAQQ,CAAG,GAAKA,EAAI,OAAS,EAAG,CACxC,IAAMJ,EAAQI,EAAI,CAAC,EACnB,OAAI,OAAOJ,EAAM,QAAW,SAAiBA,EAAM,OAC5CA,EAAM,OAAS,IACxB,CACA,OAAO,IACT,CAEA,IAAK,YAAa,CAChB,IAAMD,EAAOH,EAAW,UACxB,GAAI,MAAM,QAAQG,CAAI,GAAKA,EAAK,OAAS,EAAG,CAC1C,IAAMC,EAAQD,EAAK,CAAC,EACpB,OAAOC,EAAM,OAASA,EAAM,MAAQA,EAAM,IAAM,IAClD,CACA,OAAO,IACT,CAEA,IAAK,sBACH,OAAI,OAAOJ,EAAW,SAAY,SAAiBA,EAAW,QAE5D,OAAOA,EAAW,MAAS,UAC3B,OAAOA,EAAW,OAAU,UAC5BA,EAAW,MAAQ,EAEXA,EAAW,KAAOA,EAAW,MAAS,IAEzC,KAGT,IAAK,aACL,IAAK,SAAU,CACb,IAAMS,EAAST,EAAW,OAC1B,GAAI,MAAM,QAAQS,CAAM,GAAKA,EAAO,OAAS,EAAG,CAC9C,IAAML,EAAQK,EAAO,CAAC,EACtB,OAAIL,EAAM,MAAcA,EAAM,MAC1B,OAAOA,EAAM,QAAW,SAAiB,OAAOA,EAAM,MAAM,EACzDA,EAAM,IAAM,IACrB,CACA,OAAO,IACT,CAEA,QACE,OAAOJ,CACX,CACF,CAEA,SAASE,GAAuBF,EAAiBD,EAA0B,CACzE,GAAI,CAACC,EAAY,OAAO,KAGxB,IAAMU,EACHV,EAAW,OAASA,EAAW,MAAM,KAAQA,EAAW,KAAO,KAClE,GAAIU,GAAW,OAAOA,EAAQ,MAAS,UAAYA,EAAQ,KAAK,KAAK,EACnE,OAAOA,EAAQ,KAIjB,IAAMC,EACHX,EAAW,OAASA,EAAW,MAAM,SACtCA,EAAW,SACVU,GAAWA,EAAQ,aACnBX,GAAQA,EAAK,SACd,KAEF,GAAIY,EAAS,CACX,GAAI,OAAOA,GAAY,UAAYA,EAAQ,KAAK,EAC9C,OAAOA,EAET,GAAI,OAAOA,EAAQ,OAAU,UAAYA,EAAQ,MAAM,KAAK,EAC1D,OAAOA,EAAQ,MAEjB,GAAI,OAAOA,EAAQ,MAAS,UAAYA,EAAQ,KAAK,KAAK,EACxD,OAAOA,EAAQ,IAEnB,CAGA,OAAI,OAAOX,EAAW,MAAS,UAAYA,EAAW,KAAK,KAAK,EACvDA,EAAW,KAEhBU,GAAW,OAAOA,EAAQ,OAAU,UAAYA,EAAQ,MAAM,KAAK,EAC9DA,EAAQ,MAGV,IACT,CAKA,SAASjB,GAAYV,EAAQC,EAAgB,CAC3C,IAAM4B,EAAO,OAAO7B,GAAK,EAAE,EAAE,YAAY,EACnC8B,EAAO,OAAO7B,GAAK,EAAE,EAAE,YAAY,EACzC,OAAO4B,EAAK,cAAcC,CAAI,CAChC,CAKA,SAASnB,GAAcX,EAAQC,EAAgB,CAC7C,IAAM8B,EAAO,OAAO/B,GAAM,SAAWA,EAAI,WAAWA,CAAC,EAC/CgC,EAAO,OAAO/B,GAAM,SAAWA,EAAI,WAAWA,CAAC,EAErD,OAAI,MAAM8B,CAAI,GAAK,MAAMC,CAAI,EAAU,EACnC,MAAMD,CAAI,EAAU,EACpB,MAAMC,CAAI,EAAU,GAEjBD,EAAOC,CAChB,CAKA,SAASpB,GAAYZ,EAAQC,EAAgB,CAC3C,IAAMgC,EAAQ,IAAI,KAAKjC,CAAC,EAClBkC,EAAQ,IAAI,KAAKjC,CAAC,EAExB,OAAI,MAAMgC,EAAM,QAAQ,CAAC,GAAK,MAAMC,EAAM,QAAQ,CAAC,EAAU,EACzD,MAAMD,EAAM,QAAQ,CAAC,EAAU,EAC/B,MAAMC,EAAM,QAAQ,CAAC,EAAU,GAE5BD,EAAM,QAAQ,EAAIC,EAAM,QAAQ,CACzC,CAKA,SAASrB,GAAoBb,EAAQC,EAAQJ,EAA4B,CACvE,IAAMsC,EAAUnC,EAAE,QAAUA,EACtBoC,EAAUnC,EAAE,QAAUA,EAE5B,GAAI,CAACkC,GAAW,CAACC,EACf,OAAO1B,GAAYyB,GAAS,MAAQ,GAAIC,GAAS,MAAQ,EAAE,EAI7D,GAAIvC,EAAM,SAAW,MAAM,QAAQA,EAAM,OAAO,EAAG,CACjD,IAAMwC,EAASxC,EAAM,QAAQ,UAC1ByC,GAAaA,EAAI,KAAOH,EAAQ,IAAMG,EAAI,OAASH,EAAQ,IAC9D,EACMI,EAAS1C,EAAM,QAAQ,UAC1ByC,GAAaA,EAAI,KAAOF,EAAQ,IAAME,EAAI,OAASF,EAAQ,IAC9D,EAEA,GAAIC,IAAW,IAAME,IAAW,GAC9B,OAAOF,EAASE,CAEpB,CAGA,OAAO7B,GAAYyB,EAAQ,KAAMC,EAAQ,IAAI,CAC/C,CAKA,SAAStB,GAAiBd,EAAQC,EAAgB,CAChD,IAAMgC,EAAQjC,EAAE,WAAaA,EAAE,WAAW,UACpCkC,EAAQjC,EAAE,WAAaA,EAAE,WAAW,UAE1C,MAAI,CAACgC,GAAS,CAACC,EAENxB,GACLV,EAAE,OAASA,EAAE,WAAW,MACxBC,EAAE,OAASA,EAAE,WAAW,KAC1B,EAGKW,GAAYqB,EAAOC,CAAK,CACjC,CAKA,SAASnB,GAAcf,EAAQC,EAAgB,CAC7C,IAAMuC,EAAU,MAAM,QAAQxC,CAAC,EAAIA,EAAI,CAAC,EAClCyC,EAAU,MAAM,QAAQxC,CAAC,EAAIA,EAAI,CAAC,EAExC,OAAIuC,EAAQ,SAAW,GAAKC,EAAQ,SAAW,EAAU,EACrDD,EAAQ,SAAW,EAAU,EAC7BC,EAAQ,SAAW,EAAU,GAE1B/B,GAAY8B,EAAQ,CAAC,EAAE,KAAMC,EAAQ,CAAC,EAAE,IAAI,CACrD,CC9aA,IAAMC,EAAN,MAAMA,CAAY,CAKhB,OAAc,UAAW,CACvB,GAAI,CACF,QAAWC,KAAM,MAAM,KAAKD,EAAY,KAAK,EAAG,CAC9C,GAAI,CAEF,GAAI,CACF,IAAME,EAAQD,GAAMA,EAAG,SAAWA,EAAG,QAAQ,UAAa,KAC1D,GAAIC,EAAM,CACR,IAAMC,EAAQ,MAAM,KAAK,SAAS,iBAAiB,oBAAoBD,CAAI,IAAI,CAAC,EAChF,QAAWE,KAAKD,EACd,GAAI,CAAEC,EAAE,OAAO,CAAG,MAAY,CAAE,CAEpC,CACF,MAAY,CAAE,CAEVH,GAAMA,EAAG,eAAeA,EAAG,cAAc,YAAYA,CAAE,CAC7D,MAAY,CAAE,CACdD,EAAY,WAAW,OAAOC,CAAE,CAClC,CACF,MAAY,CAAE,CACdD,EAAY,MAAM,MAAM,CAC1B,CAGA,OAAc,SAASK,EAAqBC,EAAuB,CAC5DD,IACLL,EAAY,MAAM,IAAIK,CAAM,EACxBC,GAAWN,EAAY,WAAW,IAAIK,EAAQC,CAAS,EAC7D,CAGA,OAAc,WAAWD,EAAqB,CACvCA,IACLL,EAAY,MAAM,OAAOK,CAAM,EAC/BL,EAAY,WAAW,OAAOK,CAAM,EACtC,CAGA,OAAc,YAAa,CACzB,GAAI,CACF,QAAWJ,KAAM,MAAM,KAAKD,EAAY,KAAK,EAAG,CAC9C,IAAMO,EAAKP,EAAY,WAAW,IAAIC,CAAE,EACxC,GAAI,CAAMM,GAAIA,EAAG,CAAG,MAAY,CAAE,CACpC,CACF,MAAY,CAAE,CAChB,CACF,EAnDMP,EACW,MAAQ,IAAI,IADvBA,EAEW,WAAa,IAAI,QAFlC,IAAMQ,GAANR,EAqDOS,GAAQD,GCtCR,IAAME,GAAN,KAAoB,CAUzB,YAAYC,EAA+B,CAP3C,KAAQ,SAA+B,KACvC,KAAQ,OAA6B,KACrC,KAAQ,WAAiC,KACzC,KAAQ,cAAoC,KAE5C,KAAQ,uBAA8C,KAGpD,KAAK,cAAgBA,EAAQ,cAC7B,KAAK,YAAcA,EAAQ,OAAS,CAAC,EACrC,KAAK,aAAa,CACpB,CAEQ,cAAe,CAErB,IAAMC,EAAM,SAAS,cAAc,QAAQ,EAC3CA,EAAI,UAAY,yBAChBA,EAAI,KAAO,SACXA,EAAI,MAAQ,iBACZA,EAAI,MAAM,OAAS,OACnBA,EAAI,MAAM,WAAa,cACvBA,EAAI,MAAM,QAAU,QACpBA,EAAI,MAAM,WAAa,MACvBA,EAAI,MAAM,OAAS,UACnBA,EAAI,MAAM,QAAU,cACpBA,EAAI,MAAM,WAAa,SAGvB,GAAI,CACF,IAAMC,EAAW,OAAO,iBAAiB,KAAK,aAAa,EACvDA,GAAYA,EAAS,QACvBD,EAAI,MAAM,MAAQC,EAAS,MAE/B,MAAY,CAEZ,CAEA,IAAMC,EAAW,SAAS,cAAc,MAAM,EAC9CA,EAAS,MAAM,QAAU,cACzBA,EAAS,MAAM,WAAa,SAC5BA,EAAS,MAAM,eAAiB,SAChCA,EAAS,MAAM,OAAS,OACxBA,EAAS,MAAM,MAAQ,OACvBA,EAAS,MAAM,WAAa,IAE5BA,EAAS,UAAa,OAAe,aAAa,eAAe,GAAK,GAEzDA,EAAS,iBAAiB,KAAK,EACvC,QAASC,GAAMA,EAAE,aAAa,OAAQ,cAAc,CAAC,EAE1DH,EAAI,YAAYE,CAAQ,EACxBF,EAAI,iBAAiB,QAAUI,GAAM,CACnCA,EAAE,gBAAgB,EAClB,KAAK,OAAO,CACd,CAAC,EAED,KAAK,SAAWJ,EAGZ,KAAK,cAAc,eACrB,KAAK,cAAc,cAAc,aAAaA,EAAK,KAAK,cAAc,WAAW,CAErF,CAEO,QAAS,CACV,KAAK,OACP,KAAK,KAAK,EAEV,KAAK,KAAK,CAEd,CAEO,MAAO,CAEZ,GAAI,CAAEK,GAAY,SAAS,CAAG,MAAY,CAAE,CAC5C,KAAK,KAAK,EAGV,KAAK,WAAa,SAAS,cAAc,KAAK,EAC9C,KAAK,WAAW,MAAM,SAAW,QACjC,KAAK,WAAW,MAAM,IAAM,IAC5B,KAAK,WAAW,MAAM,KAAO,IAC7B,KAAK,WAAW,MAAM,MAAQ,IAC9B,KAAK,WAAW,MAAM,OAAS,IAC/B,KAAK,WAAW,MAAM,OAAS,MAC/B,KAAK,WAAW,iBAAiB,QAAS,IAAM,KAAK,KAAK,CAAC,EAC3D,KAAK,WAAW,QAAQ,SAAW,kBACnC,SAAS,KAAK,YAAY,KAAK,UAAU,EAEzC,KAAK,OAAS,SAAS,cAAc,KAAK,EAC1C,KAAK,OAAO,UAAY,kBACxB,KAAK,OAAO,QAAQ,SAAW,kBAC/B,KAAK,OAAO,MAAM,SAAW,WAC7B,KAAK,OAAO,MAAM,WAAa,gCAC/B,KAAK,OAAO,MAAM,OAAS,sCAC3B,KAAK,OAAO,MAAM,aAAe,MACjC,KAAK,OAAO,MAAM,UAAY,6BAC9B,KAAK,OAAO,MAAM,MAAQ,QAC1B,KAAK,OAAO,MAAM,QAAU,QAC5B,KAAK,OAAO,MAAM,OAAS,OAC3B,KAAK,OAAO,MAAM,SAAW,OAE7B,SAAS,KAAK,YAAY,KAAK,MAAM,EACrC,IAAMC,EAAQ,OAAO,KAAK,aAAgB,WAAa,KAAK,YAAY,EAAI,KAAK,YACjF,KAAK,UAAU,KAAK,OAAQA,CAAK,EAEjC,IAAMC,GAAQ,KAAK,UAAY,KAAK,eAAe,sBAAsB,EACnEC,EAAW,KAAK,OAAO,sBAAsB,EAC7CC,EAAS,EACTC,EAAK,OAAO,YAAc,SAAS,gBAAgB,YACnDC,EAAK,OAAO,aAAe,SAAS,gBAAgB,aAEtDC,EAAML,EAAK,OAASE,EACpBF,EAAK,OAASC,EAAS,OAASC,EAASE,IACvCJ,EAAK,IAAMC,EAAS,OAASC,GAAU,EACzCG,EAAML,EAAK,IAAMC,EAAS,OAASC,EAEnCG,EAAM,KAAK,IAAIH,EAAQ,KAAK,IAAIE,EAAKH,EAAS,OAASC,EAAQF,EAAK,OAASE,CAAM,CAAC,GAItF,GAAI,CAAEJ,GAAY,SAAS,KAAK,OAAQ,KAAK,QAAQ,KAAK,IAAI,CAAC,CAAG,MAAY,CAAE,CAClF,IAAIQ,EAAON,EAAK,KACZA,EAAK,KAAOC,EAAS,MAAQC,EAASC,IACxCG,EAAO,KAAK,IAAIJ,EAAQF,EAAK,MAAQC,EAAS,KAAK,GAErDK,EAAO,KAAK,IAAIJ,EAAQ,KAAK,IAAII,EAAMH,EAAKF,EAAS,MAAQC,CAAM,CAAC,EAEpE,KAAK,OAAO,MAAM,IAAM,GAAG,KAAK,MAAMG,CAAG,CAAC,KAC1C,KAAK,OAAO,MAAM,KAAO,GAAG,KAAK,MAAMC,CAAI,CAAC,IAC9C,CAEO,MAAO,CACR,KAAK,SACP,KAAK,OAAO,OAAO,EACnB,KAAK,OAAS,MAEZ,KAAK,aACP,KAAK,WAAW,OAAO,EACvB,KAAK,WAAa,MAEpB,KAAK,iBAAiB,CACxB,CAGO,SAAU,CACf,GAAI,KAAK,OAAQ,CACf,KAAK,OAAO,UAAY,GACxB,IAAMP,EAAQ,OAAO,KAAK,aAAgB,WAAa,KAAK,YAAY,EAAI,KAAK,YACjF,KAAK,UAAU,KAAK,OAAQA,CAAK,EAEjC,GAAI,CAAM,KAAK,wBAAwB,KAAK,uBAAuB,CAAG,MAAY,CAAE,CACtF,CACF,CAGO,SAAU,CACf,GAAI,CACF,KAAK,KAAK,CACZ,MAAY,CAAE,CACd,GAAI,KAAK,SAAU,CACjB,GAAI,CACF,KAAK,SAAS,OAAO,CACvB,MAAY,CAAE,CACd,KAAK,SAAW,IAClB,CACF,CAEQ,UAAUQ,EAAwBR,EAAmB,CAI3D,GAAI,CACF,IAAMS,EAAQ,KAAK,eAAiB,KAAK,cAAc,cAAiB,KAAK,cAAc,cAAgC,KACrHC,EAAUD,EAAQA,EAAM,aAAa,cAAc,EAAI,KAC7D,GAAIC,EAAS,CACX,IAAMC,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,MAAM,QAAU,OACpBA,EAAI,MAAM,IAAM,MAChBA,EAAI,MAAM,QAAU,WACpBA,EAAI,MAAM,eAAiB,SAC3BA,EAAI,MAAM,WAAa,SAEvB,IAAMC,EAAgBH,EAAQA,EAAM,aAAa,aAAa,EAAI,KAE5DI,EAAa,CAACC,EAAgBC,EAAcC,IAAkB,CAClE,IAAMC,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,MAAM,QAAU,cACpBA,EAAI,MAAM,WAAa,SACvBA,EAAI,MAAM,IAAM,MAChBA,EAAI,MAAM,QAAU,WACpBA,EAAI,MAAM,aAAe,MACzBA,EAAI,MAAM,OAAS,UACnBA,EAAI,MAAM,WAAa,MACvBA,EAAI,MAAM,MAAQ,gCAGdL,GAAiBA,IAAkBE,IACrCG,EAAI,MAAM,WAAa,mCACvBA,EAAI,MAAM,MAAQ,2BAClBA,EAAI,MAAM,WAAa,OAEzBA,EAAI,aAAe,IAAM,CAAEA,EAAI,MAAM,WAAa,yCAA0CA,EAAI,MAAM,MAAQ,wCAA0C,EACxJA,EAAI,aAAe,IAAM,CAAEA,EAAI,MAAM,WAAa,cAAeA,EAAI,MAAM,MAAQ,+BAAiC,EAEpH,IAAMrB,EAAW,SAAS,cAAc,MAAM,EAC9CA,EAAS,MAAM,QAAU,cACzBA,EAAS,MAAM,WAAa,SAC5BA,EAAS,MAAM,eAAiB,SAChCA,EAAS,MAAM,MAAQ,OACvBA,EAAS,MAAM,OAAS,OACxBA,EAAS,UAAa,OAAe,WAAc,OAAe,WAAWmB,CAAI,EAAI,GACrF,GAAI,CAAEnB,EAAS,kBAAoBA,EAAS,iBAAiB,KAAK,EAAE,QAASC,GAAWA,EAAE,aAAa,OAAQ,cAAc,CAAC,CAAG,MAAY,CAAE,CAE/I,IAAMqB,EAAM,SAAS,cAAc,MAAM,EACzC,OAAAA,EAAI,MAAM,SAAW,OACrBA,EAAI,YAAcF,EAElBC,EAAI,YAAYrB,CAAQ,EACxBqB,EAAI,YAAYC,CAAG,EAEnBD,EAAI,iBAAiB,QAAUE,GAAO,CACpCA,EAAG,gBAAgB,EACnB,GAAI,CAEF,GAAI,CACF,IAAMC,EAAM,OAAe,kBAAqB,OAAe,iBAC/D,GAAIA,GAAM,MAAM,QAAQA,EAAG,KAAK,EAAG,CACjC,IAAMC,EAAM,SAAS,OAAOX,CAAO,EAAE,MAAM,GAAG,EAAE,CAAC,CAAC,EAC9C,CAAC,MAAMW,CAAG,GAAKD,EAAG,MAAMC,CAAG,IAAGD,EAAG,MAAMC,CAAG,EAAE,OAASP,EAC3D,CACF,MAAY,CAAE,CAGd,GAAI,CACF,GAAIL,EAAO,CACTA,EAAM,aAAa,cAAeK,CAAM,EACxC,IAAMQ,EAAcb,EAAM,cAAc,WAAW,EACnD,GAAIa,EAAa,CACf,IAAMC,EAAWT,IAAW,QAAU,QAAWA,IAAW,QAAU,UAAY,UAClFQ,EAAY,UAAa,OAAe,WAAc,OAAe,WAAWC,CAAQ,EAAI,EAC9F,CAEA,GAAI,CAAGd,EAAsB,MAAM,CAAG,MAAY,CAAE,CACtD,CACF,MAAY,CAAE,CAGd,GAAI,CAAE,KAAK,KAAK,CAAG,MAAY,CAAE,CACnC,MAAY,CAAE,CAChB,CAAC,EAEMQ,CACT,EAEAN,EAAI,YAAYE,EAAW,QAAS,QAAS,OAAO,CAAC,EACrDF,EAAI,YAAYE,EAAW,QAAS,UAAW,OAAO,CAAC,EACvDF,EAAI,YAAYE,EAAW,UAAW,UAAW,SAAS,CAAC,EAE3DL,EAAU,YAAYG,CAAG,CAC3B,CACF,MAAY,CAAE,CAGd,GAAI,CACF,IAAMa,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,MAAM,OAAS,MACvBA,EAAQ,MAAM,WAAa,6BAC3BA,EAAQ,MAAM,OAAS,QACvBhB,EAAU,YAAYgB,CAAO,CAC/B,MAAY,CAAE,CAEdxB,EAAM,QAASyB,GAAS,CACtB,IAAMC,EAAM,SAAS,cAAc,KAAK,EASxC,GARAA,EAAI,UAAY,uBAChBA,EAAI,MAAM,QAAU,OACpBA,EAAI,MAAM,WAAa,SACvBA,EAAI,MAAM,QAAU,WACpBA,EAAI,MAAM,OAAS,UACnBA,EAAI,MAAM,MAAQ,gCAGdD,EAAK,UAAa,OAAe,WAAY,CAC/C,IAAME,EAAW,SAAS,cAAc,MAAM,EAC9CA,EAAS,MAAM,QAAU,cACzBA,EAAS,MAAM,WAAa,SAC5BA,EAAS,MAAM,eAAiB,SAChCA,EAAS,MAAM,YAAc,MAC7BA,EAAS,UAAa,OAAe,WAAWF,EAAK,QAAQ,GAAK,GAElE,GAAI,CAAEE,EAAS,kBAAoBA,EAAS,iBAAiB,KAAK,EAAE,QAAQ9B,GAAKA,EAAE,aAAa,OAAQ,cAAc,CAAC,CAAG,MAAY,CAAE,CACxI6B,EAAI,YAAYC,CAAQ,CAC1B,CAEA,IAAMC,EAAU,SAAS,cAAc,KAAK,EAQ5C,GAPAA,EAAQ,MAAM,KAAO,IACrBA,EAAQ,MAAM,SAAW,IACzBA,EAAQ,MAAM,SAAW,SACzBA,EAAQ,MAAM,WAAa,SAC3BA,EAAQ,MAAM,aAAe,WAC7BA,EAAQ,MAAM,YAAc,MAExBH,EAAK,KAAM,CACb,IAAMI,EAAI,SAAS,cAAc,MAAM,EACvCA,EAAE,MAAM,WAAa,MACrBA,EAAE,YAAcJ,EAAK,MAAQ,KAC7BG,EAAQ,YAAYC,CAAC,EAErB,IAAMC,EAAI,SAAS,cAAc,MAAM,EACvCA,EAAE,MAAM,QAAU,MAClBA,EAAE,YAAcL,EAAK,KACrBG,EAAQ,YAAYE,CAAC,CACvB,MACEF,EAAQ,MAAM,WAAa,MAC3BA,EAAQ,YAAcH,EAAK,MAI7B,GAFAC,EAAI,YAAYE,CAAO,EAElBH,EAAK,UAAYA,EAAK,SAAS,QAAWA,EAAK,aAAc,CAChE,IAAMM,EAAQ,SAAS,cAAc,MAAM,EAC3CA,EAAM,UAAa,OAAe,aAAa,eAAe,GAAK,SACnEA,EAAM,MAAM,WAAa,OACzBA,EAAM,MAAM,KAAO,WACnBA,EAAM,MAAM,QAAU,MACtBL,EAAI,YAAYK,CAAK,EAEjBN,EAAK,UAAYA,EAAK,SAAS,SACjCC,EAAI,iBAAiB,aAAe5B,GAAM,CACxC,KAAK,kBAAkB4B,EAAKD,EAAK,QAAS,CAC5C,CAAC,EACDC,EAAI,iBAAiB,aAAe5B,GAAM,CAE1C,CAAC,EAEL,CAEI2B,EAAK,UAAYA,EAAK,SAAS,QAGjCC,EAAI,iBAAiB,QAAUP,GAAO,CACpC,GAAI,CAAEA,EAAG,gBAAgB,CAAG,MAAY,CAAE,CAC1C,GAAI,CAEF,GAAI,CAAE,KAAK,iBAAiB,CAAG,MAAY,CAAE,CAC7C,GAAI,CAAE,SAAS,iBAAiB,wBAAwB,EAAE,QAASa,GAAOA,EAAkB,OAAO,CAAC,CAAG,MAAY,CAAE,CACrH,IAAM/B,EAAOyB,EAAI,sBAAsB,EACjCO,EAAWR,EAAK,QAAUA,EAAK,QAAQC,EAAKzB,CAAI,EAAI,OAEtDgC,GAAO,OAAOA,EAAI,MAAS,WAC7BA,EACG,KAAMC,GAAkB,CAClBA,GAAU,KAAK,KAAK,CAC3B,CAAC,EACA,MAAM,IAAM,KAAK,KAAK,CAAC,EAGrBD,GAAK,KAAK,KAAK,CAExB,MAAc,CACZ,GAAI,CACF,KAAK,KAAK,CACZ,MAAY,CAAE,CAChB,CACF,CAAC,EAGHP,EAAI,iBAAiB,aAAc,IAAM,CACvCA,EAAI,MAAM,WAAa,yCACvBA,EAAI,MAAM,MAAQ,wCACpB,CAAC,EACDA,EAAI,iBAAiB,aAAc,IAAM,CACvCA,EAAI,MAAM,WAAa,cACvBA,EAAI,MAAM,MAAQ,+BACpB,CAAC,EAEDlB,EAAU,YAAYkB,CAAG,CAC3B,CAAC,CACH,CAEQ,kBAAkBA,EAAkBS,EAAsB,CAIhE,GAFA,KAAK,iBAAiB,EAElB,CAAC,KAAK,OAAQ,OAElB,IAAMC,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,UAAY,qBACpBA,EAAQ,MAAM,SAAW,WACzBA,EAAQ,MAAM,WAAa,gCAC3BA,EAAQ,MAAM,OAAS,sCACvBA,EAAQ,MAAM,aAAe,MAC7BA,EAAQ,MAAM,UAAY,6BAC1BA,EAAQ,MAAM,SAAW,QACzBA,EAAQ,MAAM,QAAU,QACxBA,EAAQ,MAAM,OAAS,OACvBA,EAAQ,MAAM,SAAW,OAEzB,SAAS,KAAK,YAAYA,CAAO,EACjC,KAAK,UAAUA,EAASD,CAAQ,EAEhC,IAAME,EAAaX,EAAI,sBAAsB,EACvCY,EAAcF,EAAQ,sBAAsB,EAC5ClC,EAAW,KAAK,OAAO,sBAAsB,EAC7CE,EAAK,OAAO,YAAc,SAAS,gBAAgB,YACnDC,EAAK,OAAO,aAAe,SAAS,gBAAgB,aACpDF,EAAS,EAGXG,EAAM+B,EAAW,IACjB/B,EAAMgC,EAAY,OAASjC,IAC7BC,EAAM,KAAK,IAAIH,EAAQ,KAAK,IAAIE,EAAKiC,EAAY,OAASnC,EAAQG,CAAG,CAAC,GAIxE,GAAI,CAAE,SAAS,iBAAiB,wBAAwB,EAAE,QAAQ0B,GAAMA,EAAkB,OAAO,CAAC,CAAG,MAAY,CAAE,CAGnH,IAAIzB,EAAO8B,EAAW,MAAQ,EAE1B9B,EAAO+B,EAAY,MAAQlC,IAC7BG,EAAO8B,EAAW,KAAOC,EAAY,MAAQ,EAEzC/B,EAAOJ,IACTI,EAAO,KAAK,IAAIJ,EAAQ,KAAK,IAAID,EAAS,MAAQ,EAAGE,EAAKkC,EAAY,MAAQnC,CAAM,CAAC,IAIzFiC,EAAQ,MAAM,IAAM,GAAG,KAAK,MAAM9B,CAAG,CAAC,KACtC8B,EAAQ,MAAM,KAAO,GAAG,KAAK,MAAM7B,CAAI,CAAC,KAExC,KAAK,cAAgB6B,EAGrBA,EAAQ,iBAAiB,aAAc,IAAM,CAE3C,WAAW,IAAM,CACX,KAAK,gBAAkBA,GACzB,KAAK,iBAAiB,CAE1B,EAAG,GAAG,CACR,CAAC,CACH,CAEQ,kBAAmB,CACrB,KAAK,gBACP,KAAK,cAAc,OAAO,EAC1B,KAAK,cAAgB,KACrB,KAAK,uBAAyB,KAElC,CAIO,wBAAwBG,EAAwBC,EAAwB,CAC7E,GAAI,CAEF,KAAK,iBAAiB,CACxB,MAAY,CAAE,CACd,GAAID,EAAI,CACN,KAAK,cAAgBA,EACrB,KAAK,uBAAyBC,GAAa,KAC3C,GAAI,CAAEzC,GAAY,SAASwC,EAAIC,GAAa,IAAI,CAAG,MAAY,CAAE,CACnE,CACF,CACF,EAEOC,GAAQjD,GCpef,SAASkD,IAAW,CAClB,IAAMC,EAAgB,SAAS,eAAe,gBAAgB,EAC9D,GAAI,CAACA,EAAe,OAEpB,IAAIC,EAAmC,KACjCC,EAAkBF,EAExB,SAASG,EAAoBC,EAA2B,CACtD,GAAI,CAACA,EAAO,OACZ,IAAMC,EAAQD,EAAc,gBAC5B,GAAIC,GAAQ,OAAOA,EAAK,SAAY,WAClC,GAAI,CACFA,EAAK,QAAQ,CACf,MAAY,CAAE,CAEhB,GAAI,CAEF,IAAMC,EAAYF,EAAc,4BAChC,GAAIE,EAAU,CACZ,GAAI,CAAE,OAAO,oBAAoB,4BAA6BA,CAAQ,CAAG,MAAY,CAAE,CACvF,GAAI,CAAE,OAAO,oBAAoB,sBAAuBA,CAAQ,CAAG,MAAY,CAAE,CACnF,CACF,MAAY,CAAE,CACd,GAAI,CAAE,OAAQF,EAAc,gBAAiB,OAAQA,EAAc,2BAA6B,MAAY,CAAE,CAChH,CAEA,SAASG,GAAqB,CAE5B,IAAMC,EAAYN,EAAgB,cAAc,aAAa,EAC7D,GAAI,CAACM,EAAW,CAEdL,EAAoBF,CAAY,EAChCA,EAAe,KACf,MACF,CACA,IAAMQ,EAASD,EAAU,aAAa,aAAa,EACnD,GAAI,CAACC,EAAQ,CAEXN,EAAoBF,CAAY,EAChCA,EAAe,KACf,MACF,CAEA,IAAMG,EAAQI,EAAU,cAAc,YAAY,EAClD,GAAI,CAACJ,EAAO,OAGZ,GAAKA,EAAc,gBAAiB,CAClCH,EAAeG,EACf,MACF,CAGAD,EAAoBF,CAAY,EAGhC,IAAMS,EAAUF,EAAU,aAAa,cAAc,GAAK,KAEpDG,EAAW,IAAM,CACrB,IAAMC,EAAUF,GAAY,OAAe,aAAgB,OAAe,aAAaA,CAAO,EAAI,KAG9FG,EAAa,GACjB,GAAID,GAAWA,EAAQ,OAAQ,CAC7B,IAAME,EAAa,IAAI,IAAI,MAAM,KAAKF,EAAQ,iBAAmB,CAAC,CAAQ,CAAC,EAI3EC,EAHeD,EAAQ,OACpB,OAAQG,GAAWD,EAAW,IAAI,OAAOC,EAAE,EAAE,CAAC,CAAC,EAC/C,IAAKA,GAAWA,EAAE,IAAI,EACN,KAAK,IAAI,CAC9B,CAGA,IAAIC,EAAY,GACZJ,GAAWA,EAAQ,UACrBI,EAAYJ,EAAQ,SAItB,IAAIK,EAAa,GACbL,GAAWA,EAAQ,gBACrBK,EAAaL,EAAQ,eAGvB,IAAMM,EAAe,CAAC,EAsLtB,IAnLIT,IAAW,SAAWA,IAAW,UACnCS,EAAM,KAAK,CACT,MAAO,SACP,KAAML,EACN,aAAc,GACd,SAAU,OACV,QAAS,CAACM,EAAsBC,IAEvB,sCACJ,KAAK,CAAC,CAAE,WAAAC,CAAW,IAAM,CACxB,GAAI,CAEF,GAAI,CAAGjB,EAAc,iBAAoBA,EAAc,gBAAgB,kBAAqBA,EAAc,gBAAgB,iBAAiB,CAAG,MAAY,CAAE,CAC5J,IAAMkB,EAAUV,GAAWA,EAAQ,QAAW,CAAC,EACzCW,EAAU,IAAI,IAClBX,GAAWA,EAAQ,gBACf,MAAM,KAAKA,EAAQ,eAAe,EAAE,IAAKY,GAAW,OAAOA,CAAC,CAAC,EAC7D,CAAC,CACP,EAyBMC,EAxBO,IAAIJ,EAAW,CAC1B,QAASC,GAAU,CAAC,GAAG,IAAKP,IAAY,CACtC,GAAI,OAAOA,EAAE,EAAE,EACf,KAAMA,EAAE,KACR,UAAWA,EAAE,UACb,SAAUA,EAAE,SACZ,OAAQA,EAAE,OAAS,OACrB,EAAE,EACF,gBAAiBQ,EACjB,mBAAoB,CAACG,EAAiBC,IAAyB,CAC7D,GAAI,CACEf,GAAW,OAAOA,EAAQ,oBAAuB,YACnDA,EAAQ,mBAAmB,OAAOc,CAAO,EAAGC,CAAW,EAGzD,WAAW,IAAM,CACf,IAAMC,EAAcxB,EAAc,gBAC9BwB,GAAc,OAAOA,EAAW,SAAY,YAC9CA,EAAW,QAAQ,CAEvB,EAAG,EAAE,CACP,MAAY,CAAE,CAChB,CACF,CAAC,EACoB,KAAMT,GAA2Bf,EAAuBgB,CAAiC,EAC9G,GAAI,CACF,IAAMS,EAAkBzB,EAAc,gBACtC,GAAIyB,GAAkB,OAAOA,EAAe,yBAA4B,YAAcJ,GAAYA,EAAQ,GACxG,GAAI,CAAEI,EAAe,wBAAwBJ,EAAQ,GAAmBA,EAAQ,OAAO,CAAG,MAAY,CAAE,CAE5G,MAAY,CAAE,CAChB,MAAY,CAAE,CACd,MAAO,EACT,CAAC,EACA,MAAM,IAAM,EAAK,CAExB,CAAC,EAMChB,IAAW,SACbS,EAAM,KAAK,CACT,MAAO,YACP,KAAMD,EACN,aAAc,GACd,SAAU,UACV,QAAS,CAACE,EAAsBC,IAEvB,sCACJ,KAAK,CAAC,CAAE,QAASU,CAAY,IAAM,CAClC,GAAI,CAEF,GAAI,CAAG1B,EAAc,iBAAoBA,EAAc,gBAAgB,kBAAqBA,EAAc,gBAAgB,iBAAiB,CAAG,MAAY,CAAE,CAG5J,IAAM2B,GAFUnB,GAAWA,EAAQ,QAAW,CAAC,GAEf,CAAC,GAAG,OAAQG,GAAW,CACrD,IAAMiB,EAAM,OAAQjB,EAAE,UAAYA,EAAE,MAAQ,EAAG,EAAE,YAAY,EAC7D,OAAOiB,IAAQ,iBAAmBA,EAAI,SAAS,WAAW,CAC5D,CAAC,EAqBKP,EApBO,IAAIK,EAAY,CAC3B,MAAO,YACP,QAASC,GAAgB,CAAC,GAAG,IAAKhB,IAAY,CAAE,GAAI,OAAOA,EAAE,EAAE,EAAG,KAAMA,EAAE,KAAM,UAAWA,EAAE,UAAW,SAAUA,EAAE,QAAS,EAAE,EAC/H,MAAOH,GAAWA,EAAQ,MAAQA,EAAQ,MAAQ,CAAC,EACnD,QAASA,GAAWA,EAAQ,cAAgBA,EAAQ,cAAgB,KACpE,SAAWqB,GAA6B,CACtC,GAAI,CACErB,GAAW,OAAOA,EAAQ,eAAkB,YAC9CA,EAAQ,cAAcqB,CAAS,EAGjC,WAAW,IAAM,CACf,IAAML,EAAcxB,EAAc,gBAC9BwB,GAAc,OAAOA,EAAW,SAAY,YAC9CA,EAAW,QAAQ,CAEvB,EAAG,EAAE,CACP,MAAY,CAAE,CAChB,CACF,CAAC,EACoB,KAAMT,GAA2Bf,EAAuBgB,CAAiC,EAC9G,GAAI,CACF,IAAMS,EAAkBzB,EAAc,gBACtC,GAAIyB,GAAkB,OAAOA,EAAe,yBAA4B,YAAcJ,GAAYA,EAAQ,GACxG,GAAI,CAAEI,EAAe,wBAAwBJ,EAAQ,GAAmBA,EAAQ,OAAO,CAAG,MAAY,CAAE,CAE5G,MAAY,CAAE,CAChB,MAAY,CAAE,CACd,MAAO,EACT,CAAC,EACA,MAAM,IAAM,EAAK,CAExB,CAAC,EAMHP,EAAM,KAAK,CACT,MAAOT,IAAW,QAAU,YAAc,WAC1C,KAAMO,EACN,aAAc,GACd,SAAU,OACV,QAAS,CAACG,EAAsBC,IAEvB,sCACJ,KAAK,CAAC,CAAE,QAASU,CAAY,IAAM,CAClC,GAAI,CAEF,GAAI,CAAG1B,EAAc,iBAAoBA,EAAc,gBAAgB,kBAAqBA,EAAc,gBAAgB,iBAAiB,CAAG,MAAY,CAAE,CAE5J,IAAM8B,GADUtB,GAAWA,EAAQ,QAAW,CAAC,GAClB,CAAC,GAAG,OAAQG,GAAW,CAClD,IAAMiB,EAAM,OAAQjB,EAAE,UAAYA,EAAE,MAAQA,EAAE,MAAQ,EAAG,EAAE,YAAY,EASvE,MARI,GAAAiB,EAAI,SAAS,QAAQ,GAAKA,EAAI,SAAS,UAAU,GACjDA,EAAI,SAAS,MAAM,GAAKA,EAAI,SAAS,YAAY,GACjDA,EAAI,SAAS,QAAQ,GACrBA,EAAI,SAAS,KAAK,GAAKA,EAAI,SAAS,QAAQ,GAAKA,EAAI,SAAS,SAAS,GACvEA,EAAI,SAAS,WAAW,GACxBA,EAAI,SAAS,QAAQ,GAAKA,EAAI,SAAS,QAAQ,GAC/CA,EAAI,SAAS,WAAW,GACxBA,EAAI,SAAS,MAAM,GACnBA,EAAI,SAAS,MAAM,EAEzB,CAAC,EAqBOP,EApBK,IAAIK,EAAY,CAC3B,MAAOrB,IAAW,QAAU,YAAc,WAC1C,QAASyB,GAAa,CAAC,GAAG,IAAKnB,IAAY,CAAE,GAAI,OAAOA,EAAE,EAAE,EAAG,KAAMA,EAAE,KAAM,UAAWA,EAAE,UAAW,SAAUA,EAAE,QAAS,EAAE,EAC5H,MAAOH,GAAWA,EAAQ,MAAQA,EAAQ,MAAQ,CAAC,EACnD,QAASA,IAAYA,EAAQ,SAAWA,EAAQ,iBAAoBA,EAAQ,SAAWA,EAAQ,gBAAmB,KAClH,SAAWqB,GAA6B,CACtC,GAAI,CACErB,GAAW,OAAOA,EAAQ,cAAiB,YAC7CA,EAAQ,aAAaqB,CAAS,EAGhC,WAAW,IAAM,CACf,IAAML,EAAcxB,EAAc,gBAC9BwB,GAAc,OAAOA,EAAW,SAAY,YAC9CA,EAAW,QAAQ,CAEvB,EAAG,EAAE,CACP,MAAY,CAAE,CAChB,CACF,CAAC,EACsB,KAAMT,GAA2Bf,EAAuBgB,CAAiC,EAC9G,GAAI,CACF,IAAMS,EAAkBzB,EAAc,gBACtC,GAAIyB,GAAkB,OAAOA,EAAe,yBAA4B,YAAcJ,GAAYA,EAAQ,GACxG,GAAI,CAAEI,EAAe,wBAAwBJ,EAAQ,GAAmBA,EAAQ,OAAO,CAAG,MAAY,CAAE,CAE5G,MAAY,CAAE,CAClB,MAAY,CAAE,CACd,MAAO,EACT,CAAC,EACA,MAAM,IAAM,EAAK,CAExB,CAAC,EAGGhB,IAAW,UAAW,CAExB,IAAI0B,EAAc,GAClB,GAAI,CACF,IAAMC,EAAkBxB,GAAWA,EAAQ,gBAC3C,GAAIwB,GAAmB,OAAOA,EAAgB,kBAAqB,WAAY,CAC7E,IAAMC,EAASD,EAAgB,iBAAiB,EAC5C,MAAM,QAAQC,CAAM,GAAKA,EAAO,OAAS,EAM3CF,EALcE,EAAO,IAAKC,GAAY,CACpC,GAAI,OAAOA,CAAE,IAAM,aAAc,MAAO,aACxC,IAAMvB,EAAKH,GAAWA,EAAQ,OAAWA,EAAQ,OAAiB,KAAM2B,GAAY,OAAOA,EAAG,EAAE,IAAM,OAAOD,CAAE,GAAKC,EAAG,OAASD,CAAE,EAAI,KACtI,OAAOvB,EAAIA,EAAE,KAAO,OAAOuB,CAAE,CAC/B,CAAC,EACmB,KAAK,IAAI,EAE7BH,EAAc,MAElB,CACF,MAAY,CAAE,CAEdjB,EAAM,KAAK,CACT,MAAO,UACP,KAAMiB,EACN,aAAc,GACd,SAAU,WACV,QAAS,CAAChB,EAAsBC,IAAyB,CACvD,GAAI,CAEF,IAAMgB,EAAkBxB,GAAWA,EAAQ,gBAC3C,GAAIwB,GAAmB,OAAOA,EAAgB,iBAAoB,WAAY,CAE5E,GAAI,CAAE,SAAS,iBAAiB,wBAAwB,EAAE,QAASI,GAAOA,EAAkB,OAAO,CAAC,CAAG,MAAY,CAAE,CACrH,GAAI,CAAGpC,EAAc,iBAAoBA,EAAc,gBAAgB,kBAAqBA,EAAc,gBAAgB,iBAAiB,CAAG,MAAY,CAAE,CAI5J,IAAMqC,EAAiB,CACrB,cAAerB,EAAc,CAAE,sBAAuB,IAAMA,CAAW,EAAgCD,GAAUf,CACnH,EACA,GAAI,CACF,IAAMqB,EAAUW,EAAgB,gBAAgBK,CAAc,EACxDZ,EAAkBzB,EAAc,gBACtC,GAAIqB,GAAWA,EAAQ,IAAMI,GAAkB,OAAOA,EAAe,yBAA4B,WAC/F,GAAI,CAAEA,EAAe,wBAAwBJ,EAAQ,GAAmBA,EAAQ,OAAO,CAAG,MAAY,CAAE,CAE5G,MAAY,CAAE,CAChB,CACF,MAAY,CAAE,CACd,MAAO,EACT,CACF,CAAC,CACH,CAGA,GAAIhB,IAAW,SAAWA,IAAW,SAAWA,IAAW,UAAW,CAEpE,IAAIiC,EAAW,OACXC,EAA6B,KACjC,GAAI,CACF,IAAMC,EAAMhC,IAAYA,EAAQ,aAAeA,EAAQ,iBACvD,GAAIgC,EACF,GAAI,OAAOA,GAAQ,SAAU,CAC3B,IAAM7B,GAAKH,GAAWA,EAAQ,OAAUA,EAAQ,OAAmB,CAAC,GAAG,KAAM2B,GAAY,OAAOA,EAAG,EAAE,IAAM,OAAOK,CAAG,GAAKL,EAAG,OAASK,CAAG,EACrI7B,GAAK2B,EAAW3B,EAAE,MAAQ,OAAOA,EAAE,EAAE,EAAG4B,EAAc,OAAO5B,EAAE,EAAE,IAC9D2B,EAAW,OAAQC,EAAc,KAC1C,SAAW,OAAOC,GAAQ,UAAYA,EAAI,QAAS,CACjD,IAAM7B,GAAKH,GAAWA,EAAQ,OAAUA,EAAQ,OAAmB,CAAC,GAAG,KAAM2B,GAAY,OAAOA,EAAG,EAAE,IAAM,OAAOK,EAAI,OAAO,CAAC,EAC1H7B,GAAK2B,EAAW3B,EAAE,MAAQ,OAAOA,EAAE,EAAE,EAAG4B,EAAc,OAAO5B,EAAE,EAAE,IAC9D2B,EAAW,OAAQC,EAAc,KAC1C,MACED,EAAW,OAAQC,EAAc,UAGnCD,EAAW,OAAQC,EAAc,IAErC,MAAY,CAAED,EAAW,OAAQC,EAAc,IAAM,CAErDzB,EAAM,KAAK,CACT,MAAO,UACP,KAAMwB,EACN,aAAc,GACd,SAAU,gBACV,QAAS,CAACvB,EAAsBC,IACvB,sCACJ,KAAK,CAAC,CAAE,WAAAyB,CAAW,IAAM,CACxB,GAAI,CAEF,GAAI,CAAGzC,EAAc,iBAAoBA,EAAc,gBAAgB,kBAAqBA,EAAc,gBAAgB,iBAAiB,CAAG,MAAY,CAAE,CAC5J,IAAMkB,EAAUV,GAAWA,EAAQ,QAAW,CAAC,EAkBzCa,EAjBO,IAAIoB,EAAW,CAC1B,QAASvB,GAAU,CAAC,GAAG,IAAKP,IAAY,CAAE,GAAI,OAAOA,EAAE,EAAE,EAAG,KAAMA,EAAE,KAAM,UAAWA,EAAE,UAAW,SAAUA,EAAE,QAAS,EAAE,EACzH,QAAS4B,EACT,SAAWjB,GAA2B,CACpC,GAAI,CACEd,GAAW,OAAOA,EAAQ,WAAc,YAC1CA,EAAQ,UAAUc,CAAO,EAE3B,WAAW,IAAM,CACf,IAAME,EAAcxB,EAAc,gBAC9BwB,GAAc,OAAOA,EAAW,SAAY,YAC9CA,EAAW,QAAQ,CAEvB,EAAG,EAAE,CACP,MAAY,CAAE,CAChB,CACF,CAAC,EACoB,KAAMT,GAA2Bf,EAAuBgB,CAAiC,EAC9G,GAAI,CACF,IAAMS,EAAkBzB,EAAc,gBACtC,GAAIyB,GAAkB,OAAOA,EAAe,yBAA4B,YAAcJ,GAAYA,EAAQ,GACxG,GAAI,CAAEI,EAAe,wBAAwBJ,EAAQ,GAAmBA,EAAQ,OAAO,CAAG,MAAY,CAAE,CAE5G,MAAY,CAAE,CAChB,MAAY,CAAE,CACd,MAAO,EACT,CAAC,EACA,MAAM,IAAM,EAAK,CAExB,CAAC,CACH,CAGA,GAAIhB,IAAW,SAAWA,IAAW,QACnC,GAAI,CAEF,IAAIqC,EAAS,GACb,GAAI,CACF,IAAMF,EAAOhC,IAAYA,EAAQ,eAAiB,MAClD,GAAI,MAAM,QAAQgC,CAAG,GAAKA,EAAI,OAAS,EAAG,CACxC,IAAMtB,EAAUV,GAAWA,EAAQ,QAAW,CAAC,EAM/CkC,EALcF,EAAI,IAAKN,GAAY,CACjC,GAAI,OAAOA,CAAE,IAAM,YAAa,MAAO,QACvC,IAAMvB,GAAKO,GAAU,CAAC,GAAG,KAAMiB,GAAY,OAAOA,EAAG,EAAE,IAAM,OAAOD,CAAE,GAAKC,EAAG,OAASD,CAAE,EACzF,OAAOvB,EAAIA,EAAE,KAAO,OAAOuB,CAAE,CAC/B,CAAC,EACc,KAAK,IAAI,CAC1B,MAAWM,IAAQ,OAAME,EAAS,OACpC,MAAY,CAAE,CAEd5B,EAAM,KAAK,CACT,MAAO,YACP,KAAM4B,EACN,aAAc,GACd,SAAU,SACV,QAAS,CAAC3B,EAAsBC,IACvB,sCACJ,KAAK,CAAC,CAAE,QAAS2B,EAAc,aAAcC,CAAkB,IAAM,CACpE,GAAI,CACF,GAAI,CAAG5C,EAAc,iBAAoBA,EAAc,gBAAgB,kBAAqBA,EAAc,gBAAgB,iBAAiB,CAAG,MAAY,CAAE,CAC5J,IAAMkB,EAAUV,GAAWA,EAAQ,QAAW,CAAC,EACzCqC,EAAWrC,IAAYA,EAAQ,eAAiB,CAAC,IAAO,CAAC,EAiBzDa,EAhBO,IAAKuB,GAAqBD,GAAc,CACnD,QAASzB,GAAU,CAAC,GAAG,IAAKP,IAAY,CAAE,GAAI,OAAOA,EAAE,EAAE,EAAG,KAAMA,EAAE,KAAM,SAAUA,EAAE,QAAS,EAAE,EACjG,QAAS,MAAM,QAAQkC,CAAO,EAAIA,EAAU,CAAC,EAC7C,MAAO,YACP,SAAWC,GAAuB,CAChC,GAAI,CACEtC,GAAW,OAAOA,EAAQ,oBAAuB,YACnDA,EAAQ,mBAAmBsC,GAAYA,EAAS,OAASA,EAAW,IAAI,EAE1E,WAAW,IAAM,CACf,IAAMtB,EAAcxB,EAAc,gBAC9BwB,GAAc,OAAOA,EAAW,SAAY,YAAYA,EAAW,QAAQ,CACjF,EAAG,EAAE,CACP,MAAY,CAAE,CAChB,CACF,CAAC,EACoB,KAAMT,GAA2Bf,EAAuBgB,CAAiC,EAC9G,GAAI,CACF,IAAMS,EAAkBzB,EAAc,gBACtC,GAAIyB,GAAkB,OAAOA,EAAe,yBAA4B,YAAcJ,GAAYA,EAAQ,GACxG,GAAI,CAAEI,EAAe,wBAAwBJ,EAAQ,GAAmBA,EAAQ,OAAO,CAAG,MAAY,CAAE,CAE5G,MAAY,CAAE,CAChB,MAAY,CAAE,CACd,MAAO,EACT,CAAC,EACA,MAAM,IAAM,EAAK,CAExB,CAAC,CACH,MAAY,CAAE,CAIhB,GAAIhB,IAAW,UAAW,CAExB,IAAI0C,EAAW,GACf,GAAI,CACF,IAAMf,EAAkBxB,GAAWA,EAAQ,gBAC3C,GAAIwB,EAAiB,CACnB,IAAMgB,EAAWhB,EAAwB,kBAAqBA,EAAwB,gBAAkB,KAClGiB,EAASjB,EAAwB,gBAAmBA,EAAwB,cAAgB,KAC5Fd,EAAUV,GAAWA,EAAQ,QAAW,CAAC,EACzC0C,EAAYF,EAAW9B,EAAiB,KAAMP,GAAW,OAAOA,EAAE,EAAE,IAAM,OAAOqC,CAAO,CAAC,GAAG,KAAO,KACnGG,EAAUF,EAAS/B,EAAiB,KAAMP,GAAW,OAAOA,EAAE,EAAE,IAAM,OAAOsC,CAAK,CAAC,GAAG,KAAO,KAC/FC,GAAaC,EACfJ,EAAWG,IAAcC,EAAUD,EAAY,GAAGA,CAAS,MAAMC,CAAO,GAC/DD,EACTH,EAAWG,EACFC,IACTJ,EAAWI,EAEf,CACF,MAAY,CAAe,CAE3BrC,EAAM,KAAK,CACT,MAAO,OACP,KAAMiC,EACN,aAAc,GACd,SAAU,WACV,QAAS,CAAChC,EAAsBC,IAAyB,CACvD,GAAI,CACF,IAAMgB,EAAkBxB,GAAWA,EAAQ,gBAC3C,GAAIwB,GAAmB,OAAOA,EAAgB,oBAAuB,WAAY,CAE/E,GAAI,CAAE,SAAS,iBAAiB,wBAAwB,EAAE,QAASI,GAAOA,EAAkB,OAAO,CAAC,CAAG,MAAY,CAAE,CACrH,GAAI,CAAGpC,EAAc,iBAAoBA,EAAc,gBAAgB,kBAAqBA,EAAc,gBAAgB,iBAAiB,CAAG,MAAY,CAAE,CAE5J,IAAMoD,EAAgBpD,EAAc,iBAAoBA,EAAc,gBAAgB,OAAUA,EAAc,gBAAgB,OAAwB,OAChJqC,EAAiB,CACrB,cAAerB,EAAc,CAAE,sBAAuB,IAAMA,CAAW,EAAgCD,GAAUqC,GAAgBpD,CACnI,EACA,GAAI,CACF,IAAMqB,EAAUW,EAAgB,mBAAmBK,CAAc,EAC3DZ,EAAkBzB,EAAc,gBACtC,GAAIqB,GAAWA,EAAQ,IAAMI,GAAkB,OAAOA,EAAe,yBAA4B,WAC/F,GAAI,CAAEA,EAAe,wBAAwBJ,EAAQ,GAAmBA,EAAQ,OAAO,CAAG,MAAY,CAAE,CAE5G,MAAY,CAAE,CAChB,CACF,MAAY,CAAE,CACd,MAAO,EACT,CACF,CAAC,EAED,GAAI,CACF,IAAIgC,EAAW,GACTrB,EAAkBxB,GAAWA,EAAQ,gBAC3C,GAAIwB,EAAiB,CACnB,IAAMsB,EAAMtB,EAAwB,WAAa,QACjDqB,EAAWC,EAAG,OAAO,CAAC,EAAE,YAAY,EAAIA,EAAG,MAAM,CAAC,CACpD,CACAxC,EAAM,KAAK,CACT,MAAO,aACP,KAAMuC,EACN,aAAc,GACd,SAAU,UACV,QAAS,CAACtC,EAAsBC,IAAyB,CACvD,GAAI,CACF,IAAMgB,EAAkBxB,GAAWA,EAAQ,gBAC3C,GAAIwB,GAAmB,OAAOA,EAAgB,cAAiB,WAAY,CAEzE,GAAI,CAAE,SAAS,iBAAiB,wBAAwB,EAAE,QAASI,GAAOA,EAAkB,OAAO,CAAC,CAAG,MAAY,CAAE,CACrH,GAAI,CAAGpC,EAAc,iBAAoBA,EAAc,gBAAgB,kBAAqBA,EAAc,gBAAgB,iBAAiB,CAAG,MAAY,CAAE,CAC5J,IAAMoD,EAAgBpD,EAAc,iBAAoBA,EAAc,gBAAgB,OAAUA,EAAc,gBAAgB,OAAwB,OAChJqC,EAAiB,CACrB,cAAerB,EAAc,CAAE,sBAAuB,IAAMA,CAAW,EAAgCD,GAAUqC,GAAgBpD,CACnI,EACA,GAAI,CACF,IAAMqB,EAAUW,EAAgB,aAAaK,CAAc,EACrDZ,EAAkBzB,EAAc,gBACtC,GAAIqB,GAAWA,EAAQ,IAAMI,GAAkB,OAAOA,EAAe,yBAA4B,WAC/F,GAAI,CAAEA,EAAe,wBAAwBJ,EAAQ,GAAmBA,EAAQ,OAAO,CAAG,MAAY,CAAE,KAKxG,IAAI,CACF,IAAMkC,EAAK,SAAS,cAAc,cAAc,EAChD,GAAIA,GAAM9B,GAAkB,OAAOA,EAAe,yBAA4B,WAC5E,GAAI,CAAEA,EAAe,wBAAwB8B,EAAI,IAAM,CAAc,CAAC,CAAG,MAAY,CAAE,CAE3F,MAAY,CAAE,CAElB,MAAY,CAAE,CAChB,CACF,MAAY,CAAE,CACd,MAAO,EACT,CACF,CAAC,CACD,MAAY,CAAE,CAGd,GAAI,CACF,IAAIb,EAAS,GACb,GAAI,CACF,IAAMF,EAAOhC,IAAYA,EAAQ,eAAiB,MAClD,GAAI,MAAM,QAAQgC,CAAG,GAAKA,EAAI,OAAS,EAAG,CACxC,IAAMtB,EAAUV,GAAWA,EAAQ,QAAW,CAAC,EAM/CkC,EALcF,EAAI,IAAKN,GAAY,CACjC,GAAI,OAAOA,CAAE,IAAM,YAAa,MAAO,QACvC,IAAMvB,GAAKO,GAAU,CAAC,GAAG,KAAMiB,GAAY,OAAOA,EAAG,EAAE,IAAM,OAAOD,CAAE,GAAKC,EAAG,OAASD,CAAE,EACzF,OAAOvB,EAAIA,EAAE,KAAO,OAAOuB,CAAE,CAC/B,CAAC,EACc,KAAK,IAAI,CAC1B,MAAWM,IAAQ,OAAME,EAAS,OACpC,MAAY,CAAE,CAEd5B,EAAM,KAAK,CACT,MAAO,YACP,KAAM4B,EACN,aAAc,GACd,SAAU,SACV,QAAS,CAAC3B,EAAsBC,IACvB,sCACJ,KAAK,CAAC,CAAE,QAAS2B,EAAc,aAAcC,CAAkB,IAAM,CACpE,GAAI,CACF,GAAI,CAAG5C,EAAc,iBAAoBA,EAAc,gBAAgB,kBAAqBA,EAAc,gBAAgB,iBAAiB,CAAG,MAAY,CAAE,CAC5J,IAAMkB,EAAUV,GAAWA,EAAQ,QAAW,CAAC,EACzCqC,EAAWrC,IAAYA,EAAQ,eAAiB,CAAC,IAAO,CAAC,EAiBzDa,EAhBO,IAAKuB,GAAqBD,GAAc,CACnD,QAASzB,GAAU,CAAC,GAAG,IAAKP,IAAY,CAAE,GAAI,OAAOA,EAAE,EAAE,EAAG,KAAMA,EAAE,KAAM,SAAUA,EAAE,QAAS,EAAE,EACjG,QAAS,MAAM,QAAQkC,CAAO,EAAIA,EAAU,CAAC,EAC7C,MAAO,YACP,SAAWC,GAAuB,CAChC,GAAI,CACEtC,GAAW,OAAOA,EAAQ,oBAAuB,YACnDA,EAAQ,mBAAmBsC,GAAYA,EAAS,OAASA,EAAW,IAAI,EAE1E,WAAW,IAAM,CACf,IAAMtB,EAAcxB,EAAc,gBAC9BwB,GAAc,OAAOA,EAAW,SAAY,YAAYA,EAAW,QAAQ,CACjF,EAAG,EAAE,CACP,MAAY,CAAE,CAChB,CACF,CAAC,EACoB,KAAMT,GAA2Bf,EAAuBgB,CAAiC,EAC9G,GAAI,CACF,IAAMS,EAAkBzB,EAAc,gBACtC,GAAIyB,GAAkB,OAAOA,EAAe,yBAA4B,YAAcJ,GAAYA,EAAQ,GACxG,GAAI,CAAEI,EAAe,wBAAwBJ,EAAQ,GAAmBA,EAAQ,OAAO,CAAG,MAAY,CAAE,CAE5G,MAAY,CAAE,CAChB,MAAY,CAAE,CACd,MAAO,EACT,CAAC,EACA,MAAM,IAAM,EAAK,CAExB,CAAC,CACH,MAAY,CAAE,CAEhB,CAGF,GAAI,CACF,IAAImC,EAAY,GAChB,GAAI,CAEF,IAAMC,EAAKjD,IAAYA,EAAQ,cAAgBA,EAAQ,mBAAqBA,EAAQ,OAAS,MAC7F,GAAIiD,EACE,OAAOA,GAAO,SAAUD,EAAYC,EAC/BA,GAAM,OAAOA,GAAO,WAAUD,EAAYC,EAAG,MAAQ,OAAOA,EAAG,SAAWA,EAAG,IAAM,EAAE,WAG1FnD,EACF,GAAI,CACF,IAAMoD,EAAS,aAAa,QAAQ,oBAAoBpD,CAAO,QAAQ,EACvE,GAAIoD,EAAQ,CACV,IAAMC,EAAS,KAAK,MAAMD,CAAM,EAC5BC,GAAUA,EAAO,UAASH,EAAY,OAAOG,EAAO,OAAO,EACjE,CACF,MAAY,CAAE,CAGpB,MAAY,CAAE,EAEVtD,IAAW,SAAWA,IAAW,SAAWA,IAAW,YACzDS,EAAM,KAAK,CACT,MAAO,WACP,KAAM0C,GAAa,OACnB,aAAc,GACd,SAAU,UACV,QAAS,CAACzC,EAAsBC,IAAyB,CACvD,GAAI,CAMF,GAAIR,GAAW,OAAOA,EAAQ,gBAAmB,WAAY,CAC3D,GAAI,CAED,OAAe,mBAAqB,IAAM,CACzC,IAAMiB,EAAkBzB,EAAc,gBAClCyB,GAAkB,OAAOA,EAAe,SAAY,YACtDA,EAAe,QAAQ,CAE3B,EACA,IAAMJ,EAAUb,EAAQ,eAAeO,EAAQC,CAAU,CAG3D,MAAY,CAAE,CACd,MAAO,EACT,CAGA,GAAI,CACF,IAAME,EAAUV,GAAWA,EAAQ,QAAW,CAAC,EACzCoD,EAAiB,IAAI,IAAI,CAAC,YAAY,gBAAgB,eAAe,YAAY,SAAS,OAAO,YAAY,aAAa,SAAS,OAAO,kBAAkB,CAAC,EAC7JC,GAAa3C,GAAU,CAAC,GAAG,KAAMP,GAAWiD,EAAe,IAAI,QAAQjD,EAAE,UAAY,IAAI,YAAY,CAAC,CAAC,CAAC,EAC9G,GAAIkD,EACF,GAAI,CACF,GAAIrD,GAAW,OAAOA,EAAQ,YAAe,WAC3C,OAAAA,EAAQ,WAAWqD,EAAU,IAAMA,EAAU,MAAQA,CAAS,EACvD,EAEX,MAAY,CAAE,CAElB,MAAY,CAAE,CACZ,MAAY,CAAE,CAId,GAAI,CACF,IAAMC,EAAO9C,GAAeD,GAAUA,EAAO,uBAAyBA,EAAO,sBAAsB,EACnG,GAAI+C,EAAM,CAER,GAAI,CAAE,SAAS,iBAAiB,+BAA+B,EAAE,QAAQ1B,GAAKA,EAAE,OAAO,CAAC,CAAG,MAAY,CAAE,CACzG,IAAM2B,EAAK,SAAS,cAAc,KAAK,EACvCA,EAAG,UAAY,+BACfA,EAAG,MAAM,SAAW,WACpBA,EAAG,MAAM,IAAO,KAAK,MAAMD,EAAK,GAAG,EAAK,KACxCC,EAAG,MAAM,KAAQ,KAAK,MAAMD,EAAK,KAAK,EAAI,EAAK,KAC/CC,EAAG,MAAM,MAAQ,MACjBA,EAAG,MAAM,OAAS,MAClBA,EAAG,MAAM,OAAS,OAClBA,EAAG,MAAM,cAAgB,OACzB,SAAS,KAAK,YAAYA,CAAE,EAC5B,GAAI,CAAE,IAAMtC,EAAkBzB,EAAc,gBAAqByB,GAAkB,OAAOA,EAAe,yBAA4B,YAAYA,EAAe,wBAAwBsC,EAAmB,IAAM,CAAc,CAAC,CAAG,MAAY,CAAE,CACnP,CACF,MAAY,CAAE,CACd,MAAO,EACb,CACF,CAAC,CAEL,MAAY,CAAE,CAEd,OAAOjD,CAEP,EAEF,GAAI,CACF,IAAMkD,EAAO,IAAIC,GAAc,CAAE,cAAejE,EAAO,MAAOO,CAAS,CAAC,EACvEP,EAAc,gBAAkBgE,EAEjC,IAAME,EAAe,IAAM,CACzB,GAAI,CACF,IAAM1C,EAAcxB,EAAc,gBAC9BwB,GAAc,OAAOA,EAAW,SAAY,YAAYA,EAAW,QAAQ,CACjF,MAAY,CAAE,CAChB,EACA,GAAI,CACF,OAAO,iBAAiB,4BAA6B0C,CAAY,EACjE,OAAO,iBAAiB,sBAAuBA,CAAY,EAC3D,OAAO,iBAAiB,yBAA0BA,CAAY,EAC7DlE,EAAc,4BAA8BkE,CAC/C,MAAY,CAAE,CACdrE,EAAeG,CACjB,MAAY,CAEZ,CACF,CAEAG,EAAmB,EAGnBL,EAAgB,iBAAiB,QAAS,IAAM,WAAWK,EAAoB,CAAC,CAAC,EAGtE,IAAI,iBAAkBgE,GAAc,CAC7C,QAAWC,KAAKD,EAAW,CACrBC,EAAE,OAAS,cAEbjE,EAAmB,EAErB,QAAWiC,KAAK,MAAM,KAAKgC,EAAE,YAAc,CAAC,CAAC,EACvChC,EAAE,WAAa,GAAGjC,EAAmB,CAE7C,CACF,CAAC,EACE,QAAQL,EAAiB,CAAE,UAAW,GAAM,QAAS,GAAM,WAAY,GAAM,gBAAiB,CAAC,OAAO,CAAE,CAAC,CAC9G,CAEM,OAAe,8BAClB,OAAe,4BAA8B,GAC1C,SAAS,aAAe,UAC1B,SAAS,iBAAiB,mBAAoBH,EAAQ,EAEtD,WAAWA,GAAU,CAAC,GC/tB1B,GAAI,CACF0E,EAAS,SAAU,yBAAyB,CAC9C,MAAY,CAAE,CACd,GAAI,CACF,QAAQ,KAAO,QAAQ,IAAI,gCAAgC,CAC7D,MAAY,CAAE,CAGd,SAASC,IAAqB,CAC5B,OAAO,SAAUC,EAAWC,EAAwBC,EAAiB,CACnE,IAAMC,EACJH,IAASA,EAAK,MAAQA,EAAK,IAAMA,EAAK,MAAQA,EAAK,GAAK,aAE1D,GAAI,CACFI,GAAgBH,EAAWE,CAAQ,CACrC,MAAY,CAAE,CAEd,IAAIE,EAAQ,GAGZ,IAAIC,EAKAC,EAEAC,EAGAC,EAAuD,KAEvDC,EAAwB,KAIxBC,EAEAC,EAA0C,KAC1CC,EAAmB,KACnBC,EAEJ,SAASC,EAAOC,EAAcC,EAA0B,CACtD,GAAI,CACFJ,EAAcG,EAEVC,IAAoB,OAAWH,EAAsBG,EACpDA,EAAkBH,EAErB,IAAII,EAASF,GAAWA,EAAQ,OAAU,CAAC,EACvCG,EAAUH,GAAWA,EAAQ,QAAW,CAAC,EACzCI,EAAaJ,GAAWA,EAAQ,WAAcG,EAGlD,IAAIE,EACAC,GAAqBrB,EAAU,cAAc,cAAc,EAEjE,GADAA,EAAU,UAAY,GAClBqB,GACF,GAAI,CAAErB,EAAU,YAAYqB,EAAkB,CAAG,MAAY,CAAE,CAI7DV,IAAwB,OAC1BO,EAASC,EAAU,OAAQG,GAAW,CAACX,EAAqB,IAAI,OAAOW,EAAE,EAAE,CAAC,CAAC,GAI/EtB,EAAU,MAAM,OAAS,IACzBA,EAAU,MAAM,QAAU,IAC1BA,EAAU,MAAM,OAAS,OACzBA,EAAU,MAAM,QAAU,OAC1BA,EAAU,MAAM,cAAgB,SAChCA,EAAU,MAAM,SAAW,SAE3B,IAAIuB,EAASC,GAAcxB,EAAWC,EAAS,CAC7C,OAAQA,EACR,KAAMG,EACN,WAAY,UAAY,CACtBA,GAAS,GACTqB,EAAc,CAChB,EACA,OAASC,GAAmB,CAC1B,IAAIC,EAAQ,GAEZ,GAAItB,IAAgB,OAAW,CAC7B,GAAI,CACF,IAAMuB,EAAM3B,EACR,oBAAoBA,CAAO,cAC3B,KACA2B,IACEvB,IAAgB,KAClB,aAAa,WAAWuB,CAAG,EAE3B,aAAa,QAAQA,EAAK,KAAK,UAAUvB,CAAW,CAAC,EAG3D,MAAY,CAAE,CACdA,EAAc,OACdsB,EAAQ,EACV,CAGA,GAAIhB,IAAwB,KAAM,CAChC,IAAMkB,EAAY,MAAM,KAAKlB,CAAmB,EAE7C,OAAe,mBAChB,OAAQ,OAAe,kBAAkB,aACzC,YAEC,OAAe,kBAAkB,YAAY,CAC5C,QAAS,sBACT,QAASV,EACT,aAAc4B,CAChB,CAAC,EAGH,GAAI,CACF,IAAMD,EAAM3B,EACR,oBAAoBA,CAAO,gBAC3B,KACA2B,GAAK,aAAa,QAAQA,EAAK,KAAK,UAAUC,CAAS,CAAC,CAC9D,MAAY,CAAE,CACdlB,EAAsB,KACtBgB,EAAQ,EACV,CAoBA,GAjBIrB,IAAoB,SAEnB,OAAe,mBAChB,OAAQ,OAAe,kBAAkB,aACzC,YAEC,OAAe,kBAAkB,YAAY,CAC5C,QAAS,kBACT,QAASL,EACT,SAAUK,CACZ,CAAC,EAEHA,EAAkB,OAClBqB,EAAQ,IAINpB,IAAyB,OAAW,CACtC,GAAI,CACG,OAAe,mBAAqB,OAAQ,OAAe,kBAAkB,aAAgB,YAC/F,OAAe,kBAAkB,YAAY,CAAE,QAAS,uBAAwB,QAASN,EAAS,cAAeM,CAAqB,CAAC,CAE5I,MAAY,CAAE,CACd,GAAI,CAAE,IAAMqB,EAAM3B,EAAU,oBAAoBA,CAAO,iBAAmB,KAAU2B,IAAWrB,IAAyB,KAAM,aAAa,WAAWqB,CAAG,EAAQ,aAAa,QAAQA,EAAK,KAAK,UAAUrB,CAAoB,CAAC,EAAK,MAAY,CAAE,CAClPA,EAAuB,OACvBoB,EAAQ,EACV,CAGA,GAAInB,IAAiB,KAAM,CACzB,GAAI,CACG,OAAe,mBAAqB,OAAQ,OAAe,kBAAkB,aAAgB,YAC/F,OAAe,kBAAkB,YAAY,CAAE,QAAS,eAAgB,QAASP,EAAS,MAAOO,CAAa,CAAC,CAEpH,MAAY,CAAE,CACd,GAAI,CAAE,IAAMoB,EAAM3B,EAAU,oBAAoBA,CAAO,SAAW,KAAU2B,GAAK,aAAa,QAAQA,EAAK,KAAK,UAAUpB,CAAY,CAAC,CAAG,MAAY,CAAE,CACxJA,EAAe,KACfmB,EAAQ,EACV,CAEIA,GAEFF,EAAc,CAElB,EACA,UAAW,IAAM,CACf,GAAIpB,IAAgB,QAAaM,IAAwB,MAAQL,IAAoB,QAAaE,IAAiB,KAAM,CACvHH,EAAc,OACdM,EAAsB,KACtBL,EAAkB,OAClBE,EAAe,KAGf,GAAI,CAAMC,GAAoB,OAAOA,EAAiB,OAAU,YAAYA,EAAiB,MAAM,EAAGA,EAAmB,IAAM,MAAY,CAAE,CAGzIG,EAAaE,EAAOF,EAAaC,CAAmB,EACnDY,EAAc,CACrB,CACF,CACF,CAAC,EAGD,GAAI,CACF,GACET,GACAO,GACA,OAAOA,EAAO,oBAAuB,WAErC,GAAI,CACFA,EAAO,mBAAmBP,CAAe,CAC3C,MAAY,CAAE,CAElB,MAAY,CAAE,CAGd,GAAI,CAEF,IAAIc,EAAyC,KAC7C,GAAIzB,IAAgB,OAClByB,EAAsBzB,GAAe,aAC5BJ,EACT,GAAI,CACF,IAAM8B,EAAS,aAAa,QAAQ,oBAAoB9B,CAAO,aAAa,EACxE8B,IAAQD,EAAsB,KAAK,MAAMC,CAAM,EACrD,MAAY,CAAE,CAEXD,IACHA,EAAsBE,GAAkBjB,GAAWA,EAAQ,SAAWA,EAAQ,QAAQ,YAAY,GAGpG,IAAIkB,EAAiC,KACrC,GAAIH,GAAuBA,EAAoB,QAAS,CACtD,IAAMI,EAAYf,EAAU,KAAMG,GAAW,OAAOA,EAAE,EAAE,IAAM,OAAOQ,EAAqB,OAAO,CAAC,EAClGG,EAAkBC,EAAYA,EAAU,KAAO,IACjD,CAGA,GAAI,CACF,GAAI3B,IAAyB,OAC3Ba,EAAyBb,IAAyB,KAAO,KAAQA,GAAwB,aAChFN,EACT,GAAI,CAAE,IAAM8B,EAAS,aAAa,QAAQ,oBAAoB9B,CAAO,gBAAgB,EAAO8B,IAAQX,EAAyB,KAAK,MAAMW,CAAM,EAAG,MAAY,CAAE,CAEjK,GAAI,CACF,IAAMI,EAASpB,EAAgB,SAAYA,EAAgB,QAAQ,eAAiB,MAAM,QAASA,EAAgB,QAAQ,cAAc,KAAK,EAAKA,EAAgB,QAAQ,cAAc,MAAM,IAAKqB,GAAW,OAAOA,EAAE,IAAMA,EAAE,IAAI,CAAC,EAAI,KACrOhB,IAA2B,MAAQe,IAAOf,EAAyBe,EACzE,MAAY,CAAE,CAChB,MAAY,CAAE,CAEb,OAAe,aAAgB,OAAe,cAAgB,CAAC,EAC/D,OAAe,aAAalC,CAAO,EAAI,CACtC,OAAQkB,EACR,MAAOF,GAAS,CAAC,EACjB,gBAAiB,IAAI,IAAIC,EAAO,IAAKI,GAAW,OAAOA,EAAE,EAAE,CAAC,CAAC,EAC7D,YAAaW,EACb,cAAeb,EACf,mBAAoB,CAACiB,EAAiBC,IAAqB,CACzD,GAAI,CAEF,GAAI3B,IAAwB,KAAM,CAChCA,EAAsB,IAAI,IAE1B,IAAM4B,EAAa,IAAI,IAAIrB,EAAO,IAAKI,GAAW,OAAOA,EAAE,EAAE,CAAC,CAAC,EAC/DH,EAAU,QAASG,GAAW,CACvBiB,EAAW,IAAI,OAAOjB,EAAE,EAAE,CAAC,GAAGX,EAAqB,IAAI,OAAOW,EAAE,EAAE,CAAC,CAC1E,CAAC,CACH,CAEA,IAAMkB,EAAK,OAAOH,CAAO,EACrBC,EAAS3B,EAAoB,OAAO6B,CAAE,EACrC7B,EAAoB,IAAI6B,CAAE,EAG3B5B,GAAaE,EAAOF,EAAaC,CAAmB,CAC1D,MAAY,CAAE,CAChB,EACA,aAAe4B,GAA6B,CAC1C,GAAI,CACFnC,EAAkBmC,EAEd7B,GAAaE,EAAOF,EAAaC,CAAmB,CAC1D,MAAY,CAAE,CAChB,EACA,mBAAqB6B,GAA8B,CACjD,GAAI,CACFnC,EAAuBmC,IAAa,KAAO,KAAQA,GAAY,CAAC,EAC5D9B,GAAaE,EAAOF,EAAaC,CAAmB,CAC1D,MAAY,CAAE,CAChB,EACA,cAAgB4B,GAA6B,CAC3C,GAAI,CACF/B,EAAgB+B,EAEZ7B,GAAaE,EAAOF,EAAaC,CAAmB,CAC1D,MAAY,CAAE,CAChB,EACA,UAAYwB,GAA2B,CACrC,GAAI,CACEA,IAAY,KACdhC,EAAc,KAEdA,EAAc,CAAE,QAAAgC,EAAS,UAAW,KAAM,EAGxCzB,GAAaE,EAAOF,EAAaC,CAAmB,CAC1D,MAAY,CAAE,CAChB,EAEA,WAAawB,GAA2B,CACtC,GAAI,CACF7B,EAAe6B,EAAU,CAAE,QAAAA,EAAS,MAAO,IAAK,EAAI,KAChDzB,GAAaE,EAAOF,EAAaC,CAAmB,CAC1D,MAAY,CAAE,CAChB,EACA,eAAgB,CAAC8B,EAAsBC,IAAyB,CAC9D,GAAI,CAEF,GAAI,CAAMnC,GAAoB,OAAOA,EAAiB,OAAU,YAAYA,EAAiB,MAAM,EAAGA,EAAmB,IAAM,MAAY,CAAE,CAE7I,GAAI,CAAE,IAAMoC,EAAW7C,EAAU,cAAc,cAAc,EAAO6C,GAAUA,EAAS,OAAO,CAAG,MAAY,CAAE,CAC/G,IAAMC,EAAiB,IAAI,IAAI,CAAC,YAAY,gBAAgB,eAAe,YAAY,SAAS,OAAO,YAAY,aAAa,SAAS,OAAO,kBAAkB,CAAC,EAC/JC,EAAa,KACjB,GAAI,CACF,IAAMC,EAAMxC,EAAe,OAAOA,EAAa,OAAO,EAAI,KACtDwC,IAAKD,EAAQ5B,EAAU,KAAMG,GAAW,OAAOA,EAAE,EAAE,IAAM0B,CAAG,EAClE,MAAY,CAAE,CAEd,GADKD,IAAOA,GAAS5B,GAAa,CAAC,GAAG,KAAMG,GAAWwB,EAAe,IAAI,QAAQxB,EAAE,UAAY,IAAI,YAAY,CAAC,CAAC,CAAC,GAC/G,CAACyB,EAAO,OACZ,GAAI,CACFtC,EAAmB,IAAIwC,GAAWjD,EAAW+C,EAAO9B,GAAS,CAAC,EAAGE,GAAa,CAAC,CAAC,EAChFV,EAAiB,OAAO,EAIxB,GAAI,CACF,IAAMyC,EAAOlD,EAAU,cAAc,kBAAkB,GAAKA,EAAU,cAAc,gBAAgB,GAAKA,EAAU,cAAc,gBAAgB,GAAKA,EAAU,mBAAqBA,EAC/KmD,EAAKnD,EAAU,cAAc,cAAc,EACjD,GAAImD,EACF,GAAI,CACED,GAAQA,EAAK,eAAiBA,EAAK,cAAc,SAASA,CAAI,GAChEA,EAAK,cAAc,aAAaC,EAAID,CAAe,EAEnDA,EAAK,cAAc,MAAM,cAAgB,OAGzClD,EAAU,aAAamD,EAAInD,EAAU,UAAU,CAEnD,MAAa,CACX,GAAI,CAAEA,EAAU,aAAamD,EAAInD,EAAU,UAAU,CAAG,MAAY,CAAE,CACxE,CAEJ,MAAY,CAAE,CAGd,GAAI,CAAM4C,GAAcnC,GAAoB,OAAOA,EAAiB,mBAAsB,YAAYA,EAAiB,kBAAkBmC,CAAU,CAAG,MAAY,CAAE,CACpKnC,EAAiB,cAAe2C,GAAe,CAC7C,GAAI,CACF5C,EAAe,CAAE,QAASuC,EAAM,GAAI,MAAAK,CAAM,EAE1C,GAAI,CACE7B,GAAUA,EAAO,SAAWA,EAAO,aACrCA,EAAO,QAAQ,SAAW,GAAOA,EAAO,QAAQ,MAAM,QAAU,IAAKA,EAAO,QAAQ,MAAM,OAAS,UACnGA,EAAO,WAAW,SAAW,GAAOA,EAAO,WAAW,MAAM,QAAU,IAAKA,EAAO,WAAW,MAAM,OAAS,UAEhH,MAAY,CAAE,CAEVX,GAAaE,EAAOF,EAAaC,CAAmB,CAC1D,MAAY,CAAE,CAChB,CAAC,EACDJ,EAAiB,cAAe4C,GAAkB,CAChD,GAAI,CAEF5C,GAAoBA,EAAiB,OAASA,EAAiB,MAAM,EACrEA,EAAmB,KACnBD,EAAe,KACX6C,IACF7C,EAAe,CAAE,QAAS6C,EAAS,GAAI,MAAO,IAAK,EAElD,OAAe,aAAapD,CAAO,GAAM,OAAe,aAAaA,CAAO,EAAE,gBAAmB,OAAe,aAAaA,CAAO,EAAE,eAAe,EAE1J,MAAY,CAAE,CAChB,CAAC,CAEH,MAAY,CAAE,CAEd,GAAI,CACF,IAAMkD,EAAM1C,GAA6BA,EAAyB,aAAgBA,EAAyB,aAA8B,KACzI,GAAI0C,EAAI,MAAO,CAAE,GAAAA,EAAI,QAAS,IAAM,CAAE,GAAI,CAAc,MAAY,CAAC,CAAE,CAAE,CAC3E,MAAY,CAAE,CACd,OAAO,IACT,MAAY,CAAE,CAChB,EACA,IAAI,cAAe,CACjB,GAAI,CACF,IAAMH,EAAMxC,EAAe,OAAOA,EAAa,OAAO,EAAI,KAC1D,GAAIwC,EAAK,CACP,IAAM1B,GAAKH,GAAa,CAAC,GAAG,KAAMmC,GAAY,OAAOA,EAAG,EAAE,IAAMN,CAAG,EACnE,OAAO1B,EAAIA,EAAE,KAAO0B,CACtB,CACA,GAAI/C,EACF,GAAI,CACF,IAAM8B,EAAS,aAAa,QAAQ,oBAAoB9B,CAAO,QAAQ,EACvE,GAAI8B,EAAQ,CACV,IAAMwB,EAAS,KAAK,MAAMxB,CAAM,EAChC,GAAIwB,GAAUA,EAAO,QAAS,CAC5B,IAAMjC,GAAKH,GAAa,CAAC,GAAG,KAAMmC,GAAY,OAAOA,EAAG,EAAE,IAAM,OAAOC,EAAO,OAAO,CAAC,EACtF,OAAOjC,EAAIA,EAAE,KAAO,OAAOiC,EAAO,OAAO,CAC3C,CACF,CACF,MAAY,CAAE,CAElB,MAAY,CAAE,CACd,OAAO,IACT,CACF,CACF,MAAY,CAAE,CAGd,GAAI,CACD,OAAe,aAAgB,OAAe,cAAgB,CAAC,EAC/D,OAAe,aAAatD,CAAO,EAAK,OAAe,aAAaA,CAAO,GAAK,CAAC,CACpF,MAAY,CAAE,CAEd,GAAI,CAACsB,EAAQ,CACX,IAAIiC,EAAS,SAAS,cAAc,KAAK,EACzCA,EAAO,MAAM,QAAU,OACvBA,EAAO,MAAM,eAAiB,gBAC9BA,EAAO,MAAM,WAAa,SAC1BA,EAAO,MAAM,aAAe,MAE5B,IAAIC,EAAQ,SAAS,cAAc,KAAK,EACxCA,EAAM,MAAM,WAAa,MACzBA,EAAM,MAAM,QAAU,MACtBA,EAAM,YAAcvD,EAEpB,IAAIwD,EAAQ,SAAS,cAAc,KAAK,EACpCC,EAAUC,GAAqB,IAAM,CACvCxD,GAAS,GACTqB,EAAc,CAChB,CAAC,EAEDiC,EAAM,YAAYC,CAAO,EACzBH,EAAO,YAAYC,CAAK,EACxBD,EAAO,YAAYE,CAAK,EACxB1D,EAAU,YAAYwD,CAAM,CAC9B,CAGA,IAAIK,EAAmB,KAGvB,GAAInD,IAAkB,OAChBA,IAAkB,OACpBmD,EAAc1C,EAAU,KAAMG,GAAWA,EAAE,OAASZ,CAAa,OAGnE,IAAI,CACF,IAAMoD,EAAU/C,GAAWA,EAAQ,QAC7BgD,EACJD,GACAA,EAAQ,uBACRA,EAAQ,sBAAsB,MAEhC,GAAIC,GAAyBA,EAAsB,OAAS,EAAG,CAE7D,IAAMC,EAAWD,EAAsB,CAAC,EAQxC,GAPAF,EAAc1C,EAAU,KACrBG,GACC,OAAOA,EAAE,EAAE,IAAM,OAAO0C,EAAS,EAAE,GACnC,OAAO1C,EAAE,IAAI,IAAM,OAAO0C,EAAS,IAAI,CAC3C,EAGIH,EAAa,CACf,IAAMI,EAAW,OAAOJ,EAAY,UAAY,EAAE,EAAE,YAAY,EAC5DI,IAAa,iBAAmBA,IAAa,cAC/CpE,EAASI,EAAS,0CAA2C,CAC3D,SAAAgE,EACA,UAAWJ,EAAY,IACzB,CAAC,EACDA,EAAc,KAElB,CACF,CACE,MAAY,CAAE,CAIfA,IACHA,EAAc1C,EAAU,KACrBG,GACC,OAAOA,EAAE,UAAY,EAAE,EAAE,YAAY,IAAM,iBAC3C,OAAOA,EAAE,MAAQ,EAAE,EAAE,YAAY,IAAM,QAC3C,GAIGuC,IACHA,EAAc1C,EAAU,KACrBG,GACC,OAAOA,EAAE,UAAY,EAAE,EAAE,YAAY,IAAM,eAC/C,GAIF,GAAI,CACG,OAAe,cAAiB,OAAe,aAAarB,CAAO,IACrE,OAAe,aAAaA,CAAO,EAAE,cAAiB4D,GAAeA,EAAY,MAAS,KAE/F,MAAY,CAAE,CAGd,IAAIK,EAAqB,KAEzB,GAAI5D,IAAoB,OAElBA,IAAoB,KACtB4D,EAAgB,KAEhBA,EAAgB/C,EAAU,KAAMG,GAAWA,EAAE,OAAShB,CAAe,MAGvE,IAAI,CACF,IAAMwD,EAAU/C,GAAWA,EAAQ,QAC7BoD,EACJL,GACAA,EAAQ,eACRA,EAAQ,cAAc,MAExB,GAAIK,GAAiBA,EAAc,OAAS,EAAG,CAC7C,IAAMC,EAAUD,EAAc,CAAC,EAC/BD,EAAgB/C,EAAU,KACvBG,GACC,OAAOA,EAAE,EAAE,IAAM,OAAO8C,EAAQ,EAAE,GAClC,OAAO9C,EAAE,IAAI,IAAM,OAAO8C,EAAQ,IAAI,CAC1C,CACF,CACF,OAASC,EAAG,CACVxE,EAASI,EAAS,gDAAiD,CACjE,QAAS,OAAQoE,GAAW,SAAWA,CAAC,CAC1C,CAAC,CACH,CAIF,GAAI9C,IAAWlB,IAAgB,QAAaM,IAAwB,MAAQL,IAAoB,QAC9F,GAAI,CACEiB,EAAO,UACTA,EAAO,QAAQ,SAAW,GAC1BA,EAAO,QAAQ,MAAM,QAAU,IAC/BA,EAAO,QAAQ,MAAM,OAAS,WAE5BA,EAAO,aACTA,EAAO,WAAW,SAAW,GAC7BA,EAAO,WAAW,MAAM,QAAU,IAClCA,EAAO,WAAW,MAAM,OAAS,UAErC,MAAY,CAAE,CAIhB,GAAI,CAEF,IAAM+C,EAAmBJ,GAAiBA,EAAc,MAAS,KAC5D,OAAe,cAAiB,OAAe,aAAajE,CAAO,IACrE,OAAe,aAAaA,CAAO,EAAE,QAAUqE,EAEpD,MAAY,CAAE,CAGd,IAAIC,EAAU,SAAS,cAAc,KAAK,EAC1CA,EAAQ,MAAM,KAAO,WACrBA,EAAQ,MAAM,SAAW,SACzBA,EAAQ,MAAM,SAAW,WACzBA,EAAQ,MAAM,QAAU,OACxBA,EAAQ,MAAM,cAAgB,SAG9B,IAAMC,GAAgBC,GAAmB,CACvC,GAAIlD,GAAUA,EAAO,QAAS,CAC5B,IAAMmD,EAAU,OAAOnD,EAAO,QAAQ,OAAS,EAAE,EAAE,KAAK,EAEpDG,EAAYgD,EAAU,GAAGA,CAAO,IAAID,CAAM,GAAKA,EACnDlD,EAAO,QAAQ,MAAQG,EACvBH,EAAO,QAAQ,cAAc,IAAI,MAAM,QAAS,CAAE,QAAS,EAAK,CAAC,CAAC,CACpE,CACF,EAGIoD,GAAa3C,GAAkBjB,GAAWA,EAAQ,SAAWA,EAAQ,QAAQ,YAAY,EAC7F,GAAId,EACF,GAAI,CACF,IAAM8B,EAAS,aAAa,QAAQ,oBAAoB9B,CAAO,aAAa,EACxE8B,IAAQ4C,GAAa,KAAK,MAAM5C,CAAM,EAC5C,MAAY,CAAE,CAGZ1B,IAAgB,SAClBsE,GAAatE,GAAe,MAI9B,IAAIuE,GAAe3D,EACf0D,KACFC,GAAeC,GAAU5D,EAAOE,EAAWwD,EAAU,GAInDnE,IACFoE,GAAeA,GAAa,OAAQE,GAAe,CACjD,IAAMC,EAAKD,EAAK,YAAY,KAAMxD,GAAW,OAAOA,EAAE,OAAO,IAAM,OAAOd,EAAc,OAAO,CAAC,EAE9FuC,EAAQ5B,EAAU,KAAMG,GAAmBA,EAAE,KAAOd,EAAc,OAAO,EACzEyD,EAAWlB,GAASA,EAAM,UAAYA,EAAM,MAAQ,IAAI,YAAY,EAAI,GAG1EiC,EAAM,KACV,GAAI,CAACD,EAEHC,EAAM,aAEDD,EAAW,OAAS,OAAWC,EAAOD,EAAW,aAC5CA,EAAW,QAAU,OAAWC,EAAOD,EAAW,cAClDA,EAAW,SAAW,OAAWC,EAAOD,EAAW,eACnDA,EAAW,OAAS,OAAWC,EAAOD,EAAW,aACjDA,EAAW,OAAQC,EAAOD,EAAW,OAAO,aAC5CA,EAAW,UAAWC,EAAOD,EAAW,UAAU,cAClDA,EAAW,UAAWC,EAAOD,EAAW,kBACxCA,EAAW,OAAQC,EAAOD,EAAW,eACtCd,IAAa,eAAgB,CACpC,IAAMgB,EAAKF,EAAW,QAAWA,EAAW,aAAgBA,EAAW,OAAUA,EAAW,MAASA,EAAW,OAAS,KACrHE,IAAGD,EAAMC,EAAE,OAASA,EAAE,MAAQA,EAAE,QAAUA,EAAE,IAAMA,EAAE,KAAO,KACjE,MACShB,IAAa,YACpBe,EAAOD,EAAW,WAAW,OAAUA,EAAW,WAAW,MAASA,EAAW,OAAS,KAEnFd,IAAa,aACpBe,EAAOD,EAAW,YAAY,eAAkBA,EAAW,YAAY,WAAcA,EAAW,YAAY,MAASA,EAAW,OAAS,KAEtIC,EAAOD,EAAW,MAGzB,GAAIvE,EAAc,QAAU,KAE1B,OAAIyD,IAAa,aAAeA,IAAa,SACpC,CAACe,GAAQ,MAAM,QAAQA,CAAG,GAAKA,EAAI,SAAW,EAE9CA,GAAQ,KAGf,GAAIf,IAAa,aAAeA,IAAa,SAAU,CACrD,GAAI,CAAC,MAAM,QAAQe,CAAG,EAAG,MAAO,GAChC,GAAIf,IAAa,YAEf,OAAOe,EAAI,KAAME,GACfA,IAAaA,EAAS,QAAU1E,EAAc,OAAO,OAAS0E,EAAS,KAAO1E,EAAc,OAAO,GACrG,EACK,GAAIyD,IAAa,SAEtB,OAAOe,EAAI,KAAMG,GACfA,IAAUA,EAAM,OAAS3E,EAAc,OAAS2E,EAAM,KAAO3E,EAAc,MAC7E,CAEJ,KACE,QAAOwE,IAAQxE,EAAc,KAEjC,CAAC,GAGH,IAAM4E,GAAe,CAACC,EAAgBP,EAAWQ,IAAc,CAC7D,GAAID,IAAW,aAAeC,EAAM,CAEvB,SAAS,iBAAiB,qBAAqB,EACvD,QAASjB,GAAMA,EAAE,OAAO,CAAC,EAE5B,IAAMkB,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAY,qBACjBA,EAAK,MAAM,SAAW,QAEtB,IAAMC,EAAI,KAAK,IAAIF,EAAK,EAAG,OAAO,WAAa,GAAG,EAC5CG,EAAI,KAAK,IAAIH,EAAK,EAAG,OAAO,YAAc,GAAG,EAEnDC,EAAK,MAAM,KAAOC,EAAI,KACtBD,EAAK,MAAM,IAAME,EAAI,KACrBF,EAAK,MAAM,WAAa,gCACxBA,EAAK,MAAM,MAAQ,gCACnBA,EAAK,MAAM,OAAS,sCACpBA,EAAK,MAAM,aAAe,MAC1BA,EAAK,MAAM,OAAS,OACpBA,EAAK,MAAM,UAAY,6BACvBA,EAAK,MAAM,SAAW,QACtBA,EAAK,MAAM,QAAU,QAErB,IAAMG,EAAU,CACdC,EACAC,EACAC,GACAC,GAAQ,KACL,CACH,GAAIA,GAAO,CACT,IAAMC,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,MAAM,OAAS,MACnBA,EAAI,MAAM,WAAa,yCACvBA,EAAI,MAAM,OAAS,QACnBR,EAAK,YAAYQ,CAAG,EACpB,MACF,CACA,IAAM5C,EAAK,SAAS,cAAc,KAAK,EACvCA,EAAG,MAAM,QAAU,UACnBA,EAAG,MAAM,OAAS,UAClBA,EAAG,MAAM,QAAU,OACnBA,EAAG,MAAM,WAAa,SACtBA,EAAG,MAAM,IAAM,MACfA,EAAG,MAAM,SAAW,OAGpB,IAAM6C,EAAM,SAAS,cAAc,MAAM,EACrCJ,IACFI,EAAI,UAAY,mBAAqBJ,EAKjCA,IAAc,gBAAiBI,EAAI,YAAc,SAC5CJ,IAAc,QAASI,EAAI,YAAc,YACzCJ,IAAc,eAAcI,EAAI,YAAc,WAGzD,IAAMC,EAAO,SAAS,cAAc,MAAM,EAC1CA,EAAK,YAAcN,EAEnBxC,EAAG,YAAY6C,CAAG,EAClB7C,EAAG,YAAY8C,CAAI,EAEnB9C,EAAG,iBAAiB,QAAUkB,GAAM,CAClCA,EAAE,gBAAgB,EAClBkB,EAAK,OAAO,EACZM,GAAQ,CACV,CAAC,EAED1C,EAAG,iBACD,aACA,IACCA,EAAG,MAAM,WACR,wCACJ,EACAA,EAAG,iBACD,aACA,IAAOA,EAAG,MAAM,WAAa,aAC/B,EACAoC,EAAK,YAAYpC,CAAE,CACrB,EAEAuC,EAAQ,aAAc,gBAAiB,IAAM,CAC3C,IAAMQ,EACJpB,EAAK,SAAS,KACdA,EAAK,KACJA,EAAK,KAAOA,EAAK,IAAI,aAAeA,EAAK,IAAI,YAAY,IACxDoB,GAAQ,OAAe,mBACxB,OAAe,kBAAkB,YAAY,CAC5C,QAAS,UACT,IAAKA,CACP,CAAC,CAEL,CAAC,EAEDR,EAAQ,GAAI,GAAI,IAAM,CAAE,EAAG,EAAI,EAE/BA,EAAQ,oBAAqB,aAAc,IAAM,CAC/C,GAAK,OAAe,kBAAmB,CAErC,IAAIS,EAAiB,CAAC,EACtB,GAAItC,EAAa,CACf,IAAMuC,EACJvC,EAAY,SACXA,EAAY,eACXA,EAAY,cAAc,QACxBwC,GACJxC,EAAY,eACZA,EAAY,cAAc,WAGtByC,GAAoB,CACxBC,EACAC,IACG,CACH,GAAI,CACF,IAAMC,EAAY,IAAI,KAAKF,CAAK,EAC1BG,EAAU,IAAI,KAClBD,EAAU,QAAQ,EAClB,OAAOD,CAAQ,EAAI,GAAK,GAAK,GAAK,GACpC,EACMG,GAAcC,IAClBA,GAAE,mBAAmB,QAAS,CAC5B,MAAO,QACP,IAAK,SACP,CAAC,EACH,MAAO,GAAGD,GAAWF,CAAS,CAAC,WAAME,GAAWD,CAAO,CAAC,EAC1D,MAAY,CACV,MAAO,EACT,CACF,EAEIN,GAAQ,MAAM,QAAQA,CAAI,EAC5BD,EAAUC,EAAK,IAAKS,IAAY,CAC9B,GAAIA,EAAE,GACN,KAAMA,EAAE,KACR,MAAOA,EAAE,MACT,YAAaA,EAAE,WACjB,EAAE,EACOR,IAAS,MAAM,QAAQA,EAAK,IACrCF,EAAUE,GAAM,IAAKS,IAAa,CAChC,GAAIA,EAAG,GACP,KAAMA,EAAG,MACT,MAAOA,EAAG,MACV,YAAaR,GAAkBQ,EAAG,UAAWA,EAAG,QAAQ,CAC1D,EAAE,EAEN,CAEC,OAAe,kBAAkB,YAAY,CAC5C,QAAS,WACT,QAAS7G,EACT,OAAQ6E,EAAK,GACb,UAAW/D,GAAWA,EAAQ,GAC9B,QAAS8C,EAAcA,EAAY,GAAK,KACxC,QAASsC,EACT,aAAc,EAChB,CAAC,CACH,CACF,CAAC,EAED,SAAS,KAAK,YAAYZ,CAAI,EAG9B,IAAMwB,GAAe,IAAM,CACzBxB,EAAK,OAAO,EACZ,SAAS,oBAAoB,QAASwB,EAAY,CACpD,EAEA,WACE,IAAM,SAAS,iBAAiB,QAASA,EAAY,EACrD,CACF,CACF,MAAW1B,IAAW,sBAAwBP,GAAQQ,GAEpD,sCACG,KAAK,CAAC,CAAE,YAAA0B,CAAY,IAAM,CACZ,IAAIA,EAAY,CAC3B,cAAe1B,EAAK,cACpB,cAAe,IAAM,CACnB,GAAI,CACF,IAAM2B,EAAa,OAAe,kBAEhCA,GACA,OAAOA,EAAU,aAAgB,YAEjCA,EAAU,YAAY,CACpB,QAAS,sBACT,QAAShH,EACT,UAAWc,GAAWA,EAAQ,GAC9B,cAAe+D,EAAK,cACpB,cAAeA,EAAK,cACpB,gBAAiBA,EAAK,eACxB,CAAC,CAEL,OAAST,EAAG,CACV,QAAQ,MACN,gDACAA,CACF,CACF,CACF,EACA,cAAe,IAAM,CACnB,GAAI,CACF,IAAM4C,EAAa,OAAe,kBAEhCA,GACA,OAAOA,EAAU,aAAgB,YAEjCA,EAAU,YAAY,CACpB,QAAS,sBACT,QAAShH,EACT,UAAWc,GAAWA,EAAQ,GAC9B,cAAe+D,EAAK,cACpB,cAAeA,EAAK,cACpB,gBAAiBA,EAAK,eACxB,CAAC,CAEL,OAAST,EAAG,CACV,QAAQ,MACN,iDACAA,CACF,CACF,CACF,CACF,CAAC,EACI,KAAK,CACZ,CAAC,EACA,MAAOA,GAAM,CACZ,QAAQ,MAAM,6BAA8BA,CAAC,CAC/C,CAAC,CAEP,EAGA,GAAIR,EACF,GAAI,CAEF,IAAMqD,EAAkBhG,EAAO,IAAKI,GAAW,OAAOA,EAAE,EAAE,CAAC,EACtC,IAAI6F,GACvBhG,EACAyD,GACAsC,EACA1C,GACAY,GACAhE,CACF,EACa,YAAYmD,EAASV,EAAaK,CAAa,CAC9D,OAASG,EAAG,CACVxE,EAASI,EAAS,sCAAuC,CACvD,QAAS,OAAQoE,GAAW,SAAWA,CAAC,CAC1C,CAAC,EAED+C,EAAe7C,EAAStD,CAAK,CAC/B,MAGApB,EAASI,EAAS,iCAAkC,CAClD,YAAakB,EAAU,MACzB,CAAC,EACDiG,EAAe7C,EAAStD,CAAK,EAG/BjB,EAAU,YAAYuE,CAAO,EAG7B,GAAI,CACF,IAAM8C,EAAUrH,EAAU,cAAc,cAAc,EACtD,GAAIqH,EAAS,CACX,IAAMnE,EAAOqB,EAAQ,cAAc,kBAAkB,GAAKA,EAAQ,cAAc,gBAAgB,GAAKA,EAAQ,cAAc,gBAAgB,GAAKA,EAAQ,kBACpJrB,GAAQA,EAAK,gBAAkBqB,IACjCA,EAAQ,aAAa8C,EAASnE,CAAI,EAClCqB,EAAQ,MAAM,QAAU,OACxBA,EAAQ,MAAM,cAAgB,MAElC,CACF,MAAY,CAAE,CAEd,GAAI,CACEhD,GAAU,OAAOA,EAAO,UAAa,YACvCA,EAAO,SAASN,EAAM,MAAM,EAC1BM,GAAU,OAAOA,EAAO,cAAiB,YAC3CA,EAAO,aACLN,EAAM,OAASb,EACfa,EAAM,QAAUb,EAAQ,YAAc,YACxC,EAGEmB,GAAUA,EAAO,UACf,OAAOA,EAAO,eAAkB,YAClCA,EAAO,cAAcN,EAAO,CAAE,OAAQC,CAAO,CAAC,EAE5C,OAAOK,EAAO,gBAAmB,YACnCA,EAAO,eAAe,SAAU+F,EAAiBC,EAAgB,CAC/DC,GACExH,EACA,oBACAsH,EACA,OACF,EAEI/F,GAAU,OAAOA,EAAO,UAAa,YACvCA,EAAO,SAAS+F,EAAW,IAAI,EAEjCzH,EAASI,EAAS,cAAe,CAC/B,OAAQsH,EACR,QAASD,EAAW,KACpB,SAAUrG,EAAM,MAClB,CAAC,CACH,CAAC,EAEC,OAAOM,EAAO,cAAiB,YACjCA,EAAO,aAAckG,GAA8B,CACjDpH,EAAcoH,GAAU,KACpBlG,GAAUA,EAAO,SAAWA,EAAO,aACrCA,EAAO,QAAQ,SAAW,GAC1BA,EAAO,WAAW,SAAW,GAC7BA,EAAO,QAAQ,MAAM,QAAU,IAC/BA,EAAO,QAAQ,MAAM,OAAS,UAC9BA,EAAO,WAAW,MAAM,QAAU,IAClCA,EAAO,WAAW,MAAM,OAAS,UAErC,CAAC,EAGP,MAAY,CAAE,CAChB,OAASmG,EAAK,CACZ7H,EAASI,EAAS,gCAAiC,CACjD,QAAS,OAAOyH,GAAQA,EAAY,OAAO,EAC3C,MAAOA,GAAQA,EAAY,KAC7B,CAAC,EACDC,GACE3H,EACAE,EACA,+BAAiC,OAAOwH,GAAQA,EAAY,OAAO,CACrE,CACF,CACF,CAGA,SAASN,EAAe7C,EAAsBtD,EAAc,CAC1D,QAAS2G,EAAI,EAAGA,EAAI3G,EAAM,OAAQ2G,IAAK,CACrC,IAAId,EAAK7F,EAAM2G,CAAC,EACZC,EAAO,SAAS,cAAc,KAAK,EACvC,GAAI,CACFA,EAAK,aAAa,kBAAmB,OAAOf,GAAMA,EAAG,EAAE,CAAC,CAC1D,MAAY,CAAE,CACde,EAAK,MAAM,QAAU,MACrBA,EAAK,MAAM,OAAS,8CACpBA,EAAK,MAAM,aAAe,MAC1BA,EAAK,MAAM,aAAe,MAC1B,IAAIC,EACDhB,GAAMA,EAAG,UAAYA,EAAG,QAAQ,OAASA,EAAG,QAAQ,OACpDA,GAAMA,EAAG,OACTA,GAAMA,EAAG,KAAOA,EAAG,IAAI,OACxB,KAAOc,EAAI,GACbC,EAAK,UACH,gCACAE,EAAWD,CAAS,EACpB,UACChB,GAAMA,EAAG,GACN,yEACFiB,EAAW,OAAOjB,EAAG,EAAE,CAAC,EACxB,SACE,IACNvC,EAAQ,YAAYsD,CAAI,CAC1B,CACF,CAEA,SAASG,EAAUC,EAAkB,CACnC,IAAIC,EAAMD,GAAMA,EAAG,KAAOA,EAAG,KAAOA,EACpC,GAAI,CACF,GAAIC,GAAOA,EAAI,UAAY,SAAU,CACnC,GAAIA,EAAI,SAAWjI,GAAW,OAAOiI,EAAI,OAAO,IAAM,OAAOjI,CAAO,EAClE,OACEiI,EAAI,MACNP,GAAc3H,EAAWE,EAAU,OAAOgI,EAAI,KAAK,CAAC,EAEpDpH,EACEoH,EAAI,SAAYA,EAAI,SAAWA,EAAI,QAAQ,MAASA,EAAI,QACxDA,EAAI,eACN,CAEJ,CACF,MAAY,CAAE,CAChB,CAEA,SAASzG,GAAgB,CACvB,GAAI,CAEC,OAAe,mBAChB,OAAQ,OAAe,kBAAkB,aAAgB,YAExD,OAAe,kBAAkB,YAAY,CAC5C,QAAS,gBACT,MAAOrB,EACP,QAASH,CACX,CAAC,CAEL,MAAY,CAAE,CAChB,CACA,GAAI,CACD,OAAe,kBAAkB,UAAU+H,CAAS,CACvD,MAAY,CACV,OAAO,iBAAiB,UAAWA,CAAS,CAC9C,CACAvG,EAAc,CAChB,CACF,CACA,GAAI,CACF,OAAO,iBAAmB3B,GAAmB,CAC/C,MAAY,CAAE",
  "names": ["GroupDataService", "init_GroupDataService", "__esmMin", "items", "field", "options", "dType", "groups", "opt", "unassigned", "item", "index", "fv", "v", "placed", "matchId", "matchName", "group", "g", "map", "unassignedFallback", "val", "p", "a", "displayVal", "lines", "key", "groupsArr", "FieldsMenu_exports", "__export", "FieldsMenu", "FieldsMenu_default", "init_FieldsMenu", "__esmMin", "options", "anchorElement", "anchorRect", "n", "rect", "menuRect", "margin", "vw", "vh", "top", "left", "finalTop", "title", "icon", "label", "newField", "visible", "f", "hidden", "text", "h", "r", "field", "row", "c", "s", "iconHtml", "newVisible", "dataType", "iconName", "GroupByMenu_exports", "__export", "GroupByMenu", "GroupByMenu_default", "init_GroupByMenu", "__esmMin", "init_GroupDataService", "options", "anchor", "anchorRect", "title", "noneRow", "noneCheck", "noneLabel", "candidateFields", "f", "groups", "GroupDataService", "r", "check", "currentVal", "left", "dt", "iconName", "s", "label", "rectAnchor", "mrect", "vw", "vh", "margin", "top", "maxTop", "SortByMenu_exports", "__export", "SortByMenu", "SortByMenu_default", "getIconSvg", "iconName", "size", "getIconNameForDataType", "dataType", "init_SortByMenu", "__esmMin", "options", "anchor", "anchorRect", "title", "f", "isActive", "id", "label", "row", "check", "iconEl", "s", "labelEl", "rectAnchor", "mrect", "vw", "vh", "margin", "top", "maxTop", "left", "FieldSumMenu_exports", "__export", "FieldSumMenu", "FieldSumMenu_default", "init_FieldSumMenu", "__esmMin", "options", "anchor", "anchorRect", "title", "addRow", "id", "label", "icon", "selected", "r", "check", "left", "s", "lbl", "ev", "cur", "currentSet", "f", "dt", "rect", "menuRect", "vw", "vh", "AddItemMenu_exports", "__export", "AddItemMenu", "init_AddItemMenu", "__esmMin", "options", "rect", "menuRect", "margin", "vw", "vh", "top", "left", "mkItem", "iconName", "label", "description", "onClick", "row", "iconSpan", "textContainer", "titleEl", "descEl", "escapeHtml", "s", "normalizeColor", "color", "n", "b", "u", "addAlpha", "alpha", "S", "v", "C", "getContrastColor", "logDebug", "viewKey", "message", "data", "setLoadingState", "container", "titleText", "setErrorState", "error", "createLoadMoreButton", "onClick", "btn", "initFilterBar", "container", "viewKey", "options", "applyFilterVisibility", "root", "selector", "matchedIds", "displayStyle", "elements", "i", "el", "id", "createEl", "tag", "renderColorDot", "option", "colorDot", "normalizeColor", "renderNameSpan", "groupingField", "nameSpan", "name", "renderCountPill", "count", "countPill", "color", "addAlpha", "renderNumericFieldSum", "field", "itemsArr", "fieldId", "sum", "gi", "it", "fv", "v", "num", "el", "createEl", "extractParentFromItem", "it", "groupingField", "candidates", "cvs", "pfv", "v", "renderParentProgress", "group", "allItems", "parentMeta", "firstRaw", "first", "identifiers", "pushIf", "found", "A", "d", "M", "tryPush", "x", "o", "m", "done", "total", "itemsList", "isDoneByHeuristics", "content", "state", "percentFV", "gi", "pct", "progWrapper", "createEl", "bar", "fill", "renderIterationElement", "opt", "iterText", "start", "duration", "s", "days", "e", "sStr", "eStr", "iterEl", "getIconSvg", "iconName", "size", "buildGroupHeaderElement", "fields", "options", "groupingFieldDef", "f", "header", "toggleSpan", "colorDot", "renderColorDot", "nameSpan", "renderNameSpan", "effectiveDivisors", "vs", "countPill", "renderCountPill", "numericFields", "sel", "nf", "el", "renderNumericFieldSum", "avatarUrl", "fv", "match", "a", "avatarEl", "escapeHtml", "parentEl", "init_GroupDataService", "BoardCardRenderer", "fields", "allItems", "visibleFieldIds", "onFilter", "onAction", "groupDivisors", "field", "value", "safeValue", "safeField", "iconName", "size", "fill", "f", "items", "estimateField", "sum", "item", "fv", "v", "num", "n", "columnField", "groups", "dataType", "options", "it", "opt", "key", "groupKey", "optId", "optName", "group", "itId", "itTitle", "option", "start", "duration", "startDate", "endDate", "formatDate", "d", "card", "header", "itemsContainer", "columnColor", "normalizeColor", "itemEl", "footer", "headerRow", "buildGroupHeaderElement", "colorDot", "nameSpan", "countPill", "children", "ch", "descRow", "maybeIter", "addLabel", "e", "el", "content", "titleText", "number", "url", "isPR", "typename", "state", "isClosed", "isMerged", "isDraft", "isBlocked", "deps", "iconColor", "assignees", "mainContent", "iconRow", "baseIcon", "blockedOverlay", "escapeHtml", "menuBtn", "titleRow", "fieldsRow", "subIssuesProgress", "avatarsContainer", "found", "assigneesFv", "prFv", "container", "maxAvatars", "assignee", "index", "login", "avatarUrl", "img", "more", "excludeTypes", "excludeFieldNames", "columnFieldId", "valuePills", "linkedPRs", "prHtml", "pr", "rawColor", "normColor", "hasHex", "border", "bg", "addAlpha", "fg", "getContrastColor", "icon", "tooltip", "fieldType", "fieldName", "fid", "rendered", "name", "p", "fName", "labels", "label", "title", "repo", "truncated", "dateValue", "formatted", "filterVal", "parent", "color", "parentIsDoneByStatus", "completedNames", "parentItem", "parentId", "parentUrl", "parentNum", "c", "itemRepo", "parentRepo", "statusFv", "foundColor", "optNameLower", "hasBlockedLabel", "l", "blockedBy", "html", "prs", "type", "progressFv", "total", "done", "pct", "swimlaneField", "groupedArr", "GroupDataService", "map", "g", "itemsList", "leftPane", "builtHeader", "toggleEl", "style", "board", "target", "swimHeader", "toggleIcon", "isCollapsed", "pill", "itemId", "i", "rect", "columnGroups", "colOptions", "headersRow", "entries", "height", "colGroup", "colHeader", "swimlanes", "sKey", "swimlane", "swimContainer", "swimContent", "rowColumnItems", "colKey", "itemsInCol", "colItemsContainer", "rowContent", "SlicePanel", "container", "field", "items", "allFields", "stored", "debugOverlay", "resizer", "startX", "startWidth", "onMouseMove", "e", "dx", "newW", "onMouseUp", "ev", "header", "headerTop", "sliceLabel", "fieldButton", "arrow", "content", "anchorButton", "anchorRectOverride", "sliceableTypes", "sliceableFields", "f", "dataType", "dropdown", "rect", "item", "checkSpan", "iconSpan", "labelSpan", "idx", "itemEl", "checkSpanEl", "backdrop", "anchorRect", "btn", "iconName", "valueCounts", "empty", "sorted", "a", "b", "resolveParentProgress", "parentMeta", "result", "identifiers", "found", "A", "d", "M", "o", "m", "statusFV", "v", "c", "normalizeColor", "agg", "key", "value", "count", "rawValue", "parentMetaForIteration", "leftVisual", "makeColorDot", "dot", "visualAppended", "avatarUrl", "avatarEl", "escapeHtml", "repoIcon", "prog", "dotColor", "pd", "lab", "colorCandidate", "normalized", "colorVal", "iter", "it", "labelColumn", "label", "descText", "desc", "p", "titleText", "titleEl", "tspan", "displayedTitle", "summary", "doneText", "bar", "fill", "iterObj", "iterCandidate", "start", "duration", "s", "sStr", "eStr", "rangeEl", "countCircle", "counts", "fv", "existing", "labelsArr", "name", "ass", "fieldValue", "callback", "parseSortByFields", "sortByFields", "primary", "config", "secondary", "sortItems", "items", "fields", "sortConfig", "field", "f", "sorted", "a", "b", "primaryResult", "compareFieldValues", "secondaryField", "direction", "aValue", "getFieldValue", "bValue", "result", "compareText", "compareNumber", "compareDate", "compareSingleSelect", "compareIteration", "compareLabels", "item", "fieldValue", "fv", "extractTitleLikeString", "list", "first", "repo", "m", "parent", "prs", "issues", "rawNode", "content", "aStr", "bStr", "aNum", "bNum", "aDate", "bDate", "aOption", "bOption", "aIndex", "opt", "bIndex", "aLabels", "bLabels", "_MenuManager", "el", "type", "nodes", "n", "menuEl", "refreshFn", "fn", "MenuManager", "menuManager_default", "ActiveTabMenu", "options", "btn", "computed", "iconSpan", "s", "e", "menuManager_default", "items", "rect", "menuRect", "margin", "vw", "vh", "top", "left", "container", "tabEl", "viewKey", "sel", "currentLayout", "makeOption", "layout", "icon", "label", "opt", "lbl", "ev", "pd", "idx", "iconWrapper", "iconName", "midLine", "item", "row", "leftIcon", "labelEl", "b", "i", "arrow", "n", "res", "keepOpen", "children", "submenu", "parentRect", "submenuRect", "el", "refreshFn", "ActiveTabMenu_default", "initOnce", "tabsContainer", "currentLabel", "tabsContainerEl", "removeMenuFromLabel", "label", "inst", "listener", "attachMenuToActive", "activeTab", "layout", "viewKey", "getItems", "vsLocal", "fieldsInfo", "visibleSet", "f", "groupInfo", "columnInfo", "items", "anchor", "anchorRect", "FieldsMenu", "fields", "visible", "x", "created", "fieldId", "visibleFlag", "parentMenu", "parentMenuInst", "GroupByMenu", "columnFields", "raw", "fieldName", "groupable", "markersInfo", "roadmapRenderer", "active", "id", "ff", "n", "syntheticEvent", "sortInfo", "sortCurrent", "cur", "SortByMenu", "fdInfo", "FieldSumMenu", "FieldSumMenuClass", "current", "selected", "dateInfo", "startId", "endId", "startName", "endName", "parentMenuEl", "zoomInfo", "zl", "el", "sliceInfo", "cs", "stored", "parsed", "sliceableTypes", "candidate", "rect", "ph", "menu", "ActiveTabMenu_default", "dateListener", "mutations", "m", "logDebug", "createBoardFetcher", "view", "container", "viewKey", "viewName", "setLoadingState", "first", "unsavedSort", "unsavedGrouping", "unsavedGroupDivisors", "unsavedSlice", "activeSlicePanel", "unsavedColumn", "unsavedHiddenFields", "lastPayload", "lastEffectiveFilter", "render", "payload", "effectiveFilter", "items", "fields", "allFields", "effectiveGroupDivisors", "existingSlicePanel", "f", "barApi", "initFilterBar", "requestFields", "newFilter", "dirty", "key", "hiddenArr", "effectiveSortConfig", "stored", "parseSortByFields", "currentSortName", "sortField", "maybe", "n", "fieldId", "visible", "visibleSet", "id", "fieldName", "selected", "anchor", "anchorRect", "existing", "sliceableTypes", "field", "sid", "SlicePanel", "main", "el", "value", "newField", "ff", "parsed", "header", "title", "right", "loadBtn", "createLoadMoreButton", "columnField", "details", "verticalGroupByFields", "vgbField", "dataType", "swimlaneField", "groupByFields", "gbField", "e", "currentGrouping", "content", "handleFilter", "filter", "current", "sortConfig", "displayItems", "sortItems", "item", "fv", "val", "p", "assignee", "label", "handleAction", "action", "args", "menu", "x", "y", "addItem", "text", "iconClass", "onClick", "isSep", "sep", "ico", "span", "url", "options", "opts", "iters", "getIterationRange", "start", "duration", "startDate", "endDate", "formatDate", "d", "o", "it", "closeHandler", "AddItemMenu", "messaging", "visibleFieldIds", "BoardCardRenderer", "renderFlatList", "sliceEl", "matchedIds", "rawFilter", "applyFilterVisibility", "config", "err", "setErrorState", "i", "card", "titleText", "escapeHtml", "onMessage", "ev", "msg"]
}
