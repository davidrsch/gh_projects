{
  "version": 3,
  "sources": ["../../src/webviews/client/utils.ts", "../../src/webviews/client/utils/logger.ts", "../../src/webviews/client/utils/domUtils.ts", "../../src/webviews/client/viewFetcherUtils.ts", "../../src/webviews/client/boardViewFetcher.ts"],
  "sourcesContent": ["export function escapeHtml(s: any): string {\n  return s\n    ? String(s)\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\")\n    : \"\";\n}\n\nexport function normalizeColor(color: any): string | null {\n  if (!color) return null;\n  let n = String(color).trim();\n  if (\n    /^#?[0-9a-f]{3}$/i.test(n) ||\n    /^#?[0-9a-f]{6}$/i.test(n) ||\n    /^#?[0-9a-f]{8}$/i.test(n)\n  ) {\n    let b = n[0] === \"#\" ? n.slice(1) : n;\n    return \"#\" + (b.length === 8 ? b.substring(0, 6) : b);\n  }\n  let s = {\n    GRAY: \"#848d97\",\n    RED: \"#f85149\",\n    ORANGE: \"#db6d28\",\n    YELLOW: \"#d29922\",\n    GREEN: \"#3fb950\",\n    BLUE: \"#2f81f7\",\n    PURPLE: \"#a371f7\",\n    PINK: \"#db61a2\",\n    BLACK: \"#000000\",\n    WHITE: \"#ffffff\",\n  };\n  let u = n.toUpperCase();\n  return (s as any)[u] || null;\n}\n\nexport function addAlpha(color: any, alpha: any): string | null {\n  if (!color) return null;\n  let s = color.replace(\"#\", \"\");\n  let u = (b: any) => parseInt(b, 16);\n  if (s.length === 3) {\n    let b = u(s[0] + s[0]),\n      S = u(s[1] + s[1]),\n      v = u(s[2] + s[2]);\n    return \"rgba(\" + b + \",\" + S + \",\" + v + \",\" + alpha + \")\";\n  }\n  if (s.length === 6 || s.length === 8) {\n    let b = s.length === 8 ? s.substring(0, 6) : s,\n      S = u(s.substring(0, 2)),\n      v = u(b.substring(2, 4)),\n      C = u(b.substring(4, 6));\n    return \"rgba(\" + S + \",\" + v + \",\" + C + \",\" + alpha + \")\";\n  }\n  return null;\n}\n\nexport function getContrastColor(color: any): string {\n  if (!color) return \"#333333\";\n  let n = color.replace(\"#\", \"\");\n  let s = (C: any) => parseInt(C, 16);\n  let u, b, S;\n  if (n.length === 3)\n    ((u = s(n[0] + n[0])), (b = s(n[1] + n[1])), (S = s(n[2] + n[2])));\n  else if (n.length === 6 || n.length === 8) {\n    let C = n.length === 8 ? n.substring(0, 6) : n;\n    ((u = s(C.substring(0, 2))),\n      (b = s(C.substring(2, 4))),\n      (S = s(C.substring(4, 6))));\n  } else return \"#333333\";\n  return 0.2126 * (u / 255) + 0.7152 * (b / 255) + 0.0722 * (S / 255) > 0.6\n    ? \"#111111\"\n    : \"#ffffff\";\n}\n", "/// <reference path=\"../global.d.ts\" />\n\nexport function logDebug(viewKey: string, message: string, data?: any) {\n  try {\n    if (\n      (window as any).__APP_MESSAGING__ &&\n      typeof (window as any).__APP_MESSAGING__.postMessage === \"function\"\n    ) {\n      (window as any).__APP_MESSAGING__.postMessage({\n        command: \"debugLog\",\n        level: \"debug\",\n        viewKey: viewKey,\n        message: message,\n        data: data,\n      });\n    }\n  } catch (e) {}\n  try {\n    if (console && console.log) {\n      console.log(message, data);\n    }\n  } catch (e) {}\n}\n", "export function setLoadingState(container: HTMLElement, titleText: string) {\n  container.innerHTML =\n    '<div class=\"title\">' +\n    titleText +\n    '</div><div class=\"loading\"><em>Loading...</em></div>';\n}\n\nexport function setErrorState(\n  container: HTMLElement,\n  titleText: string,\n  error: string,\n) {\n  container.innerHTML =\n    '<div class=\"title\">' +\n    titleText +\n    '</div><div style=\"color:var(--vscode-editor-foreground)\">' +\n    error +\n    \"</div>\";\n}\n\nexport function createLoadMoreButton(onClick: () => void): HTMLButtonElement {\n  const btn = document.createElement(\"button\");\n  btn.type = \"button\";\n  btn.textContent = \"Load more\";\n  btn.style.marginLeft = \"8px\";\n  btn.style.border = \"1px solid var(--vscode-editorWidget-border)\";\n  btn.addEventListener(\"click\", () => {\n    onClick();\n    btn.disabled = true;\n    btn.textContent = \"Loading...\";\n  });\n  return btn;\n}\n\nexport function clearElement(element: HTMLElement) {\n  while (element.firstChild) {\n    element.removeChild(element.firstChild);\n  }\n}\n\nexport function toggleClass(\n  element: HTMLElement,\n  className: string,\n  force?: boolean,\n) {\n  element.classList.toggle(className, force);\n}\n", "/// <reference path=\"./global.d.ts\" />\nimport { logDebug } from \"./utils/logger\";\nimport {\n  setLoadingState,\n  setErrorState,\n  createLoadMoreButton,\n} from \"./utils/domUtils\";\n\nexport { logDebug, setLoadingState, setErrorState, createLoadMoreButton };\n\n/**\n * Initializes the filter bar using the shared filterBarHelper.\n * Returns the barApi if successful, or null.\n */\nexport function initFilterBar(\n  container: HTMLElement,\n  viewKey: string,\n  options: {\n    suffix?: string;\n    step?: number;\n    effFilter?: string;\n    onLoadMore?: () => void;\n    onSave?: (filter: any) => void;\n    onDiscard?: () => void;\n  },\n): any {\n  if (\n    window.filterBarHelper &&\n    typeof window.filterBarHelper.create === \"function\"\n  ) {\n    try {\n      return window.filterBarHelper.create({\n        parent: container,\n        suffix: options.suffix || viewKey,\n        effFilter:\n          typeof options.effFilter === \"string\" ? options.effFilter : undefined,\n        viewKey: viewKey,\n        step: options.step || 50,\n        onLoadMore: options.onLoadMore,\n        onSave: options.onSave,\n        onDiscard: options.onDiscard,\n      });\n    } catch (e) {\n      return null;\n    }\n  }\n  return null;\n}\n\n/**\n * Toggles visibility of elements based on matched IDs from the filter.\n */\nexport function applyFilterVisibility(\n  root: HTMLElement | Document,\n  selector: string,\n  matchedIds: Set<string>,\n  displayStyle: string = \"block\",\n) {\n  try {\n    const elements = Array.from(root.querySelectorAll(selector));\n    for (let i = 0; i < elements.length; i++) {\n      try {\n        const el = elements[i] as HTMLElement;\n        const id = el.getAttribute(\"data-gh-item-id\");\n        el.style.display = matchedIds.has(String(id)) ? displayStyle : \"none\";\n      } catch (e) {}\n    }\n  } catch (e) {}\n}\n", "import { escapeHtml } from \"./utils\";\nimport {\n  logDebug,\n  setLoadingState,\n  setErrorState,\n  createLoadMoreButton,\n  initFilterBar,\n  applyFilterVisibility,\n} from \"./viewFetcherUtils\";\n/// <reference path=\"./global.d.ts\" />\n\n// signal that the board fetcher script executed\ntry {\n  logDebug(\"global\", \"boardViewFetcher.loaded\");\n} catch (e) {}\ntry {\n  console.log && console.log(\"boardViewFetcher script loaded\");\n} catch (e) {}\n\n// Expose a global fetcher: window.boardViewFetcher(view, container, viewKey)\nfunction createBoardFetcher() {\n  return function (view: any, container: HTMLElement, viewKey: string) {\n    const viewName =\n      view && (view.name || view.id) ? view.name || view.id : \"Board View\";\n\n    try {\n      setLoadingState(container, viewName);\n    } catch (e) {}\n\n    var first = 50;\n\n    function render(payload: any, effectiveFilter?: string) {\n      try {\n        var items = (payload && payload.items) || [];\n        container.innerHTML = \"\";\n\n        let barApi = initFilterBar(container, viewKey, {\n          suffix: viewKey,\n          step: first,\n          onLoadMore: function () {\n            first += 50;\n            requestFields();\n          },\n        });\n\n        // If the server returned an effective filter, apply it via the bar API\n        try {\n          if (\n            effectiveFilter &&\n            barApi &&\n            typeof barApi.setEffectiveFilter === \"function\"\n          ) {\n            try {\n              barApi.setEffectiveFilter(effectiveFilter);\n            } catch (e) {}\n          }\n        } catch (e) {}\n\n        if (!barApi) {\n          var header = document.createElement(\"div\");\n          header.style.display = \"flex\";\n          header.style.justifyContent = \"space-between\";\n          header.style.alignItems = \"center\";\n          header.style.marginBottom = \"8px\";\n\n          var title = document.createElement(\"div\");\n          title.style.fontWeight = \"600\";\n          title.style.padding = \"6px\";\n          title.textContent = viewName;\n\n          var right = document.createElement(\"div\");\n          var loadBtn = createLoadMoreButton(() => {\n            first += 50;\n            requestFields();\n          });\n\n          right.appendChild(loadBtn);\n          header.appendChild(title);\n          header.appendChild(right);\n          container.appendChild(header);\n        }\n\n        var content = document.createElement(\"div\");\n        content.style.marginTop = \"8px\";\n        for (var i = 0; i < items.length; i++) {\n          var it = items[i];\n          var card = document.createElement(\"div\");\n          try {\n            card.setAttribute(\"data-gh-item-id\", String(it && it.id));\n          } catch (e) {}\n          card.style.padding = \"8px\";\n          card.style.border = \"1px solid var(--vscode-editorWidget-border)\";\n          card.style.marginBottom = \"8px\";\n          card.style.borderRadius = \"2px\";\n          var titleText =\n            (it && it.content && (it.content.title || it.content.name)) ||\n            (it && it.title) ||\n            (it && it.raw && it.raw.title) ||\n            \"#\" + (i + 1);\n          card.innerHTML =\n            '<div style=\"font-weight:600\">' +\n            escapeHtml(titleText) +\n            \"</div>\" +\n            (it && it.id\n              ? '<div style=\"color:var(--vscode-descriptionForeground);font-size:12px\">' +\n                escapeHtml(String(it.id)) +\n                \"</div>\"\n              : \"\");\n          content.appendChild(card);\n        }\n        container.appendChild(content);\n\n        try {\n          if (barApi && typeof barApi.setCount === \"function\")\n            barApi.setCount(items.length);\n          if (barApi && typeof barApi.setLoadState === \"function\")\n            barApi.setLoadState(\n              items.length < first,\n              items.length >= first ? \"Load more\" : \"All loaded\",\n            );\n\n          // Wire local preview filtering via centralized helper: register items and subscribe\n          if (barApi && barApi.inputEl) {\n            if (typeof barApi.registerItems === \"function\") {\n              const fields = (payload && payload.fields) || [];\n              barApi.registerItems(items, { fields: fields });\n            }\n            if (typeof barApi.onFilterChange === \"function\") {\n              barApi.onFilterChange(function (matchedIds: any, rawFilter: any) {\n                applyFilterVisibility(\n                  container,\n                  \"[data-gh-item-id]\",\n                  matchedIds,\n                  \"block\",\n                );\n\n                if (barApi && typeof barApi.setCount === \"function\")\n                  barApi.setCount(matchedIds.size);\n\n                logDebug(viewKey, \"filterInput\", {\n                  filter: rawFilter,\n                  matched: matchedIds.size,\n                  original: items.length,\n                });\n              });\n            }\n          }\n        } catch (e) {}\n      } catch (err: any) {\n        logDebug(viewKey, \"boardViewFetcher.render.error\", {\n          message: String(err && err.message),\n          stack: err && err.stack,\n        });\n        setErrorState(\n          container,\n          viewName,\n          \"Error rendering board view: \" + String(err && err.message),\n        );\n      }\n    }\n\n    function onMessage(ev: MessageEvent) {\n      var msg = ev && ev.data ? ev.data : ev;\n      try {\n        if (msg && msg.command === \"fields\") {\n          if (msg.viewKey && viewKey && String(msg.viewKey) !== String(viewKey))\n            return;\n          if (msg.error) {\n            setErrorState(container, viewName, String(msg.error));\n          } else {\n            render(\n              msg.payload || (msg.payload && msg.payload.data) || msg.payload,\n              msg.effectiveFilter,\n            );\n          }\n        }\n      } catch (e) {}\n    }\n\n    function requestFields() {\n      try {\n        if (\n          (window as any).__APP_MESSAGING__ &&\n          typeof (window as any).__APP_MESSAGING__.postMessage === \"function\"\n        ) {\n          (window as any).__APP_MESSAGING__.postMessage({\n            command: \"requestFields\",\n            first: first,\n            viewKey: viewKey,\n          });\n        }\n      } catch (e) {}\n    }\n    try {\n      (window as any).__APP_MESSAGING__.onMessage(onMessage);\n    } catch (e) {\n      window.addEventListener(\"message\", onMessage);\n    }\n    requestFields();\n  };\n}\ntry {\n  window.boardViewFetcher = createBoardFetcher();\n} catch (e) {}\n"],
  "mappings": "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",
  "names": ["escapeHtml", "s", "logDebug", "viewKey", "message", "data", "setLoadingState", "container", "titleText", "setErrorState", "error", "createLoadMoreButton", "onClick", "btn", "initFilterBar", "container", "viewKey", "options", "applyFilterVisibility", "root", "selector", "matchedIds", "displayStyle", "elements", "i", "el", "id", "logDebug", "createBoardFetcher", "view", "container", "viewKey", "viewName", "setLoadingState", "first", "render", "payload", "effectiveFilter", "items", "barApi", "initFilterBar", "requestFields", "header", "title", "right", "loadBtn", "createLoadMoreButton", "content", "i", "it", "card", "titleText", "escapeHtml", "fields", "matchedIds", "rawFilter", "applyFilterVisibility", "err", "setErrorState", "onMessage", "ev", "msg"]
}
