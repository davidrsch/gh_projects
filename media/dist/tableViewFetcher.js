"use strict";(()=>{function f(i){return i?String(i).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function D(i){if(!i)return null;let e=String(i).trim();if(/^#?[0-9a-f]{3}$/i.test(e)||/^#?[0-9a-f]{6}$/i.test(e)||/^#?[0-9a-f]{8}$/i.test(e)){let o=e[0]==="#"?e.slice(1):e;return"#"+(o.length===8?o.substring(0,6):o)}let t={GRAY:"#848d97",RED:"#f85149",ORANGE:"#db6d28",YELLOW:"#d29922",GREEN:"#3fb950",BLUE:"#2f81f7",PURPLE:"#a371f7",PINK:"#db61a2",BLACK:"#000000",WHITE:"#ffffff"},n=e.toUpperCase();return t[n]||null}function U(i,e){if(!i)return null;let t=i.replace("#",""),n=o=>parseInt(o,16);if(t.length===3){let o=n(t[0]+t[0]),r=n(t[1]+t[1]),l=n(t[2]+t[2]);return"rgba("+o+","+r+","+l+","+e+")"}if(t.length===6||t.length===8){let o=t.length===8?t.substring(0,6):t,r=n(t.substring(0,2)),l=n(o.substring(2,4)),a=n(o.substring(4,6));return"rgba("+r+","+l+","+a+","+e+")"}return null}function Y(i){if(!i)return"#333333";let e=i.replace("#",""),t=l=>parseInt(l,16),n,o,r;if(e.length===3)n=t(e[0]+e[0]),o=t(e[1]+e[1]),r=t(e[2]+e[2]);else if(e.length===6||e.length===8){let l=e.length===8?e.substring(0,6):e;n=t(l.substring(0,2)),o=t(l.substring(2,4)),r=t(l.substring(4,6))}else return"#333333";return .2126*(n/255)+.7152*(o/255)+.0722*(r/255)>.6?"#111111":"#ffffff"}function Q(i,e,t,n){var o,r,l,a,p,u,c,w,k,S,L,M,E,T,R;if(!i)return"";try{switch(i.type){case"title":{let s=i&&i.title&&(i.title.raw&&i.title.raw.text||i.title.content&&(i.title.content.title||i.title.content.name)||typeof i.title=="string"&&i.title)||i&&i.content&&(i.content.title||i.content.name)||i&&i.raw&&i.raw.text||"",b=i&&i.title&&i.title.content&&i.title.content.number||i&&i.raw&&i.raw.itemContent&&i.raw.itemContent.number||t&&t.content&&t.content.number||"",h=i&&i.title&&i.title.content&&i.title.content.url||i&&i.raw&&i.raw.itemContent&&i.raw.itemContent.url||t&&t.content&&t.content.url||"",x=null;if(t&&Array.isArray(t.fieldValues)){let d=t.fieldValues.find(m=>m&&m.type==="single_select"&&(m.raw&&m.raw.field&&String(m.raw.field.name||"").toLowerCase()==="status"||m.fieldName&&String(m.fieldName||"").toLowerCase()==="status"||m.field&&m.field.name&&String(m.field.name||"").toLowerCase()==="status"));d&&(x=d.option&&(d.option.color||d.option.id||d.option.name)||d.raw&&d.raw.color||null)}let y=D(x)||null,N=y&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(y)?y:"#666666",G=f(String(s||"")),F=b?f(String(b)):"";return'<a href="'+f(String(h||""))+'" target="_blank" rel="noopener noreferrer" style="text-decoration:none;color:inherit;display:inline-flex;align-items:center;gap:8px;width:100%;"><svg width="14" height="14" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:'+f(N)+'"><circle cx="8" cy="8" r="6" fill="currentColor" /></svg><span style="flex:1;min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:block">'+G+"</span>"+(F?'<span style="flex:none;margin-left:6px;color:var(--vscode-descriptionForeground);white-space:nowrap">#'+F+"</span>":"")+"</a>"}case"text":return"<div>"+f((o=i.text)!=null?o:"")+"</div>";case"number":{let s=i.number!==void 0&&i.number!==null?String(i.number):"";return'<div style="text-align:right;font-variant-numeric:tabular-nums">'+f(s)+"</div>"}case"date":{let s=(a=(l=(r=i.date)!=null?r:i.startDate)!=null?l:i.dueOn)!=null?a:null;if(!s)return"<div></div>";try{let b=new Date(s);if(isNaN(b.getTime()))return"<div>"+f(String(s))+"</div>";let h=b.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return"<div>"+f(h)+"</div>"}catch{return"<div>"+f(String(s))+"</div>"}}case"single_select":{let s=f((u=(p=i.option)==null?void 0:p.name)!=null?u:""),b=null;if(e&&Array.isArray(e.options)){let F=e.options.find(d=>d.id&&i.option&&i.option.id&&d.id===i.option.id||d.name&&i.option&&i.option.name&&d.name===i.option.name);F&&(b=(w=(c=F.color)!=null?c:F.id)!=null?w:null)}let h=D(b)||null,x=!!(h&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(h)),y=h||"#999999",N=x&&U(h,.12)||"rgba(0,0,0,0.06)",G=h||"#333333";return'<span style="display:block;width:100%;box-sizing:border-box"><div style="display:inline-flex;align-items:center;padding:2px 8px;border:1px solid '+f(y)+";border-radius:999px;color:"+f(G)+";background:"+f(N)+';font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;width:100%"><span style="flex:1 1 auto;min-width:0;max-width:100%;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">'+s+"</span></div></span>"}case"labels":return"<div>"+(i.labels||[]).map(s=>{let b=f(s.name||""),h=t&&(t.content&&t.content.repository&&t.content.repository.nameWithOwner||t.repository&&t.repository.nameWithOwner)||i.raw&&i.raw.itemContent&&i.raw.itemContent.repository&&i.raw.itemContent.repository.nameWithOwner||null,x=s.color||s.colour||null;if(e&&e.repoOptions&&h&&e.repoOptions[h]){let m=e.repoOptions[h].find(I=>I&&I.name===s.name);m&&(x=m.color||m.colour||x)}let y=D(x)||null,N=!!(y&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(y)),G=y||"#999999",F=N&&U(y,.12)||"rgba(0,0,0,0.06)",d=y||"#333333";return'<span style="display:inline-block;padding:2px 8px;margin-right:6px;border-radius:999px;border:1px solid '+f(G)+";background:"+f(F)+";color:"+f(d)+';font-size:12px;line-height:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">'+b+"</span>"}).join("")+"</div>";case"repository":{let s=f((S=(k=i.repository)==null?void 0:k.nameWithOwner)!=null?S:"");return'<a href="'+f(((L=i.repository)==null?void 0:L.url)||((M=i.repository)==null?void 0:M.html_url)||"")+'" target="_blank" rel="noopener noreferrer" style="text-decoration:none;color:inherit;display:inline-flex;align-items:center;gap:8px"><svg width="14" height="14" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:var(--vscode-icon-foreground)"><path fill="currentColor" d="M2 2.5A1.5 1.5 0 0 1 3.5 1h9A1.5 1.5 0 0 1 14 2.5v11A1.5 1.5 0 0 1 12.5 15h-9A1.5 1.5 0 0 1 2 13.5v-11zM3.5 2A.5.5 0 0 0 3 2.5V4h10V2.5a.5.5 0 0 0-.5-.5h-9z"/></svg><span>'+s+"</span></a>"}case"pull_request":{let s=i.pullRequests||[];return function(){var b=i.pullRequests||[];if(!b||b.length===0)return"";for(var h='<div style="display:flex;flex-wrap:wrap;gap:6px;align-items:center">',x=0;x<b.length;x++){var y=b[x],N=f(String(y&&y.number||"")),G=f(y&&y.title||""),F=f(y&&y.url||""),d=y&&(y.state_color||y.color||y.colour||y.state)||null,m=D(d)||null,I=!!(m&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(m)),_=m||"#999999",g=I&&U(m,.12)||"rgba(0,0,0,0.06)",C=Y(m)||"#333333";h+='<a href="'+F+'" target="_blank" rel="noopener noreferrer" style="text-decoration:none;color:inherit"><span title="'+G+'" style="display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;border:1px solid '+f(_)+";background:"+f(g)+";color:"+f(C)+';font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;max-width:160px"><svg width="12" height="12" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:'+f(m||"#666")+'"><circle cx="8" cy="8" r="6" fill="currentColor" /></svg><span style="flex:1 1 auto;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">#'+N+"</span></span></a>"}return h+="</div>",h}()}case"issue":return(i.issues||[]).map(s=>'<a href="'+f(s.url||"")+'" target="_blank" rel="noopener noreferrer">#'+f(String(s.number||""))+" "+f(s.title||"")+"</a>").join("<br/>");case"assignees":{let s=i.assignees||[];if(s.length===0)return"<div></div>";let b=s.slice(0,3).map((y,N)=>{let G=f(y.avatarUrl||y.avatar||""),F=N===0?"0px":N===1?"-8px":"-14px",d=Math.max(1,3-N);if(G)return'<span title="'+f(y.login||y.name||"")+'" style="display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url('+G+");border:2px solid var(--vscode-editor-background);margin-left:"+F+";vertical-align:middle;position:relative;z-index:"+d+'"></span>';let m=f((y.name||y.login||"").split(" ").map(I=>I[0]||"").join("").toUpperCase().slice(0,2));return'<span title="'+f(y.login||y.name||"")+'" style="display:inline-flex;align-items:center;justify-content:center;width:20px;height:20px;border-radius:50%;background:#777;color:#fff;font-size:11px;border:2px solid var(--vscode-editor-background);margin-left:'+F+";vertical-align:middle;position:relative;z-index:"+d+'">'+m+"</span>"}).join(""),h=s.map(y=>y.login||y.name||""),x="";return h.length===1?x=h[0]:h.length===2?x=h[0]+" and "+h[1]:x=h.slice(0,-1).join(", ")+" and "+h.slice(-1)[0],'<div style="display:flex;align-items:center;gap:8px"><span style="display:flex;align-items:center">'+('<span style="display:inline-block;vertical-align:middle;height:20px;line-height:20px;margin-right:8px;">'+b+"</span>")+'</span><span style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis">'+f(x)+"</span></div>"}case"requested_reviewers":return"<div>"+f((i.reviewers||[]).map(s=>s.login||s.name||s.kind||"").join(", "))+"</div>";case"iteration":{let s=f((E=i.title)!=null?E:""),b=D("GRAY")||null,h=!!(b&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(b)),x=b||"#999999",y=h&&U(b,.12)||"rgba(0,0,0,0.06)",N=b||"#333333";return'<div style="display:inline-block;padding:2px 8px;border:1px solid '+f(x)+";border-radius:999px;color:"+f(N)+";background:"+f(y)+';font-size:12px;line-height:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">'+s+"</div>"}case"parent_issue":{let s=i&&(i.parent||i.parentIssue||i.issue||i.option||i.item||i.value)||i&&i.raw&&(i.raw.parent||i.raw.itemContent||i.raw.item)||null,b=s&&(s.number||s.id||s.raw&&s.raw.number)&&(s.number||s.raw&&s.raw.number)||"",h=s&&(s.title||s.name||s.raw&&s.raw.title)&&(s.title||s.name||s.raw&&s.raw.title)||"",x=s&&(s.url||s.html_url||s.raw&&s.raw.url)&&(s.url||s.html_url||s.raw&&s.raw.url)||"",y=f(String(h||"")),N=b?f(String(b)):"",G=f(String(x||"")),F=null;try{var O=Array.isArray(n)?n:n||[];if(Array.isArray(O)&&O.length>0&&(b||s)){let W=s&&s.repository&&(s.repository.nameWithOwner||s.repository.name)||s&&s.content&&s.content.repository&&s.content.repository.nameWithOwner||null,H=[];b&&H.push(String(b)),s&&(s.id||s.raw&&s.raw.id)&&H.push(String(s.id||s.raw&&s.raw.id)),s&&(s.url||s.raw&&s.raw.url)&&H.push(String(s.url||s.raw&&s.raw.url)),s&&(s.title||s.name)&&H.push(String(s.title||s.name));let $=O.find(A=>{let v=A&&(A.content||A.raw&&A.raw.itemContent)||null;if(!v)return!1;let z=[];if(v.number&&z.push(String(v.number)),v.id&&z.push(String(v.id)),v.url&&z.push(String(v.url)),v.title&&z.push(String(v.title)),v.name&&z.push(String(v.name)),v.raw&&v.raw.number&&z.push(String(v.raw.number)),v.raw&&v.raw.id&&z.push(String(v.raw.id)),v.raw&&v.raw.url&&z.push(String(v.raw.url)),W){let V=v.repository&&(v.repository.nameWithOwner||v.repository.name)||null;if(V&&String(V)!==String(W))return!1}for(let V=0;V<H.length;V++)for(let B=0;B<z.length;B++)if(H[V]&&z[B]&&String(H[V])===String(z[B]))return!0;return!1});if($&&Array.isArray($.fieldValues)){let A=$.fieldValues.find(v=>v&&v.type==="single_select"&&(v.raw&&v.raw.field&&String(v.raw.field.name||"").toLowerCase()==="status"||v.fieldName&&String(v.fieldName||"").toLowerCase()==="status"||v.field&&v.field.name&&String(v.field.name||"").toLowerCase()==="status"));A&&(F=A.option&&(A.option.color||A.option.id||A.option.name)||A.raw&&A.raw.color||null)}}}catch{}F||(F=s&&(s.option&&(s.option.color||s.option.id||s.option.name)||s.color||s.colour)||null);let d=D(F)||null,m=!!(d&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(d)),I=d||"#999999",_=m&&U(d,.12)||"rgba(0,0,0,0.06)",g=Y(d)||"#333333",C='<span style="display:block;width:100%;box-sizing:border-box"><div style="display:inline-flex;align-items:center;gap:8px;padding:4px 10px;border:1px solid '+f(I)+";border-radius:999px;color:"+f(g)+";background:"+f(_)+';font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;width:100%"><svg width="14" height="14" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:'+f(d||"#666")+'"><circle cx="8" cy="8" r="6" fill="currentColor" /></svg><span class="parent-issue-title" style="flex:1;min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:block">'+y+"</span>"+(N?'<span style="margin-left:6px;color:var(--vscode-descriptionForeground);white-space:nowrap">#'+N+"</span>":"")+"</div></span>",P='<span data-gh-open="'+(G||"")+'" class="parent-issue-wrapper" style="display:block;width:100%;cursor:'+(G?"pointer":"default")+'">';return G?P+C+"</span>":C}case"milestone":return"<div>"+f((R=(T=i.milestone)==null?void 0:T.title)!=null?R:"")+"</div>";case"sub_issues_progress":try{if(!i||i.total==null||Number(i.total)<=0)return"";let s=Math.max(0,Math.floor(Number(i.total)||0)),b=Math.max(0,Math.floor(Number(i.done||0)));if(s===0)return"";let h=null;if(i.percent!==void 0&&i.percent!==null?h=Number(i.percent):h=Math.round(b/s*100),h==null||!isFinite(h))return"";h=Math.max(0,Math.min(100,h));let x=[];for(let y=0;y<s;y++)y<b?x.push('<div class="sub-issues-segment sub-issues-segment-filled" style="flex:1;min-width:0;height:12px;border-radius:4px;background:var(--vscode-focusBorder);box-sizing:border-box"></div>'):x.push('<div class="sub-issues-segment sub-issues-segment-empty" style="flex:1;min-width:0;height:12px;border-radius:4px;border:1px solid var(--vscode-focusBorder);background:transparent;box-sizing:border-box"></div>');return'<div class="sub-issues-progress" style="display:flex;align-items:center;gap:8px;width:100%"><div class="sub-issues-progress-bar" style="flex:1;min-width:0;display:flex;gap:4px;align-items:center">'+x.join("")+'</div><div class="sub-issues-progress-pct" style="min-width:44px;text-align:right;font-variant-numeric:tabular-nums;color:var(--vscode-descriptionForeground)">'+f(String(h)+"%")+"</div></div>"}catch{return""}case"missing":return"";default:return"<div>"+f(i&&i.raw&&i.raw.__typename?String(i.raw.__typename):JSON.stringify(i).slice(0,200))+"</div>"}}catch{return""}}var q=class{constructor(e,t){this.menuElement=null;this.backdropElement=null;this.field=e,this.options=t}show(e){this.hide(),this.backdropElement=document.createElement("div"),this.backdropElement.style.position="fixed",this.backdropElement.style.top="0",this.backdropElement.style.left="0",this.backdropElement.style.right="0",this.backdropElement.style.bottom="0",this.backdropElement.style.zIndex="999",this.backdropElement.addEventListener("click",()=>this.hide()),document.body.appendChild(this.backdropElement),this.menuElement=document.createElement("div"),this.menuElement.className="column-header-menu",this.menuElement.style.position="absolute",this.menuElement.style.background="var(--vscode-menu-background)",this.menuElement.style.border="1px solid var(--vscode-menu-border)",this.menuElement.style.borderRadius="4px",this.menuElement.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)",this.menuElement.style.minWidth="180px",this.menuElement.style.padding="4px 0",this.menuElement.style.zIndex="1000",this.menuElement.style.fontSize="13px";let t=e.getBoundingClientRect();this.menuElement.style.top=`${t.bottom+4}px`,this.menuElement.style.left=`${t.left}px`,this.buildMenuItems(),document.body.appendChild(this.menuElement)}hide(){this.menuElement&&(this.menuElement.remove(),this.menuElement=null),this.backdropElement&&(this.backdropElement.remove(),this.backdropElement=null)}buildMenuItems(){this.menuElement&&(this.addMenuItem("Select column",null,{isHeader:!0}),this.addSeparator(),this.addMenuItem("Sort ascending \u2191",()=>{this.options.onSort?.("ASC"),this.hide()},{icon:"\u2191",showClear:this.options.currentSort==="ASC",clearAction:this.options.onClearSort}),this.addMenuItem("Sort descending \u2193",()=>{this.options.onSort?.("DESC"),this.hide()},{icon:"\u2193",showClear:this.options.currentSort==="DESC",clearAction:this.options.onClearSort}),this.addSeparator(),this.options.canGroup&&this.addMenuItem("Group by values",()=>{this.options.onGroup?.(),this.hide()},{showClear:!!this.options.isGrouped,clearAction:this.options.onClearGroup}),this.options.canSlice&&this.addMenuItem("Slice by values",()=>{this.options.onSlice?.(),this.hide()},{showClear:!!this.options.isSliced,clearAction:this.options.onClearSlice}),this.options.canFilter&&this.addMenuItem("Filter by values...",()=>{this.options.onFilter?.(),this.hide()}),(this.options.canGroup||this.options.canSlice||this.options.canFilter)&&this.addSeparator(),this.addMenuItem("Hide field",()=>{this.options.onHide?.(),this.hide()}),this.addSeparator(),this.addMenuItem("Move left \u2190",()=>{this.options.onMove?.("left"),this.hide()},{icon:"\u2190"}),this.addMenuItem("Move right \u2192",()=>{this.options.onMove?.("right"),this.hide()},{icon:"\u2192"}))}addMenuItem(e,t,n){if(!this.menuElement)return;let o=document.createElement("div");if(o.className="menu-item",n?.isHeader){o.textContent=e,o.style.padding="6px 12px",o.style.fontWeight="600",o.style.color="var(--vscode-descriptionForeground)",o.style.fontSize="11px",o.style.textTransform="uppercase",o.style.cursor="default",this.menuElement.appendChild(o);return}o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="space-between",o.style.padding="6px 12px",o.style.cursor="pointer",o.style.color="var(--vscode-menu-foreground)";let r=document.createElement("span");if(r.textContent=e,r.style.flex="1",r.style.whiteSpace="nowrap",r.style.overflow="hidden",r.style.textOverflow="ellipsis",o.appendChild(r),n?.showClear&&n?.clearAction){let l=document.createElement("button");l.type="button",l.textContent="\u2715",l.title="Clear",l.style.border="none",l.style.background="transparent",l.style.cursor="pointer",l.style.padding="2px 6px",l.style.marginLeft="8px",l.style.color="var(--vscode-menu-foreground)",l.addEventListener("mouseenter",()=>{l.style.color="var(--vscode-menu-selectionForeground)",l.style.background="var(--vscode-menu-selectionBackground)"}),l.addEventListener("mouseleave",()=>{l.style.color="var(--vscode-menu-foreground)",l.style.background="transparent"}),l.addEventListener("click",a=>{a.stopPropagation(),n.clearAction&&n.clearAction(),this.hide()}),o.appendChild(l)}t&&(o.addEventListener("mouseenter",()=>{o.style.background="var(--vscode-menu-selectionBackground)",o.style.color="var(--vscode-menu-selectionForeground)"}),o.addEventListener("mouseleave",()=>{o.style.background="transparent",o.style.color="var(--vscode-menu-foreground)"}),o.addEventListener("click",t)),this.menuElement.appendChild(o)}addSeparator(){if(!this.menuElement)return;let e=document.createElement("div");e.style.height="1px",e.style.background="var(--vscode-menu-separatorBackground)",e.style.margin="4px 0",this.menuElement.appendChild(e)}};var J=class{constructor(e,t,n){this.panelElement=null;this.container=e,this.field=t,this.items=n}render(){this.close(),this.panelElement=document.createElement("div"),this.panelElement.className="slice-panel",this.panelElement.style.position="relative",this.panelElement.style.float="left",this.panelElement.style.width="250px",this.panelElement.style.marginRight="12px",this.panelElement.style.background="var(--vscode-sideBar-background)",this.panelElement.style.border="1px solid var(--vscode-sideBar-border)",this.panelElement.style.borderRadius="4px",this.panelElement.style.display="flex",this.panelElement.style.flexDirection="column",this.panelElement.style.overflow="hidden",this.panelElement.style.maxHeight="600px";let e=document.createElement("div");e.style.padding="12px",e.style.borderBottom="1px solid var(--vscode-sideBar-border)",e.style.display="flex",e.style.justifyContent="space-between",e.style.alignItems="center";let t=document.createElement("div");t.textContent=`Slice by ${this.field.name}`,t.style.fontWeight="600",e.appendChild(t);let n=document.createElement("button");n.textContent="\xD7",n.style.background="transparent",n.style.border="none",n.style.fontSize="24px",n.style.cursor="pointer",n.style.color="var(--vscode-foreground)",n.addEventListener("click",()=>this.close()),e.appendChild(n),this.panelElement.appendChild(e);let o=document.createElement("div");o.style.flex="1",o.style.overflow="auto",o.style.padding="8px",this.renderValues(o),this.panelElement.appendChild(o),this.container.appendChild(this.panelElement)}renderValues(e){let t=this.getValueCounts();if(t.size===0){let o=document.createElement("div");o.textContent="No values",o.style.padding="8px",o.style.color="var(--vscode-descriptionForeground)",e.appendChild(o);return}Array.from(t.entries()).sort((o,r)=>r[1].count-o[1].count).forEach(([o,{value:r,count:l}])=>{let a=document.createElement("div");a.className="slice-value-item",a.style.padding="8px 12px",a.style.cursor="pointer",a.style.borderRadius="4px",a.style.marginBottom="4px",a.style.display="flex",a.style.justifyContent="space-between",a.style.alignItems="center";let p=document.createElement("span");p.textContent=o,p.style.flex="1";let u=document.createElement("span");u.textContent=String(l),u.style.background="var(--vscode-badge-background)",u.style.color="var(--vscode-badge-foreground)",u.style.padding="2px 6px",u.style.borderRadius="10px",u.style.fontSize="11px",a.appendChild(p),a.appendChild(u),a.addEventListener("mouseenter",()=>{a.style.background="var(--vscode-list-hoverBackground)"}),a.addEventListener("mouseleave",()=>{a.style.background="transparent"}),a.addEventListener("click",()=>{this.onValueSelectCallback&&this.onValueSelectCallback(r)}),e.appendChild(a)})}getValueCounts(){let e=new Map;return this.items.forEach(t=>{let n=t.fieldValues?.find(a=>a.fieldId===this.field.id||a.fieldName===this.field.name),o=null,r="(empty)";n&&(o=this.extractValue(n),r=this.formatValue(o));let l=e.get(r);l?l.count++:e.set(r,{value:o,count:1})}),e}extractValue(e){switch((this.field.dataType||"").toLowerCase()){case"text":case"title":return e.text||e.title;case"number":return e.number;case"date":return e.date;case"single_select":return e.option?.name||e.name;case"iteration":return e.title||e.iteration?.title;default:return e.text||e.value||null}}formatValue(e){return e==null?"(empty)":String(e)}onValueSelect(e){this.onValueSelectCallback=e}close(){this.panelElement&&(this.panelElement.remove(),this.panelElement=null)}};function te(i){if(!i||!i.nodes||i.nodes.length===0)return null;let e=i.nodes[0];if(!e||!e.field)return null;let t={fieldId:e.field.id||e.field.name,direction:e.direction||"ASC"};if(i.nodes.length>1){let n=i.nodes[1];n&&n.field&&(t.secondary={fieldId:n.field.id||n.field.name,direction:n.direction||"ASC"})}return t}function K(i,e,t){if(!t||i.length===0)return i;let n=e.find(r=>r.id===t.fieldId||r.name===t.fieldId);if(!n)return i;let o=[...i];return o.sort((r,l)=>{let a=Z(r,l,n,t.direction);if(a===0&&t.secondary){let p=e.find(u=>u.id===t.secondary.fieldId||u.name===t.secondary.fieldId);if(p)return Z(r,l,p,t.secondary.direction)}return a}),o}function Z(i,e,t,n){let o=ee(i,t),r=ee(e,t);if(o===null&&r===null)return 0;if(o===null)return n==="ASC"?1:-1;if(r===null)return n==="ASC"?-1:1;let l=0;switch((t.dataType||"").toLowerCase()){case"text":case"title":l=j(o,r);break;case"number":l=le(o,r);break;case"date":l=ne(o,r);break;case"single_select":l=ae(o,r,t);break;case"iteration":l=de(o,r);break;case"labels":l=ce(o,r);break;default:l=String(o).localeCompare(String(r))}return n==="ASC"?l:-l}function ee(i,e){let t=i.fieldValues?.find(o=>o.fieldId===e.id||o.fieldName===e.name);if(!t)return null;switch((e.dataType||"").toLowerCase()){case"text":case"title":return t.text||t.title||null;case"number":return t.number!==void 0?t.number:null;case"date":return t.date||t.startDate||t.dueOn||null;case"single_select":return t.option||t;case"iteration":return t;case"labels":return t.labels||[];default:return t}}function j(i,e){let t=String(i||"").toLowerCase(),n=String(e||"").toLowerCase();return t.localeCompare(n)}function le(i,e){let t=typeof i=="number"?i:parseFloat(i),n=typeof e=="number"?e:parseFloat(e);return isNaN(t)&&isNaN(n)?0:isNaN(t)?1:isNaN(n)?-1:t-n}function ne(i,e){let t=new Date(i),n=new Date(e);return isNaN(t.getTime())&&isNaN(n.getTime())?0:isNaN(t.getTime())?1:isNaN(n.getTime())?-1:t.getTime()-n.getTime()}function ae(i,e,t){let n=i.option||i,o=e.option||e;if(!n||!o)return j(n?.name||"",o?.name||"");if(t.options&&Array.isArray(t.options)){let r=t.options.findIndex(a=>a.id===n.id||a.name===n.name),l=t.options.findIndex(a=>a.id===o.id||a.name===o.name);if(r!==-1&&l!==-1)return r-l}return j(n.name,o.name)}function de(i,e){let t=i.startDate||i.iteration?.startDate,n=e.startDate||e.iteration?.startDate;return!t&&!n?j(i.title||i.iteration?.title,e.title||e.iteration?.title):ne(t,n)}function ce(i,e){let t=Array.isArray(i)?i:[],n=Array.isArray(e)?e:[];return t.length===0&&n.length===0?0:t.length===0?1:n.length===0?-1:j(t[0].name,n[0].name)}var X=class{constructor(e,t,n,o={}){this.activeMenu=null;this.activeSlicePanel=null;this.activeSlice=null;this.container=e,this.allFields=t,this.options=o,this.items=n;let r=this.loadHiddenFields(),l=o.hiddenFields||[];this.hiddenFieldIds=new Set([...r,...l]),this.fields=this.allFields.filter(a=>!this.hiddenFieldIds.has(a.id)),this.applyFieldOrder()}render(){this.container.innerHTML="";let e=document.createElement("div");e.style.overflowX="auto",e.style.overflowY="auto",e.style.width="100%",e.style.display="block",e.style.height="100%";let t=document.createElement("table");t.style.borderCollapse="separate",t.style.borderSpacing="0",t.style.tableLayout="fixed",t.style.width="100%",this.renderColGroup(t),this.renderHeader(t),this.renderBody(t),e.appendChild(t),this.container.appendChild(e),this.setupResizers(t)}renderColGroup(e){let t=document.createElement("colgroup"),n=document.createElement("col");n.style.width="40px",t.appendChild(n);for(let r of this.fields){let l=document.createElement("col");l.style.width="150px",l.dataset.fieldId=r.id,t.appendChild(l)}let o=document.createElement("col");o.style.width="50px",t.appendChild(o),e.appendChild(t)}renderHeader(e){let t=document.createElement("thead");t.style.background="var(--vscode-sideBar-background)",t.style.position="sticky",t.style.top="0",t.style.zIndex="10";let n=document.createElement("tr"),o=document.createElement("th");o.textContent="#",this.styleHeaderCell(o),n.appendChild(o);for(let a of this.fields){let p=document.createElement("th"),u=document.createElement("div");u.style.display="flex",u.style.alignItems="center",u.style.justifyContent="space-between",u.style.width="100%",u.style.gap="4px";let c=document.createElement("span"),w=a.name||a.id||"";if(this.options.sortConfig?.fieldId===a.id){let E=this.options.sortConfig?.direction==="ASC"?" \u2191":" \u2193";w+=E}c.textContent=w,c.style.flex="1",c.style.overflow="hidden",c.style.textOverflow="ellipsis",c.style.whiteSpace="nowrap";let k=a.name?.toLowerCase()===this.options.groupingFieldName?.toLowerCase(),S=this.activeSlice?.fieldId===a.id,L=document.createElement("span");if(L.style.display="flex",L.style.alignItems="center",L.style.gap="2px",k||S){let E=document.createElement("span");E.innerHTML='<svg aria-hidden="true" height="12" viewBox="0 0 16 16" version="1.1" width="12" data-view-component="true" class="octicon octicon-filter"><path fill="currentColor" d="M.75 3h14.5a.75.75 0 0 1 .75.75v2a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1-.75-.75v-2a.75.75 0 0 1 .75-.75zm0 1.5v.5h14.5v-.5H.75zM5 9.75A.75.75 0 0 1 5.75 9h4.5a.75.75 0 0 1 .75.75v2a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-2zm1.5.5v.5h3v-.5h-3z"></path></svg>',E.style.display="flex",E.style.alignItems="center",E.style.color="var(--vscode-foreground)",E.style.opacity="0.7",E.title=k?"Grouped by this field":"Sliced by this field";let T=E.querySelector("svg");T&&(T.style.fill="currentColor"),L.appendChild(E)}let M=document.createElement("button");M.textContent="\u22EE",M.style.background="transparent",M.style.border="none",M.style.cursor="pointer",M.style.fontSize="16px",M.style.padding="2px 4px",M.style.color="var(--vscode-foreground)",M.style.opacity="0.6",M.style.borderRadius="3px",M.title=`${a.name} options`,M.addEventListener("mouseenter",()=>{M.style.opacity="1",M.style.background="var(--vscode-toolbar-hoverBackground)"}),M.addEventListener("mouseleave",()=>{M.style.opacity="0.6",M.style.background="transparent"}),M.addEventListener("click",E=>{E.stopPropagation(),p.style.background="var(--vscode-sideBar-background)",this.showHeaderMenu(E,a,p)}),u.appendChild(c),(k||S)&&u.appendChild(L),u.appendChild(M),p.appendChild(u),p.addEventListener("pointerenter",()=>{p.style.background="var(--vscode-list-hoverBackground)"}),p.addEventListener("pointerleave",()=>{p.style.background="var(--vscode-sideBar-background)"}),this.styleHeaderCell(p),n.appendChild(p)}let r=document.createElement("th"),l=document.createElement("button");l.textContent="+",l.style.background="transparent",l.style.border="none",l.style.cursor="pointer",l.style.fontSize="18px",l.style.fontWeight="bold",l.style.color="var(--vscode-foreground)",l.style.width="100%",l.style.height="100%",l.title="Show hidden fields",l.addEventListener("click",()=>this.showHiddenFieldsMenu(l)),r.appendChild(l),this.styleHeaderCell(r),r.style.textAlign="center",r.style.width="50px",n.appendChild(r),t.appendChild(n),e.appendChild(t)}styleHeaderCell(e){e.style.padding="8px",e.style.textAlign="left",e.style.whiteSpace="nowrap",e.style.overflow="hidden",e.style.textOverflow="ellipsis",e.style.borderRight="1px solid var(--vscode-panel-border)",e.style.borderBottom="1px solid var(--vscode-panel-border)",e.style.position="sticky",e.style.top="0",e.style.zIndex="11",e.style.background="var(--vscode-sideBar-background)",e.style.height="32px",e.style.boxSizing="border-box"}renderBody(e){let t=document.createElement("tbody"),n=this.items;this.options.sortConfig&&(n=K(this.items,this.fields,this.options.sortConfig)),this.activeSlice&&(n=n.filter(r=>{let l=r.fieldValues.find(p=>p.fieldId===this.activeSlice.fieldId);if(!l)return this.activeSlice.value===null;let a=null;return l.text!==void 0?a=l.text:l.title!==void 0?a=l.title:l.number!==void 0?a=l.number:l.date!==void 0?a=l.date:l.option?a=l.option.name:l.iteration?a=l.iteration.title:a=l.value,a===this.activeSlice.value}));let o=this.getGroupingField();o?this.renderGroupedRows(t,o,n):this.renderFlatRows(t,n),e.appendChild(t)}getGroupingField(){return this.options.groupingFieldName?this.fields.find(e=>e.name&&e.name.toLowerCase()===this.options.groupingFieldName?.toLowerCase()||e.id&&e.id===this.options.groupingFieldName):null}renderFlatRows(e,t){t.forEach((n,o)=>{let r=this.createRow(n,o);e.appendChild(r)})}renderGroupedRows(e,t,n){let o=this.groupItems(n,t);for(let r of o){let l=document.createElement("tr"),a=document.createElement("td");a.colSpan=this.fields.length+1,a.style.padding="8px",a.style.background="var(--vscode-editor-background)",a.style.fontWeight="600",a.style.borderTop="1px solid var(--vscode-editorGroup-border)",a.style.borderBottom="1px solid var(--vscode-editorGroup-border)",a.style.position="sticky",a.style.top="32px",a.style.zIndex="9",a.style.boxShadow="0 1px 2px rgba(0,0,0,0.1)";let p=document.createElement("div");p.style.display="flex",p.style.alignItems="center",p.style.gap="8px";let u=t,c=this.fields.find(d=>d.dataType&&String(d.dataType).toLowerCase()==="number"&&String(d.name||"").toLowerCase().includes("estimate"))||this.fields.find(d=>d.dataType&&String(d.dataType).toLowerCase()==="number"),w=c?c.id:null,k=d=>{if(!w)return 0;let m=0;for(let I of d){let _=I.item||I;if(!_||!Array.isArray(_.fieldValues))continue;let g=_.fieldValues.find(C=>C.fieldId&&C.fieldId===w||C.fieldName&&String(C.fieldName).toLowerCase().includes("estimate")||C.type==="number");if(g){let C=Number(g.number!=null?g.number:g.value!=null?g.value:NaN);isNaN(C)||(m+=C)}}return m},S=d=>isFinite(d)?String(d):"",L=document.createElement("span"),M='<svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-triangle-down"><path d="M4.427 7.427l3.396 3.396a.25.25 0 00.354 0l3.396-3.396A.25.25 0 0011.396 7H4.604a.25.25 0 00-.177.427z"></path></svg>',E='<svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-triangle-right"><path d="M8.573 4.604a.25.25 0 01.427-.177l3.396 3.396a.25.25 0 010 .354l-3.396 3.396a.25.25 0 01-.427-.177V4.604z"></path></svg>';L.innerHTML=M,L.style.cursor="pointer",L.style.userSelect="none",L.style.display="inline-flex",L.style.alignItems="center",L.style.justifyContent="center",L.style.width="16px",L.style.height="16px",L.style.fill="var(--vscode-foreground)",L.style.opacity="0.7";let T=document.createElement("div");T.style.width="12px",T.style.height="12px",T.style.borderRadius="50%",T.style.backgroundColor=D(r.option.color)||"gray";let R=document.createElement("span");R.textContent=r.option.name||r.option.title||"Unassigned";let O=document.createElement("vscode-badge");O.textContent=String(r.items.length);let s=document.createElement("div");s.style.display="flex",s.style.alignItems="center",s.style.gap="8px",s.style.position="sticky",s.style.left="0",s.style.zIndex="12",s.style.background=a.style.background,s.style.paddingRight="8px";let b=document.createElement("div");b.style.display="flex",b.style.alignItems="center",b.style.gap="8px",b.style.flex="1",s.appendChild(L);let h=null,x=null;if(String(t.dataType||"").toLowerCase()==="parent_issue"){let d=r.items&&r.items[0]?r.items[0].item||r.items[0]:null;if(d&&Array.isArray(d.fieldValues)){let m=d.fieldValues.find(I=>I.fieldId===t.id||I.fieldName===t.name||I.type==="parent_issue");m&&(h=m.parent||m.parentIssue||m.issue||m.item||m.value||null)}if(h&&Array.isArray(this.items))try{let m=[];h.number&&m.push(String(h.number)),h.id&&m.push(String(h.id)),h.url&&m.push(String(h.url)),h.title&&m.push(String(h.title));let I=this.items.find(_=>{let g=_&&(_.content||_.raw&&_.raw.itemContent)||null;if(!g)return!1;let C=[];g.number&&C.push(String(g.number)),g.id&&C.push(String(g.id)),g.url&&C.push(String(g.url)),g.title&&C.push(String(g.title)),g.name&&C.push(String(g.name)),g.raw&&g.raw.number&&C.push(String(g.raw.number)),g.raw&&g.raw.id&&C.push(String(g.raw.id)),g.raw&&g.raw.url&&C.push(String(g.raw.url));for(let P of m)for(let W of C)if(P&&W&&String(P)===String(W))return!0;return!1});I&&(x=I)}catch{}}if(r.option&&r.option.avatarUrl||r.option&&r.option.login||r.option&&r.option.name&&String(t.dataType||"").toLowerCase()==="assignees"){let d=document.createElement("span"),m=r.option&&(r.option.avatarUrl||r.option.avatar||r.option.imageUrl)||(()=>{for(let I of r.items){let _=I.item||I;if(!_||!Array.isArray(_.fieldValues))continue;let g=_.fieldValues.find(C=>C.type==="assignees"||C.fieldId===t.id);if(g&&g.assignees&&Array.isArray(g.assignees)){let C=g.assignees.find(P=>String(P.login||P.name)===String(r.option.name||r.option.id));if(C&&(C.avatarUrl||C.avatar))return C.avatarUrl||C.avatar}}return null})();m?(d.innerHTML='<span title="'+f(r.option&&(r.option.login||r.option.name)||"Assignee")+'" style="display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url('+f(m)+');border:2px solid var(--vscode-editor-background)"></span>',s.appendChild(d)):s.appendChild(T)}else if(String(t.dataType||"").toLowerCase()==="repository"){let d=document.createElement("span");d.innerHTML='<svg width="14" height="14" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:var(--vscode-icon-foreground)"><path fill="currentColor" d="M2 2.5A1.5 1.5 0 0 1 3.5 1h9A1.5 1.5 0 0 1 14 2.5v11A1.5 1.5 0 0 1 12.5 15h-9A1.5 1.5 0 0 1 2 13.5v-11zM3.5 2A.5.5 0 0 0 3 2.5V4h10V2.5a.5.5 0 0 0-.5-.5h-9z"/></svg>',s.appendChild(d)}else s.appendChild(T);if(x){let d=x.content||x.raw&&x.raw.itemContent||null;if(d){try{d.title?R.textContent=String(d.title):d.name?R.textContent=String(d.name):d.number&&(R.textContent=String(d.number))}catch{}if(Array.isArray(x.fieldValues)){let m=x.fieldValues.find(I=>I&&I.type==="single_select"&&I.option&&I.option.name);if(m&&m.option)try{let I=m.option.color||m.option.id||m.option.name||null;I&&(T.style.backgroundColor=D(I)||T.style.backgroundColor)}catch{}}}}else if(h&&(R.textContent=h.title||h.name||h.number||h.id||R.textContent,h.color))try{T.style.backgroundColor=D(h.color)||T.style.backgroundColor}catch{}s.appendChild(R);let y=document.createElement("span");y.style.display="inline-flex",y.style.alignItems="center",y.style.justifyContent="center",y.style.width="22px",y.style.height="22px",y.style.borderRadius="50%",y.style.background="var(--vscode-input-background)",y.style.border="1px solid var(--vscode-panel-border)",y.style.color="var(--vscode-foreground)",y.style.fontSize="12px",y.style.fontWeight="600",y.style.minWidth="22px",y.style.boxSizing="border-box",y.textContent=String(r.items.length||0),s.appendChild(y);let N=k(r.items||[]);if(N&&N>0){let d=document.createElement("div");if(d.style.display="inline-block",d.style.padding="2px 8px",d.style.borderRadius="999px",d.style.border="1px solid var(--vscode-panel-border)",d.style.background="var(--vscode-input-background)",d.style.color="var(--vscode-foreground)",d.style.fontSize="12px",d.style.lineHeight="18px",d.style.marginLeft="8px",d.textContent="Estimate: "+S(N),b.appendChild(d),String(t.dataType||"").toLowerCase()==="parent_issue"&&!(r.option&&(r.option.name==="Unassigned"||r.option.title==="Unassigned"))){let m=["done","closed","completed","finished"],I=A=>{try{let v=A&&(A.content||A.raw&&A.raw.itemContent);if(v){let z=(v.state||(v.merged?"MERGED":void 0)||"").toString().toUpperCase();if(z==="CLOSED"||z==="MERGED")return!0}if(Array.isArray(A.fieldValues)){if(A.fieldValues.find(B=>B&&B.type==="single_select"&&B.option&&B.option.name&&m.includes(String(B.option.name).toLowerCase())))return!0;let V=A.fieldValues.find(B=>B&&(String(B.fieldName||"").toLowerCase().includes("progress")||String(B.fieldName||"").toLowerCase().includes("percent")||B.type==="number"&&String(B.fieldName||"").toLowerCase().includes("progress")));if(V&&V.number!=null&&Number(V.number||0)>=100)return!0}if(v&&v.labels&&Array.isArray(v.labels.nodes)){let z=v.labels.nodes.map(V=>String(V.name||"").toLowerCase());for(let V of m)if(z.includes(V))return!0}}catch{}return!1},_=0,g=0;if(x&&Array.isArray(x.fieldValues)){let A=x.fieldValues.find(v=>v&&(v.type==="sub_issues_progress"||v.total!=null&&v.done!=null));A&&A.total!=null&&(g=Number(A.total||0),_=Number(A.done||0))}if(!g)for(let A of r.items){let v=A.item||A;v&&(g++,I(v)&&_++)}let C=document.createElement("div");C.style.color="var(--vscode-descriptionForeground)",C.style.fontSize="12px",C.style.marginLeft="8px",C.style.fontVariantNumeric="tabular-nums",C.textContent=`${_}/${g}`,b.appendChild(C);let P=document.createElement("div");P.style.display="inline-flex",P.style.alignItems="center",P.style.gap="8px",P.style.marginLeft="8px";let W=g>0?Math.round(_/g*100):0,H=document.createElement("div");H.style.display="inline-block",H.style.width="120px",H.style.height="12px",H.style.background="transparent",H.style.border="1px solid var(--vscode-focusBorder)",H.style.borderRadius="6px",H.style.overflow="hidden";let $=document.createElement("div");$.style.height="100%",$.style.width=String(W)+"%",$.style.background="var(--vscode-focusBorder)",H.appendChild($),P.appendChild(H),b.appendChild(P)}}if(String(t.dataType||"").toLowerCase()==="single_select")try{let d=(t.options||[]).find(m=>String(m.name)===String(r.option&&r.option.name));if(d&&d.description){let m=document.createElement("div");m.style.color="var(--vscode-descriptionForeground)",m.style.fontSize="12px",m.style.marginLeft="8px",m.textContent=String(d.description).slice(0,120),b.appendChild(m)}}catch{}if(String(t.dataType||"").toLowerCase()==="iteration")try{let d=r.option||{},m=null,I=d.startDate||d.start&&d.startDate||null,_=d.duration||d.length||null;if(I&&_)try{let g=new Date(I),C=Number(_)||0,P=new Date(g.getTime()+C*24*60*60*1e3),W=g.toLocaleDateString("en-US",{month:"short",day:"numeric"}),H=P.toLocaleDateString("en-US",{month:"short",day:"numeric"});m=`${W} \u2014 ${H}`}catch{m=null}if(m||(m=d.title||d.name?String(d.title||d.name):null),m){let g=document.createElement("div");g.style.color="var(--vscode-descriptionForeground)",g.style.fontSize="12px",g.style.marginLeft="8px",g.textContent=String(m).slice(0,120),b.appendChild(g)}}catch{}r.option&&(r.option.name==="Unassigned"||r.option.title==="Unassigned")&&(R.textContent="No "+(t.name||"value")),p.appendChild(s),p.appendChild(b),a.appendChild(p),l.appendChild(a),e.appendChild(l);let G=[];r.items.forEach(d=>{let m=this.createRow(d.item,d.index);m.classList.add("group-row-"+r.option.id),e.appendChild(m),G.push(m)});let F=!1;L.addEventListener("click",()=>{F=!F,L.innerHTML=F?E:M,G.forEach(d=>{d.style.display=F?"none":"table-row"})})}}groupItems(e,t){let n=[],o=(t.dataType||"").toLowerCase();if(o==="single_select"?n=t.options||[]:o==="iteration"&&(n=t.configuration&&t.configuration.iterations||[]),n&&n.length>0){let p=n.map(c=>({option:c,items:[]})),u=[];return e.forEach((c,w)=>{let k=c.fieldValues.find(L=>L.fieldId===t.id||L.fieldName===t.name),S=!1;if(k){let L=null,M=null;if(o==="single_select"?(L=k.optionId||k.option&&k.option.id,M=k.name||k.option&&k.option.name):o==="iteration"&&(L=k.iterationId||k.iteration&&k.iteration.id||k.id,M=k.title||k.iteration&&k.iteration.title),L||M){let E=p.find(T=>L&&String(T.option.id)===String(L)||M&&(String(T.option.name)===String(M)||String(T.option.title)===String(M)));E&&(E.items.push({item:c,index:w}),S=!0)}}S||u.push({item:c,index:w})}),u.length>0&&p.push({option:{name:"Unassigned",title:"Unassigned",color:"GRAY"},items:u}),p.filter(c=>c.items.length>0)}let r=new Map,l=[];e.forEach((p,u)=>{let c=p.fieldValues.find(S=>S.fieldId===t.id||S.fieldName===t.name),w=null;if(c)if(c.text!==void 0)w=c.text;else if(c.title!==void 0)w=c.title;else if(c.number!==void 0)w=c.number;else if(c.date!==void 0)w=c.date;else if(c.option)w=c.option.name||c.option.title||c.option.id;else if(c.iteration)w=c.iteration.title||c.iteration.id;else if(c.parent||c.parentIssue||c.issue||c.item||c.value){let S=c.parent||c.parentIssue||c.issue||c.item||c.value;S&&(w=S.number||S.id||S.raw&&(S.raw.number||S.raw.id)||S.url||S.title||S.name||null)}else c.assignees?w=Array.isArray(c.assignees)?c.assignees.map(S=>S.login||S.name).join(", "):c.assignees:c.repository?w=c.repository.nameWithOwner||c.repository.name||c.repository.full_name||c.repository.id:c.milestone?w=c.milestone.title||c.milestone.id||c.milestone.name:w=c.value!==void 0?c.value:null;if(w==null||w===""){l.push({item:p,index:u});return}let k=String(w);r.has(k)||r.set(k,{option:{id:k,name:k,title:k},items:[]}),r.get(k).items.push({item:p,index:u})});let a=Array.from(r.values());return l.length>0&&a.push({option:{name:"Unassigned",title:"Unassigned",color:"GRAY"},items:l}),a}createRow(e,t){let n=document.createElement("tr");n.setAttribute("data-gh-item-id",e.id),n.style.transition="background-color 0.15s ease",n.addEventListener("mouseenter",()=>{n.style.backgroundColor="var(--vscode-list-hoverBackground)"}),n.addEventListener("mouseleave",()=>{n.style.backgroundColor="transparent"});let o=document.createElement("td");o.textContent=String(t+1),this.styleCell(o),n.appendChild(o);for(let r=0;r<this.fields.length;r++){let l=this.fields[r],a=document.createElement("td");this.styleCell(a);let p=e.fieldValues.find(c=>c.fieldId===l.id||c.fieldName===l.name);p&&(a.innerHTML=Q(p,l,e,this.items)),a.style.position="relative";let u=document.createElement("div");u.className="column-resizer",u.style.position="absolute",u.style.top="0",u.style.right="0",u.style.width="6px",u.style.height="100%",u.style.cursor="col-resize",u.style.userSelect="none",u.style.zIndex="50",u.addEventListener("mouseenter",()=>u.style.background="var(--vscode-focusBorder)"),u.addEventListener("mouseleave",()=>u.style.background="transparent"),u.addEventListener("mousedown",c=>{c.preventDefault(),c.stopPropagation();let w=this.container.querySelector("table");if(!w)return;let S=w.querySelectorAll("col")[r+1],L=S?parseInt(S.style.width)||S.offsetWidth:a.offsetWidth;this.beginColumnResize(w,r+1,c.pageX,L)}),a.appendChild(u),n.appendChild(a)}return n}styleCell(e){e.style.padding="8px",e.style.borderRight="1px solid var(--vscode-panel-border)",e.style.borderBottom="1px solid var(--vscode-panel-border)",e.style.whiteSpace="nowrap",e.style.overflow="hidden",e.style.textOverflow="ellipsis"}showHeaderMenu(e,t,n){e.stopPropagation(),this.activeMenu&&this.activeMenu.hide();let o=(t.dataType||"").toLowerCase(),r=new Set(["assignees","single_select","parent_issue","iteration","number","date","milestone","repository"]),l=new Set(["assignees","single_select","parent_issue","iteration","number","date","milestone","repository","labels"]),a=r.has(o),p=l.has(o),u=!!(this.options.groupingFieldName&&t.name&&t.name.toLowerCase()===this.options.groupingFieldName.toLowerCase()),c=!!(this.activeSlice&&this.activeSlice.fieldId===t.id),w=this.options.sortConfig&&this.options.sortConfig.fieldId===t.id?this.options.sortConfig.direction:null;this.activeMenu=new q(t,{canGroup:a,canSlice:p,canFilter:!1,isGrouped:u,isSliced:c,currentSort:w,onSort:k=>this.handleSort(t,k),onClearSort:()=>this.clearSort(t),onGroup:()=>this.handleGroup(t),onClearGroup:()=>this.clearGroup(t),onSlice:()=>this.handleSlice(t),onClearSlice:()=>this.clearSlice(t),onHide:()=>this.hideField(t.id),onMove:k=>this.handleMove(t,k)}),this.activeMenu.show(n)}clearGroup(e){if(this.options.groupingFieldName=void 0,this.options.onGroupChange)try{this.options.onGroupChange("")}catch{}this.render()}clearSlice(e){this.activeSlice=null,this.activeSlicePanel&&(this.activeSlicePanel.close(),this.activeSlicePanel=null),this.render(),this.options.onSliceChange&&this.options.onSliceChange(null)}clearSort(e){let t=this.getStorageKey("sortConfig");t&&localStorage.removeItem(t),this.options.onSortChange&&this.options.onSortChange(null)}showHiddenFieldsMenu(e){this.activeMenu&&this.activeMenu.hide();let t=this.allFields.filter(p=>this.hiddenFieldIds.has(p.id));if(t.length===0){let p=document.createElement("div");p.textContent="No hidden fields",p.style.position="absolute",p.style.background="var(--vscode-menu-background)",p.style.border="1px solid var(--vscode-menu-border)",p.style.borderRadius="4px",p.style.padding="12px",p.style.fontSize="13px",p.style.color="var(--vscode-descriptionForeground)",p.style.zIndex="1000";let u=e.getBoundingClientRect();p.style.top=`${u.bottom+4}px`,p.style.left=`${u.left}px`,document.body.appendChild(p),setTimeout(()=>p.remove(),2e3);return}let n=document.createElement("div");n.style.position="absolute",n.style.background="var(--vscode-menu-background)",n.style.border="1px solid var(--vscode-menu-border)",n.style.borderRadius="4px",n.style.padding="4px 0",n.style.minWidth="180px",n.style.zIndex="1000",n.style.fontSize="13px";let o=e.getBoundingClientRect();n.style.top=`${o.bottom+4}px`,n.style.left=`${o.left}px`;let r=document.createElement("div");r.textContent="Show field",r.style.padding="6px 12px",r.style.fontWeight="600",r.style.color="var(--vscode-descriptionForeground)",r.style.fontSize="11px",r.style.textTransform="uppercase",n.appendChild(r);let l=document.createElement("div");l.style.height="1px",l.style.background="var(--vscode-menu-separatorBackground)",l.style.margin="4px 0",n.appendChild(l),t.forEach(p=>{let u=document.createElement("div");u.textContent=p.name||p.id,u.style.padding="6px 12px",u.style.cursor="pointer",u.style.color="var(--vscode-menu-foreground)",u.addEventListener("mouseenter",()=>{u.style.background="var(--vscode-menu-selectionBackground)",u.style.color="var(--vscode-menu-selectionForeground)"}),u.addEventListener("mouseleave",()=>{u.style.background="transparent",u.style.color="var(--vscode-menu-foreground)"}),u.addEventListener("click",()=>{this.showField(p.id),n.remove(),a.remove()}),n.appendChild(u)});let a=document.createElement("div");a.style.position="fixed",a.style.top="0",a.style.left="0",a.style.right="0",a.style.bottom="0",a.style.zIndex="999",a.addEventListener("click",()=>{n.parentElement&&n.remove(),a.parentElement&&a.remove()}),document.body.appendChild(n),document.body.appendChild(a)}handleSort(e,t){let n={fieldId:e.id,direction:t};this.saveSortConfig(n),this.options.onSortChange&&this.options.onSortChange(n)}handleGroup(e){if(e&&e.name&&(this.options.groupingFieldName=e.name,this.render(),this.options.onGroupChange))try{this.options.onGroupChange(e.name)}catch{}}handleSlice(e){this.activeSlicePanel&&(this.activeSlicePanel.close(),this.activeSlicePanel=null),this.activeSlicePanel=new J(this.container,e,this.items),this.activeSlicePanel.render();let t=this.container.querySelector("table");if(t){let n=this.container.querySelector(".slice-panel");n&&this.container.insertBefore(n,t)}this.activeSlicePanel.onValueSelect(n=>{this.activeSlice={fieldId:e.id,value:n},this.render()}),this.options.onSliceChange&&this.options.onSliceChange(e)}hideField(e){this.hiddenFieldIds.add(e),this.saveHiddenFields(),this.fields=this.allFields.filter(t=>!this.hiddenFieldIds.has(t.id)),this.render()}showField(e){this.hiddenFieldIds.delete(e),this.saveHiddenFields(),this.fields=this.allFields.filter(t=>!this.hiddenFieldIds.has(t.id)),this.render()}handleMove(e,t){let n=this.fields.findIndex(o=>o.id===e.id);t==="left"&&n>0?[this.fields[n],this.fields[n-1]]=[this.fields[n-1],this.fields[n]]:t==="right"&&n<this.fields.length-1&&([this.fields[n],this.fields[n+1]]=[this.fields[n+1],this.fields[n]]),this.saveFieldOrder(),this.render()}getStorageKey(e){return this.options.viewKey?`ghProjects.table.${this.options.viewKey}.${e}`:""}loadHiddenFields(){let e=this.getStorageKey("hiddenFields");if(!e)return[];try{let t=localStorage.getItem(e);return t?JSON.parse(t):[]}catch{return[]}}saveHiddenFields(){let e=this.getStorageKey("hiddenFields");e&&localStorage.setItem(e,JSON.stringify(Array.from(this.hiddenFieldIds)))}saveSortConfig(e){let t=this.getStorageKey("sortConfig");t&&localStorage.setItem(t,JSON.stringify(e))}saveFieldOrder(){let e=this.getStorageKey("fieldOrder");if(!e)return;let t=this.fields.map(n=>n.id);localStorage.setItem(e,JSON.stringify(t))}applyFieldOrder(){let e=this.getStorageKey("fieldOrder");if(e)try{let t=localStorage.getItem(e);if(!t)return;let n=JSON.parse(t),o=[];for(let r of n){let l=this.fields.find(a=>a.id===r);l&&o.push(l)}for(let r of this.fields)o.find(l=>l.id===r.id)||o.push(r);this.fields=o}catch{}}setupResizers(e){e.querySelectorAll("th").forEach((n,o)=>{if(o===0)return;let r=document.createElement("div");r.className="column-resizer",r.style.position="absolute",r.style.top="0",r.style.right="0",r.style.width="4px",r.style.height="100%",r.style.cursor="col-resize",r.style.userSelect="none",r.style.zIndex="100",r.addEventListener("mouseenter",()=>{r.style.background="var(--vscode-focusBorder)"}),r.addEventListener("mouseleave",()=>{r.style.background="transparent"});let l=0,a=0;r.addEventListener("mousedown",p=>{p.preventDefault(),p.stopPropagation();let c=e.querySelectorAll("col")[o],w=c?parseInt(c.style.width)||c.offsetWidth:n.offsetWidth;this.beginColumnResize(e,o,p.pageX,w)}),n.style.position="relative",n.appendChild(r)}),this.restoreColumnWidths(e)}saveColumnWidth(e,t){let n=this.getStorageKey("columnWidths");if(n)try{let o=localStorage.getItem(n),r=o?JSON.parse(o):{};r[e]=t,localStorage.setItem(n,JSON.stringify(r))}catch{}}beginColumnResize(e,t,n,o){let r=a=>{let p=Math.max(20,o+(a.pageX-n)),c=e.querySelectorAll("col")[t];c&&(c.style.width=`${p}px`,c.style.minWidth=`${p}px`,c.style.maxWidth=`${p}px`)},l=a=>{document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",l);let p=t-1;if(p>=0&&p<this.fields.length){let c=e.querySelectorAll("col")[t],w=c?parseInt(c.style.width)||c.offsetWidth:void 0;w&&this.saveColumnWidth(this.fields[p].id,w)}};document.addEventListener("mousemove",r),document.addEventListener("mouseup",l)}restoreColumnWidths(e){let t=this.getStorageKey("columnWidths");if(t)try{let n=localStorage.getItem(t);if(!n)return;let o=JSON.parse(n),r=e.querySelectorAll("col");this.fields.forEach((l,a)=>{let p=o[l.id];if(p){let u=r[a+1];u&&(u.style.width=`${p}px`,u.style.minWidth=`${p}px`,u.style.maxWidth=`${p}px`)}})}catch{}}};function ie(i,e){i.innerHTML='<div class="title">'+e+'</div><div class="loading"><em>Loading...</em></div>'}function re(i,e,t){i.innerHTML='<div class="title">'+e+'</div><div style="color:var(--vscode-editor-foreground)">'+t+"</div>"}function oe(i){let e=document.createElement("button");return e.type="button",e.textContent="Load more",e.style.marginLeft="8px",e.style.border="1px solid var(--vscode-editorWidget-border)",e.addEventListener("click",()=>{i(),e.disabled=!0,e.textContent="Loading..."}),e}function se(i,e,t){if(window.filterBarHelper&&typeof window.filterBarHelper.create=="function")try{return window.filterBarHelper.create({parent:i,suffix:t.suffix||e,effFilter:void 0,viewKey:e,step:t.step||50,onLoadMore:t.onLoadMore,onSave:t.onSave,onDiscard:t.onDiscard})}catch{return null}return null}window.tableViewFetcher=function(i,e,t){let n=i&&(i.name||i.id)?i.name||i.id:"Table View";try{ie(e,n)}catch{}let o=30;function r(p){let u=p||{},c=u.fields||[],w=u.items||[],k=w.slice(0,o);e.innerHTML="",e.style.margin="0",e.style.padding="0",e.style.height="100%",e.style.display="flex",e.style.flexDirection="column",e.style.overflow="hidden";let S=document.createElement("div");S.style.flex="0 0 auto",S.style.background="var(--vscode-editor-background)",S.style.zIndex="20",S.style.position="relative",S.style.display="flex",S.style.justifyContent="space-between",S.style.alignItems="center",S.style.width="100%";let L=document.createElement("div");L.style.flex="1 1 auto",L.style.marginRight="8px",S.appendChild(L);let M=null,E=se(L,t,{suffix:t?String(t).split(":").pop():"",step:o,onLoadMore:()=>{o+=30,a()},onSave:h=>{try{M!==null&&(window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"setViewGrouping",viewKey:t,grouping:M}),M=null)}catch{}},onDiscard:()=>{try{M!==null&&(window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"discardViewGrouping",viewKey:t}),M=null)}catch{}}});if(E)typeof E.setLoadState=="function"&&E.setLoadState(w.length<o,w.length>=o?"Load more":"All loaded"),typeof E.registerItems=="function"&&E.registerItems(w,{fields:c});else{let h=document.createElement("div");h.className="title",h.textContent=n,h.style.padding="8px",S.appendChild(h);let x=document.createElement("div");if(x.style.padding="8px",w.length>o){let y=oe(()=>{o+=30,a()});x.appendChild(y)}else{let y=document.createElement("span");y.textContent="All loaded",y.style.color="var(--vscode-descriptionForeground)",x.appendChild(y)}S.appendChild(x)}e.appendChild(S);let T=document.createElement("div");T.style.flex="1 1 auto",T.style.overflow="hidden",T.style.position="relative",e.appendChild(T);let R=pe(u),O=te(u.details?.sortByFields);if(t)try{let h=localStorage.getItem(`ghProjects.table.${t}.sortConfig`);h&&(O=JSON.parse(h))}catch{}let s=k;O&&(s=K(k,c,O)),new X(T,c,s,{groupingFieldName:R||void 0,sortConfig:O,viewKey:t,onSortChange:()=>a(),onGroupChange:h=>{try{if(M=h||null,E&&E.saveBtn&&E.discardBtn)try{E.saveBtn.disabled=!1,E.discardBtn.disabled=!1,E.saveBtn.style.opacity="1",E.saveBtn.style.cursor="pointer",E.discardBtn.style.opacity="1",E.discardBtn.style.cursor="pointer"}catch{}}catch{}}}).render(),E&&typeof E.onFilterChange=="function"&&E.onFilterChange(h=>{T.querySelectorAll("tr[data-gh-item-id]").forEach(y=>{let N=y.getAttribute("data-gh-item-id");N&&h.has(N)?y.style.display="table-row":y.style.display="none"})})}function l(p){let u=p&&p.data?p.data:p;try{if(u&&u.command==="fields"){if(u.viewKey&&t&&String(u.viewKey)!==String(t))return;u.error?re(e,n,String(u.error)):r(u.payload)}}catch{}}function a(){try{window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"requestFields",first:o,viewKey:t})}catch{}}try{window.__APP_MESSAGING__.onMessage(l)}catch{window.addEventListener("message",l)}a()};function pe(i){try{if(i&&i.details){let e=i.details.verticalGroupByFields&&i.details.verticalGroupByFields.nodes,t=i.details.groupByFields&&i.details.groupByFields.nodes;if(e&&e.length>0)return e[0].name||null;if(t&&t.length>0)return t[0].name||null}}catch{}return null}})();
//# sourceMappingURL=tableViewFetcher.js.map
