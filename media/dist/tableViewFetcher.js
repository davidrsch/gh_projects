"use strict";(()=>{function E(r){return r?String(r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function D(r){if(!r)return null;let t=String(r).trim();if(/^#?[0-9a-f]{3}$/i.test(t)||/^#?[0-9a-f]{6}$/i.test(t)||/^#?[0-9a-f]{8}$/i.test(t)){let n=t[0]==="#"?t.slice(1):t;return"#"+(n.length===8?n.substring(0,6):n)}let e={GRAY:"#848d97",RED:"#f85149",ORANGE:"#db6d28",YELLOW:"#d29922",GREEN:"#3fb950",BLUE:"#2f81f7",PURPLE:"#a371f7",PINK:"#db61a2",BLACK:"#000000",WHITE:"#ffffff"},i=t.toUpperCase();return e[i]||null}function U(r,t){if(!r)return null;let e=r.replace("#",""),i=n=>parseInt(n,16);if(e.length===3){let n=i(e[0]+e[0]),s=i(e[1]+e[1]),o=i(e[2]+e[2]);return"rgba("+n+","+s+","+o+","+t+")"}if(e.length===6||e.length===8){let n=e.length===8?e.substring(0,6):e,s=i(e.substring(0,2)),o=i(n.substring(2,4)),d=i(n.substring(4,6));return"rgba("+s+","+o+","+d+","+t+")"}return null}function K(r){if(!r)return"#333333";let t=r.replace("#",""),e=o=>parseInt(o,16),i,n,s;if(t.length===3)i=e(t[0]+t[0]),n=e(t[1]+t[1]),s=e(t[2]+t[2]);else if(t.length===6||t.length===8){let o=t.length===8?t.substring(0,6):t;i=e(o.substring(0,2)),n=e(o.substring(2,4)),s=e(o.substring(4,6))}else return"#333333";return .2126*(i/255)+.7152*(n/255)+.0722*(s/255)>.6?"#111111":"#ffffff"}function Z(r,t,e,i){var n,s,o,d,l,c,p,h,g,v,C,I,T,M,m;if(!r)return"";try{switch(r.type){case"title":{let a=r&&r.title&&(r.title.raw&&r.title.raw.text||r.title.content&&(r.title.content.title||r.title.content.name)||typeof r.title=="string"&&r.title)||r&&r.content&&(r.content.title||r.content.name)||r&&r.raw&&r.raw.text||"",x=r&&r.title&&r.title.content&&r.title.content.number||r&&r.raw&&r.raw.itemContent&&r.raw.itemContent.number||e&&e.content&&e.content.number||"",b=r&&r.title&&r.title.content&&r.title.content.url||r&&r.raw&&r.raw.itemContent&&r.raw.itemContent.url||e&&e.content&&e.content.url||"",F=null;if(e&&Array.isArray(e.fieldValues)){let u=e.fieldValues.find(y=>y&&y.type==="single_select"&&(y.raw&&y.raw.field&&String(y.raw.field.name||"").toLowerCase()==="status"||y.fieldName&&String(y.fieldName||"").toLowerCase()==="status"||y.field&&y.field.name&&String(y.field.name||"").toLowerCase()==="status"));u&&(F=u.option&&(u.option.color||u.option.id||u.option.name)||u.raw&&u.raw.color||null)}let f=D(F)||null,P=f&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(f)?f:"#666666",N=E(String(a||"")),w=x?E(String(x)):"";return'<a href="'+E(String(b||""))+'" target="_blank" rel="noopener noreferrer" style="text-decoration:none;color:inherit;display:inline-flex;align-items:center;gap:8px;width:100%;"><svg width="14" height="14" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:'+E(P)+'"><circle cx="8" cy="8" r="6" fill="currentColor" /></svg><span style="flex:1;min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:block">'+N+"</span>"+(w?'<span style="flex:none;margin-left:6px;color:var(--vscode-descriptionForeground);white-space:nowrap">#'+w+"</span>":"")+"</a>"}case"text":return"<div>"+E((n=r.text)!=null?n:"")+"</div>";case"number":{let a=r.number!==void 0&&r.number!==null?String(r.number):"";return'<div style="text-align:right;font-variant-numeric:tabular-nums">'+E(a)+"</div>"}case"date":{let a=(d=(o=(s=r.date)!=null?s:r.startDate)!=null?o:r.dueOn)!=null?d:null;if(!a)return"<div></div>";try{let x=new Date(a);if(isNaN(x.getTime()))return"<div>"+E(String(a))+"</div>";let b=x.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return"<div>"+E(b)+"</div>"}catch{return"<div>"+E(String(a))+"</div>"}}case"single_select":{let a=E((c=(l=r.option)==null?void 0:l.name)!=null?c:""),x=null;if(t&&Array.isArray(t.options)){let w=t.options.find(u=>u.id&&r.option&&r.option.id&&u.id===r.option.id||u.name&&r.option&&r.option.name&&u.name===r.option.name);w&&(x=(h=(p=w.color)!=null?p:w.id)!=null?h:null)}let b=D(x)||null,F=!!(b&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(b)),f=b||"#999999",P=F&&U(b,.12)||"rgba(0,0,0,0.06)",N=b||"#333333";return'<span style="display:block;width:100%;box-sizing:border-box"><div style="display:inline-flex;align-items:center;padding:2px 8px;border:1px solid '+E(f)+";border-radius:999px;color:"+E(N)+";background:"+E(P)+';font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;width:100%"><span style="flex:1 1 auto;min-width:0;max-width:100%;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">'+a+"</span></div></span>"}case"labels":return"<div>"+(r.labels||[]).map(a=>{let x=E(a.name||""),b=e&&(e.content&&e.content.repository&&e.content.repository.nameWithOwner||e.repository&&e.repository.nameWithOwner)||r.raw&&r.raw.itemContent&&r.raw.itemContent.repository&&r.raw.itemContent.repository.nameWithOwner||null,F=a.color||a.colour||null;if(t&&t.repoOptions&&b&&t.repoOptions[b]){let y=t.repoOptions[b].find(L=>L&&L.name===a.name);y&&(F=y.color||y.colour||F)}let f=D(F)||null,P=!!(f&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(f)),N=f||"#999999",w=P&&U(f,.12)||"rgba(0,0,0,0.06)",u=f||"#333333";return'<span style="display:inline-block;padding:2px 8px;margin-right:6px;border-radius:999px;border:1px solid '+E(N)+";background:"+E(w)+";color:"+E(u)+';font-size:12px;line-height:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">'+x+"</span>"}).join("")+"</div>";case"repository":{let a=E((v=(g=r.repository)==null?void 0:g.nameWithOwner)!=null?v:"");return'<a href="'+E(((C=r.repository)==null?void 0:C.url)||((I=r.repository)==null?void 0:I.html_url)||"")+'" target="_blank" rel="noopener noreferrer" style="text-decoration:none;color:inherit;display:inline-flex;align-items:center;gap:8px"><svg width="14" height="14" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:var(--vscode-icon-foreground)"><path fill="currentColor" d="M2 2.5A1.5 1.5 0 0 1 3.5 1h9A1.5 1.5 0 0 1 14 2.5v11A1.5 1.5 0 0 1 12.5 15h-9A1.5 1.5 0 0 1 2 13.5v-11zM3.5 2A.5.5 0 0 0 3 2.5V4h10V2.5a.5.5 0 0 0-.5-.5h-9z"/></svg><span>'+a+"</span></a>"}case"pull_request":{let a=r.pullRequests||[];return function(){var x=r.pullRequests||[];if(!x||x.length===0)return"";for(var b='<div style="display:flex;flex-wrap:wrap;gap:6px;align-items:center">',F=0;F<x.length;F++){var f=x[F],P=E(String(f&&f.number||"")),N=E(f&&f.title||""),w=E(f&&f.url||""),u=f&&(f.state_color||f.color||f.colour||f.state)||null,y=D(u)||null,L=!!(y&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(y)),G=y||"#999999",k=L&&U(y,.12)||"rgba(0,0,0,0.06)",A=K(y)||"#333333";b+='<a href="'+w+'" target="_blank" rel="noopener noreferrer" style="text-decoration:none;color:inherit"><span title="'+N+'" style="display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;border:1px solid '+E(G)+";background:"+E(k)+";color:"+E(A)+';font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;max-width:160px"><svg width="12" height="12" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:'+E(y||"#666")+'"><circle cx="8" cy="8" r="6" fill="currentColor" /></svg><span style="flex:1 1 auto;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">#'+P+"</span></span></a>"}return b+="</div>",b}()}case"issue":return(r.issues||[]).map(a=>'<a href="'+E(a.url||"")+'" target="_blank" rel="noopener noreferrer">#'+E(String(a.number||""))+" "+E(a.title||"")+"</a>").join("<br/>");case"assignees":{let a=r.assignees||[];if(a.length===0)return"<div></div>";let x=a.slice(0,3).map((f,P)=>{let N=E(f.avatarUrl||f.avatar||""),w=P===0?"0px":P===1?"-8px":"-14px",u=Math.max(1,3-P);if(N)return'<span title="'+E(f.login||f.name||"")+'" style="display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url('+N+");border:2px solid var(--vscode-editor-background);margin-left:"+w+";vertical-align:middle;position:relative;z-index:"+u+'"></span>';let y=E((f.name||f.login||"").split(" ").map(L=>L[0]||"").join("").toUpperCase().slice(0,2));return'<span title="'+E(f.login||f.name||"")+'" style="display:inline-flex;align-items:center;justify-content:center;width:20px;height:20px;border-radius:50%;background:#777;color:#fff;font-size:11px;border:2px solid var(--vscode-editor-background);margin-left:'+w+";vertical-align:middle;position:relative;z-index:"+u+'">'+y+"</span>"}).join(""),b=a.map(f=>f.login||f.name||""),F="";return b.length===1?F=b[0]:b.length===2?F=b[0]+" and "+b[1]:F=b.slice(0,-1).join(", ")+" and "+b.slice(-1)[0],'<div style="display:flex;align-items:center;gap:8px"><span style="display:flex;align-items:center">'+('<span style="display:inline-block;vertical-align:middle;height:20px;line-height:20px;margin-right:8px;">'+x+"</span>")+'</span><span style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis">'+E(F)+"</span></div>"}case"requested_reviewers":return"<div>"+E((r.reviewers||[]).map(a=>a.login||a.name||a.kind||"").join(", "))+"</div>";case"iteration":{let a=E((T=r.title)!=null?T:""),x=D("GRAY")||null,b=!!(x&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(x)),F=x||"#999999",f=b&&U(x,.12)||"rgba(0,0,0,0.06)",P=x||"#333333";return'<div style="display:inline-block;padding:2px 8px;border:1px solid '+E(F)+";border-radius:999px;color:"+E(P)+";background:"+E(f)+';font-size:12px;line-height:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">'+a+"</div>"}case"parent_issue":{let a=r&&(r.parent||r.parentIssue||r.issue||r.option||r.item||r.value)||r&&r.raw&&(r.raw.parent||r.raw.itemContent||r.raw.item)||null,x=a&&(a.number||a.id||a.raw&&a.raw.number)&&(a.number||a.raw&&a.raw.number)||"",b=a&&(a.title||a.name||a.raw&&a.raw.title)&&(a.title||a.name||a.raw&&a.raw.title)||"",F=a&&(a.url||a.html_url||a.raw&&a.raw.url)&&(a.url||a.html_url||a.raw&&a.raw.url)||"",f=E(String(b||"")),P=x?E(String(x)):"",N=E(String(F||"")),w=null;try{var S=Array.isArray(i)?i:i||[];if(Array.isArray(S)&&S.length>0&&(x||a)){let $=a&&a.repository&&(a.repository.nameWithOwner||a.repository.name)||a&&a.content&&a.content.repository&&a.content.repository.nameWithOwner||null,B=[];x&&B.push(String(x)),a&&(a.id||a.raw&&a.raw.id)&&B.push(String(a.id||a.raw&&a.raw.id)),a&&(a.url||a.raw&&a.raw.url)&&B.push(String(a.url||a.raw&&a.raw.url)),a&&(a.title||a.name)&&B.push(String(a.title||a.name));let j=S.find(H=>{let _=H&&(H.content||H.raw&&H.raw.itemContent)||null;if(!_)return!1;let z=[];if(_.number&&z.push(String(_.number)),_.id&&z.push(String(_.id)),_.url&&z.push(String(_.url)),_.title&&z.push(String(_.title)),_.name&&z.push(String(_.name)),_.raw&&_.raw.number&&z.push(String(_.raw.number)),_.raw&&_.raw.id&&z.push(String(_.raw.id)),_.raw&&_.raw.url&&z.push(String(_.raw.url)),$){let O=_.repository&&(_.repository.nameWithOwner||_.repository.name)||null;if(O&&String(O)!==String($))return!1}for(let O=0;O<B.length;O++)for(let R=0;R<z.length;R++)if(B[O]&&z[R]&&String(B[O])===String(z[R]))return!0;return!1});if(j&&Array.isArray(j.fieldValues)){let H=j.fieldValues.find(_=>_&&_.type==="single_select"&&(_.raw&&_.raw.field&&String(_.raw.field.name||"").toLowerCase()==="status"||_.fieldName&&String(_.fieldName||"").toLowerCase()==="status"||_.field&&_.field.name&&String(_.field.name||"").toLowerCase()==="status"));H&&(w=H.option&&(H.option.color||H.option.id||H.option.name)||H.raw&&H.raw.color||null)}}}catch{}w||(w=a&&(a.option&&(a.option.color||a.option.id||a.option.name)||a.color||a.colour)||null);let u=D(w)||null,y=!!(u&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(u)),L=u||"#999999",G=y&&U(u,.12)||"rgba(0,0,0,0.06)",k=K(u)||"#333333",A='<span style="display:block;width:100%;box-sizing:border-box"><div style="display:inline-flex;align-items:center;gap:8px;padding:4px 10px;border:1px solid '+E(L)+";border-radius:999px;color:"+E(k)+";background:"+E(G)+';font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;width:100%"><svg width="14" height="14" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:'+E(u||"#666")+'"><circle cx="8" cy="8" r="6" fill="currentColor" /></svg><span class="parent-issue-title" style="flex:1;min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:block">'+f+"</span>"+(P?'<span style="margin-left:6px;color:var(--vscode-descriptionForeground);white-space:nowrap">#'+P+"</span>":"")+"</div></span>",W='<span data-gh-open="'+(N||"")+'" class="parent-issue-wrapper" style="display:block;width:100%;cursor:'+(N?"pointer":"default")+'">';return N?W+A+"</span>":A}case"milestone":return"<div>"+E((m=(M=r.milestone)==null?void 0:M.title)!=null?m:"")+"</div>";case"sub_issues_progress":try{if(!r||r.total==null||Number(r.total)<=0)return"";let a=Math.max(0,Math.floor(Number(r.total)||0)),x=Math.max(0,Math.floor(Number(r.done||0)));if(a===0)return"";let b=null;return r.percent!==void 0&&r.percent!==null?b=Number(r.percent):b=Math.round(x/a*100),b==null||!isFinite(b)?"":(b=Math.max(0,Math.min(100,b)),'<div class="sub-issues-progress" style="display:flex;align-items:center;gap:8px;width:100%;"><div class="sub-issues-progress-bar" style="flex:1;min-width:0"><div style="width:100%;height:12px;border-radius:6px;border:1px solid var(--vscode-focusBorder);overflow:hidden;background:transparent;box-sizing:border-box"><div style="height:100%;width:'+String(b)+'%;background:var(--vscode-focusBorder)"></div></div></div><div class="sub-issues-progress-pct" style="min-width:44px;text-align:right;font-variant-numeric:tabular-nums;color:var(--vscode-descriptionForeground)">'+E(String(b)+"%")+"</div></div>")}catch{return""}case"missing":return"";default:return"<div>"+E(r&&r.raw&&r.raw.__typename?String(r.raw.__typename):JSON.stringify(r).slice(0,200))+"</div>"}}catch{return""}}var J=class{constructor(t,e){this.menuElement=null;this.backdropElement=null;this.field=t,this.options=e}show(t){this.hide(),this.backdropElement=document.createElement("div"),this.backdropElement.style.position="fixed",this.backdropElement.style.top="0",this.backdropElement.style.left="0",this.backdropElement.style.right="0",this.backdropElement.style.bottom="0",this.backdropElement.style.zIndex="999",this.backdropElement.addEventListener("click",()=>this.hide()),document.body.appendChild(this.backdropElement),this.menuElement=document.createElement("div"),this.menuElement.className="column-header-menu",this.menuElement.style.position="absolute",this.menuElement.style.background="var(--vscode-menu-background)",this.menuElement.style.border="1px solid var(--vscode-menu-border)",this.menuElement.style.borderRadius="4px",this.menuElement.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)",this.menuElement.style.minWidth="180px",this.menuElement.style.padding="4px 0",this.menuElement.style.zIndex="1000",this.menuElement.style.fontSize="13px";let e=t.getBoundingClientRect();this.menuElement.style.top=`${e.bottom+4}px`,this.menuElement.style.left=`${e.left}px`,this.buildMenuItems(),document.body.appendChild(this.menuElement)}hide(){this.menuElement&&(this.menuElement.remove(),this.menuElement=null),this.backdropElement&&(this.backdropElement.remove(),this.backdropElement=null)}buildMenuItems(){this.menuElement&&(this.addMenuItem("Select column",null,{isHeader:!0}),this.addSeparator(),this.addMenuItem("Sort ascending \u2191",()=>{this.options.onSort?.("ASC"),this.hide()},{icon:"\u2191",showClear:this.options.currentSort==="ASC",clearAction:this.options.onClearSort}),this.addMenuItem("Sort descending \u2193",()=>{this.options.onSort?.("DESC"),this.hide()},{icon:"\u2193",showClear:this.options.currentSort==="DESC",clearAction:this.options.onClearSort}),this.addSeparator(),this.options.canGroup&&this.addMenuItem("Group by values",()=>{this.options.onGroup?.(),this.hide()},{showClear:!!this.options.isGrouped,clearAction:this.options.onClearGroup}),this.options.canSlice&&this.addMenuItem("Slice by values",()=>{this.options.onSlice?.(),this.hide()},{showClear:!!this.options.isSliced,clearAction:this.options.onClearSlice}),this.options.canFilter&&this.addMenuItem("Filter by values...",()=>{this.options.onFilter?.(),this.hide()}),(this.options.canGroup||this.options.canSlice||this.options.canFilter)&&this.addSeparator(),this.addMenuItem("Hide field",()=>{this.options.onHide?.(),this.hide()}),this.addSeparator(),this.addMenuItem("Move left \u2190",()=>{this.options.onMove?.("left"),this.hide()},{icon:"\u2190"}),this.addMenuItem("Move right \u2192",()=>{this.options.onMove?.("right"),this.hide()},{icon:"\u2192"}))}addMenuItem(t,e,i){if(!this.menuElement)return;let n=document.createElement("div");if(n.className="menu-item",i?.isHeader){n.textContent=t,n.style.padding="6px 12px",n.style.fontWeight="600",n.style.color="var(--vscode-descriptionForeground)",n.style.fontSize="11px",n.style.textTransform="uppercase",n.style.cursor="default",this.menuElement.appendChild(n);return}n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="space-between",n.style.padding="6px 12px",n.style.cursor="pointer",n.style.color="var(--vscode-menu-foreground)";let s=document.createElement("span");if(s.textContent=t,s.style.flex="1",s.style.whiteSpace="nowrap",s.style.overflow="hidden",s.style.textOverflow="ellipsis",n.appendChild(s),i?.showClear&&i?.clearAction){let o=document.createElement("button");o.type="button",o.textContent="\u2715",o.title="Clear",o.style.border="none",o.style.background="transparent",o.style.cursor="pointer",o.style.padding="2px 6px",o.style.marginLeft="8px",o.style.color="var(--vscode-menu-foreground)",o.addEventListener("mouseenter",()=>{o.style.color="var(--vscode-menu-selectionForeground)",o.style.background="var(--vscode-menu-selectionBackground)"}),o.addEventListener("mouseleave",()=>{o.style.color="var(--vscode-menu-foreground)",o.style.background="transparent"}),o.addEventListener("click",d=>{d.stopPropagation(),i.clearAction&&i.clearAction(),this.hide()}),n.appendChild(o)}e&&(n.addEventListener("mouseenter",()=>{n.style.background="var(--vscode-menu-selectionBackground)",n.style.color="var(--vscode-menu-selectionForeground)"}),n.addEventListener("mouseleave",()=>{n.style.background="transparent",n.style.color="var(--vscode-menu-foreground)"}),n.addEventListener("click",e)),this.menuElement.appendChild(n)}addSeparator(){if(!this.menuElement)return;let t=document.createElement("div");t.style.height="1px",t.style.background="var(--vscode-menu-separatorBackground)",t.style.margin="4px 0",this.menuElement.appendChild(t)}};var Q=class{constructor(t){this.menuElement=null;this.backdropElement=null;this.options=t}show(t){this.hide(),this.backdropElement=document.createElement("div"),this.backdropElement.style.position="fixed",this.backdropElement.style.top="0",this.backdropElement.style.left="0",this.backdropElement.style.right="0",this.backdropElement.style.bottom="0",this.backdropElement.style.zIndex="998",this.backdropElement.addEventListener("click",()=>this.hide()),document.body.appendChild(this.backdropElement),this.menuElement=document.createElement("div"),this.menuElement.className="fields-menu",this.menuElement.style.position="absolute",this.menuElement.style.visibility="hidden",this.menuElement.style.left="0px",this.menuElement.style.top="0px",this.menuElement.style.background="var(--vscode-menu-background)",this.menuElement.style.border="1px solid var(--vscode-menu-border)",this.menuElement.style.borderRadius="4px",this.menuElement.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)",this.menuElement.style.minWidth="220px",this.menuElement.style.padding="6px 0",this.menuElement.style.zIndex="1000",this.menuElement.style.fontSize="13px",document.body.appendChild(this.menuElement),this.buildMenu();let e=t.getBoundingClientRect(),i=this.menuElement.getBoundingClientRect(),n=8,s=window.innerWidth||document.documentElement.clientWidth,o=window.innerHeight||document.documentElement.clientHeight,d=e.bottom+n;e.bottom+i.height+n>o&&(e.top-i.height-n>=0?d=e.top-i.height-n:d=Math.max(n,Math.min(o-i.height-n,e.bottom+n)));let l=e.left;e.left+i.width+n>s&&(l=Math.max(n,e.right-i.width)),l=Math.max(n,Math.min(l,s-i.width-n)),this.menuElement.style.top=`${Math.round(d)}px`,this.menuElement.style.left=`${Math.round(l)}px`,this.menuElement.style.visibility="visible"}hide(){this.menuElement&&(this.menuElement.remove(),this.menuElement=null),this.backdropElement&&(this.backdropElement.remove(),this.backdropElement=null)}buildMenu(){if(!this.menuElement)return;let t=document.createElement("div");t.style.display="flex",t.style.alignItems="center",t.style.padding="6px 12px",t.style.fontWeight="600",t.style.color="var(--vscode-descriptionForeground)",t.style.fontSize="12px",t.style.textTransform="uppercase";let e=document.createElement("i");e.className="octicon octicon-note",e.style.marginRight="8px",t.appendChild(e);let i=document.createElement("span");i.textContent="Fields",t.appendChild(i),this.menuElement.appendChild(t),this.addSeparator();let n=document.createElement("div");n.style.display="flex",n.style.alignItems="center",n.style.padding="6px 12px",n.style.cursor="pointer",n.style.color="var(--vscode-menu-foreground)",n.innerHTML='<span style="margin-right:8px;font-weight:700">+</span><span>New field</span>',n.addEventListener("mouseenter",()=>{n.style.background="var(--vscode-menu-selectionBackground)",n.style.color="var(--vscode-menu-selectionForeground)"}),n.addEventListener("mouseleave",()=>{n.style.background="transparent",n.style.color="var(--vscode-menu-foreground)"}),n.addEventListener("click",()=>{this.options.onCreateField?.(),this.hide()}),this.menuElement.appendChild(n),this.addSeparator();let s=this.options.fields.filter(d=>this.options.visibleFieldIds.has(d.id)),o=this.options.fields.filter(d=>!this.options.visibleFieldIds.has(d.id));this.addSectionHeader("Visible fields"),s.length===0?this.addEmptyRow("No visible fields"):s.forEach(d=>this.addFieldRow(d,!0)),this.addSeparator(),this.addSectionHeader("Hidden fields"),o.length===0?this.addEmptyRow("No hidden fields"):o.forEach(d=>this.addFieldRow(d,!1))}addSectionHeader(t){if(!this.menuElement)return;let e=document.createElement("div");e.textContent=t,e.style.padding="6px 12px",e.style.fontSize="11px",e.style.fontWeight="600",e.style.color="var(--vscode-descriptionForeground)",e.style.textTransform="uppercase",this.menuElement.appendChild(e)}addEmptyRow(t){if(!this.menuElement)return;let e=document.createElement("div");e.textContent=t,e.style.padding="6px 12px",e.style.color="var(--vscode-menu-foreground)",e.style.opacity="0.8",this.menuElement.appendChild(e)}addFieldRow(t,e){if(!this.menuElement)return;let i=document.createElement("div");if(i.style.display="flex",i.style.alignItems="center",i.style.padding="6px 12px",i.style.cursor="pointer",i.style.color="var(--vscode-menu-foreground)",e){let o=document.createElement("span");o.textContent="\u2713",o.style.marginRight="8px",o.style.color="var(--vscode-menu-selectionForeground)",i.appendChild(o)}else{let o=document.createElement("span");o.style.display="inline-block",o.style.width="14px",o.style.marginRight="8px",i.appendChild(o)}let n=document.createElement("i");n.className=t.iconClass||"octicon octicon-tag",n.style.marginRight="8px",i.appendChild(n);let s=document.createElement("span");s.textContent=t.name,s.style.flex="1",s.style.whiteSpace="nowrap",s.style.overflow="hidden",s.style.textOverflow="ellipsis",i.appendChild(s),i.addEventListener("mouseenter",()=>{i.style.background="var(--vscode-menu-selectionBackground)",i.style.color="var(--vscode-menu-selectionForeground)"}),i.addEventListener("mouseleave",()=>{i.style.background="transparent",i.style.color="var(--vscode-menu-foreground)"}),i.addEventListener("click",()=>{let o=!e;this.options.onToggleVisibility?.(t.id,o),o?this.options.visibleFieldIds.add(t.id):this.options.visibleFieldIds.delete(t.id),this.menuElement&&(this.menuElement.innerHTML="",this.buildMenu())}),this.menuElement.appendChild(i)}addSeparator(){if(!this.menuElement)return;let t=document.createElement("div");t.style.height="1px",t.style.background="var(--vscode-menu-separatorBackground)",t.style.margin="6px 0",this.menuElement.appendChild(t)}},ee=Q;var X=class{constructor(t,e,i,n){this.panelElement=null;this.container=t,this.field=e,this.items=i,this.allFields=n||[]}render(){this.close(),this.panelElement=document.createElement("div"),this.panelElement.className="slice-panel",this.panelElement.style.position="relative",this.panelElement.style.float="left";try{let v=localStorage.getItem("ghProjects.slicePanel.width");v?this.panelElement.style.width=v:this.panelElement.style.width="280px"}catch{this.panelElement.style.width="280px"}this.panelElement.style.marginRight="12px",this.panelElement.style.background="var(--vscode-sideBar-background)",this.panelElement.style.border="1px solid var(--vscode-sideBar-border)",this.panelElement.style.borderRadius="6px",this.panelElement.style.display="flex",this.panelElement.style.flexDirection="column",this.panelElement.style.overflow="hidden",this.panelElement.style.maxHeight="600px";let t=document.createElement("pre");t.className="slice-panel-debug-overlay",t.style.position="absolute",t.style.left="8px",t.style.bottom="8px",t.style.right="8px",t.style.maxHeight="120px",t.style.overflow="auto",t.style.background="rgba(0,0,0,0.6)",t.style.color="white",t.style.fontSize="11px",t.style.padding="8px",t.style.borderRadius="6px",t.style.zIndex="200",t.style.display="none",t.title="SlicePanel debug (click to show/hide)",t.addEventListener("click",()=>{t.style.display=t.style.display==="none"?"block":"none"}),this.panelElement.appendChild(t);let e=document.createElement("div");e.className="slice-panel-resizer",e.style.position="absolute",e.style.top="0",e.style.right="0",e.style.bottom="0",e.style.width="6px",e.style.cursor="col-resize",e.style.zIndex="100",this.panelElement.appendChild(e);let i=null,n=null,s=v=>{if(i==null||n==null)return;let C=v.pageX-i,I=Math.max(160,n+C);this.panelElement.style.width=I+"px"},o=()=>{if(i!=null){document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",o);try{localStorage.setItem("ghProjects.slicePanel.width",this.panelElement.style.width)}catch{}i=null,n=null}};e.addEventListener("mousedown",v=>{v.preventDefault(),i=v.pageX,n=this.panelElement?this.panelElement.offsetWidth:280,document.addEventListener("mousemove",s),document.addEventListener("mouseup",o)});let d=document.createElement("div");d.style.padding="12px",d.style.borderBottom="1px solid var(--vscode-sideBar-border)",d.style.display="flex",d.style.flexDirection="column",d.style.gap="8px";let l=document.createElement("div");l.style.display="flex",l.style.alignItems="center",l.style.gap="8px";let c=document.createElement("span");c.textContent="Slice by",c.style.fontSize="11px",c.style.fontWeight="600",c.style.color="var(--vscode-descriptionForeground)",c.style.textTransform="uppercase",c.style.letterSpacing="0.5px",l.appendChild(c);let p=document.createElement("button");p.textContent=this.field.name,p.style.flex="1",p.style.padding="6px 12px",p.style.background="var(--vscode-button-secondaryBackground)",p.style.color="var(--vscode-button-secondaryForeground)",p.style.border="1px solid var(--vscode-button-border)",p.style.borderRadius="4px",p.style.cursor="pointer",p.style.fontSize="13px",p.style.fontWeight="500",p.style.textAlign="left",p.style.display="flex",p.style.justifyContent="space-between",p.style.alignItems="center";let h=document.createElement("span");h.textContent="\u25BC",h.style.fontSize="10px",h.style.marginLeft="auto",p.appendChild(h),p.addEventListener("click",v=>{v.stopPropagation(),this.showFieldDropdown(p)}),l.appendChild(p),d.appendChild(l),this.panelElement.appendChild(d);let g=document.createElement("div");g.style.flex="1",g.style.overflow="auto",g.style.padding="8px",this.renderValues(g),this.panelElement.appendChild(g),this.container.appendChild(this.panelElement)}showFieldDropdown(t){let e=new Set(["assignees","single_select","parent_issue","iteration","number","date","milestone","repository","labels"]),i=this.allFields.filter(o=>{let d=(o.dataType||"").toLowerCase();return e.has(d)});if(i.length===0)return;let n=document.createElement("div");n.style.position="absolute",n.style.top=`${t.getBoundingClientRect().bottom+4}px`,n.style.left=`${t.getBoundingClientRect().left}px`,n.style.minWidth=`${t.offsetWidth}px`,n.style.background="var(--vscode-dropdown-background)",n.style.border="1px solid var(--vscode-dropdown-border)",n.style.borderRadius="4px",n.style.boxShadow="0 4px 8px rgba(0,0,0,0.2)",n.style.zIndex="1000",n.style.maxHeight="300px",n.style.overflowY="auto",i.forEach(o=>{let d=document.createElement("div");d.textContent=o.name,d.style.padding="8px 12px",d.style.cursor="pointer",d.style.fontSize="13px",d.style.color="var(--vscode-dropdown-foreground)",o.id===this.field.id&&(d.style.background="var(--vscode-list-activeSelectionBackground)",d.style.color="var(--vscode-list-activeSelectionForeground)"),d.addEventListener("mouseenter",()=>{o.id!==this.field.id&&(d.style.background="var(--vscode-list-hoverBackground)")}),d.addEventListener("mouseleave",()=>{o.id!==this.field.id&&(d.style.background="transparent")}),d.addEventListener("click",()=>{this.field=o,n.remove(),s.remove(),this.render(),this.onFieldChangeCallback&&this.onFieldChangeCallback(o)}),n.appendChild(d)});let s=document.createElement("div");s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.right="0",s.style.bottom="0",s.style.zIndex="999",s.addEventListener("click",()=>{n.remove(),s.remove()}),document.body.appendChild(s),document.body.appendChild(n)}renderValues(t){let e=this.getValueCounts();if(e.size===0){let s=document.createElement("div");s.textContent="No values",s.style.padding="8px",s.style.color="var(--vscode-descriptionForeground)",t.appendChild(s);return}let i=Array.from(e.entries()).sort((s,o)=>o[1].count-s[1].count),n=s=>{let o={resolved:null,statusColor:null,number:null,title:null,done:0,total:0,pct:0};if(!s)return o;let d=[];s.number&&d.push(String(s.number)),s.id&&d.push(String(s.id)),s.url&&d.push(String(s.url)),s.title&&d.push(String(s.title));let l=this.items.find(p=>{let h=p&&(p.content||p.raw&&p.raw.itemContent)||null;if(!h)return!1;let g=[];h.number&&g.push(String(h.number)),h.id&&g.push(String(h.id)),h.url&&g.push(String(h.url)),h.title&&g.push(String(h.title)),h.name&&g.push(String(h.name)),h.raw&&h.raw.number&&g.push(String(h.raw.number)),h.raw&&h.raw.id&&g.push(String(h.raw.id)),h.raw&&h.raw.url&&g.push(String(h.raw.url));for(let v of d)for(let C of g)if(v&&C&&String(v)===String(C))return!0;return!1});if(!l)return o;o.resolved=l;let c=l.content||l.raw&&l.raw.itemContent||null;if(o.title=c&&(c.title||c.name)?c.title||c.name:l.title||l.name||null,o.number=c&&c.number?String(c.number):l.number||l.id||null,Array.isArray(l.fieldValues)){let p=l.fieldValues.find(g=>g&&g.type==="single_select"&&g.option&&g.option.name);if(p&&p.option)try{let g=p.option.color||p.option.id||p.option.name||null;o.statusColor=D(g)||null}catch{}let h=l.fieldValues.find(g=>g&&(g.type==="sub_issues_progress"||g.total!=null&&g.done!=null));h&&h.total!=null&&(o.total=Number(h.total||0),o.done=Number(h.done||0),o.pct=o.total>0?Math.round(o.done/o.total*100):0)}return o};i.forEach(([s,{value:o,count:d,rawValue:l}])=>{let c=document.createElement("div");c.className="slice-value-item",c.style.padding="10px 12px",c.style.cursor="pointer",c.style.borderRadius="4px",c.style.marginBottom="4px",c.style.display="flex",c.style.alignItems="center",c.style.gap="8px",c.style.transition="background-color 0.15s ease";let p=(this.field.dataType||"").toLowerCase(),h=null;p==="parent_issue"&&l&&(h=l.parent||l.parentIssue||l.issue||l.item||l.value||l);let g=document.createElement("div");g.style.display="flex",g.style.alignItems="center",g.style.gap="8px",g.style.flex="0 0 auto";let v=m=>{let S=document.createElement("span");return S.style.display="inline-block",S.style.width="12px",S.style.height="12px",S.style.borderRadius="50%",S.style.flexShrink="0",S.style.backgroundColor=m||"var(--vscode-descriptionForeground)",S},C=!1;if(p==="assignees"&&l){let m=l,S=m&&(m.avatarUrl||m.avatar||m.imageUrl||m.avatar_url);if(S){let a=document.createElement("span");a.innerHTML='<span title="'+E(m.login||m.name||m.id||"")+'" style="display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url('+E(S)+');border:2px solid var(--vscode-editor-background)"></span>',g.appendChild(a),C=!0}else g.appendChild(v(null)),C=!0}if(!C&&p==="repository"){let m=document.createElement("span");m.innerHTML='<svg width="14" height="14" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:var(--vscode-icon-foreground)"><path fill="currentColor" d="M2 2.5A1.5 1.5 0 0 1 3.5 1h9A1.5 1.5 0 0 1 14 2.5v11A1.5 1.5 0 0 1 12.5 15h-9A1.5 1.5 0 0 1 2 13.5v-11zM3.5 2A.5.5 0 0 0 3 2.5V4h10V2.5a.5.5 0 0 0-.5-.5h-9z"/></svg>',g.appendChild(m),C=!0}if(!C&&p==="parent_issue"){let m=h?n(h):null,S=m&&m.statusColor?m.statusColor:null;if(!S&&h&&(S=D(h.color||h.option&&h.option.color||h.statusColor||h.status?.color)||null),h&&(h.title||h.name||h.number||m&&(m.title||m.number))){let a=v(S);g.appendChild(a),C=!0}}if(!C&&p==="labels"&&l){let m=l,S=m&&(m.color||m.colorName||m.hex||m.name),a=D(S);g.appendChild(v(a)),C=!0}if(!C){let m=null;if(p==="single_select"&&l&&l.option&&(m=l.option.color||l.option.name||l.option.id),!m&&l&&(l.color||l.colorName)&&(m=l.color||l.colorName),!m&&Array.isArray(this.field.options))try{let a=(this.field.options||[]).find(x=>String(x.name)===String(s)||String(x.id)===String(l&&(l.optionId||l.option&&l.option.id)));a&&(m=a.color||a.name||a.id)}catch{}if(!m&&this.field&&this.field.configuration&&Array.isArray(this.field.configuration.iterations))try{let a=(this.field.configuration.iterations||[]).find(x=>String(x.title)===String(s)||String(x.id)===String(l&&(l.iterationId||l.iteration&&l.iteration.id)));a&&(m=a.color||a.name||a.title||a.id)}catch{}let S=D(m);g.appendChild(v(S))}c.appendChild(g);let I=document.createElement("div");I.style.flex="1",I.style.display="flex",I.style.flexDirection="column",I.style.minWidth="0";let T=null;if(p!=="parent_issue"&&(T=document.createElement("span"),T.textContent=s,T.style.fontSize="13px",T.style.fontWeight="500",T.style.whiteSpace="normal",T.style.wordBreak="break-word",T.style.overflow="hidden",I.appendChild(T)),p==="single_select"){let m=null;try{if(l&&l.option&&l.option.description)m=l.option.description;else if(Array.isArray(this.field.options)){let S=(this.field.options||[]).find(a=>String(a.name)===String(s)||String(a.id)===String(l&&(l.optionId||l.option&&l.option.id)));S&&S.description&&(m=S.description)}}catch{}if(m){let S=document.createElement("span");S.textContent=m,S.style.fontSize="11px",S.style.color="var(--vscode-descriptionForeground)",S.style.whiteSpace="normal",S.style.wordBreak="break-word",S.style.overflow="hidden",S.style.maxHeight="3.6em",I.appendChild(S)}}if(p==="parent_issue"&&l){let m=h||l.parent||l.parentIssue||l.issue||l.item||l.value||null,S=n(m),a=S.title||m&&(m.title||m.name)||s,x=document.createElement("div");x.style.display="flex",x.style.gap="8px",x.style.alignItems="baseline";let b=document.createElement("span"),F=String(a).slice(0,120);if(b.textContent=S.number?`${F} #${String(S.number)}`:F,b.style.fontSize="13px",b.style.fontWeight="600",b.style.whiteSpace="normal",b.style.wordBreak="break-word",x.appendChild(b),I.appendChild(x),S.total&&S.total>0){let f=document.createElement("div");f.style.display="flex",f.style.alignItems="center",f.style.gap="8px",f.style.marginTop="6px";let P=document.createElement("div");P.textContent=`${S.done}/${S.total}`,P.style.color="var(--vscode-descriptionForeground)",P.style.fontSize="12px",P.style.fontVariantNumeric="tabular-nums",f.appendChild(P);let N=document.createElement("div");N.style.display="inline-block",N.style.width="120px",N.style.height="10px",N.style.background="transparent",N.style.border="1px solid var(--vscode-focusBorder)",N.style.borderRadius="6px",N.style.overflow="hidden";let w=document.createElement("div");w.style.height="100%",w.style.width=String(S.pct)+"%",w.style.background="var(--vscode-focusBorder)",N.appendChild(w),f.appendChild(N),I.appendChild(f)}}if(p==="iteration")try{let m=l&&(l.iteration||l.configuration||l)||null,S=null;if(m&&m.startDate&&(m.duration||m.length))S=m;else if(this.field&&this.field.configuration&&Array.isArray(this.field.configuration.iterations)){let a=(this.field.configuration.iterations||[]).find(x=>String(x.title||x.name)===String(s)||String(x.id)===String(l&&(l.iterationId||l.iteration&&l.iteration.id)));a&&(S=a)}if(S){let a=S.startDate||S.start,x=S.duration||S.length||S.days;if(a&&x){let b=new Date(a),F=new Date(b.getTime()+Number(x||0)*24*60*60*1e3),f=b.toLocaleDateString("en-US",{month:"short",day:"numeric"}),P=F.toLocaleDateString("en-US",{month:"short",day:"numeric"}),N=document.createElement("div");N.textContent=`${f} \u2014 ${P}`,N.style.fontSize="11px",N.style.color="var(--vscode-descriptionForeground)",N.style.marginTop="4px",I.appendChild(N)}}}catch{}c.appendChild(I);let M=document.createElement("span");M.style.display="inline-flex",M.style.alignItems="center",M.style.justifyContent="center",M.style.minWidth="24px",M.style.height="24px",M.style.borderRadius="50%",M.style.background="var(--vscode-input-background)",M.style.border="1px solid var(--vscode-panel-border)",M.style.color="var(--vscode-foreground)",M.style.fontSize="12px",M.style.fontWeight="600",M.style.padding="0 6px",M.style.boxSizing="border-box",M.textContent=String(d),c.appendChild(M),c.addEventListener("mouseenter",()=>{c.style.background="var(--vscode-list-hoverBackground)"}),c.addEventListener("mouseleave",()=>{c.style.background="transparent"}),c.addEventListener("click",()=>{this.onValueSelectCallback&&this.onValueSelectCallback(o)}),t.appendChild(c)})}getValueCounts(){let t=new Map,e=(this.field.dataType||"").toLowerCase();return this.items.forEach(i=>{let n=i.fieldValues?.find(c=>c.fieldId===this.field.id||c.fieldName===this.field.name);if(!n){let c="(empty)",p=t.get(c);p?p.count++:t.set(c,{value:null,count:1,rawValue:null});return}if(e==="labels"){let c=n.labels&&Array.isArray(n.labels.nodes)?n.labels.nodes:Array.isArray(n.labels)?n.labels:null;if(Array.isArray(c)&&c.length>0){c.forEach(p=>{let h=p&&(p.name||p.title)?String(p.name||p.title):"(empty)",g=this.formatValue(h),v=t.get(g);v?v.count++:t.set(g,{value:h,count:1,rawValue:p})});return}}if(e==="assignees"){let c=n.assignees||(n.assignee?[n.assignee]:null);if(Array.isArray(c)&&c.length>0){c.forEach(p=>{let h=String(p.login||p.name||p.id||"(unknown)"),g=this.formatValue(h),v=t.get(g);v?v.count++:t.set(g,{value:p,count:1,rawValue:p})});return}}let s=null,o=null;try{if(e==="single_select")s=n.option?.name||n.name||n.value,o=n;else if(e==="iteration")s=n.iteration?.title||n.title||n.value,o=n;else if(e==="parent_issue"){let c=n.parent||n.parentIssue||n.issue||n.item||n.value||null;c&&(s=c.title||c.name||c.number||c.id||c.url||null),o=c||n}else e==="milestone"?(s=n.milestone?.title||n.milestone?.name||n.value||null,o=n.milestone||n):e==="repository"?(s=n.repository?.nameWithOwner||n.repository?.full_name||n.repository?.name||n.value||null,o=n.repository||n):e==="number"?(s=n.number!=null?n.number:n.value,o=n):e==="date"?(s=n.date||n.value||null,o=n):(s=n.text||n.title||n.value||null,o=n)}catch{s=n.text||n.title||n.value||null,o=n}let d=s==null||s===""?"(empty)":this.formatValue(s),l=t.get(d);l?l.count++:t.set(d,{value:s,count:1,rawValue:o})}),t}extractValue(t){let e=(this.field.dataType||"").toLowerCase();return t?e==="single_select"?t.option?.name||t.name||t.value:e==="iteration"?t.iteration?.title||t.title||t.value:e==="assignees"?t.assignees||t.assignee||null:e==="labels"?t.labels||null:e==="parent_issue"?t.parent||t.parentIssue||t.issue||t.item||t.value||null:e==="milestone"?t.milestone||t.value||null:e==="repository"?t.repository||t.value||null:e==="number"?t.number!=null?t.number:t.value:e==="date"?t.date||t.value||null:t.text||t.title||t.value||null:null}formatValue(t){return t==null?"(empty)":String(t)}onValueSelect(t){this.onValueSelectCallback=t}onFieldChange(t){this.onFieldChangeCallback=t}close(){this.panelElement&&(this.panelElement.remove(),this.panelElement=null)}};function ie(r){if(!r||!r.nodes||r.nodes.length===0)return null;let t=r.nodes[0];if(!t||!t.field)return null;let e={fieldId:t.field.id||t.field.name,direction:t.direction||"ASC"};if(r.nodes.length>1){let i=r.nodes[1];i&&i.field&&(e.secondary={fieldId:i.field.id||i.field.name,direction:i.direction||"ASC"})}return e}function V(r,t,e){if(!e||r.length===0)return r;let i=t.find(s=>s.id===e.fieldId||s.name===e.fieldId);if(!i)return r;let n=[...r];return n.sort((s,o)=>{let d=te(s,o,i,e.direction);if(d===0&&e.secondary){let l=t.find(c=>c.id===e.secondary.fieldId||c.name===e.secondary.fieldId);if(l)return te(s,o,l,e.secondary.direction)}return d}),n}function te(r,t,e,i){let n=ne(r,e),s=ne(t,e);if(n===null&&s===null)return 0;if(n===null)return i==="ASC"?1:-1;if(s===null)return i==="ASC"?-1:1;let o=0;switch((e.dataType||"").toLowerCase()){case"text":case"title":o=q(n,s);break;case"number":o=de(n,s);break;case"date":o=se(n,s);break;case"single_select":o=ce(n,s,e);break;case"iteration":o=pe(n,s);break;case"labels":o=ue(n,s);break;default:o=String(n).localeCompare(String(s))}return i==="ASC"?o:-o}function ne(r,t){let e=r.fieldValues?.find(n=>n.fieldId===t.id||n.fieldName===t.name);if(!e)return null;switch((t.dataType||"").toLowerCase()){case"text":case"title":return e.text||e.title||null;case"number":return e.number!==void 0?e.number:null;case"date":return e.date||e.startDate||e.dueOn||null;case"single_select":return e.option||e;case"iteration":return e;case"labels":return e.labels||[];default:return e}}function q(r,t){let e=String(r||"").toLowerCase(),i=String(t||"").toLowerCase();return e.localeCompare(i)}function de(r,t){let e=typeof r=="number"?r:parseFloat(r),i=typeof t=="number"?t:parseFloat(t);return isNaN(e)&&isNaN(i)?0:isNaN(e)?1:isNaN(i)?-1:e-i}function se(r,t){let e=new Date(r),i=new Date(t);return isNaN(e.getTime())&&isNaN(i.getTime())?0:isNaN(e.getTime())?1:isNaN(i.getTime())?-1:e.getTime()-i.getTime()}function ce(r,t,e){let i=r.option||r,n=t.option||t;if(!i||!n)return q(i?.name||"",n?.name||"");if(e.options&&Array.isArray(e.options)){let s=e.options.findIndex(d=>d.id===i.id||d.name===i.name),o=e.options.findIndex(d=>d.id===n.id||d.name===n.name);if(s!==-1&&o!==-1)return s-o}return q(i.name,n.name)}function pe(r,t){let e=r.startDate||r.iteration?.startDate,i=t.startDate||t.iteration?.startDate;return!e&&!i?q(r.title||r.iteration?.title,t.title||t.iteration?.title):se(e,i)}function ue(r,t){let e=Array.isArray(r)?r:[],i=Array.isArray(t)?t:[];return e.length===0&&i.length===0?0:e.length===0?1:i.length===0?-1:q(e[0].name,i[0].name)}var Y=class{constructor(t,e,i,n={}){this.activeMenu=null;this.activeFieldsMenu=null;this.activeSlicePanel=null;this.activeSlice=null;this.activeSlicePanelFieldId=null;this.container=t,this.allFields=(e||[]).map(d=>({...d,id:String(d.id)})),this.options=n,this.items=i;let s=this.loadHiddenFields().map(d=>String(d)),o=(n.hiddenFields||[]).map(d=>String(d));this.hiddenFieldIds=new Set([...s,...o]),this.fields=this.allFields.filter(d=>!this.hiddenFieldIds.has(d.id));try{console.debug("[ProjectTable] init: allFieldIds=",this.allFields.map(d=>d.id)),console.debug("[ProjectTable] init: hiddenFieldIds=",Array.from(this.hiddenFieldIds)),console.debug("[ProjectTable] init: visibleFieldIds=",this.fields.map(d=>d.id))}catch{}try{let d={allFieldIds:this.allFields.map(l=>String(l.id)),hiddenFieldIds:Array.from(this.hiddenFieldIds),visibleFieldIds:this.fields.map(l=>String(l.id))};window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"debugLog",level:"debug",message:"ProjectTable init",data:d,viewKey:this.options.viewKey})}catch{}this.applyFieldOrder()}render(){let t=this.container.querySelector(".slice-panel");this.container.innerHTML="",t&&this.container.appendChild(t);let e=document.createElement("div");e.className="table-wrapper",e.style.overflowX="auto",e.style.overflowY="auto",e.style.width="100%",e.style.display="block",e.style.height="100%";let i=document.createElement("table");i.style.borderCollapse="separate",i.style.borderSpacing="0",i.style.tableLayout="fixed",i.style.width="100%",this.renderColGroup(i),this.renderHeader(i),this.renderBody(i),e.appendChild(i),this.container.appendChild(e),this.setupResizers(i)}renderColGroup(t){let e=document.createElement("colgroup"),i=document.createElement("col");i.style.width="40px",e.appendChild(i);for(let s of this.fields){let o=document.createElement("col");o.style.width="150px",o.dataset.fieldId=s.id,e.appendChild(o)}let n=document.createElement("col");n.style.width="50px",e.appendChild(n),t.appendChild(e)}renderHeader(t){let e=document.createElement("thead");e.style.background="var(--vscode-sideBar-background)",e.style.position="sticky",e.style.top="0",e.style.zIndex="10";let i=document.createElement("tr"),n=document.createElement("th");n.textContent="#",this.styleHeaderCell(n),i.appendChild(n);for(let d of this.fields){let l=document.createElement("th"),c=document.createElement("div");c.style.display="flex",c.style.alignItems="center",c.style.justifyContent="space-between",c.style.width="100%",c.style.gap="4px";let p=document.createElement("span"),h=d.name||d.id||"";if(this.options.sortConfig?.fieldId===d.id){let T=this.options.sortConfig?.direction==="ASC"?" \u2191":" \u2193";h+=T}p.textContent=h,p.style.flex="1",p.style.overflow="hidden",p.style.textOverflow="ellipsis",p.style.whiteSpace="nowrap";let g=d.name?.toLowerCase()===this.options.groupingFieldName?.toLowerCase(),v=this.activeSlice&&this.activeSlice.fieldId===d.id||this.activeSlicePanelFieldId&&String(this.activeSlicePanelFieldId)===String(d.id),C=document.createElement("span");if(C.style.display="flex",C.style.alignItems="center",C.style.gap="2px",g||v){let T=document.createElement("span");T.innerHTML='<svg aria-hidden="true" height="12" viewBox="0 0 16 16" version="1.1" width="12" data-view-component="true" class="octicon octicon-filter"><path fill="currentColor" d="M.75 3h14.5a.75.75 0 0 1 .75.75v2a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1-.75-.75v-2a.75.75 0 0 1 .75-.75zm0 1.5v.5h14.5v-.5H.75zM5 9.75A.75.75 0 0 1 5.75 9h4.5a.75.75 0 0 1 .75.75v2a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-2zm1.5.5v.5h3v-.5h-3z"></path></svg>',T.style.display="flex",T.style.alignItems="center",T.style.color="var(--vscode-foreground)",T.style.opacity="0.7",T.title=g?"Grouped by this field":"Sliced by this field";let M=T.querySelector("svg");M&&(M.style.fill="currentColor"),C.appendChild(T)}let I=document.createElement("button");I.textContent="\u22EE",I.style.background="transparent",I.style.border="none",I.style.cursor="pointer",I.style.fontSize="16px",I.style.padding="2px 4px",I.style.color="var(--vscode-foreground)",I.style.opacity="0.6",I.style.borderRadius="3px",I.title=`${d.name} options`,I.addEventListener("mouseenter",()=>{I.style.opacity="1",I.style.background="var(--vscode-toolbar-hoverBackground)"}),I.addEventListener("mouseleave",()=>{I.style.opacity="0.6",I.style.background="transparent"}),I.addEventListener("click",T=>{T.stopPropagation(),l.style.background="var(--vscode-sideBar-background)",this.showHeaderMenu(T,d,l)}),c.appendChild(p),(g||v)&&c.appendChild(C),c.appendChild(I),l.appendChild(c),l.addEventListener("pointerenter",()=>{l.style.background="var(--vscode-list-hoverBackground)"}),l.addEventListener("pointerleave",()=>{l.style.background="var(--vscode-sideBar-background)"}),this.styleHeaderCell(l),i.appendChild(l)}let s=document.createElement("th"),o=document.createElement("button");o.textContent="+",o.style.background="transparent",o.style.border="none",o.style.cursor="pointer",o.style.fontSize="18px",o.style.fontWeight="bold",o.style.color="var(--vscode-foreground)",o.style.width="100%",o.style.height="100%",o.title="Show hidden fields",o.addEventListener("click",()=>this.showFieldsMenu(o)),s.appendChild(o),this.styleHeaderCell(s),s.style.textAlign="center",s.style.width="50px",i.appendChild(s),e.appendChild(i),t.appendChild(e)}showFieldsMenu(t){this.activeMenu&&(this.activeMenu.hide(),this.activeMenu=null),this.activeFieldsMenu&&(this.activeFieldsMenu.hide(),this.activeFieldsMenu=null);let e=new Set(this.allFields.filter(n=>!this.hiddenFieldIds.has(String(n.id))).map(n=>String(n.id)));try{console.debug("[ProjectTable] showFieldsMenu: hiddenFieldIds=",Array.from(this.hiddenFieldIds)),console.debug("[ProjectTable] showFieldsMenu: allFieldIds=",this.allFields.map(n=>n.id))}catch{}let i=new ee({fields:this.allFields.map(n=>({id:n.id,name:n.name,iconClass:n.iconClass})),visibleFieldIds:e,onToggleVisibility:(n,s)=>{s?this.showField(n):this.hideField(n)},onCreateField:()=>{try{console.log("Create field requested")}catch{}}});this.activeFieldsMenu=i,i.show(t)}styleHeaderCell(t){t.style.padding="8px",t.style.textAlign="left",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.textOverflow="ellipsis",t.style.borderRight="1px solid var(--vscode-panel-border)",t.style.borderBottom="1px solid var(--vscode-panel-border)",t.style.position="sticky",t.style.top="0",t.style.zIndex="11",t.style.background="var(--vscode-sideBar-background)",t.style.height="32px",t.style.boxSizing="border-box"}renderBody(t){let e=document.createElement("tbody"),i=this.items;this.options.sortConfig&&(i=V(this.items,this.fields,this.options.sortConfig)),this.activeSlice&&(i=i.filter(s=>{let o=s.fieldValues.find(l=>String(l.fieldId)===String(this.activeSlice.fieldId));if(!o)return this.activeSlice.value===null;let d=null;return o.text!==void 0?d=o.text:o.title!==void 0?d=o.title:o.number!==void 0?d=o.number:o.date!==void 0?d=o.date:o.option?d=o.option.name:o.iteration?d=o.iteration.title:d=o.value,d===this.activeSlice.value}));let n=this.getGroupingField();n?this.renderGroupedRows(e,n,i):this.renderFlatRows(e,i),t.appendChild(e)}getGroupingField(){return this.options.groupingFieldName?this.fields.find(t=>t.name&&t.name.toLowerCase()===this.options.groupingFieldName?.toLowerCase()||t.id&&t.id===this.options.groupingFieldName):null}renderFlatRows(t,e){e.forEach((i,n)=>{let s=this.createRow(i,n);t.appendChild(s)})}renderGroupedRows(t,e,i){let n=this.groupItems(i,e);for(let s of n){let o=document.createElement("tr"),d=document.createElement("td");d.colSpan=this.fields.length+1,d.style.padding="8px",d.style.background="var(--vscode-editor-background)",d.style.fontWeight="600",d.style.borderTop="1px solid var(--vscode-editorGroup-border)",d.style.borderBottom="1px solid var(--vscode-editorGroup-border)",d.style.position="sticky",d.style.top="32px",d.style.zIndex="9",d.style.boxShadow="0 1px 2px rgba(0,0,0,0.1)";let l=document.createElement("div");l.style.display="flex",l.style.alignItems="center",l.style.gap="8px";let c=e,p=this.fields.find(u=>u.dataType&&String(u.dataType).toLowerCase()==="number"&&String(u.name||"").toLowerCase().includes("estimate"))||this.fields.find(u=>u.dataType&&String(u.dataType).toLowerCase()==="number"),h=p?p.id:null,g=u=>{if(!h)return 0;let y=0;for(let L of u){let G=L.item||L;if(!G||!Array.isArray(G.fieldValues))continue;let k=G.fieldValues.find(A=>A.fieldId&&String(A.fieldId)===String(h)||A.fieldName&&String(A.fieldName).toLowerCase().includes("estimate")||A.type==="number");if(k){let A=Number(k.number!=null?k.number:k.value!=null?k.value:NaN);isNaN(A)||(y+=A)}}return y},v=u=>isFinite(u)?String(u):"",C=document.createElement("span"),I='<svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-triangle-down"><path d="M4.427 7.427l3.396 3.396a.25.25 0 00.354 0l3.396-3.396A.25.25 0 0011.396 7H4.604a.25.25 0 00-.177.427z"></path></svg>',T='<svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-triangle-right"><path d="M8.573 4.604a.25.25 0 01.427-.177l3.396 3.396a.25.25 0 010 .354l-3.396 3.396a.25.25 0 01-.427-.177V4.604z"></path></svg>';C.innerHTML=I,C.style.cursor="pointer",C.style.userSelect="none",C.style.display="inline-flex",C.style.alignItems="center",C.style.justifyContent="center",C.style.width="16px",C.style.height="16px",C.style.fill="var(--vscode-foreground)",C.style.opacity="0.7";let M=document.createElement("div");M.style.width="12px",M.style.height="12px",M.style.borderRadius="50%",M.style.backgroundColor=D(s.option.color)||"gray";let m=document.createElement("span");m.textContent=s.option.name||s.option.title||"Unassigned";let S=document.createElement("vscode-badge");S.textContent=String(s.items.length);let a=document.createElement("div");a.style.display="flex",a.style.alignItems="center",a.style.gap="8px",a.style.position="sticky",a.style.left="0",a.style.zIndex="12",a.style.background=d.style.background,a.style.paddingRight="8px";let x=document.createElement("div");x.style.display="flex",x.style.alignItems="center",x.style.gap="8px",x.style.flex="1",a.appendChild(C);let b=null,F=null;if(String(e.dataType||"").toLowerCase()==="parent_issue"){let u=s.items&&s.items[0]?s.items[0].item||s.items[0]:null;if(u&&Array.isArray(u.fieldValues)){let y=u.fieldValues.find(L=>String(L.fieldId)===String(e.id)||L.fieldName===e.name||L.type==="parent_issue");y&&(b=y.parent||y.parentIssue||y.issue||y.item||y.value||null)}if(b&&Array.isArray(this.items))try{let y=[];b.number&&y.push(String(b.number)),b.id&&y.push(String(b.id)),b.url&&y.push(String(b.url)),b.title&&y.push(String(b.title));let L=this.items.find(G=>{let k=G&&(G.content||G.raw&&G.raw.itemContent)||null;if(!k)return!1;let A=[];k.number&&A.push(String(k.number)),k.id&&A.push(String(k.id)),k.url&&A.push(String(k.url)),k.title&&A.push(String(k.title)),k.name&&A.push(String(k.name)),k.raw&&k.raw.number&&A.push(String(k.raw.number)),k.raw&&k.raw.id&&A.push(String(k.raw.id)),k.raw&&k.raw.url&&A.push(String(k.raw.url));for(let W of y)for(let $ of A)if(W&&$&&String(W)===String($))return!0;return!1});L&&(F=L)}catch{}}if(s.option&&s.option.avatarUrl||s.option&&s.option.login||s.option&&s.option.name&&String(e.dataType||"").toLowerCase()==="assignees"){let u=document.createElement("span"),y=s.option&&(s.option.avatarUrl||s.option.avatar||s.option.imageUrl)||(()=>{for(let L of s.items){let G=L.item||L;if(!G||!Array.isArray(G.fieldValues))continue;let k=G.fieldValues.find(A=>A.type==="assignees"||String(A.fieldId)===String(e.id));if(k&&k.assignees&&Array.isArray(k.assignees)){let A=k.assignees.find(W=>String(W.login||W.name)===String(s.option.name||s.option.id));if(A&&(A.avatarUrl||A.avatar))return A.avatarUrl||A.avatar}}return null})();y?(u.innerHTML='<span title="'+E(s.option&&(s.option.login||s.option.name)||"Assignee")+'" style="display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url('+E(y)+');border:2px solid var(--vscode-editor-background)"></span>',a.appendChild(u)):a.appendChild(M)}else if(String(e.dataType||"").toLowerCase()==="repository"){let u=document.createElement("span");u.innerHTML='<svg width="14" height="14" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:var(--vscode-icon-foreground)"><path fill="currentColor" d="M2 2.5A1.5 1.5 0 0 1 3.5 1h9A1.5 1.5 0 0 1 14 2.5v11A1.5 1.5 0 0 1 12.5 15h-9A1.5 1.5 0 0 1 2 13.5v-11zM3.5 2A.5.5 0 0 0 3 2.5V4h10V2.5a.5.5 0 0 0-.5-.5h-9z"/></svg>',a.appendChild(u)}else a.appendChild(M);if(F){let u=F.content||F.raw&&F.raw.itemContent||null;if(u){try{u.title?m.textContent=String(u.title):u.name?m.textContent=String(u.name):u.number&&(m.textContent=String(u.number))}catch{}if(Array.isArray(F.fieldValues)){let y=F.fieldValues.find(L=>L&&L.type==="single_select"&&L.option&&L.option.name);if(y&&y.option)try{let L=y.option.color||y.option.id||y.option.name||null;L&&(M.style.backgroundColor=D(L)||M.style.backgroundColor)}catch{}}}}else if(b&&(m.textContent=b.title||b.name||b.number||b.id||m.textContent,b.color))try{M.style.backgroundColor=D(b.color)||M.style.backgroundColor}catch{}a.appendChild(m);let f=document.createElement("span");f.style.display="inline-flex",f.style.alignItems="center",f.style.justifyContent="center",f.style.width="22px",f.style.height="22px",f.style.borderRadius="50%",f.style.background="var(--vscode-input-background)",f.style.border="1px solid var(--vscode-panel-border)",f.style.color="var(--vscode-foreground)",f.style.fontSize="12px",f.style.fontWeight="600",f.style.minWidth="22px",f.style.boxSizing="border-box",f.textContent=String(s.items.length||0),a.appendChild(f);let P=g(s.items||[]);if(P&&P>0){let u=document.createElement("div");if(u.style.display="inline-block",u.style.padding="2px 8px",u.style.borderRadius="999px",u.style.border="1px solid var(--vscode-panel-border)",u.style.background="var(--vscode-input-background)",u.style.color="var(--vscode-foreground)",u.style.fontSize="12px",u.style.lineHeight="18px",u.style.marginLeft="8px",u.textContent="Estimate: "+v(P),a.appendChild(u),String(e.dataType||"").toLowerCase()==="parent_issue"&&!(s.option&&(s.option.name==="Unassigned"||s.option.title==="Unassigned"))){let y=["done","closed","completed","finished"],L=H=>{try{let _=H&&(H.content||H.raw&&H.raw.itemContent);if(_){let z=(_.state||(_.merged?"MERGED":void 0)||"").toString().toUpperCase();if(z==="CLOSED"||z==="MERGED")return!0}if(Array.isArray(H.fieldValues)){if(H.fieldValues.find(R=>R&&R.type==="single_select"&&R.option&&R.option.name&&y.includes(String(R.option.name).toLowerCase())))return!0;let O=H.fieldValues.find(R=>R&&(String(R.fieldName||"").toLowerCase().includes("progress")||String(R.fieldName||"").toLowerCase().includes("percent")||R.type==="number"&&String(R.fieldName||"").toLowerCase().includes("progress")));if(O&&O.number!=null&&Number(O.number||0)>=100)return!0}if(_&&_.labels&&Array.isArray(_.labels.nodes)){let z=_.labels.nodes.map(O=>String(O.name||"").toLowerCase());for(let O of y)if(z.includes(O))return!0}}catch{}return!1},G=0,k=0;if(F&&Array.isArray(F.fieldValues)){let H=F.fieldValues.find(_=>_&&(_.type==="sub_issues_progress"||_.total!=null&&_.done!=null));H&&H.total!=null&&(k=Number(H.total||0),G=Number(H.done||0))}if(!k)for(let H of s.items){let _=H.item||H;_&&(k++,L(_)&&G++)}let A=document.createElement("div");A.style.color="var(--vscode-descriptionForeground)",A.style.fontSize="12px",A.style.marginLeft="8px",A.style.fontVariantNumeric="tabular-nums",A.textContent=`${G}/${k}`,a.appendChild(A);let W=document.createElement("div");W.style.display="inline-flex",W.style.alignItems="center",W.style.gap="8px",W.style.marginLeft="8px";let $=k>0?Math.round(G/k*100):0,B=document.createElement("div");B.style.display="inline-block",B.style.width="120px",B.style.height="12px",B.style.background="transparent",B.style.border="1px solid var(--vscode-focusBorder)",B.style.borderRadius="6px",B.style.overflow="hidden";let j=document.createElement("div");j.style.height="100%",j.style.width=String($)+"%",j.style.background="var(--vscode-focusBorder)",B.appendChild(j),W.appendChild(B),a.appendChild(W)}}if(String(e.dataType||"").toLowerCase()==="single_select")try{let u=(e.options||[]).find(y=>String(y.name)===String(s.option&&s.option.name));if(u&&u.description){let y=document.createElement("div");y.style.color="var(--vscode-descriptionForeground)",y.style.fontSize="12px",y.style.marginLeft="8px",y.textContent=String(u.description).slice(0,120),a.appendChild(y)}}catch{}if(String(e.dataType||"").toLowerCase()==="iteration")try{let u=s.option||{},y=null,L=u.startDate||u.start&&u.startDate||null,G=u.duration||u.length||null;if(L&&G)try{let k=new Date(L),A=Number(G)||0,W=new Date(k.getTime()+A*24*60*60*1e3),$=k.toLocaleDateString("en-US",{month:"short",day:"numeric"}),B=W.toLocaleDateString("en-US",{month:"short",day:"numeric"});y=`${$} \u2014 ${B}`}catch{y=null}if(y||(y=u.title||u.name?String(u.title||u.name):null),y){let k=document.createElement("div");k.style.color="var(--vscode-descriptionForeground)",k.style.fontSize="12px",k.style.marginLeft="8px",k.textContent=String(y).slice(0,120),a.appendChild(k)}}catch{}s.option&&(s.option.name==="Unassigned"||s.option.title==="Unassigned")&&(m.textContent="No "+(e.name||"value")),l.appendChild(a),l.appendChild(x),d.appendChild(l),o.appendChild(d),t.appendChild(o);let N=[];s.items.forEach(u=>{let y=this.createRow(u.item,u.index);y.classList.add("group-row-"+s.option.id),t.appendChild(y),N.push(y)});let w=!1;C.addEventListener("click",()=>{w=!w,C.innerHTML=w?T:I,N.forEach(u=>{u.style.display=w?"none":"table-row"})})}}groupItems(t,e){let i=[],n=(e.dataType||"").toLowerCase();if(n==="single_select"?i=e.options||[]:n==="iteration"&&(i=e.configuration&&e.configuration.iterations||[]),i&&i.length>0){let l=i.map(p=>({option:p,items:[]})),c=[];return t.forEach((p,h)=>{let g=p.fieldValues.find(C=>String(C.fieldId)===String(e.id)||C.fieldName===e.name),v=!1;if(g){let C=null,I=null;if(n==="single_select"?(C=g.optionId||g.option&&g.option.id,I=g.name||g.option&&g.option.name):n==="iteration"&&(C=g.iterationId||g.iteration&&g.iteration.id||g.id,I=g.title||g.iteration&&g.iteration.title),C||I){let T=l.find(M=>C&&String(M.option.id)===String(C)||I&&(String(M.option.name)===String(I)||String(M.option.title)===String(I)));T&&(T.items.push({item:p,index:h}),v=!0)}}v||c.push({item:p,index:h})}),c.length>0&&l.push({option:{name:"Unassigned",title:"Unassigned",color:"GRAY"},items:c}),l.filter(p=>p.items.length>0)}let s=new Map,o=[];t.forEach((l,c)=>{let p=l.fieldValues.find(v=>String(v.fieldId)===String(e.id)||v.fieldName===e.name),h=null;if(p)if(p.text!==void 0)h=p.text;else if(p.title!==void 0)h=p.title;else if(p.number!==void 0)h=p.number;else if(p.date!==void 0)h=p.date;else if(p.option)h=p.option.name||p.option.title||p.option.id;else if(p.iteration)h=p.iteration.title||p.iteration.id;else if(p.parent||p.parentIssue||p.issue||p.item||p.value){let v=p.parent||p.parentIssue||p.issue||p.item||p.value;v&&(h=v.number||v.id||v.raw&&(v.raw.number||v.raw.id)||v.url||v.title||v.name||null)}else p.assignees?h=Array.isArray(p.assignees)?p.assignees.map(v=>v.login||v.name).join(", "):p.assignees:p.repository?h=p.repository.nameWithOwner||p.repository.name||p.repository.full_name||p.repository.id:p.milestone?h=p.milestone.title||p.milestone.id||p.milestone.name:h=p.value!==void 0?p.value:null;if(h==null||h===""){o.push({item:l,index:c});return}let g=String(h);s.has(g)||s.set(g,{option:{id:g,name:g,title:g},items:[]}),s.get(g).items.push({item:l,index:c})});let d=Array.from(s.values());return o.length>0&&d.push({option:{name:"Unassigned",title:"Unassigned",color:"GRAY"},items:o}),d}createRow(t,e){let i=document.createElement("tr");i.setAttribute("data-gh-item-id",t.id),i.style.transition="background-color 0.15s ease",i.addEventListener("mouseenter",()=>{i.style.backgroundColor="var(--vscode-list-hoverBackground)"}),i.addEventListener("mouseleave",()=>{i.style.backgroundColor="transparent"});let n=document.createElement("td");n.textContent=String(e+1),this.styleCell(n),i.appendChild(n);for(let s=0;s<this.fields.length;s++){let o=this.fields[s],d=document.createElement("td");this.styleCell(d);let l=t.fieldValues.find(p=>String(p.fieldId)===String(o.id)||p.fieldName===o.name);l&&(d.innerHTML=Z(l,o,t,this.items)),d.style.position="relative";let c=document.createElement("div");c.className="column-resizer",c.style.position="absolute",c.style.top="0",c.style.right="0",c.style.width="6px",c.style.height="100%",c.style.cursor="col-resize",c.style.userSelect="none",c.style.zIndex="50",c.addEventListener("mouseenter",()=>c.style.background="var(--vscode-focusBorder)"),c.addEventListener("mouseleave",()=>c.style.background="transparent"),c.addEventListener("mousedown",p=>{p.preventDefault(),p.stopPropagation();let h=this.container.querySelector("table");if(!h)return;let v=h.querySelectorAll("col")[s+1],C=v?parseInt(v.style.width)||v.offsetWidth:d.offsetWidth;this.beginColumnResize(h,s+1,p.pageX,C)}),d.appendChild(c),i.appendChild(d)}return i}styleCell(t){t.style.padding="8px",t.style.borderRight="1px solid var(--vscode-panel-border)",t.style.borderBottom="1px solid var(--vscode-panel-border)",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.textOverflow="ellipsis"}showHeaderMenu(t,e,i){t.stopPropagation(),this.activeMenu&&this.activeMenu.hide();let n=(e.dataType||"").toLowerCase(),s=new Set(["assignees","single_select","parent_issue","iteration","number","date","milestone","repository"]),o=new Set(["assignees","single_select","parent_issue","iteration","number","date","milestone","repository","labels"]),d=s.has(n),l=o.has(n),c=!!(this.options.groupingFieldName&&e.name&&e.name.toLowerCase()===this.options.groupingFieldName.toLowerCase()),p=!!(this.activeSlice&&this.activeSlice.fieldId===e.id||this.activeSlicePanelFieldId&&String(this.activeSlicePanelFieldId)===String(e.id)),h=this.options.sortConfig&&this.options.sortConfig.fieldId===e.id?this.options.sortConfig.direction:null;this.activeMenu=new J(e,{canGroup:d,canSlice:l,canFilter:!1,isGrouped:c,isSliced:p,currentSort:h,onSort:g=>this.handleSort(e,g),onClearSort:()=>this.clearSort(e),onGroup:()=>this.handleGroup(e),onClearGroup:()=>this.clearGroup(e),onSlice:()=>this.handleSlice(e),onClearSlice:()=>this.clearSlice(e),onHide:()=>this.hideField(e.id),onMove:g=>this.handleMove(e,g)}),this.activeMenu.show(i)}clearGroup(t){if(this.options.groupingFieldName=void 0,this.options.onGroupChange)try{this.options.onGroupChange("")}catch{}this.render()}clearSlice(t){this.activeSlice=null,this.activeSlicePanel&&(this.activeSlicePanel.close(),this.activeSlicePanel=null),this.activeSlicePanelFieldId=null,this.container.style.display="block",this.render(),this.options.onSliceChange&&this.options.onSliceChange(null)}clearSort(t){let e=this.getStorageKey("sortConfig");e&&localStorage.removeItem(e),this.options.onSortChange&&this.options.onSortChange(null)}showHiddenFieldsMenu(t){this.activeMenu&&this.activeMenu.hide();let e=this.allFields.filter(l=>this.hiddenFieldIds.has(String(l.id)));if(e.length===0){let l=document.createElement("div");l.textContent="No hidden fields",l.style.position="absolute",l.style.background="var(--vscode-menu-background)",l.style.border="1px solid var(--vscode-menu-border)",l.style.borderRadius="4px",l.style.padding="12px",l.style.fontSize="13px",l.style.color="var(--vscode-descriptionForeground)",l.style.zIndex="1000";let c=t.getBoundingClientRect();l.style.top=`${c.bottom+4}px`,l.style.left=`${c.left}px`,document.body.appendChild(l),setTimeout(()=>l.remove(),2e3);return}let i=document.createElement("div");i.style.position="absolute",i.style.background="var(--vscode-menu-background)",i.style.border="1px solid var(--vscode-menu-border)",i.style.borderRadius="4px",i.style.padding="4px 0",i.style.minWidth="180px",i.style.zIndex="1000",i.style.fontSize="13px";let n=t.getBoundingClientRect();i.style.top=`${n.bottom+4}px`,i.style.left=`${n.left}px`;let s=document.createElement("div");s.textContent="Show field",s.style.padding="6px 12px",s.style.fontWeight="600",s.style.color="var(--vscode-descriptionForeground)",s.style.fontSize="11px",s.style.textTransform="uppercase",i.appendChild(s);let o=document.createElement("div");o.style.height="1px",o.style.background="var(--vscode-menu-separatorBackground)",o.style.margin="4px 0",i.appendChild(o),e.forEach(l=>{let c=document.createElement("div");c.textContent=l.name||l.id,c.style.padding="6px 12px",c.style.cursor="pointer",c.style.color="var(--vscode-menu-foreground)",c.addEventListener("mouseenter",()=>{c.style.background="var(--vscode-menu-selectionBackground)",c.style.color="var(--vscode-menu-selectionForeground)"}),c.addEventListener("mouseleave",()=>{c.style.background="transparent",c.style.color="var(--vscode-menu-foreground)"}),c.addEventListener("click",()=>{this.showField(l.id),i.remove(),d.remove()}),i.appendChild(c)});let d=document.createElement("div");d.style.position="fixed",d.style.top="0",d.style.left="0",d.style.right="0",d.style.bottom="0",d.style.zIndex="999",d.addEventListener("click",()=>{i.parentElement&&i.remove(),d.parentElement&&d.remove()}),document.body.appendChild(i),document.body.appendChild(d)}handleSort(t,e){let i={fieldId:t.id,direction:e};this.saveSortConfig(i),this.options.onSortChange&&this.options.onSortChange(i)}handleGroup(t){if(t&&t.name&&(this.options.groupingFieldName=t.name,this.render(),this.options.onGroupChange))try{this.options.onGroupChange(t.name)}catch{}}handleSlice(t){this.activeSlicePanel&&(this.activeSlicePanel.close(),this.activeSlicePanel=null),this.activeSlicePanel=new X(this.container,t,this.items,this.allFields),this.activeSlicePanel.render();try{this.activeSlicePanelFieldId=String(t.id)}catch{this.activeSlicePanelFieldId=null}let e=this.container.querySelector(".table-wrapper");if(e){let i=this.container.querySelector(".slice-panel");i&&this.container.insertBefore(i,e)}this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.gap="0",this.activeSlicePanel.onValueSelect(i=>{this.activeSlice={fieldId:t.id,value:i},this.render()}),this.activeSlicePanel.onFieldChange(i=>{this.activeSlice=null,this.handleSlice(i),this.options.onSliceChange&&this.options.onSliceChange(i)}),this.options.onSliceChange&&this.options.onSliceChange(t)}hideField(t){let e=String(t);this.hiddenFieldIds.add(e);try{console.debug("[ProjectTable] hideField -> added",e,"hiddenFieldIds=",Array.from(this.hiddenFieldIds))}catch{}if(this.options.onHiddenFieldsChange){this.fields=this.allFields.filter(i=>!this.hiddenFieldIds.has(i.id));try{this.applyFieldOrder()}catch{}try{this.options.onHiddenFieldsChange(Array.from(this.hiddenFieldIds))}catch{}this.render()}else{this.saveHiddenFields(),this.fields=this.allFields.filter(i=>!this.hiddenFieldIds.has(i.id));try{this.applyFieldOrder()}catch{}this.render()}}showField(t){let e=String(t);this.hiddenFieldIds.delete(e);try{console.debug("[ProjectTable] showField -> removed",e,"hiddenFieldIds=",Array.from(this.hiddenFieldIds))}catch{}if(this.options.onHiddenFieldsChange){this.fields=this.allFields.filter(i=>!this.hiddenFieldIds.has(i.id));try{this.applyFieldOrder()}catch{}try{this.options.onHiddenFieldsChange(Array.from(this.hiddenFieldIds))}catch{}this.render()}else{this.saveHiddenFields(),this.fields=this.allFields.filter(i=>!this.hiddenFieldIds.has(i.id));try{this.applyFieldOrder()}catch{}this.render()}}handleMove(t,e){let i=this.fields.findIndex(n=>n.id===t.id);e==="left"&&i>0?[this.fields[i],this.fields[i-1]]=[this.fields[i-1],this.fields[i]]:e==="right"&&i<this.fields.length-1&&([this.fields[i],this.fields[i+1]]=[this.fields[i+1],this.fields[i]]),this.saveFieldOrder(),this.render()}getStorageKey(t){return this.options.viewKey?`ghProjects.table.${this.options.viewKey}.${t}`:""}loadHiddenFields(){let t=this.getStorageKey("hiddenFields");if(!t)return[];try{let e=localStorage.getItem(t),n=((e?JSON.parse(e):[])||[]).map(s=>String(s));try{console.debug("[ProjectTable] loadHiddenFields ->",n)}catch{}return n}catch{return[]}}saveHiddenFields(){let t=this.getStorageKey("hiddenFields");if(!t)return;let e=Array.from(this.hiddenFieldIds).map(i=>String(i));try{console.debug("[ProjectTable] saveHiddenFields ->",e)}catch{}localStorage.setItem(t,JSON.stringify(e))}saveSortConfig(t){let e=this.getStorageKey("sortConfig");e&&localStorage.setItem(e,JSON.stringify(t))}saveFieldOrder(){let t=this.getStorageKey("fieldOrder");if(!t)return;let e=this.fields.map(i=>i.id);localStorage.setItem(t,JSON.stringify(e))}applyFieldOrder(){let t=this.getStorageKey("fieldOrder");if(t)try{let e=localStorage.getItem(t);if(!e)return;let i=JSON.parse(e),n=[];for(let s of i){let o=this.fields.find(d=>String(d.id)===String(s));o&&n.push(o)}for(let s of this.fields)n.find(o=>o.id===s.id)||n.push(s);this.fields=n}catch{}}setupResizers(t){t.querySelectorAll("th").forEach((i,n)=>{if(n===0)return;let s=document.createElement("div");s.className="column-resizer",s.style.position="absolute",s.style.top="0",s.style.right="0",s.style.width="4px",s.style.height="100%",s.style.cursor="col-resize",s.style.userSelect="none",s.style.zIndex="100",s.addEventListener("mouseenter",()=>{s.style.background="var(--vscode-focusBorder)"}),s.addEventListener("mouseleave",()=>{s.style.background="transparent"});let o=0,d=0;s.addEventListener("mousedown",l=>{l.preventDefault(),l.stopPropagation();let p=t.querySelectorAll("col")[n],h=p?parseInt(p.style.width)||p.offsetWidth:i.offsetWidth;this.beginColumnResize(t,n,l.pageX,h)}),i.style.position="relative",i.appendChild(s)}),this.restoreColumnWidths(t)}saveColumnWidth(t,e){let i=this.getStorageKey("columnWidths");if(i)try{let n=localStorage.getItem(i),s=n?JSON.parse(n):{};s[t]=e,localStorage.setItem(i,JSON.stringify(s))}catch{}}beginColumnResize(t,e,i,n){let s=d=>{let l=Math.max(20,n+(d.pageX-i)),p=t.querySelectorAll("col")[e];p&&(p.style.width=`${l}px`,p.style.minWidth=`${l}px`,p.style.maxWidth=`${l}px`)},o=d=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",o);let l=e-1;if(l>=0&&l<this.fields.length){let p=t.querySelectorAll("col")[e],h=p?parseInt(p.style.width)||p.offsetWidth:void 0;h&&this.saveColumnWidth(this.fields[l].id,h)}};document.addEventListener("mousemove",s),document.addEventListener("mouseup",o)}restoreColumnWidths(t){let e=this.getStorageKey("columnWidths");if(e)try{let i=localStorage.getItem(e);if(!i)return;let n=JSON.parse(i),s=t.querySelectorAll("col");this.fields.forEach((o,d)=>{let l=n[o.id];if(l){let c=s[d+1];c&&(c.style.width=`${l}px`,c.style.minWidth=`${l}px`,c.style.maxWidth=`${l}px`)}})}catch{}}};function oe(r,t){r.innerHTML='<div class="title">'+t+'</div><div class="loading"><em>Loading...</em></div>'}function le(r,t,e){r.innerHTML='<div class="title">'+t+'</div><div style="color:var(--vscode-editor-foreground)">'+e+"</div>"}function re(r){let t=document.createElement("button");return t.type="button",t.textContent="Load more",t.style.marginLeft="8px",t.style.border="1px solid var(--vscode-editorWidget-border)",t.addEventListener("click",()=>{r(),t.disabled=!0,t.textContent="Loading..."}),t}function ae(r,t,e){if(window.filterBarHelper&&typeof window.filterBarHelper.create=="function")try{return window.filterBarHelper.create({parent:r,suffix:e.suffix||t,effFilter:void 0,viewKey:t,step:e.step||50,onLoadMore:e.onLoadMore,onSave:e.onSave,onDiscard:e.onDiscard})}catch{return null}return null}window.tableViewFetcher=function(r,t,e){let i=r&&(r.name||r.id)?r.name||r.id:"Table View";try{oe(t,i)}catch{}let n=30;function s(l){let c=l||{},p=c.fields||[],h=c.items||[],g=h.slice(0,n);t.innerHTML="",t.style.margin="0",t.style.padding="0",t.style.height="100%",t.style.display="flex",t.style.flexDirection="column",t.style.overflow="hidden";let v=document.createElement("div");v.style.flex="0 0 auto",v.style.background="var(--vscode-editor-background)",v.style.zIndex="20",v.style.position="relative",v.style.display="flex",v.style.justifyContent="space-between",v.style.alignItems="center",v.style.width="100%";let C=document.createElement("div");C.style.flex="1 1 auto",C.style.marginRight="8px",v.appendChild(C);let I=null,T=null,M=null,m=ae(C,e,{suffix:e?String(e).split(":").pop():"",step:n,onLoadMore:()=>{n+=30,d()},onSave:w=>{try{if(I!==null&&(window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"setViewGrouping",viewKey:e,grouping:I}),I=null),T!==null){let u=Array.from(T);window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"setViewHiddenFields",viewKey:e,hiddenFields:u});try{let y=e?`ghProjects.table.${e}.hiddenFields`:null;y&&localStorage.setItem(y,JSON.stringify(u))}catch{}T=null}if(M!==null){window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"setViewSlice",viewKey:e,slice:M});try{let u=e?`ghProjects.table.${e}.slice`:null;u&&localStorage.setItem(u,JSON.stringify(M))}catch{}M=null}}catch{}},onDiscard:()=>{try{if(I!==null&&(window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"discardViewGrouping",viewKey:e}),I=null),T!==null&&(window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"discardViewHiddenFields",viewKey:e}),T=null,d()),M!==null){window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"discardViewSlice",viewKey:e}),M=null;try{let w=e?`ghProjects.table.${e}.slice`:null;w&&localStorage.removeItem(w)}catch{}d()}}catch{}}});if(m)typeof m.setLoadState=="function"&&m.setLoadState(h.length<n,h.length>=n?"Load more":"All loaded"),typeof m.registerItems=="function"&&m.registerItems(h,{fields:p});else{let w=document.createElement("div");w.className="title",w.textContent=i,w.style.padding="8px",v.appendChild(w);let u=document.createElement("div");if(u.style.padding="8px",h.length>n){let y=re(()=>{n+=30,d()});u.appendChild(y)}else{let y=document.createElement("span");y.textContent="All loaded",y.style.color="var(--vscode-descriptionForeground)",u.appendChild(y)}v.appendChild(u)}t.appendChild(v);let S=document.createElement("div");S.style.flex="1 1 auto",S.style.overflow="hidden",S.style.position="relative",t.appendChild(S);let a=me(c),x=ie(c.details?.sortByFields);if(e)try{let w=localStorage.getItem(`ghProjects.table.${e}.sortConfig`);w&&(x=JSON.parse(w))}catch{}let b=g;x&&(b=V(g,p,x));let F=c.allFields&&Array.isArray(c.allFields)?c.allFields:c.fields||[],f=c.details&&c.details.fields&&Array.isArray(c.details.fields.nodes)?c.details.fields.nodes:null,P;if(f&&Array.isArray(f)){let w=new Set(f.map(u=>String(u.id)));P=(F||[]).map(u=>String(u.id)).filter(u=>!w.has(u))}try{let w={allFieldIds:(F||[]).map(u=>String(u.id)),viewFieldIds:f?f.map(u=>String(u.id)):null,viewHiddenFieldIds:P};window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"debugLog",level:"debug",message:"tableViewFetcher field debug",data:w,viewKey:e})}catch{}new Y(S,F,b,{groupingFieldName:a||void 0,sortConfig:x,viewKey:e,hiddenFields:P,onHiddenFieldsChange:w=>{try{if(T=new Set((w||[]).map(u=>String(u))),m&&m.saveBtn&&m.discardBtn)try{m.saveBtn.disabled=!1,m.discardBtn.disabled=!1,m.saveBtn.style.opacity="1",m.saveBtn.style.cursor="pointer",m.discardBtn.style.opacity="1",m.discardBtn.style.cursor="pointer"}catch{}}catch{}},onSortChange:()=>d(),onGroupChange:w=>{try{if(I=w||null,m&&m.saveBtn&&m.discardBtn)try{m.saveBtn.disabled=!1,m.discardBtn.disabled=!1,m.saveBtn.style.opacity="1",m.saveBtn.style.cursor="pointer",m.discardBtn.style.opacity="1",m.discardBtn.style.cursor="pointer"}catch{}}catch{}},onSliceChange:w=>{try{if(M=w?{fieldId:w.id,value:null}:null,m&&m.saveBtn&&m.discardBtn)try{m.saveBtn.disabled=!1,m.discardBtn.disabled=!1,m.saveBtn.style.opacity="1",m.saveBtn.style.cursor="pointer",m.discardBtn.style.opacity="1",m.discardBtn.style.cursor="pointer"}catch{}window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"debugLog",level:"debug",message:w?`Slice activated on field: ${w.name}`:"Slice cleared",viewKey:e})}catch{}}}).render(),m&&typeof m.onFilterChange=="function"&&m.onFilterChange(w=>{S.querySelectorAll("tr[data-gh-item-id]").forEach(y=>{let L=y.getAttribute("data-gh-item-id");L&&w.has(L)?y.style.display="table-row":y.style.display="none"})})}function o(l){let c=l&&l.data?l.data:l;try{if(c&&c.command==="fields"){if(c.viewKey&&e&&String(c.viewKey)!==String(e))return;c.error?le(t,i,String(c.error)):s(c.payload)}}catch{}}function d(){try{window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"requestFields",first:n,viewKey:e})}catch{}}try{window.__APP_MESSAGING__.onMessage(o)}catch{window.addEventListener("message",o)}d()};function me(r){try{if(r&&r.details){let t=r.details.verticalGroupByFields&&r.details.verticalGroupByFields.nodes,e=r.details.groupByFields&&r.details.groupByFields.nodes;if(t&&t.length>0)return t[0].name||null;if(e&&e.length>0)return e[0].name||null}}catch{}return null}})();
//# sourceMappingURL=tableViewFetcher.js.map
