"use strict";(()=>{function g(o){return o?String(o).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function O(o){if(!o)return null;let t=String(o).trim();if(/^#?[0-9a-f]{3}$/i.test(t)||/^#?[0-9a-f]{6}$/i.test(t)||/^#?[0-9a-f]{8}$/i.test(t)){let i=t[0]==="#"?t.slice(1):t;return"#"+(i.length===8?i.substring(0,6):i)}let e={GRAY:"#848d97",RED:"#f85149",ORANGE:"#db6d28",YELLOW:"#d29922",GREEN:"#3fb950",BLUE:"#2f81f7",PURPLE:"#a371f7",PINK:"#db61a2",BLACK:"#000000",WHITE:"#ffffff"},n=t.toUpperCase();return e[n]||null}function j(o,t){if(!o)return null;let e=o.replace("#",""),n=i=>parseInt(i,16);if(e.length===3){let i=n(e[0]+e[0]),s=n(e[1]+e[1]),r=n(e[2]+e[2]);return"rgba("+i+","+s+","+r+","+t+")"}if(e.length===6||e.length===8){let i=e.length===8?e.substring(0,6):e,s=n(e.substring(0,2)),r=n(i.substring(2,4)),l=n(i.substring(4,6));return"rgba("+s+","+r+","+l+","+t+")"}return null}function Y(o){if(!o)return"#333333";let t=o.replace("#",""),e=r=>parseInt(r,16),n,i,s;if(t.length===3)n=e(t[0]+t[0]),i=e(t[1]+t[1]),s=e(t[2]+t[2]);else if(t.length===6||t.length===8){let r=t.length===8?t.substring(0,6):t;n=e(r.substring(0,2)),i=e(r.substring(2,4)),s=e(r.substring(4,6))}else return"#333333";return .2126*(n/255)+.7152*(i/255)+.0722*(s/255)>.6?"#111111":"#ffffff"}function Z(o,t,e,n){var i,s,r,l,c,p,u,w,F,S,I,L,A,x,P;if(!o)return"";try{switch(o.type){case"title":{let a=o&&o.title&&(o.title.raw&&o.title.raw.text||o.title.content&&(o.title.content.title||o.title.content.name)||typeof o.title=="string"&&o.title)||o&&o.content&&(o.content.title||o.content.name)||o&&o.raw&&o.raw.text||"",E=o&&o.title&&o.title.content&&o.title.content.number||o&&o.raw&&o.raw.itemContent&&o.raw.itemContent.number||e&&e.content&&e.content.number||"",y=o&&o.title&&o.title.content&&o.title.content.url||o&&o.raw&&o.raw.itemContent&&o.raw.itemContent.url||e&&e.content&&e.content.url||"",C=null;if(e&&Array.isArray(e.fieldValues)){let d=e.fieldValues.find(m=>m&&m.type==="single_select"&&(m.raw&&m.raw.field&&String(m.raw.field.name||"").toLowerCase()==="status"||m.fieldName&&String(m.fieldName||"").toLowerCase()==="status"||m.field&&m.field.name&&String(m.field.name||"").toLowerCase()==="status"));d&&(C=d.option&&(d.option.color||d.option.id||d.option.name)||d.raw&&d.raw.color||null)}let h=O(C)||null,H=h&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(h)?h:"#666666",k=g(String(a||"")),b=E?g(String(E)):"";return'<a href="'+g(String(y||""))+'" target="_blank" rel="noopener noreferrer" style="text-decoration:none;color:inherit;display:inline-flex;align-items:center;gap:8px;width:100%;"><svg width="14" height="14" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:'+g(H)+'"><circle cx="8" cy="8" r="6" fill="currentColor" /></svg><span style="flex:1;min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:block">'+k+"</span>"+(b?'<span style="flex:none;margin-left:6px;color:var(--vscode-descriptionForeground);white-space:nowrap">#'+b+"</span>":"")+"</a>"}case"text":return"<div>"+g((i=o.text)!=null?i:"")+"</div>";case"number":{let a=o.number!==void 0&&o.number!==null?String(o.number):"";return'<div style="text-align:right;font-variant-numeric:tabular-nums">'+g(a)+"</div>"}case"date":{let a=(l=(r=(s=o.date)!=null?s:o.startDate)!=null?r:o.dueOn)!=null?l:null;if(!a)return"<div></div>";try{let E=new Date(a);if(isNaN(E.getTime()))return"<div>"+g(String(a))+"</div>";let y=E.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return"<div>"+g(y)+"</div>"}catch{return"<div>"+g(String(a))+"</div>"}}case"single_select":{let a=g((p=(c=o.option)==null?void 0:c.name)!=null?p:""),E=null;if(t&&Array.isArray(t.options)){let b=t.options.find(d=>d.id&&o.option&&o.option.id&&d.id===o.option.id||d.name&&o.option&&o.option.name&&d.name===o.option.name);b&&(E=(w=(u=b.color)!=null?u:b.id)!=null?w:null)}let y=O(E)||null,C=!!(y&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(y)),h=y||"#999999",H=C&&j(y,.12)||"rgba(0,0,0,0.06)",k=y||"#333333";return'<span style="display:block;width:100%;box-sizing:border-box"><div style="display:inline-flex;align-items:center;padding:2px 8px;border:1px solid '+g(h)+";border-radius:999px;color:"+g(k)+";background:"+g(H)+';font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;width:100%"><span style="flex:1 1 auto;min-width:0;max-width:100%;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">'+a+"</span></div></span>"}case"labels":return"<div>"+(o.labels||[]).map(a=>{let E=g(a.name||""),y=e&&(e.content&&e.content.repository&&e.content.repository.nameWithOwner||e.repository&&e.repository.nameWithOwner)||o.raw&&o.raw.itemContent&&o.raw.itemContent.repository&&o.raw.itemContent.repository.nameWithOwner||null,C=a.color||a.colour||null;if(t&&t.repoOptions&&y&&t.repoOptions[y]){let m=t.repoOptions[y].find(_=>_&&_.name===a.name);m&&(C=m.color||m.colour||C)}let h=O(C)||null,H=!!(h&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(h)),k=h||"#999999",b=H&&j(h,.12)||"rgba(0,0,0,0.06)",d=h||"#333333";return'<span style="display:inline-block;padding:2px 8px;margin-right:6px;border-radius:999px;border:1px solid '+g(k)+";background:"+g(b)+";color:"+g(d)+';font-size:12px;line-height:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">'+E+"</span>"}).join("")+"</div>";case"repository":{let a=g((S=(F=o.repository)==null?void 0:F.nameWithOwner)!=null?S:"");return'<a href="'+g(((I=o.repository)==null?void 0:I.url)||((L=o.repository)==null?void 0:L.html_url)||"")+'" target="_blank" rel="noopener noreferrer" style="text-decoration:none;color:inherit;display:inline-flex;align-items:center;gap:8px"><svg width="14" height="14" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:var(--vscode-icon-foreground)"><path fill="currentColor" d="M2 2.5A1.5 1.5 0 0 1 3.5 1h9A1.5 1.5 0 0 1 14 2.5v11A1.5 1.5 0 0 1 12.5 15h-9A1.5 1.5 0 0 1 2 13.5v-11zM3.5 2A.5.5 0 0 0 3 2.5V4h10V2.5a.5.5 0 0 0-.5-.5h-9z"/></svg><span>'+a+"</span></a>"}case"pull_request":{let a=o.pullRequests||[];return function(){var E=o.pullRequests||[];if(!E||E.length===0)return"";for(var y='<div style="display:flex;flex-wrap:wrap;gap:6px;align-items:center">',C=0;C<E.length;C++){var h=E[C],H=g(String(h&&h.number||"")),k=g(h&&h.title||""),b=g(h&&h.url||""),d=h&&(h.state_color||h.color||h.colour||h.state)||null,m=O(d)||null,_=!!(m&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(m)),N=m||"#999999",f=_&&j(m,.12)||"rgba(0,0,0,0.06)",M=Y(m)||"#333333";y+='<a href="'+b+'" target="_blank" rel="noopener noreferrer" style="text-decoration:none;color:inherit"><span title="'+k+'" style="display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;border:1px solid '+g(N)+";background:"+g(f)+";color:"+g(M)+';font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;max-width:160px"><svg width="12" height="12" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:'+g(m||"#666")+'"><circle cx="8" cy="8" r="6" fill="currentColor" /></svg><span style="flex:1 1 auto;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">#'+H+"</span></span></a>"}return y+="</div>",y}()}case"issue":return(o.issues||[]).map(a=>'<a href="'+g(a.url||"")+'" target="_blank" rel="noopener noreferrer">#'+g(String(a.number||""))+" "+g(a.title||"")+"</a>").join("<br/>");case"assignees":{let a=o.assignees||[];if(a.length===0)return"<div></div>";let E=a.slice(0,3).map((h,H)=>{let k=g(h.avatarUrl||h.avatar||""),b=H===0?"0px":H===1?"-8px":"-14px",d=Math.max(1,3-H);if(k)return'<span title="'+g(h.login||h.name||"")+'" style="display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url('+k+");border:2px solid var(--vscode-editor-background);margin-left:"+b+";vertical-align:middle;position:relative;z-index:"+d+'"></span>';let m=g((h.name||h.login||"").split(" ").map(_=>_[0]||"").join("").toUpperCase().slice(0,2));return'<span title="'+g(h.login||h.name||"")+'" style="display:inline-flex;align-items:center;justify-content:center;width:20px;height:20px;border-radius:50%;background:#777;color:#fff;font-size:11px;border:2px solid var(--vscode-editor-background);margin-left:'+b+";vertical-align:middle;position:relative;z-index:"+d+'">'+m+"</span>"}).join(""),y=a.map(h=>h.login||h.name||""),C="";return y.length===1?C=y[0]:y.length===2?C=y[0]+" and "+y[1]:C=y.slice(0,-1).join(", ")+" and "+y.slice(-1)[0],'<div style="display:flex;align-items:center;gap:8px"><span style="display:flex;align-items:center">'+('<span style="display:inline-block;vertical-align:middle;height:20px;line-height:20px;margin-right:8px;">'+E+"</span>")+'</span><span style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis">'+g(C)+"</span></div>"}case"requested_reviewers":return"<div>"+g((o.reviewers||[]).map(a=>a.login||a.name||a.kind||"").join(", "))+"</div>";case"iteration":{let a=g((A=o.title)!=null?A:""),E=O("GRAY")||null,y=!!(E&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(E)),C=E||"#999999",h=y&&j(E,.12)||"rgba(0,0,0,0.06)",H=E||"#333333";return'<div style="display:inline-block;padding:2px 8px;border:1px solid '+g(C)+";border-radius:999px;color:"+g(H)+";background:"+g(h)+';font-size:12px;line-height:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">'+a+"</div>"}case"parent_issue":{let a=o&&(o.parent||o.parentIssue||o.issue||o.option||o.item||o.value)||o&&o.raw&&(o.raw.parent||o.raw.itemContent||o.raw.item)||null,E=a&&(a.number||a.id||a.raw&&a.raw.number)&&(a.number||a.raw&&a.raw.number)||"",y=a&&(a.title||a.name||a.raw&&a.raw.title)&&(a.title||a.name||a.raw&&a.raw.title)||"",C=a&&(a.url||a.html_url||a.raw&&a.raw.url)&&(a.url||a.html_url||a.raw&&a.raw.url)||"",h=g(String(y||"")),H=E?g(String(E)):"",k=g(String(C||"")),b=null;try{var $=Array.isArray(n)?n:n||[];if(Array.isArray($)&&$.length>0&&(E||a)){let W=a&&a.repository&&(a.repository.nameWithOwner||a.repository.name)||a&&a.content&&a.content.repository&&a.content.repository.nameWithOwner||null,G=[];E&&G.push(String(E)),a&&(a.id||a.raw&&a.raw.id)&&G.push(String(a.id||a.raw&&a.raw.id)),a&&(a.url||a.raw&&a.raw.url)&&G.push(String(a.url||a.raw&&a.raw.url)),a&&(a.title||a.name)&&G.push(String(a.title||a.name));let D=$.find(T=>{let v=T&&(T.content||T.raw&&T.raw.itemContent)||null;if(!v)return!1;let B=[];if(v.number&&B.push(String(v.number)),v.id&&B.push(String(v.id)),v.url&&B.push(String(v.url)),v.title&&B.push(String(v.title)),v.name&&B.push(String(v.name)),v.raw&&v.raw.number&&B.push(String(v.raw.number)),v.raw&&v.raw.id&&B.push(String(v.raw.id)),v.raw&&v.raw.url&&B.push(String(v.raw.url)),W){let V=v.repository&&(v.repository.nameWithOwner||v.repository.name)||null;if(V&&String(V)!==String(W))return!1}for(let V=0;V<G.length;V++)for(let z=0;z<B.length;z++)if(G[V]&&B[z]&&String(G[V])===String(B[z]))return!0;return!1});if(D&&Array.isArray(D.fieldValues)){let T=D.fieldValues.find(v=>v&&v.type==="single_select"&&(v.raw&&v.raw.field&&String(v.raw.field.name||"").toLowerCase()==="status"||v.fieldName&&String(v.fieldName||"").toLowerCase()==="status"||v.field&&v.field.name&&String(v.field.name||"").toLowerCase()==="status"));T&&(b=T.option&&(T.option.color||T.option.id||T.option.name)||T.raw&&T.raw.color||null)}}}catch{}b||(b=a&&(a.option&&(a.option.color||a.option.id||a.option.name)||a.color||a.colour)||null);let d=O(b)||null,m=!!(d&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(d)),_=d||"#999999",N=m&&j(d,.12)||"rgba(0,0,0,0.06)",f=Y(d)||"#333333",M='<span style="display:block;width:100%;box-sizing:border-box"><div style="display:inline-flex;align-items:center;gap:8px;padding:4px 10px;border:1px solid '+g(_)+";border-radius:999px;color:"+g(f)+";background:"+g(N)+';font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;width:100%"><svg width="14" height="14" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:'+g(d||"#666")+'"><circle cx="8" cy="8" r="6" fill="currentColor" /></svg><span class="parent-issue-title" style="flex:1;min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:block">'+h+"</span>"+(H?'<span style="margin-left:6px;color:var(--vscode-descriptionForeground);white-space:nowrap">#'+H+"</span>":"")+"</div></span>",R='<span data-gh-open="'+(k||"")+'" class="parent-issue-wrapper" style="display:block;width:100%;cursor:'+(k?"pointer":"default")+'">';return k?R+M+"</span>":M}case"milestone":return"<div>"+g((P=(x=o.milestone)==null?void 0:x.title)!=null?P:"")+"</div>";case"sub_issues_progress":try{if(!o||o.total==null||Number(o.total)<=0)return"";let a=Math.max(0,Math.floor(Number(o.total)||0)),E=Math.max(0,Math.floor(Number(o.done||0)));if(a===0)return"";let y=null;if(o.percent!==void 0&&o.percent!==null?y=Number(o.percent):y=Math.round(E/a*100),y==null||!isFinite(y))return"";y=Math.max(0,Math.min(100,y));let C=[];for(let h=0;h<a;h++)h<E?C.push('<div class="sub-issues-segment sub-issues-segment-filled" style="flex:1;min-width:0;height:12px;border-radius:4px;background:var(--vscode-focusBorder);box-sizing:border-box"></div>'):C.push('<div class="sub-issues-segment sub-issues-segment-empty" style="flex:1;min-width:0;height:12px;border-radius:4px;border:1px solid var(--vscode-focusBorder);background:transparent;box-sizing:border-box"></div>');return'<div class="sub-issues-progress" style="display:flex;align-items:center;gap:8px;width:100%"><div class="sub-issues-progress-bar" style="flex:1;min-width:0;display:flex;gap:4px;align-items:center">'+C.join("")+'</div><div class="sub-issues-progress-pct" style="min-width:44px;text-align:right;font-variant-numeric:tabular-nums;color:var(--vscode-descriptionForeground)">'+g(String(y)+"%")+"</div></div>"}catch{return""}case"missing":return"";default:return"<div>"+g(o&&o.raw&&o.raw.__typename?String(o.raw.__typename):JSON.stringify(o).slice(0,200))+"</div>"}}catch{return""}}var q=class{constructor(t,e){this.menuElement=null;this.backdropElement=null;this.field=t,this.options=e}show(t){this.hide(),this.backdropElement=document.createElement("div"),this.backdropElement.style.position="fixed",this.backdropElement.style.top="0",this.backdropElement.style.left="0",this.backdropElement.style.right="0",this.backdropElement.style.bottom="0",this.backdropElement.style.zIndex="999",this.backdropElement.addEventListener("click",()=>this.hide()),document.body.appendChild(this.backdropElement),this.menuElement=document.createElement("div"),this.menuElement.className="column-header-menu",this.menuElement.style.position="absolute",this.menuElement.style.background="var(--vscode-menu-background)",this.menuElement.style.border="1px solid var(--vscode-menu-border)",this.menuElement.style.borderRadius="4px",this.menuElement.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)",this.menuElement.style.minWidth="180px",this.menuElement.style.padding="4px 0",this.menuElement.style.zIndex="1000",this.menuElement.style.fontSize="13px";let e=t.getBoundingClientRect();this.menuElement.style.top=`${e.bottom+4}px`,this.menuElement.style.left=`${e.left}px`,this.buildMenuItems(),document.body.appendChild(this.menuElement)}hide(){this.menuElement&&(this.menuElement.remove(),this.menuElement=null),this.backdropElement&&(this.backdropElement.remove(),this.backdropElement=null)}buildMenuItems(){this.menuElement&&(this.addMenuItem("Select column",null,{isHeader:!0}),this.addSeparator(),this.addMenuItem("Sort ascending \u2191",()=>{this.options.onSort?.("ASC"),this.hide()},{icon:"\u2191",showClear:this.options.currentSort==="ASC",clearAction:this.options.onClearSort}),this.addMenuItem("Sort descending \u2193",()=>{this.options.onSort?.("DESC"),this.hide()},{icon:"\u2193",showClear:this.options.currentSort==="DESC",clearAction:this.options.onClearSort}),this.addSeparator(),this.options.canGroup&&this.addMenuItem("Group by values",()=>{this.options.onGroup?.(),this.hide()},{showClear:!!this.options.isGrouped,clearAction:this.options.onClearGroup}),this.options.canSlice&&this.addMenuItem("Slice by values",()=>{this.options.onSlice?.(),this.hide()},{showClear:!!this.options.isSliced,clearAction:this.options.onClearSlice}),this.options.canFilter&&this.addMenuItem("Filter by values...",()=>{this.options.onFilter?.(),this.hide()}),(this.options.canGroup||this.options.canSlice||this.options.canFilter)&&this.addSeparator(),this.addMenuItem("Hide field",()=>{this.options.onHide?.(),this.hide()}),this.addSeparator(),this.addMenuItem("Move left \u2190",()=>{this.options.onMove?.("left"),this.hide()},{icon:"\u2190"}),this.addMenuItem("Move right \u2192",()=>{this.options.onMove?.("right"),this.hide()},{icon:"\u2192"}))}addMenuItem(t,e,n){if(!this.menuElement)return;let i=document.createElement("div");if(i.className="menu-item",n?.isHeader){i.textContent=t,i.style.padding="6px 12px",i.style.fontWeight="600",i.style.color="var(--vscode-descriptionForeground)",i.style.fontSize="11px",i.style.textTransform="uppercase",i.style.cursor="default",this.menuElement.appendChild(i);return}i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="space-between",i.style.padding="6px 12px",i.style.cursor="pointer",i.style.color="var(--vscode-menu-foreground)";let s=document.createElement("span");if(s.textContent=t,s.style.flex="1",s.style.whiteSpace="nowrap",s.style.overflow="hidden",s.style.textOverflow="ellipsis",i.appendChild(s),n?.showClear&&n?.clearAction){let r=document.createElement("button");r.type="button",r.textContent="\u2715",r.title="Clear",r.style.border="none",r.style.background="transparent",r.style.cursor="pointer",r.style.padding="2px 6px",r.style.marginLeft="8px",r.style.color="var(--vscode-menu-foreground)",r.addEventListener("mouseenter",()=>{r.style.color="var(--vscode-menu-selectionForeground)",r.style.background="var(--vscode-menu-selectionBackground)"}),r.addEventListener("mouseleave",()=>{r.style.color="var(--vscode-menu-foreground)",r.style.background="transparent"}),r.addEventListener("click",l=>{l.stopPropagation(),n.clearAction&&n.clearAction(),this.hide()}),i.appendChild(r)}e&&(i.addEventListener("mouseenter",()=>{i.style.background="var(--vscode-menu-selectionBackground)",i.style.color="var(--vscode-menu-selectionForeground)"}),i.addEventListener("mouseleave",()=>{i.style.background="transparent",i.style.color="var(--vscode-menu-foreground)"}),i.addEventListener("click",e)),this.menuElement.appendChild(i)}addSeparator(){if(!this.menuElement)return;let t=document.createElement("div");t.style.height="1px",t.style.background="var(--vscode-menu-separatorBackground)",t.style.margin="4px 0",this.menuElement.appendChild(t)}};var Q=class{constructor(t){this.menuElement=null;this.backdropElement=null;this.options=t}show(t){this.hide(),this.backdropElement=document.createElement("div"),this.backdropElement.style.position="fixed",this.backdropElement.style.top="0",this.backdropElement.style.left="0",this.backdropElement.style.right="0",this.backdropElement.style.bottom="0",this.backdropElement.style.zIndex="998",this.backdropElement.addEventListener("click",()=>this.hide()),document.body.appendChild(this.backdropElement),this.menuElement=document.createElement("div"),this.menuElement.className="fields-menu",this.menuElement.style.position="absolute",this.menuElement.style.visibility="hidden",this.menuElement.style.left="0px",this.menuElement.style.top="0px",this.menuElement.style.background="var(--vscode-menu-background)",this.menuElement.style.border="1px solid var(--vscode-menu-border)",this.menuElement.style.borderRadius="4px",this.menuElement.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)",this.menuElement.style.minWidth="220px",this.menuElement.style.padding="6px 0",this.menuElement.style.zIndex="1000",this.menuElement.style.fontSize="13px",document.body.appendChild(this.menuElement),this.buildMenu();let e=t.getBoundingClientRect(),n=this.menuElement.getBoundingClientRect(),i=8,s=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight,l=e.bottom+i;e.bottom+n.height+i>r&&(e.top-n.height-i>=0?l=e.top-n.height-i:l=Math.max(i,Math.min(r-n.height-i,e.bottom+i)));let c=e.left;e.left+n.width+i>s&&(c=Math.max(i,e.right-n.width)),c=Math.max(i,Math.min(c,s-n.width-i)),this.menuElement.style.top=`${Math.round(l)}px`,this.menuElement.style.left=`${Math.round(c)}px`,this.menuElement.style.visibility="visible"}hide(){this.menuElement&&(this.menuElement.remove(),this.menuElement=null),this.backdropElement&&(this.backdropElement.remove(),this.backdropElement=null)}buildMenu(){if(!this.menuElement)return;let t=document.createElement("div");t.style.display="flex",t.style.alignItems="center",t.style.padding="6px 12px",t.style.fontWeight="600",t.style.color="var(--vscode-descriptionForeground)",t.style.fontSize="12px",t.style.textTransform="uppercase";let e=document.createElement("i");e.className="octicon octicon-note",e.style.marginRight="8px",t.appendChild(e);let n=document.createElement("span");n.textContent="Fields",t.appendChild(n),this.menuElement.appendChild(t),this.addSeparator();let i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.padding="6px 12px",i.style.cursor="pointer",i.style.color="var(--vscode-menu-foreground)",i.innerHTML='<span style="margin-right:8px;font-weight:700">+</span><span>New field</span>',i.addEventListener("mouseenter",()=>{i.style.background="var(--vscode-menu-selectionBackground)",i.style.color="var(--vscode-menu-selectionForeground)"}),i.addEventListener("mouseleave",()=>{i.style.background="transparent",i.style.color="var(--vscode-menu-foreground)"}),i.addEventListener("click",()=>{this.options.onCreateField?.(),this.hide()}),this.menuElement.appendChild(i),this.addSeparator();let s=this.options.fields.filter(l=>this.options.visibleFieldIds.has(l.id)),r=this.options.fields.filter(l=>!this.options.visibleFieldIds.has(l.id));this.addSectionHeader("Visible fields"),s.length===0?this.addEmptyRow("No visible fields"):s.forEach(l=>this.addFieldRow(l,!0)),this.addSeparator(),this.addSectionHeader("Hidden fields"),r.length===0?this.addEmptyRow("No hidden fields"):r.forEach(l=>this.addFieldRow(l,!1))}addSectionHeader(t){if(!this.menuElement)return;let e=document.createElement("div");e.textContent=t,e.style.padding="6px 12px",e.style.fontSize="11px",e.style.fontWeight="600",e.style.color="var(--vscode-descriptionForeground)",e.style.textTransform="uppercase",this.menuElement.appendChild(e)}addEmptyRow(t){if(!this.menuElement)return;let e=document.createElement("div");e.textContent=t,e.style.padding="6px 12px",e.style.color="var(--vscode-menu-foreground)",e.style.opacity="0.8",this.menuElement.appendChild(e)}addFieldRow(t,e){if(!this.menuElement)return;let n=document.createElement("div");if(n.style.display="flex",n.style.alignItems="center",n.style.padding="6px 12px",n.style.cursor="pointer",n.style.color="var(--vscode-menu-foreground)",e){let r=document.createElement("span");r.textContent="\u2713",r.style.marginRight="8px",r.style.color="var(--vscode-menu-selectionForeground)",n.appendChild(r)}else{let r=document.createElement("span");r.style.display="inline-block",r.style.width="14px",r.style.marginRight="8px",n.appendChild(r)}let i=document.createElement("i");i.className=t.iconClass||"octicon octicon-tag",i.style.marginRight="8px",n.appendChild(i);let s=document.createElement("span");s.textContent=t.name,s.style.flex="1",s.style.whiteSpace="nowrap",s.style.overflow="hidden",s.style.textOverflow="ellipsis",n.appendChild(s),n.addEventListener("mouseenter",()=>{n.style.background="var(--vscode-menu-selectionBackground)",n.style.color="var(--vscode-menu-selectionForeground)"}),n.addEventListener("mouseleave",()=>{n.style.background="transparent",n.style.color="var(--vscode-menu-foreground)"}),n.addEventListener("click",()=>{let r=!e;this.options.onToggleVisibility?.(t.id,r),r?this.options.visibleFieldIds.add(t.id):this.options.visibleFieldIds.delete(t.id),this.menuElement&&(this.menuElement.innerHTML="",this.buildMenu())}),this.menuElement.appendChild(n)}addSeparator(){if(!this.menuElement)return;let t=document.createElement("div");t.style.height="1px",t.style.background="var(--vscode-menu-separatorBackground)",t.style.margin="6px 0",this.menuElement.appendChild(t)}},ee=Q;var J=class{constructor(t,e,n){this.panelElement=null;this.container=t,this.field=e,this.items=n}render(){this.close(),this.panelElement=document.createElement("div"),this.panelElement.className="slice-panel",this.panelElement.style.position="relative",this.panelElement.style.float="left",this.panelElement.style.width="250px",this.panelElement.style.marginRight="12px",this.panelElement.style.background="var(--vscode-sideBar-background)",this.panelElement.style.border="1px solid var(--vscode-sideBar-border)",this.panelElement.style.borderRadius="4px",this.panelElement.style.display="flex",this.panelElement.style.flexDirection="column",this.panelElement.style.overflow="hidden",this.panelElement.style.maxHeight="600px";let t=document.createElement("div");t.style.padding="12px",t.style.borderBottom="1px solid var(--vscode-sideBar-border)",t.style.display="flex",t.style.justifyContent="space-between",t.style.alignItems="center";let e=document.createElement("div");e.textContent=`Slice by ${this.field.name}`,e.style.fontWeight="600",t.appendChild(e);let n=document.createElement("button");n.textContent="\xD7",n.style.background="transparent",n.style.border="none",n.style.fontSize="24px",n.style.cursor="pointer",n.style.color="var(--vscode-foreground)",n.addEventListener("click",()=>this.close()),t.appendChild(n),this.panelElement.appendChild(t);let i=document.createElement("div");i.style.flex="1",i.style.overflow="auto",i.style.padding="8px",this.renderValues(i),this.panelElement.appendChild(i),this.container.appendChild(this.panelElement)}renderValues(t){let e=this.getValueCounts();if(e.size===0){let i=document.createElement("div");i.textContent="No values",i.style.padding="8px",i.style.color="var(--vscode-descriptionForeground)",t.appendChild(i);return}Array.from(e.entries()).sort((i,s)=>s[1].count-i[1].count).forEach(([i,{value:s,count:r}])=>{let l=document.createElement("div");l.className="slice-value-item",l.style.padding="8px 12px",l.style.cursor="pointer",l.style.borderRadius="4px",l.style.marginBottom="4px",l.style.display="flex",l.style.justifyContent="space-between",l.style.alignItems="center";let c=document.createElement("span");c.textContent=i,c.style.flex="1";let p=document.createElement("span");p.textContent=String(r),p.style.background="var(--vscode-badge-background)",p.style.color="var(--vscode-badge-foreground)",p.style.padding="2px 6px",p.style.borderRadius="10px",p.style.fontSize="11px",l.appendChild(c),l.appendChild(p),l.addEventListener("mouseenter",()=>{l.style.background="var(--vscode-list-hoverBackground)"}),l.addEventListener("mouseleave",()=>{l.style.background="transparent"}),l.addEventListener("click",()=>{this.onValueSelectCallback&&this.onValueSelectCallback(s)}),t.appendChild(l)})}getValueCounts(){let t=new Map;return this.items.forEach(e=>{let n=e.fieldValues?.find(l=>l.fieldId===this.field.id||l.fieldName===this.field.name),i=null,s="(empty)";n&&(i=this.extractValue(n),s=this.formatValue(i));let r=t.get(s);r?r.count++:t.set(s,{value:i,count:1})}),t}extractValue(t){switch((this.field.dataType||"").toLowerCase()){case"text":case"title":return t.text||t.title;case"number":return t.number;case"date":return t.date;case"single_select":return t.option?.name||t.name;case"iteration":return t.title||t.iteration?.title;default:return t.text||t.value||null}}formatValue(t){return t==null?"(empty)":String(t)}onValueSelect(t){this.onValueSelectCallback=t}close(){this.panelElement&&(this.panelElement.remove(),this.panelElement=null)}};function ie(o){if(!o||!o.nodes||o.nodes.length===0)return null;let t=o.nodes[0];if(!t||!t.field)return null;let e={fieldId:t.field.id||t.field.name,direction:t.direction||"ASC"};if(o.nodes.length>1){let n=o.nodes[1];n&&n.field&&(e.secondary={fieldId:n.field.id||n.field.name,direction:n.direction||"ASC"})}return e}function K(o,t,e){if(!e||o.length===0)return o;let n=t.find(s=>s.id===e.fieldId||s.name===e.fieldId);if(!n)return o;let i=[...o];return i.sort((s,r)=>{let l=te(s,r,n,e.direction);if(l===0&&e.secondary){let c=t.find(p=>p.id===e.secondary.fieldId||p.name===e.secondary.fieldId);if(c)return te(s,r,c,e.secondary.direction)}return l}),i}function te(o,t,e,n){let i=ne(o,e),s=ne(t,e);if(i===null&&s===null)return 0;if(i===null)return n==="ASC"?1:-1;if(s===null)return n==="ASC"?-1:1;let r=0;switch((e.dataType||"").toLowerCase()){case"text":case"title":r=U(i,s);break;case"number":r=de(i,s);break;case"date":r=se(i,s);break;case"single_select":r=ce(i,s,e);break;case"iteration":r=pe(i,s);break;case"labels":r=ue(i,s);break;default:r=String(i).localeCompare(String(s))}return n==="ASC"?r:-r}function ne(o,t){let e=o.fieldValues?.find(i=>i.fieldId===t.id||i.fieldName===t.name);if(!e)return null;switch((t.dataType||"").toLowerCase()){case"text":case"title":return e.text||e.title||null;case"number":return e.number!==void 0?e.number:null;case"date":return e.date||e.startDate||e.dueOn||null;case"single_select":return e.option||e;case"iteration":return e;case"labels":return e.labels||[];default:return e}}function U(o,t){let e=String(o||"").toLowerCase(),n=String(t||"").toLowerCase();return e.localeCompare(n)}function de(o,t){let e=typeof o=="number"?o:parseFloat(o),n=typeof t=="number"?t:parseFloat(t);return isNaN(e)&&isNaN(n)?0:isNaN(e)?1:isNaN(n)?-1:e-n}function se(o,t){let e=new Date(o),n=new Date(t);return isNaN(e.getTime())&&isNaN(n.getTime())?0:isNaN(e.getTime())?1:isNaN(n.getTime())?-1:e.getTime()-n.getTime()}function ce(o,t,e){let n=o.option||o,i=t.option||t;if(!n||!i)return U(n?.name||"",i?.name||"");if(e.options&&Array.isArray(e.options)){let s=e.options.findIndex(l=>l.id===n.id||l.name===n.name),r=e.options.findIndex(l=>l.id===i.id||l.name===i.name);if(s!==-1&&r!==-1)return s-r}return U(n.name,i.name)}function pe(o,t){let e=o.startDate||o.iteration?.startDate,n=t.startDate||t.iteration?.startDate;return!e&&!n?U(o.title||o.iteration?.title,t.title||t.iteration?.title):se(e,n)}function ue(o,t){let e=Array.isArray(o)?o:[],n=Array.isArray(t)?t:[];return e.length===0&&n.length===0?0:e.length===0?1:n.length===0?-1:U(e[0].name,n[0].name)}var X=class{constructor(t,e,n,i={}){this.activeMenu=null;this.activeFieldsMenu=null;this.activeSlicePanel=null;this.activeSlice=null;this.container=t,this.allFields=(e||[]).map(l=>({...l,id:String(l.id)})),this.options=i,this.items=n;let s=this.loadHiddenFields().map(l=>String(l)),r=(i.hiddenFields||[]).map(l=>String(l));this.hiddenFieldIds=new Set([...s,...r]),this.fields=this.allFields.filter(l=>!this.hiddenFieldIds.has(l.id));try{console.debug("[ProjectTable] init: allFieldIds=",this.allFields.map(l=>l.id)),console.debug("[ProjectTable] init: hiddenFieldIds=",Array.from(this.hiddenFieldIds)),console.debug("[ProjectTable] init: visibleFieldIds=",this.fields.map(l=>l.id))}catch{}try{let l={allFieldIds:this.allFields.map(c=>String(c.id)),hiddenFieldIds:Array.from(this.hiddenFieldIds),visibleFieldIds:this.fields.map(c=>String(c.id))};window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"debugLog",level:"debug",message:"ProjectTable init",data:l,viewKey:this.options.viewKey})}catch{}this.applyFieldOrder()}render(){this.container.innerHTML="";let t=document.createElement("div");t.style.overflowX="auto",t.style.overflowY="auto",t.style.width="100%",t.style.display="block",t.style.height="100%";let e=document.createElement("table");e.style.borderCollapse="separate",e.style.borderSpacing="0",e.style.tableLayout="fixed",e.style.width="100%",this.renderColGroup(e),this.renderHeader(e),this.renderBody(e),t.appendChild(e),this.container.appendChild(t),this.setupResizers(e)}renderColGroup(t){let e=document.createElement("colgroup"),n=document.createElement("col");n.style.width="40px",e.appendChild(n);for(let s of this.fields){let r=document.createElement("col");r.style.width="150px",r.dataset.fieldId=s.id,e.appendChild(r)}let i=document.createElement("col");i.style.width="50px",e.appendChild(i),t.appendChild(e)}renderHeader(t){let e=document.createElement("thead");e.style.background="var(--vscode-sideBar-background)",e.style.position="sticky",e.style.top="0",e.style.zIndex="10";let n=document.createElement("tr"),i=document.createElement("th");i.textContent="#",this.styleHeaderCell(i),n.appendChild(i);for(let l of this.fields){let c=document.createElement("th"),p=document.createElement("div");p.style.display="flex",p.style.alignItems="center",p.style.justifyContent="space-between",p.style.width="100%",p.style.gap="4px";let u=document.createElement("span"),w=l.name||l.id||"";if(this.options.sortConfig?.fieldId===l.id){let A=this.options.sortConfig?.direction==="ASC"?" \u2191":" \u2193";w+=A}u.textContent=w,u.style.flex="1",u.style.overflow="hidden",u.style.textOverflow="ellipsis",u.style.whiteSpace="nowrap";let F=l.name?.toLowerCase()===this.options.groupingFieldName?.toLowerCase(),S=this.activeSlice?.fieldId===l.id,I=document.createElement("span");if(I.style.display="flex",I.style.alignItems="center",I.style.gap="2px",F||S){let A=document.createElement("span");A.innerHTML='<svg aria-hidden="true" height="12" viewBox="0 0 16 16" version="1.1" width="12" data-view-component="true" class="octicon octicon-filter"><path fill="currentColor" d="M.75 3h14.5a.75.75 0 0 1 .75.75v2a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1-.75-.75v-2a.75.75 0 0 1 .75-.75zm0 1.5v.5h14.5v-.5H.75zM5 9.75A.75.75 0 0 1 5.75 9h4.5a.75.75 0 0 1 .75.75v2a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-2zm1.5.5v.5h3v-.5h-3z"></path></svg>',A.style.display="flex",A.style.alignItems="center",A.style.color="var(--vscode-foreground)",A.style.opacity="0.7",A.title=F?"Grouped by this field":"Sliced by this field";let x=A.querySelector("svg");x&&(x.style.fill="currentColor"),I.appendChild(A)}let L=document.createElement("button");L.textContent="\u22EE",L.style.background="transparent",L.style.border="none",L.style.cursor="pointer",L.style.fontSize="16px",L.style.padding="2px 4px",L.style.color="var(--vscode-foreground)",L.style.opacity="0.6",L.style.borderRadius="3px",L.title=`${l.name} options`,L.addEventListener("mouseenter",()=>{L.style.opacity="1",L.style.background="var(--vscode-toolbar-hoverBackground)"}),L.addEventListener("mouseleave",()=>{L.style.opacity="0.6",L.style.background="transparent"}),L.addEventListener("click",A=>{A.stopPropagation(),c.style.background="var(--vscode-sideBar-background)",this.showHeaderMenu(A,l,c)}),p.appendChild(u),(F||S)&&p.appendChild(I),p.appendChild(L),c.appendChild(p),c.addEventListener("pointerenter",()=>{c.style.background="var(--vscode-list-hoverBackground)"}),c.addEventListener("pointerleave",()=>{c.style.background="var(--vscode-sideBar-background)"}),this.styleHeaderCell(c),n.appendChild(c)}let s=document.createElement("th"),r=document.createElement("button");r.textContent="+",r.style.background="transparent",r.style.border="none",r.style.cursor="pointer",r.style.fontSize="18px",r.style.fontWeight="bold",r.style.color="var(--vscode-foreground)",r.style.width="100%",r.style.height="100%",r.title="Show hidden fields",r.addEventListener("click",()=>this.showFieldsMenu(r)),s.appendChild(r),this.styleHeaderCell(s),s.style.textAlign="center",s.style.width="50px",n.appendChild(s),e.appendChild(n),t.appendChild(e)}showFieldsMenu(t){this.activeMenu&&(this.activeMenu.hide(),this.activeMenu=null),this.activeFieldsMenu&&(this.activeFieldsMenu.hide(),this.activeFieldsMenu=null);let e=new Set(this.allFields.filter(i=>!this.hiddenFieldIds.has(String(i.id))).map(i=>String(i.id)));try{console.debug("[ProjectTable] showFieldsMenu: hiddenFieldIds=",Array.from(this.hiddenFieldIds)),console.debug("[ProjectTable] showFieldsMenu: allFieldIds=",this.allFields.map(i=>i.id))}catch{}let n=new ee({fields:this.allFields.map(i=>({id:i.id,name:i.name,iconClass:i.iconClass})),visibleFieldIds:e,onToggleVisibility:(i,s)=>{s?this.showField(i):this.hideField(i)},onCreateField:()=>{try{console.log("Create field requested")}catch{}}});this.activeFieldsMenu=n,n.show(t)}styleHeaderCell(t){t.style.padding="8px",t.style.textAlign="left",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.textOverflow="ellipsis",t.style.borderRight="1px solid var(--vscode-panel-border)",t.style.borderBottom="1px solid var(--vscode-panel-border)",t.style.position="sticky",t.style.top="0",t.style.zIndex="11",t.style.background="var(--vscode-sideBar-background)",t.style.height="32px",t.style.boxSizing="border-box"}renderBody(t){let e=document.createElement("tbody"),n=this.items;this.options.sortConfig&&(n=K(this.items,this.fields,this.options.sortConfig)),this.activeSlice&&(n=n.filter(s=>{let r=s.fieldValues.find(c=>String(c.fieldId)===String(this.activeSlice.fieldId));if(!r)return this.activeSlice.value===null;let l=null;return r.text!==void 0?l=r.text:r.title!==void 0?l=r.title:r.number!==void 0?l=r.number:r.date!==void 0?l=r.date:r.option?l=r.option.name:r.iteration?l=r.iteration.title:l=r.value,l===this.activeSlice.value}));let i=this.getGroupingField();i?this.renderGroupedRows(e,i,n):this.renderFlatRows(e,n),t.appendChild(e)}getGroupingField(){return this.options.groupingFieldName?this.fields.find(t=>t.name&&t.name.toLowerCase()===this.options.groupingFieldName?.toLowerCase()||t.id&&t.id===this.options.groupingFieldName):null}renderFlatRows(t,e){e.forEach((n,i)=>{let s=this.createRow(n,i);t.appendChild(s)})}renderGroupedRows(t,e,n){let i=this.groupItems(n,e);for(let s of i){let r=document.createElement("tr"),l=document.createElement("td");l.colSpan=this.fields.length+1,l.style.padding="8px",l.style.background="var(--vscode-editor-background)",l.style.fontWeight="600",l.style.borderTop="1px solid var(--vscode-editorGroup-border)",l.style.borderBottom="1px solid var(--vscode-editorGroup-border)",l.style.position="sticky",l.style.top="32px",l.style.zIndex="9",l.style.boxShadow="0 1px 2px rgba(0,0,0,0.1)";let c=document.createElement("div");c.style.display="flex",c.style.alignItems="center",c.style.gap="8px";let p=e,u=this.fields.find(d=>d.dataType&&String(d.dataType).toLowerCase()==="number"&&String(d.name||"").toLowerCase().includes("estimate"))||this.fields.find(d=>d.dataType&&String(d.dataType).toLowerCase()==="number"),w=u?u.id:null,F=d=>{if(!w)return 0;let m=0;for(let _ of d){let N=_.item||_;if(!N||!Array.isArray(N.fieldValues))continue;let f=N.fieldValues.find(M=>M.fieldId&&String(M.fieldId)===String(w)||M.fieldName&&String(M.fieldName).toLowerCase().includes("estimate")||M.type==="number");if(f){let M=Number(f.number!=null?f.number:f.value!=null?f.value:NaN);isNaN(M)||(m+=M)}}return m},S=d=>isFinite(d)?String(d):"",I=document.createElement("span"),L='<svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-triangle-down"><path d="M4.427 7.427l3.396 3.396a.25.25 0 00.354 0l3.396-3.396A.25.25 0 0011.396 7H4.604a.25.25 0 00-.177.427z"></path></svg>',A='<svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-triangle-right"><path d="M8.573 4.604a.25.25 0 01.427-.177l3.396 3.396a.25.25 0 010 .354l-3.396 3.396a.25.25 0 01-.427-.177V4.604z"></path></svg>';I.innerHTML=L,I.style.cursor="pointer",I.style.userSelect="none",I.style.display="inline-flex",I.style.alignItems="center",I.style.justifyContent="center",I.style.width="16px",I.style.height="16px",I.style.fill="var(--vscode-foreground)",I.style.opacity="0.7";let x=document.createElement("div");x.style.width="12px",x.style.height="12px",x.style.borderRadius="50%",x.style.backgroundColor=O(s.option.color)||"gray";let P=document.createElement("span");P.textContent=s.option.name||s.option.title||"Unassigned";let $=document.createElement("vscode-badge");$.textContent=String(s.items.length);let a=document.createElement("div");a.style.display="flex",a.style.alignItems="center",a.style.gap="8px",a.style.position="sticky",a.style.left="0",a.style.zIndex="12",a.style.background=l.style.background,a.style.paddingRight="8px";let E=document.createElement("div");E.style.display="flex",E.style.alignItems="center",E.style.gap="8px",E.style.flex="1",a.appendChild(I);let y=null,C=null;if(String(e.dataType||"").toLowerCase()==="parent_issue"){let d=s.items&&s.items[0]?s.items[0].item||s.items[0]:null;if(d&&Array.isArray(d.fieldValues)){let m=d.fieldValues.find(_=>String(_.fieldId)===String(e.id)||_.fieldName===e.name||_.type==="parent_issue");m&&(y=m.parent||m.parentIssue||m.issue||m.item||m.value||null)}if(y&&Array.isArray(this.items))try{let m=[];y.number&&m.push(String(y.number)),y.id&&m.push(String(y.id)),y.url&&m.push(String(y.url)),y.title&&m.push(String(y.title));let _=this.items.find(N=>{let f=N&&(N.content||N.raw&&N.raw.itemContent)||null;if(!f)return!1;let M=[];f.number&&M.push(String(f.number)),f.id&&M.push(String(f.id)),f.url&&M.push(String(f.url)),f.title&&M.push(String(f.title)),f.name&&M.push(String(f.name)),f.raw&&f.raw.number&&M.push(String(f.raw.number)),f.raw&&f.raw.id&&M.push(String(f.raw.id)),f.raw&&f.raw.url&&M.push(String(f.raw.url));for(let R of m)for(let W of M)if(R&&W&&String(R)===String(W))return!0;return!1});_&&(C=_)}catch{}}if(s.option&&s.option.avatarUrl||s.option&&s.option.login||s.option&&s.option.name&&String(e.dataType||"").toLowerCase()==="assignees"){let d=document.createElement("span"),m=s.option&&(s.option.avatarUrl||s.option.avatar||s.option.imageUrl)||(()=>{for(let _ of s.items){let N=_.item||_;if(!N||!Array.isArray(N.fieldValues))continue;let f=N.fieldValues.find(M=>M.type==="assignees"||String(M.fieldId)===String(e.id));if(f&&f.assignees&&Array.isArray(f.assignees)){let M=f.assignees.find(R=>String(R.login||R.name)===String(s.option.name||s.option.id));if(M&&(M.avatarUrl||M.avatar))return M.avatarUrl||M.avatar}}return null})();m?(d.innerHTML='<span title="'+g(s.option&&(s.option.login||s.option.name)||"Assignee")+'" style="display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url('+g(m)+');border:2px solid var(--vscode-editor-background)"></span>',a.appendChild(d)):a.appendChild(x)}else if(String(e.dataType||"").toLowerCase()==="repository"){let d=document.createElement("span");d.innerHTML='<svg width="14" height="14" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;color:var(--vscode-icon-foreground)"><path fill="currentColor" d="M2 2.5A1.5 1.5 0 0 1 3.5 1h9A1.5 1.5 0 0 1 14 2.5v11A1.5 1.5 0 0 1 12.5 15h-9A1.5 1.5 0 0 1 2 13.5v-11zM3.5 2A.5.5 0 0 0 3 2.5V4h10V2.5a.5.5 0 0 0-.5-.5h-9z"/></svg>',a.appendChild(d)}else a.appendChild(x);if(C){let d=C.content||C.raw&&C.raw.itemContent||null;if(d){try{d.title?P.textContent=String(d.title):d.name?P.textContent=String(d.name):d.number&&(P.textContent=String(d.number))}catch{}if(Array.isArray(C.fieldValues)){let m=C.fieldValues.find(_=>_&&_.type==="single_select"&&_.option&&_.option.name);if(m&&m.option)try{let _=m.option.color||m.option.id||m.option.name||null;_&&(x.style.backgroundColor=O(_)||x.style.backgroundColor)}catch{}}}}else if(y&&(P.textContent=y.title||y.name||y.number||y.id||P.textContent,y.color))try{x.style.backgroundColor=O(y.color)||x.style.backgroundColor}catch{}a.appendChild(P);let h=document.createElement("span");h.style.display="inline-flex",h.style.alignItems="center",h.style.justifyContent="center",h.style.width="22px",h.style.height="22px",h.style.borderRadius="50%",h.style.background="var(--vscode-input-background)",h.style.border="1px solid var(--vscode-panel-border)",h.style.color="var(--vscode-foreground)",h.style.fontSize="12px",h.style.fontWeight="600",h.style.minWidth="22px",h.style.boxSizing="border-box",h.textContent=String(s.items.length||0),a.appendChild(h);let H=F(s.items||[]);if(H&&H>0){let d=document.createElement("div");if(d.style.display="inline-block",d.style.padding="2px 8px",d.style.borderRadius="999px",d.style.border="1px solid var(--vscode-panel-border)",d.style.background="var(--vscode-input-background)",d.style.color="var(--vscode-foreground)",d.style.fontSize="12px",d.style.lineHeight="18px",d.style.marginLeft="8px",d.textContent="Estimate: "+S(H),a.appendChild(d),String(e.dataType||"").toLowerCase()==="parent_issue"&&!(s.option&&(s.option.name==="Unassigned"||s.option.title==="Unassigned"))){let m=["done","closed","completed","finished"],_=T=>{try{let v=T&&(T.content||T.raw&&T.raw.itemContent);if(v){let B=(v.state||(v.merged?"MERGED":void 0)||"").toString().toUpperCase();if(B==="CLOSED"||B==="MERGED")return!0}if(Array.isArray(T.fieldValues)){if(T.fieldValues.find(z=>z&&z.type==="single_select"&&z.option&&z.option.name&&m.includes(String(z.option.name).toLowerCase())))return!0;let V=T.fieldValues.find(z=>z&&(String(z.fieldName||"").toLowerCase().includes("progress")||String(z.fieldName||"").toLowerCase().includes("percent")||z.type==="number"&&String(z.fieldName||"").toLowerCase().includes("progress")));if(V&&V.number!=null&&Number(V.number||0)>=100)return!0}if(v&&v.labels&&Array.isArray(v.labels.nodes)){let B=v.labels.nodes.map(V=>String(V.name||"").toLowerCase());for(let V of m)if(B.includes(V))return!0}}catch{}return!1},N=0,f=0;if(C&&Array.isArray(C.fieldValues)){let T=C.fieldValues.find(v=>v&&(v.type==="sub_issues_progress"||v.total!=null&&v.done!=null));T&&T.total!=null&&(f=Number(T.total||0),N=Number(T.done||0))}if(!f)for(let T of s.items){let v=T.item||T;v&&(f++,_(v)&&N++)}let M=document.createElement("div");M.style.color="var(--vscode-descriptionForeground)",M.style.fontSize="12px",M.style.marginLeft="8px",M.style.fontVariantNumeric="tabular-nums",M.textContent=`${N}/${f}`,a.appendChild(M);let R=document.createElement("div");R.style.display="inline-flex",R.style.alignItems="center",R.style.gap="8px",R.style.marginLeft="8px";let W=f>0?Math.round(N/f*100):0,G=document.createElement("div");G.style.display="inline-block",G.style.width="120px",G.style.height="12px",G.style.background="transparent",G.style.border="1px solid var(--vscode-focusBorder)",G.style.borderRadius="6px",G.style.overflow="hidden";let D=document.createElement("div");D.style.height="100%",D.style.width=String(W)+"%",D.style.background="var(--vscode-focusBorder)",G.appendChild(D),R.appendChild(G),a.appendChild(R)}}if(String(e.dataType||"").toLowerCase()==="single_select")try{let d=(e.options||[]).find(m=>String(m.name)===String(s.option&&s.option.name));if(d&&d.description){let m=document.createElement("div");m.style.color="var(--vscode-descriptionForeground)",m.style.fontSize="12px",m.style.marginLeft="8px",m.textContent=String(d.description).slice(0,120),a.appendChild(m)}}catch{}if(String(e.dataType||"").toLowerCase()==="iteration")try{let d=s.option||{},m=null,_=d.startDate||d.start&&d.startDate||null,N=d.duration||d.length||null;if(_&&N)try{let f=new Date(_),M=Number(N)||0,R=new Date(f.getTime()+M*24*60*60*1e3),W=f.toLocaleDateString("en-US",{month:"short",day:"numeric"}),G=R.toLocaleDateString("en-US",{month:"short",day:"numeric"});m=`${W} \u2014 ${G}`}catch{m=null}if(m||(m=d.title||d.name?String(d.title||d.name):null),m){let f=document.createElement("div");f.style.color="var(--vscode-descriptionForeground)",f.style.fontSize="12px",f.style.marginLeft="8px",f.textContent=String(m).slice(0,120),a.appendChild(f)}}catch{}s.option&&(s.option.name==="Unassigned"||s.option.title==="Unassigned")&&(P.textContent="No "+(e.name||"value")),c.appendChild(a),c.appendChild(E),l.appendChild(c),r.appendChild(l),t.appendChild(r);let k=[];s.items.forEach(d=>{let m=this.createRow(d.item,d.index);m.classList.add("group-row-"+s.option.id),t.appendChild(m),k.push(m)});let b=!1;I.addEventListener("click",()=>{b=!b,I.innerHTML=b?A:L,k.forEach(d=>{d.style.display=b?"none":"table-row"})})}}groupItems(t,e){let n=[],i=(e.dataType||"").toLowerCase();if(i==="single_select"?n=e.options||[]:i==="iteration"&&(n=e.configuration&&e.configuration.iterations||[]),n&&n.length>0){let c=n.map(u=>({option:u,items:[]})),p=[];return t.forEach((u,w)=>{let F=u.fieldValues.find(I=>String(I.fieldId)===String(e.id)||I.fieldName===e.name),S=!1;if(F){let I=null,L=null;if(i==="single_select"?(I=F.optionId||F.option&&F.option.id,L=F.name||F.option&&F.option.name):i==="iteration"&&(I=F.iterationId||F.iteration&&F.iteration.id||F.id,L=F.title||F.iteration&&F.iteration.title),I||L){let A=c.find(x=>I&&String(x.option.id)===String(I)||L&&(String(x.option.name)===String(L)||String(x.option.title)===String(L)));A&&(A.items.push({item:u,index:w}),S=!0)}}S||p.push({item:u,index:w})}),p.length>0&&c.push({option:{name:"Unassigned",title:"Unassigned",color:"GRAY"},items:p}),c.filter(u=>u.items.length>0)}let s=new Map,r=[];t.forEach((c,p)=>{let u=c.fieldValues.find(S=>String(S.fieldId)===String(e.id)||S.fieldName===e.name),w=null;if(u)if(u.text!==void 0)w=u.text;else if(u.title!==void 0)w=u.title;else if(u.number!==void 0)w=u.number;else if(u.date!==void 0)w=u.date;else if(u.option)w=u.option.name||u.option.title||u.option.id;else if(u.iteration)w=u.iteration.title||u.iteration.id;else if(u.parent||u.parentIssue||u.issue||u.item||u.value){let S=u.parent||u.parentIssue||u.issue||u.item||u.value;S&&(w=S.number||S.id||S.raw&&(S.raw.number||S.raw.id)||S.url||S.title||S.name||null)}else u.assignees?w=Array.isArray(u.assignees)?u.assignees.map(S=>S.login||S.name).join(", "):u.assignees:u.repository?w=u.repository.nameWithOwner||u.repository.name||u.repository.full_name||u.repository.id:u.milestone?w=u.milestone.title||u.milestone.id||u.milestone.name:w=u.value!==void 0?u.value:null;if(w==null||w===""){r.push({item:c,index:p});return}let F=String(w);s.has(F)||s.set(F,{option:{id:F,name:F,title:F},items:[]}),s.get(F).items.push({item:c,index:p})});let l=Array.from(s.values());return r.length>0&&l.push({option:{name:"Unassigned",title:"Unassigned",color:"GRAY"},items:r}),l}createRow(t,e){let n=document.createElement("tr");n.setAttribute("data-gh-item-id",t.id),n.style.transition="background-color 0.15s ease",n.addEventListener("mouseenter",()=>{n.style.backgroundColor="var(--vscode-list-hoverBackground)"}),n.addEventListener("mouseleave",()=>{n.style.backgroundColor="transparent"});let i=document.createElement("td");i.textContent=String(e+1),this.styleCell(i),n.appendChild(i);for(let s=0;s<this.fields.length;s++){let r=this.fields[s],l=document.createElement("td");this.styleCell(l);let c=t.fieldValues.find(u=>String(u.fieldId)===String(r.id)||u.fieldName===r.name);c&&(l.innerHTML=Z(c,r,t,this.items)),l.style.position="relative";let p=document.createElement("div");p.className="column-resizer",p.style.position="absolute",p.style.top="0",p.style.right="0",p.style.width="6px",p.style.height="100%",p.style.cursor="col-resize",p.style.userSelect="none",p.style.zIndex="50",p.addEventListener("mouseenter",()=>p.style.background="var(--vscode-focusBorder)"),p.addEventListener("mouseleave",()=>p.style.background="transparent"),p.addEventListener("mousedown",u=>{u.preventDefault(),u.stopPropagation();let w=this.container.querySelector("table");if(!w)return;let S=w.querySelectorAll("col")[s+1],I=S?parseInt(S.style.width)||S.offsetWidth:l.offsetWidth;this.beginColumnResize(w,s+1,u.pageX,I)}),l.appendChild(p),n.appendChild(l)}return n}styleCell(t){t.style.padding="8px",t.style.borderRight="1px solid var(--vscode-panel-border)",t.style.borderBottom="1px solid var(--vscode-panel-border)",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.textOverflow="ellipsis"}showHeaderMenu(t,e,n){t.stopPropagation(),this.activeMenu&&this.activeMenu.hide();let i=(e.dataType||"").toLowerCase(),s=new Set(["assignees","single_select","parent_issue","iteration","number","date","milestone","repository"]),r=new Set(["assignees","single_select","parent_issue","iteration","number","date","milestone","repository","labels"]),l=s.has(i),c=r.has(i),p=!!(this.options.groupingFieldName&&e.name&&e.name.toLowerCase()===this.options.groupingFieldName.toLowerCase()),u=!!(this.activeSlice&&this.activeSlice.fieldId===e.id),w=this.options.sortConfig&&this.options.sortConfig.fieldId===e.id?this.options.sortConfig.direction:null;this.activeMenu=new q(e,{canGroup:l,canSlice:c,canFilter:!1,isGrouped:p,isSliced:u,currentSort:w,onSort:F=>this.handleSort(e,F),onClearSort:()=>this.clearSort(e),onGroup:()=>this.handleGroup(e),onClearGroup:()=>this.clearGroup(e),onSlice:()=>this.handleSlice(e),onClearSlice:()=>this.clearSlice(e),onHide:()=>this.hideField(e.id),onMove:F=>this.handleMove(e,F)}),this.activeMenu.show(n)}clearGroup(t){if(this.options.groupingFieldName=void 0,this.options.onGroupChange)try{this.options.onGroupChange("")}catch{}this.render()}clearSlice(t){this.activeSlice=null,this.activeSlicePanel&&(this.activeSlicePanel.close(),this.activeSlicePanel=null),this.render(),this.options.onSliceChange&&this.options.onSliceChange(null)}clearSort(t){let e=this.getStorageKey("sortConfig");e&&localStorage.removeItem(e),this.options.onSortChange&&this.options.onSortChange(null)}showHiddenFieldsMenu(t){this.activeMenu&&this.activeMenu.hide();let e=this.allFields.filter(c=>this.hiddenFieldIds.has(String(c.id)));if(e.length===0){let c=document.createElement("div");c.textContent="No hidden fields",c.style.position="absolute",c.style.background="var(--vscode-menu-background)",c.style.border="1px solid var(--vscode-menu-border)",c.style.borderRadius="4px",c.style.padding="12px",c.style.fontSize="13px",c.style.color="var(--vscode-descriptionForeground)",c.style.zIndex="1000";let p=t.getBoundingClientRect();c.style.top=`${p.bottom+4}px`,c.style.left=`${p.left}px`,document.body.appendChild(c),setTimeout(()=>c.remove(),2e3);return}let n=document.createElement("div");n.style.position="absolute",n.style.background="var(--vscode-menu-background)",n.style.border="1px solid var(--vscode-menu-border)",n.style.borderRadius="4px",n.style.padding="4px 0",n.style.minWidth="180px",n.style.zIndex="1000",n.style.fontSize="13px";let i=t.getBoundingClientRect();n.style.top=`${i.bottom+4}px`,n.style.left=`${i.left}px`;let s=document.createElement("div");s.textContent="Show field",s.style.padding="6px 12px",s.style.fontWeight="600",s.style.color="var(--vscode-descriptionForeground)",s.style.fontSize="11px",s.style.textTransform="uppercase",n.appendChild(s);let r=document.createElement("div");r.style.height="1px",r.style.background="var(--vscode-menu-separatorBackground)",r.style.margin="4px 0",n.appendChild(r),e.forEach(c=>{let p=document.createElement("div");p.textContent=c.name||c.id,p.style.padding="6px 12px",p.style.cursor="pointer",p.style.color="var(--vscode-menu-foreground)",p.addEventListener("mouseenter",()=>{p.style.background="var(--vscode-menu-selectionBackground)",p.style.color="var(--vscode-menu-selectionForeground)"}),p.addEventListener("mouseleave",()=>{p.style.background="transparent",p.style.color="var(--vscode-menu-foreground)"}),p.addEventListener("click",()=>{this.showField(c.id),n.remove(),l.remove()}),n.appendChild(p)});let l=document.createElement("div");l.style.position="fixed",l.style.top="0",l.style.left="0",l.style.right="0",l.style.bottom="0",l.style.zIndex="999",l.addEventListener("click",()=>{n.parentElement&&n.remove(),l.parentElement&&l.remove()}),document.body.appendChild(n),document.body.appendChild(l)}handleSort(t,e){let n={fieldId:t.id,direction:e};this.saveSortConfig(n),this.options.onSortChange&&this.options.onSortChange(n)}handleGroup(t){if(t&&t.name&&(this.options.groupingFieldName=t.name,this.render(),this.options.onGroupChange))try{this.options.onGroupChange(t.name)}catch{}}handleSlice(t){this.activeSlicePanel&&(this.activeSlicePanel.close(),this.activeSlicePanel=null),this.activeSlicePanel=new J(this.container,t,this.items),this.activeSlicePanel.render();let e=this.container.querySelector("table");if(e){let n=this.container.querySelector(".slice-panel");n&&this.container.insertBefore(n,e)}this.activeSlicePanel.onValueSelect(n=>{this.activeSlice={fieldId:t.id,value:n},this.render()}),this.options.onSliceChange&&this.options.onSliceChange(t)}hideField(t){let e=String(t);this.hiddenFieldIds.add(e);try{console.debug("[ProjectTable] hideField -> added",e,"hiddenFieldIds=",Array.from(this.hiddenFieldIds))}catch{}if(this.options.onHiddenFieldsChange){this.fields=this.allFields.filter(n=>!this.hiddenFieldIds.has(n.id));try{this.applyFieldOrder()}catch{}try{this.options.onHiddenFieldsChange(Array.from(this.hiddenFieldIds))}catch{}this.render()}else{this.saveHiddenFields(),this.fields=this.allFields.filter(n=>!this.hiddenFieldIds.has(n.id));try{this.applyFieldOrder()}catch{}this.render()}}showField(t){let e=String(t);this.hiddenFieldIds.delete(e);try{console.debug("[ProjectTable] showField -> removed",e,"hiddenFieldIds=",Array.from(this.hiddenFieldIds))}catch{}if(this.options.onHiddenFieldsChange){this.fields=this.allFields.filter(n=>!this.hiddenFieldIds.has(n.id));try{this.applyFieldOrder()}catch{}try{this.options.onHiddenFieldsChange(Array.from(this.hiddenFieldIds))}catch{}this.render()}else{this.saveHiddenFields(),this.fields=this.allFields.filter(n=>!this.hiddenFieldIds.has(n.id));try{this.applyFieldOrder()}catch{}this.render()}}handleMove(t,e){let n=this.fields.findIndex(i=>i.id===t.id);e==="left"&&n>0?[this.fields[n],this.fields[n-1]]=[this.fields[n-1],this.fields[n]]:e==="right"&&n<this.fields.length-1&&([this.fields[n],this.fields[n+1]]=[this.fields[n+1],this.fields[n]]),this.saveFieldOrder(),this.render()}getStorageKey(t){return this.options.viewKey?`ghProjects.table.${this.options.viewKey}.${t}`:""}loadHiddenFields(){let t=this.getStorageKey("hiddenFields");if(!t)return[];try{let e=localStorage.getItem(t),i=((e?JSON.parse(e):[])||[]).map(s=>String(s));try{console.debug("[ProjectTable] loadHiddenFields ->",i)}catch{}return i}catch{return[]}}saveHiddenFields(){let t=this.getStorageKey("hiddenFields");if(!t)return;let e=Array.from(this.hiddenFieldIds).map(n=>String(n));try{console.debug("[ProjectTable] saveHiddenFields ->",e)}catch{}localStorage.setItem(t,JSON.stringify(e))}saveSortConfig(t){let e=this.getStorageKey("sortConfig");e&&localStorage.setItem(e,JSON.stringify(t))}saveFieldOrder(){let t=this.getStorageKey("fieldOrder");if(!t)return;let e=this.fields.map(n=>n.id);localStorage.setItem(t,JSON.stringify(e))}applyFieldOrder(){let t=this.getStorageKey("fieldOrder");if(t)try{let e=localStorage.getItem(t);if(!e)return;let n=JSON.parse(e),i=[];for(let s of n){let r=this.fields.find(l=>String(l.id)===String(s));r&&i.push(r)}for(let s of this.fields)i.find(r=>r.id===s.id)||i.push(s);this.fields=i}catch{}}setupResizers(t){t.querySelectorAll("th").forEach((n,i)=>{if(i===0)return;let s=document.createElement("div");s.className="column-resizer",s.style.position="absolute",s.style.top="0",s.style.right="0",s.style.width="4px",s.style.height="100%",s.style.cursor="col-resize",s.style.userSelect="none",s.style.zIndex="100",s.addEventListener("mouseenter",()=>{s.style.background="var(--vscode-focusBorder)"}),s.addEventListener("mouseleave",()=>{s.style.background="transparent"});let r=0,l=0;s.addEventListener("mousedown",c=>{c.preventDefault(),c.stopPropagation();let u=t.querySelectorAll("col")[i],w=u?parseInt(u.style.width)||u.offsetWidth:n.offsetWidth;this.beginColumnResize(t,i,c.pageX,w)}),n.style.position="relative",n.appendChild(s)}),this.restoreColumnWidths(t)}saveColumnWidth(t,e){let n=this.getStorageKey("columnWidths");if(n)try{let i=localStorage.getItem(n),s=i?JSON.parse(i):{};s[t]=e,localStorage.setItem(n,JSON.stringify(s))}catch{}}beginColumnResize(t,e,n,i){let s=l=>{let c=Math.max(20,i+(l.pageX-n)),u=t.querySelectorAll("col")[e];u&&(u.style.width=`${c}px`,u.style.minWidth=`${c}px`,u.style.maxWidth=`${c}px`)},r=l=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",r);let c=e-1;if(c>=0&&c<this.fields.length){let u=t.querySelectorAll("col")[e],w=u?parseInt(u.style.width)||u.offsetWidth:void 0;w&&this.saveColumnWidth(this.fields[c].id,w)}};document.addEventListener("mousemove",s),document.addEventListener("mouseup",r)}restoreColumnWidths(t){let e=this.getStorageKey("columnWidths");if(e)try{let n=localStorage.getItem(e);if(!n)return;let i=JSON.parse(n),s=t.querySelectorAll("col");this.fields.forEach((r,l)=>{let c=i[r.id];if(c){let p=s[l+1];p&&(p.style.width=`${c}px`,p.style.minWidth=`${c}px`,p.style.maxWidth=`${c}px`)}})}catch{}}};function oe(o,t){o.innerHTML='<div class="title">'+t+'</div><div class="loading"><em>Loading...</em></div>'}function re(o,t,e){o.innerHTML='<div class="title">'+t+'</div><div style="color:var(--vscode-editor-foreground)">'+e+"</div>"}function le(o){let t=document.createElement("button");return t.type="button",t.textContent="Load more",t.style.marginLeft="8px",t.style.border="1px solid var(--vscode-editorWidget-border)",t.addEventListener("click",()=>{o(),t.disabled=!0,t.textContent="Loading..."}),t}function ae(o,t,e){if(window.filterBarHelper&&typeof window.filterBarHelper.create=="function")try{return window.filterBarHelper.create({parent:o,suffix:e.suffix||t,effFilter:void 0,viewKey:t,step:e.step||50,onLoadMore:e.onLoadMore,onSave:e.onSave,onDiscard:e.onDiscard})}catch{return null}return null}window.tableViewFetcher=function(o,t,e){let n=o&&(o.name||o.id)?o.name||o.id:"Table View";try{oe(t,n)}catch{}let i=30;function s(c){let p=c||{},u=p.fields||[],w=p.items||[],F=w.slice(0,i);t.innerHTML="",t.style.margin="0",t.style.padding="0",t.style.height="100%",t.style.display="flex",t.style.flexDirection="column",t.style.overflow="hidden";let S=document.createElement("div");S.style.flex="0 0 auto",S.style.background="var(--vscode-editor-background)",S.style.zIndex="20",S.style.position="relative",S.style.display="flex",S.style.justifyContent="space-between",S.style.alignItems="center",S.style.width="100%";let I=document.createElement("div");I.style.flex="1 1 auto",I.style.marginRight="8px",S.appendChild(I);let L=null,A=null,x=ae(I,e,{suffix:e?String(e).split(":").pop():"",step:i,onLoadMore:()=>{i+=30,l()},onSave:k=>{try{if(L!==null&&(window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"setViewGrouping",viewKey:e,grouping:L}),L=null),A!==null){let b=Array.from(A);window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"setViewHiddenFields",viewKey:e,hiddenFields:b});try{let d=e?`ghProjects.table.${e}.hiddenFields`:null;d&&localStorage.setItem(d,JSON.stringify(b))}catch{}A=null}}catch{}},onDiscard:()=>{try{L!==null&&(window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"discardViewGrouping",viewKey:e}),L=null),A!==null&&(window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"discardViewHiddenFields",viewKey:e}),A=null,l())}catch{}}});if(x)typeof x.setLoadState=="function"&&x.setLoadState(w.length<i,w.length>=i?"Load more":"All loaded"),typeof x.registerItems=="function"&&x.registerItems(w,{fields:u});else{let k=document.createElement("div");k.className="title",k.textContent=n,k.style.padding="8px",S.appendChild(k);let b=document.createElement("div");if(b.style.padding="8px",w.length>i){let d=le(()=>{i+=30,l()});b.appendChild(d)}else{let d=document.createElement("span");d.textContent="All loaded",d.style.color="var(--vscode-descriptionForeground)",b.appendChild(d)}S.appendChild(b)}t.appendChild(S);let P=document.createElement("div");P.style.flex="1 1 auto",P.style.overflow="hidden",P.style.position="relative",t.appendChild(P);let $=me(p),a=ie(p.details?.sortByFields);if(e)try{let k=localStorage.getItem(`ghProjects.table.${e}.sortConfig`);k&&(a=JSON.parse(k))}catch{}let E=F;a&&(E=K(F,u,a));let y=p.allFields&&Array.isArray(p.allFields)?p.allFields:p.fields||[],C=p.details&&p.details.fields&&Array.isArray(p.details.fields.nodes)?p.details.fields.nodes:null,h;if(C&&Array.isArray(C)){let k=new Set(C.map(b=>String(b.id)));h=(y||[]).map(b=>String(b.id)).filter(b=>!k.has(b))}try{let k={allFieldIds:(y||[]).map(b=>String(b.id)),viewFieldIds:C?C.map(b=>String(b.id)):null,viewHiddenFieldIds:h};window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"debugLog",level:"debug",message:"tableViewFetcher field debug",data:k,viewKey:e})}catch{}new X(P,y,E,{groupingFieldName:$||void 0,sortConfig:a,viewKey:e,hiddenFields:h,onHiddenFieldsChange:k=>{try{if(A=new Set((k||[]).map(b=>String(b))),x&&x.saveBtn&&x.discardBtn)try{x.saveBtn.disabled=!1,x.discardBtn.disabled=!1,x.saveBtn.style.opacity="1",x.saveBtn.style.cursor="pointer",x.discardBtn.style.opacity="1",x.discardBtn.style.cursor="pointer"}catch{}}catch{}},onSortChange:()=>l(),onGroupChange:k=>{try{if(L=k||null,x&&x.saveBtn&&x.discardBtn)try{x.saveBtn.disabled=!1,x.discardBtn.disabled=!1,x.saveBtn.style.opacity="1",x.saveBtn.style.cursor="pointer",x.discardBtn.style.opacity="1",x.discardBtn.style.cursor="pointer"}catch{}}catch{}}}).render(),x&&typeof x.onFilterChange=="function"&&x.onFilterChange(k=>{P.querySelectorAll("tr[data-gh-item-id]").forEach(d=>{let m=d.getAttribute("data-gh-item-id");m&&k.has(m)?d.style.display="table-row":d.style.display="none"})})}function r(c){let p=c&&c.data?c.data:c;try{if(p&&p.command==="fields"){if(p.viewKey&&e&&String(p.viewKey)!==String(e))return;p.error?re(t,n,String(p.error)):s(p.payload)}}catch{}}function l(){try{window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"requestFields",first:i,viewKey:e})}catch{}}try{window.__APP_MESSAGING__.onMessage(r)}catch{window.addEventListener("message",r)}l()};function me(o){try{if(o&&o.details){let t=o.details.verticalGroupByFields&&o.details.verticalGroupByFields.nodes,e=o.details.groupByFields&&o.details.groupByFields.nodes;if(t&&t.length>0)return t[0].name||null;if(e&&e.length>0)return e[0].name||null}}catch{}return null}})();
//# sourceMappingURL=tableViewFetcher.js.map
