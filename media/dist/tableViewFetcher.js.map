{
  "version": 3,
  "sources": ["../../src/webviews/client/components/ColumnHeaderMenu.ts", "../../src/webviews/client/renderers/columnHeaderRenderer.ts", "../../src/webviews/client/components/FieldsMenu.ts", "../../src/webviews/client/utils.ts", "../../src/webviews/client/components/SlicePanel.ts", "../../src/webviews/client/utils/tableSorting.ts", "../../src/webviews/client/services/GroupDataService.ts", "../../src/webviews/client/icons/iconRegistry.ts", "../../src/webviews/client/renderers/strategies.ts", "../../src/webviews/client/renderers/cellRenderer.ts", "../../src/webviews/client/components/BasePicker.ts", "../../src/webviews/client/components/LabelsPicker.ts", "../../src/webviews/client/components/AssigneesPicker.ts", "../../src/webviews/client/components/ReviewersPicker.ts", "../../src/webviews/client/components/MilestonePicker.ts", "../../src/webviews/client/editors/CellEditor.ts", "../../src/webviews/client/editors/TextCellEditor.ts", "../../src/webviews/client/editors/NumberCellEditor.ts", "../../src/webviews/client/editors/DateCellEditor.ts", "../../src/webviews/client/editors/EditorManager.ts", "../../src/webviews/client/renderers/RowRenderer.ts", "../../src/webviews/client/renderers/GroupRenderer.ts", "../../src/webviews/client/components/TableResizer.ts", "../../src/webviews/client/components/FieldDropdown.ts", "../../src/webviews/client/components/InteractiveCellManager.ts", "../../src/webviews/client/components/TableKeyboardNavigator.ts", "../../src/webviews/client/components/ProjectTable.ts", "../../src/webviews/client/utils/domUtils.ts", "../../src/webviews/client/viewFetcherUtils.ts", "../../src/webviews/client/tableViewFetcher.ts"],
  "sourcesContent": ["/**\r\n * Column Header Dropdown Menu Component\r\n * Shows context menu when clicking column header with actions like sort, group, slice, hide, move\r\n */\r\n\r\nexport interface MenuOptions {\r\n  canGroup: boolean;\r\n  canSlice: boolean;\r\n  canFilter: boolean;\r\n  isGrouped?: boolean;\r\n  isSliced?: boolean;\r\n  currentSort?: \"ASC\" | \"DESC\" | null;\r\n  onSort?: (direction: \"ASC\" | \"DESC\") => void;\r\n  onGroup?: () => void;\r\n  onSlice?: () => void;\r\n  onClearGroup?: () => void;\r\n  onClearSlice?: () => void;\r\n  onClearSort?: () => void;\r\n  onHide?: () => void;\r\n  onMove?: (direction: \"left\" | \"right\") => void;\r\n  onFilter?: () => void;\r\n  // positional info for disabling move actions\r\n  isFirst?: boolean;\r\n  isLast?: boolean;\r\n}\r\n\r\nexport class ColumnHeaderMenu {\r\n  private field: any;\r\n  private options: MenuOptions;\r\n  private menuElement: HTMLElement | null = null;\r\n  private backdropElement: HTMLElement | null = null;\r\n\r\n  constructor(field: any, options: MenuOptions) {\r\n    this.field = field;\r\n    this.options = options;\r\n  }\r\n\r\n  /**\r\n   * Helper to get icon SVG from registry\r\n   * Note: iconName is a runtime string value, so we use 'as any' to bypass\r\n   * the IconName type check. This is safe because the function validates the icon name.\r\n   */\r\n  private getIconSvg(iconName: string): string {\r\n    if (window.getIconSvg) {\r\n      return window.getIconSvg(iconName as any);\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  /**\r\n   * Show the menu anchored below the header element\r\n   */\r\n  public show(anchorElement: HTMLElement): void {\r\n    // Hide any existing menu\r\n    this.hide();\r\n\r\n    // Create backdrop to detect outside clicks\r\n    this.backdropElement = document.createElement(\"div\");\r\n    this.backdropElement.style.position = \"fixed\";\r\n    this.backdropElement.style.top = \"0\";\r\n    this.backdropElement.style.left = \"0\";\r\n    this.backdropElement.style.right = \"0\";\r\n    this.backdropElement.style.bottom = \"0\";\r\n    this.backdropElement.style.zIndex = \"999\";\r\n    this.backdropElement.addEventListener(\"click\", () => this.hide());\r\n    document.body.appendChild(this.backdropElement);\r\n\r\n    // Create menu\r\n    this.menuElement = document.createElement(\"div\");\r\n    this.menuElement.className = \"column-header-menu\";\r\n    this.menuElement.style.position = \"absolute\";\r\n    this.menuElement.style.background = \"var(--vscode-menu-background)\";\r\n    this.menuElement.style.border = \"1px solid var(--vscode-menu-border)\";\r\n    this.menuElement.style.borderRadius = \"4px\";\r\n    this.menuElement.style.boxShadow = \"0 2px 8px rgba(0, 0, 0, 0.15)\";\r\n    this.menuElement.style.minWidth = \"180px\";\r\n    this.menuElement.style.padding = \"4px 0\";\r\n    this.menuElement.style.zIndex = \"1000\";\r\n    this.menuElement.style.fontSize = \"13px\";\r\n\r\n    // Position below anchor\r\n    const rect = anchorElement.getBoundingClientRect();\r\n    this.menuElement.style.top = `${rect.bottom + 4}px`;\r\n    this.menuElement.style.left = `${rect.left}px`;\r\n\r\n    // Build menu items\r\n    this.buildMenuItems();\r\n\r\n    document.body.appendChild(this.menuElement);\r\n  }\r\n\r\n  /**\r\n   * Hide and remove the menu\r\n   */\r\n  public hide(): void {\r\n    if (this.menuElement) {\r\n      this.menuElement.remove();\r\n      this.menuElement = null;\r\n    }\r\n    if (this.backdropElement) {\r\n      this.backdropElement.remove();\r\n      this.backdropElement = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Build menu items based on options\r\n   */\r\n  private buildMenuItems(): void {\r\n    if (!this.menuElement) return;\r\n\r\n    // Header\r\n    this.addMenuItem(\"Select column\", null, { isHeader: true });\r\n    this.addSeparator();\r\n\r\n    // Sort options (always available). If the column is currently sorted, show an 'x' clear button\r\n    this.addMenuItem(\r\n      \"Sort ascending\",\r\n      () => {\r\n        this.options.onSort?.(\"ASC\");\r\n        this.hide();\r\n      },\r\n      {\r\n        icon: this.getIconSvg(\"sort-asc\"),\r\n        showClear: !!(this.options.currentSort === \"ASC\"),\r\n        clearAction: this.options.onClearSort,\r\n      },\r\n    );\r\n\r\n    this.addMenuItem(\r\n      \"Sort descending\",\r\n      () => {\r\n        this.options.onSort?.(\"DESC\");\r\n        this.hide();\r\n      },\r\n      {\r\n        icon: this.getIconSvg(\"sort-desc\"),\r\n        showClear: !!(this.options.currentSort === \"DESC\"),\r\n        clearAction: this.options.onClearSort,\r\n      },\r\n    );\r\n\r\n    this.addSeparator();\r\n\r\n    // Group by (conditional)\r\n    if (this.options.canGroup) {\r\n      this.addMenuItem(\r\n        \"Group by values\",\r\n        () => {\r\n          this.options.onGroup?.();\r\n          this.hide();\r\n        },\r\n        {\r\n          icon: this.getIconSvg(\"rows\"),\r\n          showClear: !!this.options.isGrouped,\r\n          clearAction: this.options.onClearGroup,\r\n        },\r\n      );\r\n    }\r\n\r\n    // Slice by (conditional)\r\n    if (this.options.canSlice) {\r\n      this.addMenuItem(\r\n        \"Slice by values\",\r\n        () => {\r\n          this.options.onSlice?.();\r\n          this.hide();\r\n        },\r\n        {\r\n          icon: this.getIconSvg(\"sliceby\"),\r\n          showClear: !!this.options.isSliced,\r\n          clearAction: this.options.onClearSlice,\r\n        },\r\n      );\r\n    }\r\n\r\n    // Filter (conditional)\r\n    if (this.options.canFilter) {\r\n      this.addMenuItem(\"Filter by values...\", () => {\r\n        this.options.onFilter?.();\r\n        this.hide();\r\n      });\r\n    }\r\n\r\n    // Always available actions\r\n    if (\r\n      this.options.canGroup ||\r\n      this.options.canSlice ||\r\n      this.options.canFilter\r\n    ) {\r\n      this.addSeparator();\r\n    }\r\n\r\n    // Do not show hide for title fields\r\n    const isTitle = !!(\r\n      this.field &&\r\n      (this.field.type === \"title\" ||\r\n        String(this.field.name || \"\").toLowerCase() === \"title\" ||\r\n        String(this.field.id || \"\").toLowerCase() === \"title\")\r\n    );\r\n    if (!isTitle) {\r\n      this.addMenuItem(\r\n        \"Hide field\",\r\n        () => {\r\n          this.options.onHide?.();\r\n          this.hide();\r\n        },\r\n        {\r\n          icon: this.getIconSvg(\"eye-closed\"),\r\n        },\r\n      );\r\n    }\r\n\r\n    this.addSeparator();\r\n\r\n    const disableLeft = !!this.options.isFirst;\r\n    const disableRight = !!this.options.isLast;\r\n\r\n    this.addMenuItem(\r\n      \"Move left\",\r\n      () => {\r\n        if (disableLeft) return;\r\n        this.options.onMove?.(\"left\");\r\n        this.hide();\r\n      },\r\n      {\r\n        icon: this.getIconSvg(\"arrow-left\"),\r\n        disabled: disableLeft,\r\n      },\r\n    );\r\n\r\n    this.addMenuItem(\r\n      \"Move right\",\r\n      () => {\r\n        if (disableRight) return;\r\n        this.options.onMove?.(\"right\");\r\n        this.hide();\r\n      },\r\n      {\r\n        icon: this.getIconSvg(\"arrow-right\"),\r\n        disabled: disableRight,\r\n      },\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Add a menu item\r\n   */\r\n  private addMenuItem(\r\n    label: string,\r\n    onClick: (() => void) | null,\r\n    options?: {\r\n      isHeader?: boolean;\r\n      icon?: string;\r\n      showClear?: boolean;\r\n      clearAction?: (() => void) | null;\r\n      disabled?: boolean;\r\n    },\r\n  ): void {\r\n    if (!this.menuElement) return;\r\n    const item = document.createElement(\"div\");\r\n    item.className = \"menu-item\";\r\n\r\n    if (options?.isHeader) {\r\n      item.textContent = label;\r\n      item.style.padding = \"6px 12px\";\r\n      item.style.fontWeight = \"600\";\r\n      item.style.color = \"var(--vscode-descriptionForeground)\";\r\n      item.style.fontSize = \"11px\";\r\n      item.style.textTransform = \"uppercase\";\r\n      item.style.cursor = \"default\";\r\n      this.menuElement.appendChild(item);\r\n      return;\r\n    }\r\n\r\n    // Non-header item layout: optional icon on left, label, optional clear 'x' button on the right\r\n    item.style.display = \"flex\";\r\n    item.style.alignItems = \"center\";\r\n    item.style.justifyContent = \"space-between\";\r\n    item.style.padding = \"6px 12px\";\r\n    item.style.cursor = \"pointer\";\r\n    item.style.color = \"var(--vscode-menu-foreground)\";\r\n\r\n    // Left icon\r\n    if (options?.icon) {\r\n      const iconEl = document.createElement(\"span\");\r\n      iconEl.className = \"menu-item-icon\";\r\n      iconEl.style.display = \"inline-block\";\r\n      iconEl.style.width = \"14px\";\r\n      iconEl.style.marginRight = \"8px\";\r\n      iconEl.style.flex = \"0 0 auto\";\r\n      // allow callers to pass either a short glyph or full SVG string\r\n      iconEl.innerHTML = options.icon;\r\n      item.appendChild(iconEl);\r\n    }\r\n\r\n    const labelEl = document.createElement(\"span\");\r\n    labelEl.textContent = label;\r\n    labelEl.style.flex = \"1\";\r\n    labelEl.style.whiteSpace = \"nowrap\";\r\n    labelEl.style.overflow = \"hidden\";\r\n    labelEl.style.textOverflow = \"ellipsis\";\r\n\r\n    item.appendChild(labelEl);\r\n\r\n    // Optional clear 'x' button\r\n    if (options?.showClear && options?.clearAction) {\r\n      const clearBtn = document.createElement(\"button\");\r\n      clearBtn.type = \"button\";\r\n      clearBtn.textContent = \"\u2715\";\r\n      clearBtn.title = \"Clear\";\r\n      clearBtn.style.border = \"none\";\r\n      clearBtn.style.background = \"transparent\";\r\n      clearBtn.style.cursor = \"pointer\";\r\n      clearBtn.style.padding = \"2px 6px\";\r\n      clearBtn.style.marginLeft = \"8px\";\r\n      clearBtn.style.color = \"var(--vscode-menu-foreground)\";\r\n\r\n      clearBtn.addEventListener(\"mouseenter\", () => {\r\n        clearBtn.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n        clearBtn.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n      });\r\n      clearBtn.addEventListener(\"mouseleave\", () => {\r\n        clearBtn.style.color = \"var(--vscode-menu-foreground)\";\r\n        clearBtn.style.background = \"transparent\";\r\n      });\r\n\r\n      clearBtn.addEventListener(\"click\", (e) => {\r\n        e.stopPropagation();\r\n        options.clearAction && options.clearAction();\r\n        this.hide();\r\n      });\r\n\r\n      item.appendChild(clearBtn);\r\n    }\r\n\r\n    // Disabled state\r\n    if (options?.disabled) {\r\n      item.style.opacity = \"0.5\";\r\n      item.style.cursor = \"default\";\r\n    }\r\n\r\n    if (onClick) {\r\n      item.addEventListener(\"mouseenter\", () => {\r\n        item.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n        item.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n      });\r\n\r\n      item.addEventListener(\"mouseleave\", () => {\r\n        item.style.background = \"transparent\";\r\n        item.style.color = \"var(--vscode-menu-foreground)\";\r\n      });\r\n\r\n      item.addEventListener(\"click\", () => {\r\n        if (options?.disabled) return;\r\n        onClick();\r\n      });\r\n    }\r\n\r\n    this.menuElement.appendChild(item);\r\n  }\r\n\r\n  /**\r\n   * Add menu separator\r\n   */\r\n  private addSeparator(): void {\r\n    if (!this.menuElement) return;\r\n\r\n    const separator = document.createElement(\"div\");\r\n    separator.style.height = \"1px\";\r\n    separator.style.background = \"var(--vscode-menu-separatorBackground)\";\r\n    separator.style.margin = \"4px 0\";\r\n\r\n    this.menuElement.appendChild(separator);\r\n  }\r\n}\r\n", "export interface ColumnHeaderOptions {\r\n  fields: any[];\r\n  sortConfig: any;\r\n  groupingFieldName?: string;\r\n  activeSlice: any;\r\n  activeSlicePanelFieldId: string | null;\r\n  onHeaderMenu: (e: MouseEvent, field: any, th: HTMLElement) => void;\r\n  onShowFieldsMenu: (anchor: HTMLElement) => void;\r\n  onClearGroup: (field: any) => void;\r\n  onClearSlice: (field: any) => void;\r\n}\r\n\r\nexport class ColumnHeaderRenderer {\r\n  constructor(private options: ColumnHeaderOptions) {}\r\n\r\n  /**\r\n   * Helper to get icon SVG from registry\r\n   * Note: iconName is a runtime string value, so we use 'as any' to bypass\r\n   * the IconName type check. This is safe because the function validates the icon name.\r\n   */\r\n  private getIconSvg(iconName: string): string {\r\n    if (window.getIconSvg) {\r\n      return window.getIconSvg(iconName as any);\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  public render(table: HTMLTableElement) {\r\n    const thead = document.createElement(\"thead\");\r\n    thead.style.background = \"var(--vscode-sideBar-background)\";\r\n    thead.style.position = \"sticky\";\r\n    thead.style.top = \"0\";\r\n    thead.style.zIndex = \"10\";\r\n    thead.setAttribute(\"role\", \"rowgroup\");\r\n\r\n    const tr = document.createElement(\"tr\");\r\n    tr.setAttribute(\"role\", \"row\");\r\n\r\n    // Index Header\r\n    const thIndex = document.createElement(\"th\");\r\n    thIndex.textContent = \"#\";\r\n    thIndex.setAttribute(\"role\", \"columnheader\");\r\n    thIndex.setAttribute(\"aria-colindex\", \"1\");\r\n    thIndex.setAttribute(\"aria-label\", \"Row number\");\r\n    thIndex.setAttribute(\"scope\", \"col\");\r\n    this.styleHeaderCell(thIndex);\r\n    tr.appendChild(thIndex);\r\n\r\n    // Field Headers\r\n    for (let fieldIndex = 0; fieldIndex < this.options.fields.length; fieldIndex++) {\r\n      const field = this.options.fields[fieldIndex];\r\n      const th = document.createElement(\"th\");\r\n      \r\n      // Add ARIA attributes\r\n      th.setAttribute(\"role\", \"columnheader\");\r\n      th.setAttribute(\"aria-colindex\", String(fieldIndex + 2)); // +2 for index column\r\n      th.setAttribute(\"scope\", \"col\");\r\n      \r\n      // Add sort state to ARIA\r\n      const isSorted = this.options.sortConfig?.fieldId === field.id;\r\n      if (isSorted) {\r\n        const sortDirection = this.options.sortConfig?.direction === \"ASC\" ? \"ascending\" : \"descending\";\r\n        th.setAttribute(\"aria-sort\", sortDirection);\r\n      }\r\n\r\n      // Create header content wrapper\r\n      const headerContent = document.createElement(\"div\");\r\n      headerContent.style.display = \"flex\";\r\n      headerContent.style.alignItems = \"center\";\r\n      headerContent.style.justifyContent = \"space-between\";\r\n      headerContent.style.width = \"100%\";\r\n      headerContent.style.gap = \"4px\";\r\n\r\n      // Field name span\r\n      const nameSpan = document.createElement(\"span\");\r\n      const headerText = field.name || field.id || \"\";\r\n      nameSpan.textContent = headerText;\r\n      nameSpan.style.flex = \"1\";\r\n      nameSpan.style.overflow = \"hidden\";\r\n      nameSpan.style.textOverflow = \"ellipsis\";\r\n      nameSpan.style.whiteSpace = \"nowrap\";\r\n\r\n      // Check if this field is grouped\r\n      const isGrouped =\r\n        field.name?.toLowerCase() ===\r\n        this.options.groupingFieldName?.toLowerCase();\r\n\r\n      // Check if this field is being sliced\r\n      const isSliced =\r\n        (this.options.activeSlice &&\r\n          this.options.activeSlice.fieldId === field.id) ||\r\n        (this.options.activeSlicePanelFieldId &&\r\n          String(this.options.activeSlicePanelFieldId) === String(field.id));\r\n\r\n      // Icons container (for sort / group / slice indicators)\r\n      const iconsContainer = document.createElement(\"span\");\r\n      iconsContainer.style.display = \"flex\";\r\n      iconsContainer.style.alignItems = \"center\";\r\n      iconsContainer.style.gap = \"6px\";\r\n\r\n      // Show Sort icon\r\n      if (isSorted) {\r\n        const sortIcon = document.createElement(\"span\");\r\n        sortIcon.className = \"column-sort-icon\";\r\n        const direction =\r\n          this.options.sortConfig?.direction === \"ASC\"\r\n            ? \"sort-asc\"\r\n            : \"sort-desc\";\r\n        sortIcon.innerHTML = this.getIconSvg(direction);\r\n        sortIcon.style.display = \"inline-flex\";\r\n        sortIcon.style.alignItems = \"center\";\r\n        sortIcon.style.color = \"var(--vscode-foreground)\";\r\n        sortIcon.style.opacity = \"0.85\";\r\n        sortIcon.title =\r\n          this.options.sortConfig?.direction === \"ASC\"\r\n            ? \"Sorted ascending\"\r\n            : \"Sorted descending\";\r\n        iconsContainer.appendChild(sortIcon);\r\n      }\r\n\r\n      // Show Group icon\r\n      if (isGrouped) {\r\n        const groupIcon = document.createElement(\"span\");\r\n        groupIcon.className = \"column-group-icon\";\r\n        groupIcon.innerHTML = this.getIconSvg(\"rows\");\r\n        groupIcon.style.display = \"inline-flex\";\r\n        groupIcon.style.alignItems = \"center\";\r\n        groupIcon.style.color = \"var(--vscode-foreground)\";\r\n        groupIcon.style.opacity = \"0.85\";\r\n        groupIcon.title = \"Grouped by this field (click to clear)\";\r\n        groupIcon.style.cursor = \"pointer\";\r\n        groupIcon.addEventListener(\"click\", (ev) => {\r\n          ev.stopPropagation();\r\n          this.options.onClearGroup(field);\r\n        });\r\n        iconsContainer.appendChild(groupIcon);\r\n      }\r\n\r\n      // Show Slice icon\r\n      if (isSliced) {\r\n        const sliceIcon = document.createElement(\"span\");\r\n        sliceIcon.className = \"column-slice-icon\";\r\n        sliceIcon.innerHTML = this.getIconSvg(\"sliceby\");\r\n        sliceIcon.style.display = \"inline-flex\";\r\n        sliceIcon.style.alignItems = \"center\";\r\n        sliceIcon.style.color = \"var(--vscode-foreground)\";\r\n        sliceIcon.style.opacity = \"0.85\";\r\n        sliceIcon.title = \"Sliced by this field (click to clear)\";\r\n        sliceIcon.style.cursor = \"pointer\";\r\n        sliceIcon.addEventListener(\"click\", (ev) => {\r\n          ev.stopPropagation();\r\n          this.options.onClearSlice(field);\r\n        });\r\n        iconsContainer.appendChild(sliceIcon);\r\n      }\r\n\r\n      // Menu button (\u22EE)\r\n      const menuBtn = document.createElement(\"button\");\r\n      menuBtn.textContent = \"\u22EE\";\r\n      menuBtn.style.background = \"transparent\";\r\n      menuBtn.style.border = \"none\";\r\n      menuBtn.style.cursor = \"pointer\";\r\n      menuBtn.style.fontSize = \"16px\";\r\n      menuBtn.style.padding = \"2px 4px\";\r\n      menuBtn.style.color = \"var(--vscode-foreground)\";\r\n      menuBtn.style.opacity = \"0.6\";\r\n      menuBtn.style.borderRadius = \"3px\";\r\n      menuBtn.title = `${field.name} options`;\r\n\r\n      menuBtn.addEventListener(\"mouseenter\", () => {\r\n        menuBtn.style.opacity = \"1\";\r\n        menuBtn.style.background = \"var(--vscode-toolbar-hoverBackground)\";\r\n      });\r\n\r\n      menuBtn.addEventListener(\"mouseleave\", () => {\r\n        menuBtn.style.opacity = \"0.6\";\r\n        menuBtn.style.background = \"transparent\";\r\n      });\r\n\r\n      menuBtn.addEventListener(\"click\", (e) => {\r\n        e.stopPropagation();\r\n        (th as HTMLElement).style.background =\r\n          \"var(--vscode-sideBar-background)\";\r\n        this.options.onHeaderMenu(e, field, th);\r\n      });\r\n\r\n      headerContent.appendChild(nameSpan);\r\n      if (isSorted || isGrouped || isSliced) {\r\n        headerContent.appendChild(iconsContainer);\r\n      }\r\n      headerContent.appendChild(menuBtn);\r\n      th.appendChild(headerContent);\r\n\r\n      th.addEventListener(\"pointerenter\", () => {\r\n        th.style.background = \"var(--vscode-list-hoverBackground)\";\r\n      });\r\n\r\n      th.addEventListener(\"pointerleave\", () => {\r\n        th.style.background = \"var(--vscode-sideBar-background)\";\r\n      });\r\n\r\n      this.styleHeaderCell(th);\r\n      tr.appendChild(th);\r\n    }\r\n\r\n    // Add Field column (+)\r\n    const thAddField = document.createElement(\"th\");\r\n    const addFieldBtn = document.createElement(\"button\");\r\n    addFieldBtn.textContent = \"+\";\r\n    addFieldBtn.style.background = \"transparent\";\r\n    addFieldBtn.style.border = \"none\";\r\n    addFieldBtn.style.cursor = \"pointer\";\r\n    addFieldBtn.style.fontSize = \"18px\";\r\n    addFieldBtn.style.fontWeight = \"bold\";\r\n    addFieldBtn.style.color = \"var(--vscode-foreground)\";\r\n    addFieldBtn.style.width = \"100%\";\r\n    addFieldBtn.style.height = \"100%\";\r\n    addFieldBtn.title = \"Show hidden fields\";\r\n\r\n    addFieldBtn.addEventListener(\"click\", () =>\r\n      this.options.onShowFieldsMenu(addFieldBtn),\r\n    );\r\n\r\n    thAddField.appendChild(addFieldBtn);\r\n    this.styleHeaderCell(thAddField);\r\n    thAddField.style.textAlign = \"center\";\r\n    thAddField.style.width = \"50px\";\r\n    tr.appendChild(thAddField);\r\n\r\n    thead.appendChild(tr);\r\n    table.appendChild(thead);\r\n  }\r\n\r\n  private styleHeaderCell(th: HTMLTableCellElement) {\r\n    th.style.padding = \"8px\";\r\n    th.style.textAlign = \"left\";\r\n    th.style.whiteSpace = \"nowrap\";\r\n    th.style.overflow = \"hidden\";\r\n    th.style.textOverflow = \"ellipsis\";\r\n    th.style.borderRight = \"1px solid var(--vscode-panel-border)\";\r\n    th.style.borderBottom = \"1px solid var(--vscode-panel-border)\";\r\n    th.style.position = \"sticky\";\r\n    th.style.top = \"0\";\r\n    th.style.zIndex = \"11\";\r\n    th.style.background = \"var(--vscode-sideBar-background)\";\r\n    th.style.height = \"32px\";\r\n    th.style.boxSizing = \"border-box\";\r\n  }\r\n}\r\n", "/**\r\n * Fields Menu\r\n * Dropdown used from table plus-column. Shows project fields split into Visible / Hidden sections\r\n * First item is a \"+ New field\" button. Visible fields show a leading checkmark.\r\n */\r\n\r\nexport interface FieldItem {\r\n  id: string;\r\n  name: string;\r\n  iconClass?: string;\r\n  dataType?: string;\r\n}\r\n\r\nexport interface FieldsMenuOptions {\r\n  fields: FieldItem[];\r\n  visibleFieldIds: Set<string>;\r\n  onToggleVisibility?: (fieldId: string, visible: boolean) => void;\r\n  onCreateField?: () => void;\r\n}\r\n\r\nexport class FieldsMenu {\r\n  private options: FieldsMenuOptions;\r\n  private menuElement: HTMLElement | null = null;\r\n  private backdropElement: HTMLElement | null = null;\r\n\r\n  constructor(options: FieldsMenuOptions) {\r\n    this.options = options;\r\n  }\r\n\r\n  public show(anchorElement: HTMLElement) {\r\n    this.hide();\r\n\r\n    // Backdrop to detect outside clicks\r\n    this.backdropElement = document.createElement(\"div\");\r\n    this.backdropElement.style.position = \"fixed\";\r\n    this.backdropElement.style.top = \"0\";\r\n    this.backdropElement.style.left = \"0\";\r\n    this.backdropElement.style.right = \"0\";\r\n    this.backdropElement.style.bottom = \"0\";\r\n    this.backdropElement.style.zIndex = \"998\";\r\n    this.backdropElement.addEventListener(\"click\", () => this.hide());\r\n    document.body.appendChild(this.backdropElement);\r\n\r\n    // Create menu offscreen first so we can measure size and pick best placement\r\n    this.menuElement = document.createElement(\"div\");\r\n    this.menuElement.className = \"fields-menu\";\r\n    this.menuElement.style.position = \"absolute\";\r\n    this.menuElement.style.visibility = \"hidden\";\r\n    this.menuElement.style.left = \"0px\";\r\n    this.menuElement.style.top = \"0px\";\r\n    this.menuElement.style.background = \"var(--vscode-menu-background)\";\r\n    this.menuElement.style.border = \"1px solid var(--vscode-menu-border)\";\r\n    this.menuElement.style.borderRadius = \"4px\";\r\n    this.menuElement.style.boxShadow = \"0 2px 8px rgba(0,0,0,0.15)\";\r\n    this.menuElement.style.minWidth = \"220px\";\r\n    this.menuElement.style.padding = \"6px 0\";\r\n    // When there are many fields, allow the menu to scroll vertically instead of growing off-screen\r\n    this.menuElement.style.maxHeight = \"60vh\";\r\n    this.menuElement.style.overflowY = \"auto\";\r\n    this.menuElement.style.boxSizing = \"border-box\";\r\n    this.menuElement.style.zIndex = \"1000\";\r\n    this.menuElement.style.fontSize = \"13px\";\r\n\r\n    // Append hidden, build, measure, then position\r\n    document.body.appendChild(this.menuElement);\r\n    this.buildMenu();\r\n\r\n    const rect = anchorElement.getBoundingClientRect();\r\n    const menuRect = this.menuElement.getBoundingClientRect();\r\n    const margin = 8;\r\n    const vw = window.innerWidth || document.documentElement.clientWidth;\r\n    const vh = window.innerHeight || document.documentElement.clientHeight;\r\n\r\n    // Vertical placement: prefer below, otherwise above, else clamp\r\n    let top = rect.bottom + margin;\r\n    if (rect.bottom + menuRect.height + margin > vh) {\r\n      // try above\r\n      if (rect.top - menuRect.height - margin >= 0) {\r\n        top = rect.top - menuRect.height - margin;\r\n      } else {\r\n        // clamp within viewport\r\n        top = Math.max(\r\n          margin,\r\n          Math.min(vh - menuRect.height - margin, rect.bottom + margin),\r\n        );\r\n      }\r\n    }\r\n\r\n    // Horizontal placement: align left by default, but adjust if overflowing\r\n    let left = rect.left;\r\n    if (rect.left + menuRect.width + margin > vw) {\r\n      // try align to right edge of anchor\r\n      left = Math.max(margin, rect.right - menuRect.width);\r\n    }\r\n    // Clamp left\r\n    left = Math.max(margin, Math.min(left, vw - menuRect.width - margin));\r\n\r\n    this.menuElement.style.top = `${Math.round(top)}px`;\r\n    this.menuElement.style.left = `${Math.round(left)}px`;\r\n    this.menuElement.style.visibility = \"visible\";\r\n  }\r\n\r\n  public hide() {\r\n    if (this.menuElement) {\r\n      this.menuElement.remove();\r\n      this.menuElement = null;\r\n    }\r\n    if (this.backdropElement) {\r\n      this.backdropElement.remove();\r\n      this.backdropElement = null;\r\n    }\r\n  }\r\n\r\n  private buildMenu() {\r\n    if (!this.menuElement) return;\r\n\r\n    // Header\r\n    const title = document.createElement(\"div\");\r\n    title.style.display = \"flex\";\r\n    title.style.alignItems = \"center\";\r\n    title.style.padding = \"6px 12px\";\r\n    title.style.fontWeight = \"600\";\r\n    title.style.color = \"var(--vscode-descriptionForeground)\";\r\n    title.style.fontSize = \"12px\";\r\n    title.style.textTransform = \"uppercase\";\r\n\r\n    const icon = document.createElement(\"i\");\r\n    icon.className = \"octicon octicon-note\";\r\n    icon.style.marginRight = \"8px\";\r\n    title.appendChild(icon);\r\n\r\n    const label = document.createElement(\"span\");\r\n    label.textContent = \"Fields\";\r\n    title.appendChild(label);\r\n\r\n    this.menuElement.appendChild(title);\r\n    this.addSeparator();\r\n\r\n    // + New field\r\n    const newField = document.createElement(\"div\");\r\n    newField.style.display = \"flex\";\r\n    newField.style.alignItems = \"center\";\r\n    newField.style.padding = \"6px 12px\";\r\n    newField.style.cursor = \"pointer\";\r\n    newField.style.color = \"var(--vscode-menu-foreground)\";\r\n    newField.innerHTML = `<span style=\"margin-right:8px;font-weight:700\">+</span><span>New field</span>`;\r\n    newField.addEventListener(\"mouseenter\", () => {\r\n      newField.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n      newField.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n    });\r\n    newField.addEventListener(\"mouseleave\", () => {\r\n      newField.style.background = \"transparent\";\r\n      newField.style.color = \"var(--vscode-menu-foreground)\";\r\n    });\r\n    newField.addEventListener(\"click\", () => {\r\n      this.options.onCreateField?.();\r\n      this.hide();\r\n    });\r\n    this.menuElement.appendChild(newField);\r\n\r\n    this.addSeparator();\r\n\r\n    const visible = this.options.fields.filter((f) =>\r\n      this.options.visibleFieldIds.has(f.id),\r\n    );\r\n    const hidden = this.options.fields.filter(\r\n      (f) => !this.options.visibleFieldIds.has(f.id),\r\n    );\r\n\r\n    this.addSectionHeader(\"Visible fields\");\r\n    if (visible.length === 0) this.addEmptyRow(\"No visible fields\");\r\n    else visible.forEach((f) => this.addFieldRow(f, true));\r\n\r\n    this.addSeparator();\r\n\r\n    this.addSectionHeader(\"Hidden fields\");\r\n    if (hidden.length === 0) this.addEmptyRow(\"No hidden fields\");\r\n    else hidden.forEach((f) => this.addFieldRow(f, false));\r\n  }\r\n\r\n  private addSectionHeader(text: string) {\r\n    if (!this.menuElement) return;\r\n    const h = document.createElement(\"div\");\r\n    h.textContent = text;\r\n    h.style.padding = \"6px 12px\";\r\n    h.style.fontSize = \"11px\";\r\n    h.style.fontWeight = \"600\";\r\n    h.style.color = \"var(--vscode-descriptionForeground)\";\r\n    h.style.textTransform = \"uppercase\";\r\n    this.menuElement.appendChild(h);\r\n  }\r\n  private addEmptyRow(text: string) {\r\n    if (!this.menuElement) return;\r\n    const r = document.createElement(\"div\");\r\n    r.textContent = text;\r\n    r.style.padding = \"6px 12px\";\r\n    r.style.color = \"var(--vscode-menu-foreground)\";\r\n    r.style.opacity = \"0.8\";\r\n    this.menuElement.appendChild(r);\r\n  }\r\n\r\n  private addFieldRow(field: FieldItem, visible: boolean) {\r\n    if (!this.menuElement) return;\r\n    const row = document.createElement(\"div\");\r\n    row.style.display = \"flex\";\r\n    row.style.alignItems = \"center\";\r\n    row.style.padding = \"6px 12px\";\r\n    row.style.cursor = \"pointer\";\r\n    row.style.color = \"var(--vscode-menu-foreground)\";\r\n\r\n    if (visible) {\r\n      const c = document.createElement(\"span\");\r\n      c.textContent = \"\u2713\";\r\n      c.style.marginRight = \"8px\";\r\n      c.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n      row.appendChild(c);\r\n    } else {\r\n      const s = document.createElement(\"span\");\r\n      s.style.display = \"inline-block\";\r\n      s.style.width = \"14px\";\r\n      s.style.marginRight = \"8px\";\r\n      row.appendChild(s);\r\n    }\r\n\r\n    // Determine icon SVG based on field dataType or provided iconClass. Use placeholder tokens for octicon paths so user can replace them later.\r\n    const iconHtml = this.getIconForField(field);\r\n    const icon = document.createElement(\"span\");\r\n    icon.innerHTML = iconHtml;\r\n    icon.style.marginRight = \"8px\";\r\n    icon.style.display = \"inline-flex\";\r\n    icon.style.alignItems = \"center\";\r\n    row.appendChild(icon);\r\n    const label = document.createElement(\"span\");\r\n    label.textContent = field.name;\r\n    label.style.flex = \"1\";\r\n    label.style.whiteSpace = \"nowrap\";\r\n    label.style.overflow = \"hidden\";\r\n    label.style.textOverflow = \"ellipsis\";\r\n    row.appendChild(label);\r\n\r\n    row.addEventListener(\"mouseenter\", () => {\r\n      row.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n      row.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n    });\r\n    row.addEventListener(\"mouseleave\", () => {\r\n      row.style.background = \"transparent\";\r\n      row.style.color = \"var(--vscode-menu-foreground)\";\r\n    });\r\n    row.addEventListener(\"click\", () => {\r\n      const newVisible = !visible;\r\n      this.options.onToggleVisibility?.(field.id, newVisible);\r\n      if (newVisible) this.options.visibleFieldIds.add(field.id);\r\n      else this.options.visibleFieldIds.delete(field.id);\r\n      this.menuElement && ((this.menuElement.innerHTML = \"\"), this.buildMenu());\r\n    });\r\n\r\n    this.menuElement.appendChild(row);\r\n  }\r\n\r\n  private addSeparator() {\r\n    if (!this.menuElement) return;\r\n    const s = document.createElement(\"div\");\r\n    s.style.height = \"1px\";\r\n    s.style.background = \"var(--vscode-menu-separatorBackground)\";\r\n    s.style.margin = \"6px 0\";\r\n    this.menuElement.appendChild(s);\r\n  }\r\n\r\n  /**\r\n   * Return inline SVG HTML for the given field using the icon registry.\r\n   */\r\n  private getIconForField(field: FieldItem): string {\r\n    const dataType = (field.dataType || \"\").toString().toLowerCase();\r\n\r\n    // If getIconNameForDataType is available from the icon registry, use it\r\n    if (\r\n      typeof (window as any).getIconNameForDataType === \"function\" &&\r\n      typeof (window as any).getIconSvg === \"function\"\r\n    ) {\r\n      const iconName = (window as any).getIconNameForDataType(dataType);\r\n      return (window as any).getIconSvg(iconName);\r\n    }\r\n\r\n    // Fallback: use provided CSS iconClass if available\r\n    if (field.iconClass) {\r\n      return `<i class=\"${field.iconClass}\"></i>`;\r\n    }\r\n\r\n    // Ultimate fallback: empty span\r\n    return \"<span></span>\";\r\n  }\r\n}\r\n\r\nexport default FieldsMenu;\r\n", "export function escapeHtml(s: any): string {\r\n  return s\r\n    ? String(s)\r\n        .replace(/&/g, \"&amp;\")\r\n        .replace(/</g, \"&lt;\")\r\n        .replace(/>/g, \"&gt;\")\r\n    : \"\";\r\n}\r\n\r\nexport function normalizeColor(color: any): string | null {\r\n  if (!color) return null;\r\n  let n = String(color).trim();\r\n  if (\r\n    /^#?[0-9a-f]{3}$/i.test(n) ||\r\n    /^#?[0-9a-f]{6}$/i.test(n) ||\r\n    /^#?[0-9a-f]{8}$/i.test(n)\r\n  ) {\r\n    let b = n[0] === \"#\" ? n.slice(1) : n;\r\n    return \"#\" + (b.length === 8 ? b.substring(0, 6) : b);\r\n  }\r\n  let s = {\r\n    GRAY: \"#848d97\",\r\n    RED: \"#f85149\",\r\n    ORANGE: \"#db6d28\",\r\n    YELLOW: \"#d29922\",\r\n    GREEN: \"#3fb950\",\r\n    BLUE: \"#2f81f7\",\r\n    PURPLE: \"#a371f7\",\r\n    PINK: \"#db61a2\",\r\n    BLACK: \"#000000\",\r\n    WHITE: \"#ffffff\",\r\n  };\r\n  let u = n.toUpperCase();\r\n  return (s as any)[u] || null;\r\n}\r\n\r\nexport function addAlpha(color: any, alpha: any): string | null {\r\n  if (!color) return null;\r\n  let s = color.replace(\"#\", \"\");\r\n  let u = (b: any) => parseInt(b, 16);\r\n  if (s.length === 3) {\r\n    let b = u(s[0] + s[0]),\r\n      S = u(s[1] + s[1]),\r\n      v = u(s[2] + s[2]);\r\n    return \"rgba(\" + b + \",\" + S + \",\" + v + \",\" + alpha + \")\";\r\n  }\r\n  if (s.length === 6 || s.length === 8) {\r\n    let b = s.length === 8 ? s.substring(0, 6) : s,\r\n      S = u(s.substring(0, 2)),\r\n      v = u(b.substring(2, 4)),\r\n      C = u(b.substring(4, 6));\r\n    return \"rgba(\" + S + \",\" + v + \",\" + C + \",\" + alpha + \")\";\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function getContrastColor(color: any): string {\r\n  if (!color) return \"#333333\";\r\n  let n = color.replace(\"#\", \"\");\r\n  let s = (C: any) => parseInt(C, 16);\r\n  let u, b, S;\r\n  if (n.length === 3)\r\n    ((u = s(n[0] + n[0])), (b = s(n[1] + n[1])), (S = s(n[2] + n[2])));\r\n  else if (n.length === 6 || n.length === 8) {\r\n    let C = n.length === 8 ? n.substring(0, 6) : n;\r\n    ((u = s(C.substring(0, 2))),\r\n      (b = s(C.substring(2, 4))),\r\n      (S = s(C.substring(4, 6))));\r\n  } else return \"#333333\";\r\n  return 0.2126 * (u / 255) + 0.7152 * (b / 255) + 0.0722 * (S / 255) > 0.6\r\n    ? \"#111111\"\r\n    : \"#ffffff\";\r\n}\r\n", "/**\r\n * Slice Panel Component\r\n * Shows unique values for a field with counts, allowing quick filtering\r\n */\r\n\r\nimport { normalizeColor, escapeHtml } from \"../utils\";\r\n\r\nexport class SlicePanel {\r\n  private container: HTMLElement;\r\n  private field: any;\r\n  private items: any[];\r\n  private panelElement: HTMLElement | null = null;\r\n  private onValueSelectCallback?: (value: any) => void;\r\n  private onFieldChangeCallback?: (field: any) => void;\r\n  private allFields: any[];\r\n\r\n  constructor(\r\n    container: HTMLElement,\r\n    field: any,\r\n    items: any[],\r\n    allFields?: any[],\r\n  ) {\r\n    this.container = container;\r\n    this.field = field;\r\n    this.items = items;\r\n    this.allFields = allFields || [];\r\n  }\r\n\r\n  /**\r\n   * Render the slice panel\r\n   */\r\n  public render(): void {\r\n    this.close(); // Close any existing panel\r\n\r\n    // Create panel\r\n    this.panelElement = document.createElement(\"div\");\r\n    this.panelElement.className = \"slice-panel\";\r\n    this.panelElement.style.position = \"relative\";\r\n    this.panelElement.style.float = \"left\";\r\n    // Restore persisted width if available\r\n    try {\r\n      const stored = localStorage.getItem(\"ghProjects.slicePanel.width\");\r\n      if (stored) this.panelElement.style.width = stored;\r\n      else this.panelElement.style.width = \"280px\";\r\n    } catch (e) {\r\n      this.panelElement.style.width = \"280px\";\r\n    }\r\n    this.panelElement.style.marginRight = \"12px\";\r\n    this.panelElement.style.background = \"var(--vscode-sideBar-background)\";\r\n    this.panelElement.style.border = \"1px solid var(--vscode-sideBar-border)\";\r\n    this.panelElement.style.borderRadius = \"6px\";\r\n    this.panelElement.style.display = \"flex\";\r\n    this.panelElement.style.flexDirection = \"column\";\r\n    this.panelElement.style.overflow = \"hidden\";\r\n    this.panelElement.style.maxHeight = \"600px\";\r\n\r\n    // Temporary debug overlay: shows last resolved parent metadata and progress\r\n    const debugOverlay = document.createElement(\"pre\");\r\n    debugOverlay.className = \"slice-panel-debug-overlay\";\r\n    debugOverlay.style.position = \"absolute\";\r\n    debugOverlay.style.left = \"8px\";\r\n    debugOverlay.style.bottom = \"8px\";\r\n    debugOverlay.style.right = \"8px\";\r\n    debugOverlay.style.maxHeight = \"120px\";\r\n    debugOverlay.style.overflow = \"auto\";\r\n    debugOverlay.style.background = \"rgba(0,0,0,0.6)\";\r\n    debugOverlay.style.color = \"white\";\r\n    debugOverlay.style.fontSize = \"11px\";\r\n    debugOverlay.style.padding = \"8px\";\r\n    debugOverlay.style.borderRadius = \"6px\";\r\n    debugOverlay.style.zIndex = \"200\";\r\n    debugOverlay.style.display = \"none\"; // hidden by default\r\n    debugOverlay.title = \"SlicePanel debug (click to show/hide)\";\r\n    debugOverlay.addEventListener(\"click\", () => {\r\n      debugOverlay.style.display =\r\n        debugOverlay.style.display === \"none\" ? \"block\" : \"none\";\r\n    });\r\n    this.panelElement.appendChild(debugOverlay);\r\n\r\n    // Add resizer on the right edge to allow adjusting panel width\r\n    const resizer = document.createElement(\"div\");\r\n    resizer.className = \"slice-panel-resizer\";\r\n    resizer.style.position = \"absolute\";\r\n    resizer.style.top = \"0\";\r\n    resizer.style.right = \"0\";\r\n    resizer.style.bottom = \"0\";\r\n    resizer.style.width = \"6px\";\r\n    resizer.style.cursor = \"col-resize\";\r\n    resizer.style.zIndex = \"100\";\r\n    this.panelElement.appendChild(resizer);\r\n\r\n    let startX: number | null = null;\r\n    let startWidth: number | null = null;\r\n\r\n    const onMouseMove = (e: MouseEvent) => {\r\n      if (startX == null || startWidth == null) return;\r\n      const dx = e.pageX - startX;\r\n      const newW = Math.max(160, startWidth + dx);\r\n      this.panelElement!.style.width = newW + \"px\";\r\n    };\r\n\r\n    const onMouseUp = () => {\r\n      if (startX == null) return;\r\n      document.removeEventListener(\"mousemove\", onMouseMove);\r\n      document.removeEventListener(\"mouseup\", onMouseUp);\r\n      try {\r\n        localStorage.setItem(\r\n          \"ghProjects.slicePanel.width\",\r\n          this.panelElement!.style.width,\r\n        );\r\n      } catch (e) {}\r\n      startX = null;\r\n      startWidth = null;\r\n    };\r\n\r\n    resizer.addEventListener(\"mousedown\", (ev: MouseEvent) => {\r\n      ev.preventDefault();\r\n      startX = ev.pageX;\r\n      startWidth = this.panelElement ? this.panelElement.offsetWidth : 280;\r\n      document.addEventListener(\"mousemove\", onMouseMove);\r\n      document.addEventListener(\"mouseup\", onMouseUp);\r\n    });\r\n\r\n    // Header with dropdown\r\n    const header = document.createElement(\"div\");\r\n    header.style.padding = \"12px\";\r\n    header.style.borderBottom = \"1px solid var(--vscode-sideBar-border)\";\r\n    header.style.display = \"flex\";\r\n    header.style.flexDirection = \"column\";\r\n    header.style.gap = \"8px\";\r\n\r\n    const headerTop = document.createElement(\"div\");\r\n    headerTop.style.display = \"flex\";\r\n    headerTop.style.alignItems = \"center\";\r\n    headerTop.style.gap = \"8px\";\r\n\r\n    const sliceLabel = document.createElement(\"span\");\r\n    sliceLabel.textContent = \"Slice by\";\r\n    sliceLabel.style.fontSize = \"11px\";\r\n    sliceLabel.style.fontWeight = \"600\";\r\n    sliceLabel.style.color = \"var(--vscode-descriptionForeground)\";\r\n    sliceLabel.style.textTransform = \"uppercase\";\r\n    sliceLabel.style.letterSpacing = \"0.5px\";\r\n    headerTop.appendChild(sliceLabel);\r\n\r\n    // Field dropdown/button\r\n    const fieldButton = document.createElement(\"button\");\r\n    fieldButton.textContent = this.field.name;\r\n    fieldButton.style.flex = \"1\";\r\n    fieldButton.style.padding = \"6px 12px\";\r\n    fieldButton.style.background = \"var(--vscode-button-secondaryBackground)\";\r\n    fieldButton.style.color = \"var(--vscode-button-secondaryForeground)\";\r\n    fieldButton.style.border = \"1px solid var(--vscode-button-border)\";\r\n    fieldButton.style.borderRadius = \"4px\";\r\n    fieldButton.style.cursor = \"pointer\";\r\n    fieldButton.style.fontSize = \"13px\";\r\n    fieldButton.style.fontWeight = \"500\";\r\n    fieldButton.style.textAlign = \"left\";\r\n    fieldButton.style.display = \"flex\";\r\n    fieldButton.style.justifyContent = \"space-between\";\r\n    fieldButton.style.alignItems = \"center\";\r\n\r\n    // Add dropdown arrow\r\n    const arrow = document.createElement(\"span\");\r\n    arrow.textContent = \"\u25BC\";\r\n    arrow.style.fontSize = \"10px\";\r\n    arrow.style.marginLeft = \"auto\";\r\n    fieldButton.appendChild(arrow);\r\n\r\n    // Add dropdown menu on click\r\n    fieldButton.addEventListener(\"click\", (e) => {\r\n      e.stopPropagation();\r\n      this.showFieldDropdown(fieldButton);\r\n    });\r\n\r\n    headerTop.appendChild(fieldButton);\r\n    header.appendChild(headerTop);\r\n\r\n    this.panelElement.appendChild(header);\r\n\r\n    // Content\r\n    const content = document.createElement(\"div\");\r\n    content.style.flex = \"1\";\r\n    content.style.overflow = \"auto\";\r\n    content.style.padding = \"8px\";\r\n\r\n    this.renderValues(content);\r\n\r\n    this.panelElement.appendChild(content);\r\n    this.container.appendChild(this.panelElement);\r\n  }\r\n\r\n  /**\r\n   * Show dropdown menu to select a different field\r\n   */\r\n  private showFieldDropdown(anchorButton: HTMLElement): void {\r\n    // Get sliceable fields\r\n    const sliceableTypes = new Set([\r\n      \"assignees\",\r\n      \"single_select\",\r\n      \"parent_issue\",\r\n      \"iteration\",\r\n      \"number\",\r\n      \"date\",\r\n      \"milestone\",\r\n      \"repository\",\r\n      \"labels\",\r\n    ]);\r\n\r\n    const sliceableFields = this.allFields.filter((f) => {\r\n      const dataType = (f.dataType || \"\").toLowerCase();\r\n      return sliceableTypes.has(dataType);\r\n    });\r\n\r\n    if (sliceableFields.length === 0) return;\r\n\r\n    // Create dropdown\r\n    const dropdown = document.createElement(\"div\");\r\n    dropdown.style.position = \"absolute\";\r\n    dropdown.style.top = `${anchorButton.getBoundingClientRect().bottom + 4}px`;\r\n    dropdown.style.left = `${anchorButton.getBoundingClientRect().left}px`;\r\n    dropdown.style.minWidth = `${anchorButton.offsetWidth}px`;\r\n    dropdown.style.background = \"var(--vscode-dropdown-background)\";\r\n    dropdown.style.border = \"1px solid var(--vscode-dropdown-border)\";\r\n    dropdown.style.borderRadius = \"4px\";\r\n    dropdown.style.boxShadow = \"0 4px 8px rgba(0,0,0,0.2)\";\r\n    dropdown.style.zIndex = \"1000\";\r\n    dropdown.style.maxHeight = \"300px\";\r\n    dropdown.style.overflowY = \"auto\";\r\n\r\n    sliceableFields.forEach((field) => {\r\n      const item = document.createElement(\"div\");\r\n      item.style.display = \"flex\";\r\n      item.style.alignItems = \"center\";\r\n\r\n      // Icon for field type\r\n      const iconSpan = document.createElement(\"span\");\r\n      iconSpan.style.display = \"inline-flex\";\r\n      iconSpan.style.alignItems = \"center\";\r\n      iconSpan.style.justifyContent = \"center\";\r\n      iconSpan.style.width = \"18px\";\r\n      iconSpan.style.marginRight = \"8px\";\r\n      iconSpan.innerHTML = this.getIconForDataType(\r\n        (field.dataType || \"\").toString().toLowerCase(),\r\n      );\r\n      item.appendChild(iconSpan);\r\n\r\n      const labelSpan = document.createElement(\"span\");\r\n      labelSpan.textContent = field.name;\r\n      item.appendChild(labelSpan);\r\n      item.style.padding = \"8px 12px\";\r\n      item.style.cursor = \"pointer\";\r\n      item.style.fontSize = \"13px\";\r\n      item.style.color = \"var(--vscode-dropdown-foreground)\";\r\n\r\n      if (field.id === this.field.id) {\r\n        item.style.background = \"var(--vscode-list-activeSelectionBackground)\";\r\n        item.style.color = \"var(--vscode-list-activeSelectionForeground)\";\r\n      }\r\n\r\n      item.addEventListener(\"mouseenter\", () => {\r\n        if (field.id !== this.field.id) {\r\n          item.style.background = \"var(--vscode-list-hoverBackground)\";\r\n        }\r\n      });\r\n\r\n      item.addEventListener(\"mouseleave\", () => {\r\n        if (field.id !== this.field.id) {\r\n          item.style.background = \"transparent\";\r\n        }\r\n      });\r\n\r\n      item.addEventListener(\"click\", () => {\r\n        this.field = field;\r\n        dropdown.remove();\r\n        backdrop.remove();\r\n        this.render();\r\n        if (this.onFieldChangeCallback) {\r\n          this.onFieldChangeCallback(field);\r\n        }\r\n      });\r\n\r\n      dropdown.appendChild(item);\r\n    });\r\n\r\n    // Backdrop to close dropdown\r\n    const backdrop = document.createElement(\"div\");\r\n    backdrop.style.position = \"fixed\";\r\n    backdrop.style.top = \"0\";\r\n    backdrop.style.left = \"0\";\r\n    backdrop.style.right = \"0\";\r\n    backdrop.style.bottom = \"0\";\r\n    backdrop.style.zIndex = \"999\";\r\n\r\n    backdrop.addEventListener(\"click\", () => {\r\n      dropdown.remove();\r\n      backdrop.remove();\r\n    });\r\n\r\n    document.body.appendChild(backdrop);\r\n    document.body.appendChild(dropdown);\r\n  }\r\n\r\n  /**\r\n   * Return inline SVG HTML for a given dataType using the icon registry.\r\n   */\r\n  private getIconForDataType(dataType: string): string {\r\n    // Use the icon registry if available (shared with FieldsMenu)\r\n    if (\r\n      typeof (window as any).getIconNameForDataType === \"function\" &&\r\n      typeof (window as any).getIconSvg === \"function\"\r\n    ) {\r\n      const iconName = (window as any).getIconNameForDataType(dataType);\r\n      return (window as any).getIconSvg(iconName);\r\n    }\r\n\r\n    // Fallback: empty span\r\n    return \"<span></span>\";\r\n  }\r\n\r\n  /**\r\n   * Render the list of unique values with counts\r\n   */\r\n  private renderValues(container: HTMLElement): void {\r\n    // Get unique values and their counts\r\n    const valueCounts = this.getValueCounts();\r\n\r\n    if (valueCounts.size === 0) {\r\n      const empty = document.createElement(\"div\");\r\n      empty.textContent = \"No values\";\r\n      empty.style.padding = \"8px\";\r\n      empty.style.color = \"var(--vscode-descriptionForeground)\";\r\n      container.appendChild(empty);\r\n      return;\r\n    }\r\n\r\n    // Sort by count (descending)\r\n    const sorted = Array.from(valueCounts.entries()).sort(\r\n      (a, b) => b[1].count - a[1].count,\r\n    );\r\n\r\n    // Helper: resolve parent item and compute progress (done/total/pct)\r\n    const resolveParentProgress = (parentMeta: any) => {\r\n      const result: any = {\r\n        resolved: null,\r\n        statusColor: null,\r\n        number: null,\r\n        title: null,\r\n        done: 0,\r\n        total: 0,\r\n        pct: 0,\r\n      };\r\n      if (!parentMeta) return result;\r\n\r\n      // Build identifier list from parentMeta\r\n      const identifiers: string[] = [];\r\n      if (parentMeta.number) identifiers.push(String(parentMeta.number));\r\n      if (parentMeta.id) identifiers.push(String(parentMeta.id));\r\n      if (parentMeta.url) identifiers.push(String(parentMeta.url));\r\n      if (parentMeta.title) identifiers.push(String(parentMeta.title));\r\n\r\n      // Try to find a matching item in this.items (same logic as grouping header resolution)\r\n      const found = this.items.find((A: any) => {\r\n        const d = (A && (A.content || (A.raw && A.raw.itemContent))) || null;\r\n        if (!d) return false;\r\n        const M: string[] = [];\r\n        if (d.number) M.push(String(d.number));\r\n        if (d.id) M.push(String(d.id));\r\n        if (d.url) M.push(String(d.url));\r\n        if (d.title) M.push(String(d.title));\r\n        if (d.name) M.push(String(d.name));\r\n        if (d.raw && d.raw.number) M.push(String(d.raw.number));\r\n        if (d.raw && d.raw.id) M.push(String(d.raw.id));\r\n        if (d.raw && d.raw.url) M.push(String(d.raw.url));\r\n        for (let o of identifiers) {\r\n          for (let m of M) {\r\n            if (o && m && String(o) === String(m)) return true;\r\n          }\r\n        }\r\n        return false;\r\n      });\r\n\r\n      if (!found) return result; // single strategy: only use resolved item in snapshot\r\n\r\n      result.resolved = found;\r\n      const content =\r\n        found.content || (found.raw && found.raw.itemContent) || null;\r\n      result.title =\r\n        content && (content.title || content.name)\r\n          ? content.title || content.name\r\n          : found.title || found.name || null;\r\n      result.number =\r\n        content && content.number\r\n          ? String(content.number)\r\n          : found.number || found.id || null;\r\n\r\n      // Determine status color from single_select field in parent (if present)\r\n      if (Array.isArray(found.fieldValues)) {\r\n        const statusFV = found.fieldValues.find(\r\n          (v: any) =>\r\n            v && v.type === \"single_select\" && v.option && v.option.name,\r\n        );\r\n        if (statusFV && statusFV.option) {\r\n          try {\r\n            const c =\r\n              statusFV.option.color ||\r\n              statusFV.option.id ||\r\n              statusFV.option.name ||\r\n              null;\r\n            result.statusColor = normalizeColor(c) || null;\r\n          } catch (e) {}\r\n        }\r\n\r\n        // Try to read aggregate progress field (sub_issues_progress or synthesized with total/done)\r\n        const agg = found.fieldValues.find(\r\n          (v: any) =>\r\n            v &&\r\n            (v.type === \"sub_issues_progress\" ||\r\n              (v.total != null && v.done != null)),\r\n        );\r\n        if (agg && agg.total != null) {\r\n          result.total = Number(agg.total || 0);\r\n          result.done = Number(agg.done || 0);\r\n          result.pct =\r\n            result.total > 0\r\n              ? Math.round((result.done / result.total) * 100)\r\n              : 0;\r\n        }\r\n      }\r\n\r\n      return result;\r\n    };\r\n\r\n    // Render each value with grouping-style presentation\r\n    sorted.forEach(([key, { value, count, rawValue }]) => {\r\n      const item = document.createElement(\"div\");\r\n      item.className = \"slice-value-item\";\r\n      item.style.padding = \"10px 12px\";\r\n      item.style.cursor = \"pointer\";\r\n      item.style.borderRadius = \"4px\";\r\n      item.style.marginBottom = \"4px\";\r\n      item.style.display = \"flex\";\r\n      item.style.alignItems = \"center\";\r\n      item.style.gap = \"8px\";\r\n      item.style.transition = \"background-color 0.15s ease\";\r\n\r\n      const dataType = (this.field.dataType || \"\").toLowerCase();\r\n\r\n      // Normalize parent meta for this iteration so both visual and label rendering use the same source\r\n      let parentMetaForIteration: any = null;\r\n      if (dataType === \"parent_issue\" && rawValue) {\r\n        parentMetaForIteration =\r\n          rawValue.parent ||\r\n          rawValue.parentIssue ||\r\n          rawValue.issue ||\r\n          rawValue.item ||\r\n          rawValue.value ||\r\n          rawValue;\r\n      }\r\n\r\n      // Left visual area: avatar / color dot / repo icon\r\n      const leftVisual = document.createElement(\"div\");\r\n      leftVisual.style.display = \"flex\";\r\n      leftVisual.style.alignItems = \"center\";\r\n      leftVisual.style.gap = \"8px\";\r\n      leftVisual.style.flex = \"0 0 auto\";\r\n\r\n      // Helper: create a color dot\r\n      const makeColorDot = (c: string | null) => {\r\n        const dot = document.createElement(\"span\");\r\n        dot.style.display = \"inline-block\";\r\n        dot.style.width = \"12px\";\r\n        dot.style.height = \"12px\";\r\n        dot.style.borderRadius = \"50%\";\r\n        dot.style.flexShrink = \"0\";\r\n        dot.style.backgroundColor = c || \"var(--vscode-descriptionForeground)\";\r\n        return dot;\r\n      };\r\n\r\n      let visualAppended = false;\r\n\r\n      // Assignees: rawValue may be an individual assignee object (from getValueCounts)\r\n      if (dataType === \"assignees\" && rawValue) {\r\n        const a = rawValue;\r\n        const avatarUrl =\r\n          a && (a.avatarUrl || a.avatar || a.imageUrl || a.avatar_url);\r\n        if (avatarUrl) {\r\n          const avatarEl = document.createElement(\"span\");\r\n          avatarEl.innerHTML =\r\n            '<span title=\"' +\r\n            escapeHtml(a.login || a.name || a.id || \"\") +\r\n            '\" style=\"display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url(' +\r\n            escapeHtml(avatarUrl) +\r\n            ');border:2px solid var(--vscode-editor-background)\"></span>';\r\n          leftVisual.appendChild(avatarEl);\r\n          visualAppended = true;\r\n        } else {\r\n          // fallback color dot\r\n          leftVisual.appendChild(makeColorDot(null));\r\n          visualAppended = true;\r\n        }\r\n      }\r\n\r\n      // Repository: show repo icon\r\n      if (!visualAppended && dataType === \"repository\") {\r\n        const repoIcon = document.createElement(\"span\");\r\n        repoIcon.innerHTML =\r\n          '<svg width=\"14\" height=\"14\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style=\"flex-shrink:0;color:var(--vscode-icon-foreground)\"><path fill=\"currentColor\" d=\"M2 2.5A1.5 1.5 0 0 1 3.5 1h9A1.5 1.5 0 0 1 14 2.5v11A1.5 1.5 0 0 1 12.5 15h-9A1.5 1.5 0 0 1 2 13.5v-11zM3.5 2A.5.5 0 0 0 3 2.5V4h10V2.5a.5.5 0 0 0-.5-.5h-9z\"/></svg>';\r\n        leftVisual.appendChild(repoIcon);\r\n        visualAppended = true;\r\n      }\r\n\r\n      // Parent issue: try to extract parent title and show a color dot (use resolved parent status color if possible)\r\n      if (!visualAppended && dataType === \"parent_issue\") {\r\n        const prog = parentMetaForIteration\r\n          ? resolveParentProgress(parentMetaForIteration)\r\n          : null;\r\n        // Prefer status color from resolved parent progress, then try parentMeta.option/color fields\r\n        let dotColor = prog && prog.statusColor ? prog.statusColor : null;\r\n        if (!dotColor && parentMetaForIteration) {\r\n          dotColor =\r\n            normalizeColor(\r\n              parentMetaForIteration.color ||\r\n                (parentMetaForIteration.option &&\r\n                  parentMetaForIteration.option.color) ||\r\n                parentMetaForIteration.statusColor ||\r\n                parentMetaForIteration.status?.color,\r\n            ) || null;\r\n        }\r\n\r\n        if (\r\n          parentMetaForIteration &&\r\n          (parentMetaForIteration.title ||\r\n            parentMetaForIteration.name ||\r\n            parentMetaForIteration.number ||\r\n            (prog && (prog.title || prog.number)))\r\n        ) {\r\n          const pd = makeColorDot(dotColor);\r\n          leftVisual.appendChild(pd);\r\n          visualAppended = true;\r\n        }\r\n      }\r\n\r\n      // Labels: ensure label color dot comes from label metadata\r\n      if (!visualAppended && dataType === \"labels\" && rawValue) {\r\n        // rawValue here is the individual label object\r\n        const lab = rawValue;\r\n        const colorCandidate =\r\n          lab && (lab.color || lab.colorName || lab.hex || lab.name);\r\n        const normalized = normalizeColor(colorCandidate);\r\n        leftVisual.appendChild(makeColorDot(normalized));\r\n        visualAppended = true;\r\n      }\r\n\r\n      // If still no specialized visual, fall back to normalized color from options/iterations\r\n      if (!visualAppended) {\r\n        let colorVal: any = null;\r\n        if (dataType === \"single_select\" && rawValue && rawValue.option) {\r\n          colorVal =\r\n            rawValue.option.color || rawValue.option.name || rawValue.option.id;\r\n        }\r\n        // If repository/parent/iteration/milestone provide color directly, prefer it\r\n        if (!colorVal && rawValue && (rawValue.color || rawValue.colorName)) {\r\n          colorVal = rawValue.color || rawValue.colorName;\r\n        }\r\n        if (!colorVal && Array.isArray(this.field.options)) {\r\n          try {\r\n            const found = (this.field.options || []).find(\r\n              (o: any) =>\r\n                String(o.name) === String(key) ||\r\n                String(o.id) ===\r\n                  String(\r\n                    rawValue &&\r\n                      (rawValue.optionId ||\r\n                        (rawValue.option && rawValue.option.id)),\r\n                  ),\r\n            );\r\n            if (found) colorVal = found.color || found.name || found.id;\r\n          } catch (e) {}\r\n        }\r\n        if (\r\n          !colorVal &&\r\n          this.field &&\r\n          this.field.configuration &&\r\n          Array.isArray(this.field.configuration.iterations)\r\n        ) {\r\n          try {\r\n            const iter = (this.field.configuration.iterations || []).find(\r\n              (it: any) =>\r\n                String(it.title) === String(key) ||\r\n                String(it.id) ===\r\n                  String(\r\n                    rawValue &&\r\n                      (rawValue.iterationId ||\r\n                        (rawValue.iteration && rawValue.iteration.id)),\r\n                  ),\r\n            );\r\n            if (iter)\r\n              colorVal = iter.color || iter.name || iter.title || iter.id;\r\n          } catch (e) {}\r\n        }\r\n        const normalized = normalizeColor(colorVal);\r\n        leftVisual.appendChild(makeColorDot(normalized));\r\n      }\r\n\r\n      item.appendChild(leftVisual);\r\n\r\n      // Label column\r\n      const labelColumn = document.createElement(\"div\");\r\n      labelColumn.style.flex = \"1\";\r\n      labelColumn.style.display = \"flex\";\r\n      labelColumn.style.flexDirection = \"column\";\r\n      labelColumn.style.minWidth = \"0\";\r\n\r\n      // For parent_issue we render a custom header below (avoid duplicating the generic label)\r\n      let label: HTMLElement | null = null;\r\n      if (dataType !== \"parent_issue\") {\r\n        label = document.createElement(\"span\");\r\n        label.textContent = key;\r\n        label.style.fontSize = \"13px\";\r\n        label.style.fontWeight = \"500\";\r\n        // Allow wrapping to next line instead of overflowing\r\n        label.style.whiteSpace = \"normal\";\r\n        label.style.wordBreak = \"break-word\";\r\n        label.style.overflow = \"hidden\";\r\n        labelColumn.appendChild(label);\r\n      }\r\n\r\n      // Add description for single_select\r\n      if (dataType === \"single_select\") {\r\n        // Prefer metadata description from field.options if available, else rawValue.option.description\r\n        let descText: string | null = null;\r\n        try {\r\n          if (rawValue && rawValue.option && rawValue.option.description)\r\n            descText = rawValue.option.description;\r\n          else if (Array.isArray(this.field.options)) {\r\n            const found = (this.field.options || []).find(\r\n              (o: any) =>\r\n                String(o.name) === String(key) ||\r\n                String(o.id) ===\r\n                  String(\r\n                    rawValue &&\r\n                      (rawValue.optionId ||\r\n                        (rawValue.option && rawValue.option.id)),\r\n                  ),\r\n            );\r\n            if (found && found.description) descText = found.description;\r\n          }\r\n        } catch (e) {}\r\n\r\n        if (descText) {\r\n          const desc = document.createElement(\"span\");\r\n          desc.textContent = descText;\r\n          desc.style.fontSize = \"11px\";\r\n          desc.style.color = \"var(--vscode-descriptionForeground)\";\r\n          desc.style.whiteSpace = \"normal\";\r\n          desc.style.wordBreak = \"break-word\";\r\n          desc.style.overflow = \"hidden\";\r\n          desc.style.maxHeight = \"3.6em\";\r\n          labelColumn.appendChild(desc);\r\n        }\r\n      }\r\n\r\n      // For parent_issue, show title snippet if available\r\n      if (dataType === \"parent_issue\" && rawValue) {\r\n        const p =\r\n          parentMetaForIteration ||\r\n          rawValue.parent ||\r\n          rawValue.parentIssue ||\r\n          rawValue.issue ||\r\n          rawValue.item ||\r\n          rawValue.value ||\r\n          null;\r\n        const prog = resolveParentProgress(p);\r\n        // Title + number\r\n        const titleText = prog.title || (p && (p.title || p.name)) || key;\r\n        const titleEl = document.createElement(\"div\");\r\n        titleEl.style.display = \"flex\";\r\n        titleEl.style.gap = \"8px\";\r\n        titleEl.style.alignItems = \"baseline\";\r\n        const tspan = document.createElement(\"span\");\r\n        // Append number inline into the title text so it appears immediately after the title\r\n        const displayedTitle = String(titleText).slice(0, 120);\r\n        tspan.textContent = prog.number\r\n          ? `${displayedTitle} #${String(prog.number)}`\r\n          : displayedTitle;\r\n        tspan.style.fontSize = \"13px\";\r\n        tspan.style.fontWeight = \"600\";\r\n        tspan.style.whiteSpace = \"normal\";\r\n        tspan.style.wordBreak = \"break-word\";\r\n        titleEl.appendChild(tspan);\r\n        labelColumn.appendChild(titleEl);\r\n\r\n        // Progress summary and bar\r\n        if (prog.total && prog.total > 0) {\r\n          const summary = document.createElement(\"div\");\r\n          summary.style.display = \"flex\";\r\n          summary.style.alignItems = \"center\";\r\n          summary.style.gap = \"8px\";\r\n          summary.style.marginTop = \"6px\";\r\n\r\n          const doneText = document.createElement(\"div\");\r\n          doneText.textContent = `${prog.done}/${prog.total}`;\r\n          doneText.style.color = \"var(--vscode-descriptionForeground)\";\r\n          doneText.style.fontSize = \"12px\";\r\n          doneText.style.fontVariantNumeric = \"tabular-nums\";\r\n          summary.appendChild(doneText);\r\n\r\n          const bar = document.createElement(\"div\");\r\n          bar.style.display = \"inline-block\";\r\n          bar.style.width = \"120px\";\r\n          bar.style.height = \"10px\";\r\n          bar.style.background = \"transparent\";\r\n          bar.style.border = \"1px solid var(--vscode-focusBorder)\";\r\n          bar.style.borderRadius = \"6px\";\r\n          bar.style.overflow = \"hidden\";\r\n          const fill = document.createElement(\"div\");\r\n          fill.style.height = \"100%\";\r\n          fill.style.width = String(prog.pct) + \"%\";\r\n          fill.style.background = \"var(--vscode-focusBorder)\";\r\n          bar.appendChild(fill);\r\n          summary.appendChild(bar);\r\n\r\n          labelColumn.appendChild(summary);\r\n        }\r\n      }\r\n\r\n      // Iteration: show date range if available\r\n      if (dataType === \"iteration\") {\r\n        try {\r\n          // rawValue may be an FV with iteration object, or we can look up field.configuration.iterations\r\n          const iterObj =\r\n            (rawValue &&\r\n              (rawValue.iteration || rawValue.configuration || rawValue)) ||\r\n            null;\r\n          let iterCandidate: any = null;\r\n          if (\r\n            iterObj &&\r\n            iterObj.startDate &&\r\n            (iterObj.duration || iterObj.length)\r\n          ) {\r\n            iterCandidate = iterObj;\r\n          } else if (\r\n            this.field &&\r\n            this.field.configuration &&\r\n            Array.isArray(this.field.configuration.iterations)\r\n          ) {\r\n            const found = (this.field.configuration.iterations || []).find(\r\n              (it: any) =>\r\n                String(it.title || it.name) === String(key) ||\r\n                String(it.id) ===\r\n                  String(\r\n                    rawValue &&\r\n                      (rawValue.iterationId ||\r\n                        (rawValue.iteration && rawValue.iteration.id)),\r\n                  ),\r\n            );\r\n            if (found) iterCandidate = found;\r\n          }\r\n\r\n          if (iterCandidate) {\r\n            const start = iterCandidate.startDate || iterCandidate.start;\r\n            const duration =\r\n              iterCandidate.duration ||\r\n              iterCandidate.length ||\r\n              iterCandidate.days;\r\n            if (start && duration) {\r\n              const s = new Date(start);\r\n              const e = new Date(\r\n                s.getTime() + Number(duration || 0) * 24 * 60 * 60 * 1000,\r\n              );\r\n              const sStr = s.toLocaleDateString(\"en-US\", {\r\n                month: \"short\",\r\n                day: \"numeric\",\r\n              });\r\n              const eStr = e.toLocaleDateString(\"en-US\", {\r\n                month: \"short\",\r\n                day: \"numeric\",\r\n              });\r\n              const rangeEl = document.createElement(\"div\");\r\n              rangeEl.textContent = `${sStr} \u2014 ${eStr}`;\r\n              rangeEl.style.fontSize = \"11px\";\r\n              rangeEl.style.color = \"var(--vscode-descriptionForeground)\";\r\n              rangeEl.style.marginTop = \"4px\";\r\n              labelColumn.appendChild(rangeEl);\r\n            }\r\n          }\r\n        } catch (e) {}\r\n      }\r\n\r\n      item.appendChild(labelColumn);\r\n\r\n      // Count circle (like grouping)\r\n      const countCircle = document.createElement(\"span\");\r\n      countCircle.style.display = \"inline-flex\";\r\n      countCircle.style.alignItems = \"center\";\r\n      countCircle.style.justifyContent = \"center\";\r\n      countCircle.style.minWidth = \"24px\";\r\n      countCircle.style.height = \"24px\";\r\n      countCircle.style.borderRadius = \"50%\";\r\n      countCircle.style.background = \"var(--vscode-input-background)\";\r\n      countCircle.style.border = \"1px solid var(--vscode-panel-border)\";\r\n      countCircle.style.color = \"var(--vscode-foreground)\";\r\n      countCircle.style.fontSize = \"12px\";\r\n      countCircle.style.fontWeight = \"600\";\r\n      countCircle.style.padding = \"0 6px\";\r\n      countCircle.style.boxSizing = \"border-box\";\r\n      countCircle.textContent = String(count);\r\n\r\n      item.appendChild(countCircle);\r\n\r\n      // Hover effect\r\n      item.addEventListener(\"mouseenter\", () => {\r\n        item.style.background = \"var(--vscode-list-hoverBackground)\";\r\n      });\r\n\r\n      item.addEventListener(\"mouseleave\", () => {\r\n        item.style.background = \"transparent\";\r\n      });\r\n\r\n      // Click handler\r\n      item.addEventListener(\"click\", () => {\r\n        if (this.onValueSelectCallback) {\r\n          this.onValueSelectCallback(value);\r\n        }\r\n      });\r\n\r\n      container.appendChild(item);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get unique values and their counts\r\n   */\r\n  private getValueCounts(): Map<\r\n    string,\r\n    { value: any; count: number; rawValue: any }\r\n  > {\r\n    const counts = new Map<\r\n      string,\r\n      { value: any; count: number; rawValue: any }\r\n    >();\r\n\r\n    const dataType = (this.field.dataType || \"\").toLowerCase();\r\n\r\n    this.items.forEach((item) => {\r\n      const fv = item.fieldValues?.find(\r\n        (f: any) =>\r\n          f.fieldId === this.field.id || f.fieldName === this.field.name,\r\n      );\r\n      if (!fv) {\r\n        const key = \"(empty)\";\r\n        const existing = counts.get(key);\r\n        if (existing) existing.count++;\r\n        else counts.set(key, { value: null, count: 1, rawValue: null });\r\n        return;\r\n      }\r\n\r\n      // Handle multi-value fields (labels, assignees)\r\n      if (dataType === \"labels\") {\r\n        // GitHub sometimes nests labels under .labels.nodes or .labels\r\n        const labelsArr =\r\n          fv.labels && Array.isArray(fv.labels.nodes)\r\n            ? fv.labels.nodes\r\n            : Array.isArray(fv.labels)\r\n              ? fv.labels\r\n              : null;\r\n        if (Array.isArray(labelsArr) && labelsArr.length > 0) {\r\n          labelsArr.forEach((lab: any) => {\r\n            const name =\r\n              lab && (lab.name || lab.title)\r\n                ? String(lab.name || lab.title)\r\n                : \"(empty)\";\r\n            const key = this.formatValue(name);\r\n            const existing = counts.get(key);\r\n            if (existing) existing.count++;\r\n            else counts.set(key, { value: name, count: 1, rawValue: lab });\r\n          });\r\n          return;\r\n        }\r\n      }\r\n\r\n      if (dataType === \"assignees\") {\r\n        const ass = fv.assignees || (fv.assignee ? [fv.assignee] : null);\r\n        if (Array.isArray(ass) && ass.length > 0) {\r\n          ass.forEach((a: any) => {\r\n            const name = String(a.login || a.name || a.id || \"(unknown)\");\r\n            const key = this.formatValue(name);\r\n            const existing = counts.get(key);\r\n            if (existing) existing.count++;\r\n            else counts.set(key, { value: a, count: 1, rawValue: a });\r\n          });\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Single-value fields and other complex types\r\n      let value: any = null;\r\n      let rawValue: any = null;\r\n\r\n      try {\r\n        if (dataType === \"single_select\") {\r\n          value = fv.option?.name || fv.name || fv.value;\r\n          rawValue = fv;\r\n        } else if (dataType === \"iteration\") {\r\n          value = fv.iteration?.title || fv.title || fv.value;\r\n          rawValue = fv;\r\n        } else if (dataType === \"parent_issue\") {\r\n          const p =\r\n            fv.parent ||\r\n            fv.parentIssue ||\r\n            fv.issue ||\r\n            fv.item ||\r\n            fv.value ||\r\n            null;\r\n          if (p) value = p.title || p.name || p.number || p.id || p.url || null;\r\n          rawValue = p || fv;\r\n        } else if (dataType === \"milestone\") {\r\n          value = fv.milestone?.title || fv.milestone?.name || fv.value || null;\r\n          rawValue = fv.milestone || fv;\r\n        } else if (dataType === \"repository\") {\r\n          value =\r\n            fv.repository?.nameWithOwner ||\r\n            fv.repository?.full_name ||\r\n            fv.repository?.name ||\r\n            fv.value ||\r\n            null;\r\n          rawValue = fv.repository || fv;\r\n        } else if (dataType === \"number\") {\r\n          value = fv.number != null ? fv.number : fv.value;\r\n          rawValue = fv;\r\n        } else if (dataType === \"date\") {\r\n          value = fv.date || fv.value || null;\r\n          rawValue = fv;\r\n        } else {\r\n          // fallback: text, title, other simple values\r\n          value = fv.text || fv.title || fv.value || null;\r\n          rawValue = fv;\r\n        }\r\n      } catch (e) {\r\n        value = fv.text || fv.title || fv.value || null;\r\n        rawValue = fv;\r\n      }\r\n\r\n      const key =\r\n        value === null || value === undefined || value === \"\"\r\n          ? \"(empty)\"\r\n          : this.formatValue(value);\r\n      const existing = counts.get(key);\r\n      if (existing) existing.count++;\r\n      else counts.set(key, { value, count: 1, rawValue });\r\n    });\r\n\r\n    return counts;\r\n  }\r\n\r\n  /**\r\n   * Extract value from field value object\r\n   */\r\n  private extractValue(fieldValue: any): any {\r\n    // Deprecated: primary logic moved into getValueCounts which handles multi-value types.\r\n    const dataType = (this.field.dataType || \"\").toLowerCase();\r\n    if (!fieldValue) return null;\r\n    if (dataType === \"single_select\")\r\n      return fieldValue.option?.name || fieldValue.name || fieldValue.value;\r\n    if (dataType === \"iteration\")\r\n      return (\r\n        fieldValue.iteration?.title || fieldValue.title || fieldValue.value\r\n      );\r\n    if (dataType === \"assignees\")\r\n      return fieldValue.assignees || fieldValue.assignee || null;\r\n    if (dataType === \"labels\") return fieldValue.labels || null;\r\n    if (dataType === \"parent_issue\")\r\n      return (\r\n        fieldValue.parent ||\r\n        fieldValue.parentIssue ||\r\n        fieldValue.issue ||\r\n        fieldValue.item ||\r\n        fieldValue.value ||\r\n        null\r\n      );\r\n    if (dataType === \"milestone\")\r\n      return fieldValue.milestone || fieldValue.value || null;\r\n    if (dataType === \"repository\")\r\n      return fieldValue.repository || fieldValue.value || null;\r\n    if (dataType === \"number\")\r\n      return fieldValue.number != null ? fieldValue.number : fieldValue.value;\r\n    if (dataType === \"date\") return fieldValue.date || fieldValue.value || null;\r\n    return fieldValue.text || fieldValue.title || fieldValue.value || null;\r\n  }\r\n\r\n  /**\r\n   * Format value for display\r\n   */\r\n  private formatValue(value: any): string {\r\n    if (value === null || value === undefined) {\r\n      return \"(empty)\";\r\n    }\r\n    return String(value);\r\n  }\r\n\r\n  /**\r\n   * Register callback for value selection\r\n   */\r\n  public onValueSelect(callback: (value: any) => void): void {\r\n    this.onValueSelectCallback = callback;\r\n  }\r\n\r\n  /**\r\n   * Register callback for field change\r\n   */\r\n  public onFieldChange(callback: (field: any) => void): void {\r\n    this.onFieldChangeCallback = callback;\r\n  }\r\n\r\n  /**\r\n   * Close and remove the panel\r\n   */\r\n  public close(): void {\r\n    if (this.panelElement) {\r\n      this.panelElement.remove();\r\n      this.panelElement = null;\r\n    }\r\n  }\r\n}\r\n", "import type { FieldConfig } from \"../../../lib/types\";\r\n\r\nexport interface SortConfig {\r\n  fieldId: string;\r\n  direction: \"ASC\" | \"DESC\";\r\n  secondary?: {\r\n    fieldId: string;\r\n    direction: \"ASC\" | \"DESC\";\r\n  };\r\n}\r\n\r\n/**\r\n * Parse sortByFields from GitHub GraphQL response into SortConfig\r\n */\r\nexport function parseSortByFields(sortByFields: any): SortConfig | null {\r\n  if (!sortByFields || !sortByFields.nodes || sortByFields.nodes.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  const primary = sortByFields.nodes[0];\r\n  if (!primary || !primary.field) {\r\n    return null;\r\n  }\r\n\r\n  const config: SortConfig = {\r\n    fieldId: primary.field.id || primary.field.name,\r\n    direction: primary.direction || \"ASC\",\r\n  };\r\n\r\n  // Add secondary sort if available\r\n  if (sortByFields.nodes.length > 1) {\r\n    const secondary = sortByFields.nodes[1];\r\n    if (secondary && secondary.field) {\r\n      config.secondary = {\r\n        fieldId: secondary.field.id || secondary.field.name,\r\n        direction: secondary.direction || \"ASC\",\r\n      };\r\n    }\r\n  }\r\n\r\n  return config;\r\n}\r\n\r\n/**\r\n * Sort items array based on sort configuration\r\n */\r\nexport function sortItems(\r\n  items: any[],\r\n  fields: FieldConfig[],\r\n  sortConfig: SortConfig,\r\n): any[] {\r\n  if (!sortConfig || items.length === 0) {\r\n    return items;\r\n  }\r\n\r\n  const field = fields.find(\r\n    (f) => f.id === sortConfig.fieldId || f.name === sortConfig.fieldId,\r\n  );\r\n  if (!field) {\r\n    return items;\r\n  }\r\n\r\n  // Create a copy to avoid mutating original\r\n  const sorted = [...items];\r\n\r\n  sorted.sort((a, b) => {\r\n    // Primary sort\r\n    const primaryResult = compareFieldValues(a, b, field, sortConfig.direction);\r\n\r\n    // If equal and secondary sort exists, use secondary\r\n    if (primaryResult === 0 && sortConfig.secondary) {\r\n      const secondaryField = fields.find(\r\n        (f) =>\r\n          f.id === sortConfig.secondary!.fieldId ||\r\n          f.name === sortConfig.secondary!.fieldId,\r\n      );\r\n      if (secondaryField) {\r\n        return compareFieldValues(\r\n          a,\r\n          b,\r\n          secondaryField,\r\n          sortConfig.secondary.direction,\r\n        );\r\n      }\r\n    }\r\n\r\n    return primaryResult;\r\n  });\r\n\r\n  return sorted;\r\n}\r\n\r\n/**\r\n * Compare two items by a specific field\r\n */\r\nexport function compareFieldValues(\r\n  a: any,\r\n  b: any,\r\n  field: FieldConfig,\r\n  direction: \"ASC\" | \"DESC\",\r\n): number {\r\n  // Find field values for both items\r\n  const aValue = getFieldValue(a, field);\r\n  const bValue = getFieldValue(b, field);\r\n\r\n  // Handle null/undefined\r\n  if (aValue === null && bValue === null) return 0;\r\n  if (aValue === null) return direction === \"ASC\" ? 1 : -1;\r\n  if (bValue === null) return direction === \"ASC\" ? -1 : 1;\r\n\r\n  let result = 0;\r\n  const dataType = (field.dataType || \"\").toLowerCase();\r\n\r\n  switch (dataType) {\r\n    case \"text\":\r\n    case \"title\":\r\n      result = compareText(aValue, bValue);\r\n      break;\r\n\r\n    case \"number\":\r\n      result = compareNumber(aValue, bValue);\r\n      break;\r\n\r\n    case \"date\":\r\n      result = compareDate(aValue, bValue);\r\n      break;\r\n\r\n    case \"single_select\":\r\n      result = compareSingleSelect(aValue, bValue, field);\r\n      break;\r\n\r\n    case \"iteration\":\r\n      result = compareIteration(aValue, bValue);\r\n      break;\r\n\r\n    case \"labels\":\r\n      result = compareLabels(aValue, bValue);\r\n      break;\r\n\r\n    case \"assignees\":\r\n    case \"repository\":\r\n    case \"milestone\":\r\n    case \"issue_type\":\r\n    case \"parent_issue\":\r\n    case \"tracked_by\":\r\n    case \"tracks\":\r\n    case \"reviewers\":\r\n      result = compareText(aValue, bValue);\r\n      break;\r\n\r\n    case \"linked_pull_requests\":\r\n    case \"sub_issues_progress\":\r\n      result = compareNumber(aValue, bValue);\r\n      break;\r\n\r\n    default:\r\n      // For unsupported data types, do not apply custom sorting\r\n      // and treat items as equal so their relative order is preserved.\r\n      result = 0;\r\n  }\r\n\r\n  return direction === \"ASC\" ? result : -result;\r\n}\r\n\r\n/**\r\n * Extract field value from item\r\n */\r\nfunction getFieldValue(item: any, field: FieldConfig): any {\r\n  const fieldValue = item.fieldValues?.find(\r\n    (fv: any) => fv.fieldId === field.id || fv.fieldName === field.name,\r\n  );\r\n\r\n  if (!fieldValue) return null;\r\n\r\n  const dataType = (field.dataType || \"\").toLowerCase();\r\n\r\n  switch (dataType) {\r\n    case \"text\": {\r\n      // Normal text fields use .text, but some Title-like fields may be\r\n      // mis-typed as TEXT while still carrying a structured title object.\r\n      if (fieldValue.text != null) return fieldValue.text;\r\n      return extractTitleLikeString(fieldValue, item);\r\n    }\r\n\r\n    case \"title\": {\r\n      // Title fields store a structured object; prefer a human-friendly string\r\n      return extractTitleLikeString(fieldValue, item);\r\n    }\r\n\r\n    case \"number\":\r\n      return fieldValue.number !== undefined ? fieldValue.number : null;\r\n\r\n    case \"date\":\r\n      return (\r\n        fieldValue.date || fieldValue.startDate || fieldValue.dueOn || null\r\n      );\r\n\r\n    case \"single_select\":\r\n      return fieldValue.option || fieldValue;\r\n\r\n    case \"iteration\":\r\n      return fieldValue;\r\n\r\n    case \"labels\":\r\n      return fieldValue.labels || [];\r\n\r\n    case \"assignees\": {\r\n      const list = fieldValue.assignees;\r\n      if (Array.isArray(list) && list.length > 0) {\r\n        const first = list[0];\r\n        return first.login || first.name || null;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    case \"repository\": {\r\n      const repo = fieldValue.repository;\r\n      if (!repo) return null;\r\n      return (\r\n        repo.nameWithOwner || repo.name || repo.full_name || repo.id || null\r\n      );\r\n    }\r\n\r\n    case \"milestone\": {\r\n      const m = fieldValue.milestone;\r\n      if (!m) return null;\r\n      // Prefer due date when present (ISO date strings sort lexicographically),\r\n      // otherwise fall back to title/name.\r\n      return m.dueOn || m.title || m.name || null;\r\n    }\r\n\r\n    case \"issue_type\": {\r\n      if (fieldValue.text) return fieldValue.text;\r\n      if (fieldValue.option) {\r\n        return fieldValue.option.name || fieldValue.option.title || null;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    case \"parent_issue\": {\r\n      const parent = fieldValue.parent;\r\n      if (!parent) return null;\r\n      if (parent.title) return parent.title;\r\n      if (typeof parent.number === \"number\") return String(parent.number);\r\n      return parent.id || null;\r\n    }\r\n\r\n    case \"linked_pull_requests\": {\r\n      const prs = fieldValue.pullRequests;\r\n      if (Array.isArray(prs) && prs.length > 0) {\r\n        const first = prs[0];\r\n        if (typeof first.number === \"number\") return first.number;\r\n        return first.title || null;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    case \"reviewers\": {\r\n      const list = fieldValue.reviewers;\r\n      if (Array.isArray(list) && list.length > 0) {\r\n        const first = list[0];\r\n        return first.login || first.name || first.id || null;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    case \"sub_issues_progress\": {\r\n      if (typeof fieldValue.percent === \"number\") return fieldValue.percent;\r\n      if (\r\n        typeof fieldValue.done === \"number\" &&\r\n        typeof fieldValue.total === \"number\" &&\r\n        fieldValue.total > 0\r\n      ) {\r\n        return (fieldValue.done / fieldValue.total) * 100;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    case \"tracked_by\":\r\n    case \"tracks\": {\r\n      const issues = fieldValue.issues;\r\n      if (Array.isArray(issues) && issues.length > 0) {\r\n        const first = issues[0];\r\n        if (first.title) return first.title;\r\n        if (typeof first.number === \"number\") return String(first.number);\r\n        return first.id || null;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    default:\r\n      return fieldValue;\r\n  }\r\n}\r\n\r\nfunction extractTitleLikeString(fieldValue: any, item: any): string | null {\r\n  if (!fieldValue) return null;\r\n\r\n  // Prefer the underlying raw node's text when present\r\n  const rawNode =\r\n    (fieldValue.title && fieldValue.title.raw) || fieldValue.raw || null;\r\n  if (rawNode && typeof rawNode.text === \"string\" && rawNode.text.trim()) {\r\n    return rawNode.text;\r\n  }\r\n\r\n  // Then look at the content object which often carries title/name\r\n  const content =\r\n    (fieldValue.title && fieldValue.title.content) ||\r\n    fieldValue.content ||\r\n    (rawNode && rawNode.itemContent) ||\r\n    (item && item.content) ||\r\n    null;\r\n\r\n  if (content) {\r\n    if (typeof content === \"string\" && content.trim()) {\r\n      return content;\r\n    }\r\n    if (typeof content.title === \"string\" && content.title.trim()) {\r\n      return content.title;\r\n    }\r\n    if (typeof content.name === \"string\" && content.name.trim()) {\r\n      return content.name;\r\n    }\r\n  }\r\n\r\n  // Fallbacks: occasionally a plain text field is reused\r\n  if (typeof fieldValue.text === \"string\" && fieldValue.text.trim()) {\r\n    return fieldValue.text;\r\n  }\r\n  if (rawNode && typeof rawNode.title === \"string\" && rawNode.title.trim()) {\r\n    return rawNode.title;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Compare text values\r\n */\r\nfunction compareText(a: any, b: any): number {\r\n  const aStr = String(a || \"\").toLowerCase();\r\n  const bStr = String(b || \"\").toLowerCase();\r\n  return aStr.localeCompare(bStr);\r\n}\r\n\r\n/**\r\n * Compare number values\r\n */\r\nfunction compareNumber(a: any, b: any): number {\r\n  const aNum = typeof a === \"number\" ? a : parseFloat(a);\r\n  const bNum = typeof b === \"number\" ? b : parseFloat(b);\r\n\r\n  if (isNaN(aNum) && isNaN(bNum)) return 0;\r\n  if (isNaN(aNum)) return 1;\r\n  if (isNaN(bNum)) return -1;\r\n\r\n  return aNum - bNum;\r\n}\r\n\r\n/**\r\n * Compare date values\r\n */\r\nfunction compareDate(a: any, b: any): number {\r\n  const aDate = new Date(a);\r\n  const bDate = new Date(b);\r\n\r\n  if (isNaN(aDate.getTime()) && isNaN(bDate.getTime())) return 0;\r\n  if (isNaN(aDate.getTime())) return 1;\r\n  if (isNaN(bDate.getTime())) return -1;\r\n\r\n  return aDate.getTime() - bDate.getTime();\r\n}\r\n\r\n/**\r\n * Compare single select values by option order\r\n */\r\nfunction compareSingleSelect(a: any, b: any, field: FieldConfig): number {\r\n  const aOption = a.option || a;\r\n  const bOption = b.option || b;\r\n\r\n  if (!aOption || !bOption) {\r\n    return compareText(aOption?.name || \"\", bOption?.name || \"\");\r\n  }\r\n\r\n  // If field has options array, sort by position in array\r\n  if (field.options && Array.isArray(field.options)) {\r\n    const aIndex = field.options.findIndex(\r\n      (opt: any) => opt.id === aOption.id || opt.name === aOption.name,\r\n    );\r\n    const bIndex = field.options.findIndex(\r\n      (opt: any) => opt.id === bOption.id || opt.name === bOption.name,\r\n    );\r\n\r\n    if (aIndex !== -1 && bIndex !== -1) {\r\n      return aIndex - bIndex;\r\n    }\r\n  }\r\n\r\n  // Fallback to name comparison\r\n  return compareText(aOption.name, bOption.name);\r\n}\r\n\r\n/**\r\n * Compare iteration values by start date\r\n */\r\nfunction compareIteration(a: any, b: any): number {\r\n  const aDate = a.startDate || a.iteration?.startDate;\r\n  const bDate = b.startDate || b.iteration?.startDate;\r\n\r\n  if (!aDate && !bDate) {\r\n    // Sort by title if no dates\r\n    return compareText(\r\n      a.title || a.iteration?.title,\r\n      b.title || b.iteration?.title,\r\n    );\r\n  }\r\n\r\n  return compareDate(aDate, bDate);\r\n}\r\n\r\n/**\r\n * Compare labels by first label name\r\n */\r\nfunction compareLabels(a: any, b: any): number {\r\n  const aLabels = Array.isArray(a) ? a : [];\r\n  const bLabels = Array.isArray(b) ? b : [];\r\n\r\n  if (aLabels.length === 0 && bLabels.length === 0) return 0;\r\n  if (aLabels.length === 0) return 1;\r\n  if (bLabels.length === 0) return -1;\r\n\r\n  return compareText(aLabels[0].name, bLabels[0].name);\r\n}\r\n", "export class GroupDataService {\r\n  public static groupItems(items: any[], field: any): any[] {\r\n    // Normalize options: Single Select uses .options, Iteration uses .configuration.iterations\r\n    let options: any[] = [];\r\n    const dType = (field.dataType || \"\").toLowerCase();\r\n    if (dType === \"single_select\") {\r\n      options = field.options || [];\r\n    } else if (dType === \"iteration\") {\r\n      options = (field.configuration && field.configuration.iterations) || [];\r\n    }\r\n    // If we have explicit options (single select/iteration), use them to group.\r\n    if (options && options.length > 0) {\r\n      const groups: any[] = options.map((opt: any) => ({\r\n        option: opt,\r\n        items: [],\r\n      }));\r\n      const unassigned: any[] = [];\r\n\r\n      items.forEach((item, index) => {\r\n        const fv = item.fieldValues.find(\r\n          (v: any) =>\r\n            String(v.fieldId) === String(field.id) ||\r\n            v.fieldName === field.name,\r\n        );\r\n        let placed = false;\r\n\r\n        if (fv) {\r\n          // Match logic\r\n          let matchId: string | null = null;\r\n          let matchName: string | null = null;\r\n\r\n          if (dType === \"single_select\") {\r\n            matchId = fv.optionId || (fv.option && fv.option.id);\r\n            matchName = fv.name || (fv.option && fv.option.name);\r\n          } else if (dType === \"iteration\") {\r\n            matchId =\r\n              fv.iterationId || (fv.iteration && fv.iteration.id) || fv.id;\r\n            matchName = fv.title || (fv.iteration && fv.iteration.title);\r\n          }\r\n\r\n          if (matchId || matchName) {\r\n            const group = groups.find(\r\n              (g: any) =>\r\n                (matchId && String(g.option.id) === String(matchId)) ||\r\n                (matchName &&\r\n                  (String(g.option.name) === String(matchName) ||\r\n                    String(g.option.title) === String(matchName))),\r\n            );\r\n            if (group) {\r\n              group.items.push({ item, index });\r\n              placed = true;\r\n            }\r\n          }\r\n        }\r\n\r\n        if (!placed) {\r\n          unassigned.push({ item, index });\r\n        }\r\n      });\r\n\r\n      if (unassigned.length > 0) {\r\n        groups.push({\r\n          option: { name: \"Unassigned\", title: \"Unassigned\", color: \"GRAY\" },\r\n          items: unassigned,\r\n        });\r\n      }\r\n\r\n      return groups.filter((g: any) => g.items.length > 0);\r\n    }\r\n\r\n    // Fallback grouping: build groups based on actual item values (useful for assignees, repository, date, number, etc.)\r\n    const map = new Map<string, { option: any; items: any[] }>();\r\n    const unassignedFallback: any[] = [];\r\n\r\n    items.forEach((item, index) => {\r\n      const fv = item.fieldValues.find(\r\n        (v: any) =>\r\n          String(v.fieldId) === String(field.id) || v.fieldName === field.name,\r\n      );\r\n      let val: any = null;\r\n      if (fv) {\r\n        // Text/title/number/date straightforward\r\n        if (fv.text !== undefined) val = fv.text;\r\n        else if (fv.title !== undefined) val = fv.title;\r\n        else if (fv.number !== undefined) val = fv.number;\r\n        else if (fv.date !== undefined) val = fv.date;\r\n        // single_select / option\r\n        else if (fv.option)\r\n          val = fv.option.name || fv.option.title || fv.option.id;\r\n        // iteration\r\n        else if (fv.iteration) val = fv.iteration.title || fv.iteration.id;\r\n        // parent_issue - try parent/parentIssue/issue/item/value/raw\r\n        else if (\r\n          fv.parent ||\r\n          fv.parentIssue ||\r\n          fv.issue ||\r\n          fv.item ||\r\n          fv.value\r\n        ) {\r\n          const p =\r\n            fv.parent || fv.parentIssue || fv.issue || fv.item || fv.value;\r\n          if (p) {\r\n            // Prefer number, then id, then url, then title\r\n            val =\r\n              p.number ||\r\n              p.id ||\r\n              (p.raw && (p.raw.number || p.raw.id)) ||\r\n              p.url ||\r\n              p.title ||\r\n              p.name ||\r\n              null;\r\n          }\r\n        }\r\n        // assignees\r\n        else if (fv.assignees)\r\n          val = Array.isArray(fv.assignees)\r\n            ? fv.assignees.map((a: any) => a.login || a.name).join(\", \")\r\n            : fv.assignees;\r\n        // repository\r\n        else if (fv.repository)\r\n          val =\r\n            fv.repository.nameWithOwner ||\r\n            fv.repository.name ||\r\n            fv.repository.full_name ||\r\n            fv.repository.id;\r\n        // milestone\r\n        else if (fv.milestone)\r\n          val = fv.milestone.title || fv.milestone.id || fv.milestone.name;\r\n        else val = fv.value !== undefined ? fv.value : null;\r\n      }\r\n\r\n      if (val === null || val === undefined || val === \"\") {\r\n        unassignedFallback.push({ item, index });\r\n        return;\r\n      }\r\n\r\n      const key = String(val);\r\n      if (!map.has(key)) {\r\n        map.set(key, { option: { id: key, name: key, title: key }, items: [] });\r\n      }\r\n      map.get(key)!.items.push({ item, index });\r\n    });\r\n\r\n    const groupsArr = Array.from(map.values());\r\n    if (unassignedFallback.length > 0) {\r\n      groupsArr.push({\r\n        option: { name: \"Unassigned\", title: \"Unassigned\", color: \"GRAY\" },\r\n        items: unassignedFallback,\r\n      });\r\n    }\r\n\r\n    return groupsArr;\r\n  }\r\n}\r\n", "/**\r\n * Icon Registry\r\n * Central registry for all GitHub-style Octicon SVGs used in webviews.\r\n * Uses official GitHub Octicons SVG paths for consistency.\r\n */\r\n\r\n/**\r\n * All available icon names in the registry\r\n */\r\nexport type IconName =\r\n  // View layouts\r\n  | \"table\"\r\n  | \"project\"\r\n  | \"board\"\r\n  | \"roadmap\"\r\n  // Field types\r\n  | \"list\"\r\n  | \"people\"\r\n  | \"tag\"\r\n  | \"single-select\"\r\n  | \"issue-tracks\"\r\n  | \"issue-tracked-by\"\r\n  | \"iterations\"\r\n  | \"number\"\r\n  | \"calendar\"\r\n  | \"pull-request\"\r\n  | \"milestone\"\r\n  | \"repo\"\r\n  | \"typography\"\r\n  // Issues and pull requests\r\n  | \"issue-opened\"\r\n  | \"issue-closed\"\r\n  | \"issue-draft\"\r\n  | \"git-pull-request\"\r\n  | \"git-pull-request-closed\"\r\n  | \"git-pull-request-draft\"\r\n  | \"git-merge\"\r\n  | \"blocked\"\r\n  // Sorting and grouping\r\n  | \"sort-asc\"\r\n  | \"sort-desc\"\r\n  | \"rows\"\r\n  | \"sliceby\"\r\n  // Navigation and actions\r\n  | \"eye-closed\"\r\n  | \"arrow-left\"\r\n  | \"arrow-right\"\r\n  | \"triangle-down\"\r\n  | \"triangle-right\"\r\n  | \"note\";\r\n\r\n/**\r\n * Icon definition with SVG path data and metadata\r\n */\r\ninterface IconDefinition {\r\n  /**\r\n   * SVG path data (d attribute) or full inner HTML for multi-path icons\r\n   */\r\n  path: string;\r\n  /**\r\n   * ViewBox dimensions (default: \"0 0 16 16\")\r\n   */\r\n  viewBox?: string;\r\n  /**\r\n   * Whether this is full inner HTML (multiple paths/elements) vs single path\r\n   */\r\n  isInnerHTML?: boolean;\r\n}\r\n\r\n/**\r\n * Registry of all icon definitions with official GitHub Octicons SVG paths\r\n */\r\nconst ICON_DEFINITIONS: Record<IconName, IconDefinition> = {\r\n  // View layouts\r\n  table: {\r\n    path: \"M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25ZM6.5 6.5v8h7.75a.25.25 0 0 0 .25-.25V6.5Zm8-1.5V1.75a.25.25 0 0 0-.25-.25H6.5V5Zm-13 1.5v7.75c0 .138.112.25.25.25H5v-8ZM5 5V1.5H1.75a.25.25 0 0 0-.25.25V5Z\",\r\n  },\r\n  project: {\r\n    path: \"M1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0ZM1.5 1.75v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25ZM11.75 3a.75.75 0 0 1 .75.75v7.5a.75.75 0 0 1-1.5 0v-7.5a.75.75 0 0 1 .75-.75Zm-8.25.75a.75.75 0 0 1 1.5 0v5.5a.75.75 0 0 1-1.5 0ZM8 3a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 3Z\",\r\n  },\r\n  board: {\r\n    // Same as project icon\r\n    path: \"M1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0ZM1.5 1.75v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25ZM11.75 3a.75.75 0 0 1 .75.75v7.5a.75.75 0 0 1-1.5 0v-7.5a.75.75 0 0 1 .75-.75Zm-8.25.75a.75.75 0 0 1 1.5 0v5.5a.75.75 0 0 1-1.5 0ZM8 3a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 3Z\",\r\n  },\r\n  roadmap: {\r\n    path: '<path d=\"M4.75 7a.75.75 0 0 0 0 1.5h4.5a.75.75 0 0 0 0-1.5h-4.5ZM5 4.75A.75.75 0 0 1 5.75 4h5.5a.75.75 0 0 1 0 1.5h-5.5A.75.75 0 0 1 5 4.75ZM6.75 10a.75.75 0 0 0 0 1.5h4.5a.75.75 0 0 0 0-1.5h-4.5Z\" /><path d=\"M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25Z\" />',\r\n    isInnerHTML: true,\r\n  },\r\n\r\n  // Field types\r\n  list: {\r\n    path: \"M5.75 2.5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5Zm0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5Zm0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5ZM2 14a1 1 0 1 1 0-2 1 1 0 0 1 0 2Zm1-6a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM2 4a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z\",\r\n  },\r\n  people: {\r\n    path: \"M2 5.5a3.5 3.5 0 1 1 5.898 2.549 5.508 5.508 0 0 1 3.034 4.084.75.75 0 1 1-1.482.235 4 4 0 0 0-7.9 0 .75.75 0 0 1-1.482-.236A5.507 5.507 0 0 1 3.102 8.05 3.493 3.493 0 0 1 2 5.5ZM11 4a3.001 3.001 0 0 1 2.22 5.018 5.01 5.01 0 0 1 2.56 3.012.749.749 0 0 1-.885.954.752.752 0 0 1-.549-.514 3.507 3.507 0 0 0-2.522-2.372.75.75 0 0 1-.574-.73v-.352a.75.75 0 0 1 .416-.672A1.5 1.5 0 0 0 11 5.5.75.75 0 0 1 11 4Zm-5.5-.5a2 2 0 1 0-.001 3.999A2 2 0 0 0 5.5 3.5Z\",\r\n  },\r\n  tag: {\r\n    path: '<path d=\"M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25\"></path>',\r\n    isInnerHTML: true,\r\n  },\r\n  \"single-select\": {\r\n    path: '<path d=\"m5.06 7.356 2.795 2.833c.08.081.21.081.29 0l2.794-2.833c.13-.131.038-.356-.145-.356H5.206c-.183 0-.275.225-.145.356Z\"></path><path d=\"M1 2.75C1 1.784 1.784 1 2.75 1h10.5c.966 0 1.75.784 1.75 1.75v10.5A1.75 1.75 0 0 1 13.25 15H2.75A1.75 1.75 0 0 1 1 13.25Zm1.75-.25a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h10.5a.25.25 0 0 0 .25-.25V2.75a.25.25 0 0 0-.25-.25Z\"></path>',\r\n    isInnerHTML: true,\r\n  },\r\n  \"issue-tracks\": {\r\n    path: '<path d=\"M1.5 8a6.5 6.5 0 0 1 13 0A.75.75 0 0 0 16 8a8 8 0 1 0-8 8 .75.75 0 0 0 0-1.5A6.5 6.5 0 0 1 1.5 8Z\"></path><path d=\"M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm3.573 5.823-2.896-2.896a.25.25 0 0 1 0-.354l2.896-2.896a.25.25 0 0 1 .427.177V11.5h3.25a.75.75 0 0 1 0 1.5H12v2.146a.25.25 0 0 1-.427.177Z\"></path>',\r\n    isInnerHTML: true,\r\n  },\r\n  \"issue-tracked-by\": {\r\n    path: '<path d=\"M1.5 8a6.5 6.5 0 0 1 13 0A.75.75 0 0 0 16 8a8 8 0 1 0-8 8 .75.75 0 0 0 0-1.5A6.5 6.5 0 0 1 1.5 8Z\"></path><path d=\"M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm1.5 1.75a.75.75 0 0 1 .75-.75h5a.75.75 0 0 1 0 1.5h-5a.75.75 0 0 1-.75-.75Zm2.75 2.25a.75.75 0 0 0 0 1.5h3a.75.75 0 0 0 0-1.5h-3Z\"></path>',\r\n    isInnerHTML: true,\r\n  },\r\n  iterations: {\r\n    path: \"M2.5 7.25a4.75 4.75 0 0 1 9.5 0 .75.75 0 0 0 1.5 0 6.25 6.25 0 1 0-6.25 6.25H12v2.146c0 .223.27.335.427.177l2.896-2.896a.25.25 0 0 0 0-.354l-2.896-2.896a.25.25 0 0 0-.427.177V12H7.25A4.75 4.75 0 0 1 2.5 7.25Z\",\r\n  },\r\n  number: {\r\n    path: \"M9 4.75A.75.75 0 0 1 9.75 4h4a.75.75 0 0 1 .53 1.28l-1.89 1.892c.312.076.604.18.867.319.742.391 1.244 1.063 1.244 2.005 0 .653-.231 1.208-.629 1.627-.386.408-.894.653-1.408.777-1.01.243-2.225.063-3.124-.527a.751.751 0 0 1 .822-1.254c.534.35 1.32.474 1.951.322.306-.073.53-.201.67-.349.129-.136.218-.32.218-.596 0-.308-.123-.509-.444-.678-.373-.197-.98-.318-1.806-.318a.75.75 0 0 1-.53-1.28l1.72-1.72H9.75A.75.75 0 0 1 9 4.75Zm-3.587 5.763c-.35-.05-.77.113-.983.572a.75.75 0 1 1-1.36-.632c.508-1.094 1.589-1.565 2.558-1.425 1 .145 1.872.945 1.872 2.222 0 1.433-1.088 2.192-1.79 2.681-.308.216-.571.397-.772.573H7a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75c0-.69.3-1.211.67-1.61.348-.372.8-.676 1.15-.92.8-.56 1.18-.904 1.18-1.474 0-.473-.267-.69-.587-.737ZM5.604.089A.75.75 0 0 1 6 .75v4.77h.711a.75.75 0 0 1 0 1.5H3.759a.75.75 0 0 1 0-1.5H4.5V2.15l-.334.223a.75.75 0 0 1-.832-1.248l1.5-1a.75.75 0 0 1 .77-.037Z\",\r\n  },\r\n  calendar: {\r\n    path: \"M4.75 0a.75.75 0 0 1 .75.75V2h5V.75a.75.75 0 0 1 1.5 0V2h1.25c.966 0 1.75.784 1.75 1.75v10.5A1.75 1.75 0 0 1 13.25 16H2.75A1.75 1.75 0 0 1 1 14.25V3.75C1 2.784 1.784 2 2.75 2H4V.75A.75.75 0 0 1 4.75 0ZM2.5 7.5v6.75c0 .138.112.25.25.25h10.5a.25.25 0 0 0 .25-.25V7.5Zm10.75-4H2.75a.25.25 0 0 0-.25.25V6h11V3.75a.25.25 0 0 0-.25-.25Z\",\r\n  },\r\n  \"pull-request\": {\r\n    path: \"M1.5 3.25a2.25 2.25 0 1 1 3 2.122v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.25 2.25 0 0 1 1.5 3.25Zm5.677-.177L9.573.677A.25.25 0 0 1 10 .854V2.5h1A2.5 2.5 0 0 1 13.5 5v5.628a2.251 2.251 0 1 1-1.5 0V5a1 1 0 0 0-1-1h-1v1.646a.25.25 0 0 1-.427.177L7.177 3.427a.25.25 0 0 1 0-.354ZM3.75 2.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm0 9.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm8.25.75a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Z\",\r\n  },\r\n  milestone: {\r\n    path: \"M7.75 0a.75.75 0 0 1 .75.75V3h3.634c.414 0 .814.147 1.13.414l2.07 1.75a1.75 1.75 0 0 1 0 2.672l-2.07 1.75a1.75 1.75 0 0 1-1.13.414H8.5v5.25a.75.75 0 0 1-1.5 0V10H2.75A1.75 1.75 0 0 1 1 8.25v-3.5C1 3.784 1.784 3 2.75 3H7V.75A.75.75 0 0 1 7.75 0Zm4.384 8.5a.25.25 0 0 0 .161-.06l2.07-1.75a.248.248 0 0 0 0-.38l-2.07-1.75a.25.25 0 0 0-.161-.06H2.75a.25.25 0 0 0-.25.25v3.5c0 .138.112.25.25.25h9.384Z\",\r\n  },\r\n  repo: {\r\n    path: \"M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z\",\r\n  },\r\n  typography: {\r\n    path: \"M6.71 10H2.332l-.874 2.498a.75.75 0 0 1-1.415-.496l3.39-9.688a1.217 1.217 0 0 1 2.302.018l3.227 9.681a.75.75 0 0 1-1.423.474Zm3.13-4.358C10.53 4.374 11.87 4 13 4c1.5 0 3 .939 3 2.601v5.649a.75.75 0 0 1-1.448.275C13.995 12.82 13.3 13 12.5 13c-.77 0-1.514-.231-2.078-.709-.577-.488-.922-1.199-.922-2.041 0-.694.265-1.411.887-1.944C11 7.78 11.88 7.5 13 7.5h1.5v-.899c0-.54-.5-1.101-1.5-1.101-.869 0-1.528.282-1.84.858a.75.75 0 1 1-1.32-.716ZM6.21 8.5 4.574 3.594 2.857 8.5Zm8.29.5H13c-.881 0-1.375.22-1.637.444-.253.217-.363.5-.363.806 0 .408.155.697.39.896.249.21.63.354 1.11.354.732 0 1.26-.209 1.588-.449.35-.257.412-.495.412-.551Z\",\r\n  },\r\n\r\n  // Issues and pull requests\r\n  \"issue-opened\": {\r\n    path: '<path d=\"M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z\"></path><path d=\"M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z\"></path>',\r\n    isInnerHTML: true,\r\n  },\r\n  \"issue-closed\": {\r\n    path: '<path d=\"M11.28 6.78a.75.75 0 0 0-1.06-1.06L7.25 8.69 5.78 7.22a.75.75 0 0 0-1.06 1.06l2 2a.75.75 0 0 0 1.06 0l3.5-3.5Z\"></path><path d=\"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0Zm-1.5 0a6.5 6.5 0 1 0-13 0 6.5 6.5 0 0 0 13 0Z\"></path>',\r\n    isInnerHTML: true,\r\n  },\r\n  \"issue-draft\": {\r\n    path: '<path d=\"M14.307 11.655a.75.75 0 0 1 .165 1.048 8.05 8.05 0 0 1-1.769 1.77.75.75 0 0 1-.883-1.214 6.552 6.552 0 0 0 1.44-1.439.75.75 0 0 1 1.047-.165Zm-2.652-9.962a.75.75 0 0 1 1.048-.165 8.05 8.05 0 0 1 1.77 1.769.75.75 0 0 1-1.214.883 6.552 6.552 0 0 0-1.439-1.44.75.75 0 0 1-.165-1.047ZM6.749.097a8.074 8.074 0 0 1 2.502 0 .75.75 0 1 1-.233 1.482 6.558 6.558 0 0 0-2.036 0A.751.751 0 0 1 6.749.097ZM.955 6.125a.75.75 0 0 1 .624.857 6.558 6.558 0 0 0 0 2.036.75.75 0 1 1-1.482.233 8.074 8.074 0 0 1 0-2.502.75.75 0 0 1 .858-.624Zm14.09 0a.75.75 0 0 1 .858.624c.13.829.13 1.673 0 2.502a.75.75 0 1 1-1.482-.233 6.558 6.558 0 0 0 0-2.036.75.75 0 0 1 .624-.857Zm-8.92 8.92a.75.75 0 0 1 .857-.624 6.558 6.558 0 0 0 2.036 0 .75.75 0 1 1 .233 1.482c-.829.13-1.673.13-2.502 0a.75.75 0 0 1-.624-.858Zm-4.432-3.39a.75.75 0 0 1 1.048.165 6.552 6.552 0 0 0 1.439 1.44.751.751 0 0 1-.883 1.212 8.05 8.05 0 0 1-1.77-1.769.75.75 0 0 1 .166-1.048Zm2.652-9.962A.75.75 0 0 1 4.18 2.74a6.556 6.556 0 0 0-1.44 1.44.751.751 0 0 1-1.212-.883 8.05 8.05 0 0 1 1.769-1.77.75.75 0 0 1 1.048.166Z\"></path>',\r\n    isInnerHTML: true,\r\n  },\r\n  \"git-pull-request\": {\r\n    path: \"M1.5 3.25a2.25 2.25 0 1 1 3 2.122v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.25 2.25 0 0 1 1.5 3.25Zm5.677-.177L9.573.677A.25.25 0 0 1 10 .854V2.5h1A2.5 2.5 0 0 1 13.5 5v5.628a2.251 2.251 0 1 1-1.5 0V5a1 1 0 0 0-1-1h-1v1.646a.25.25 0 0 1-.427.177L7.177 3.427a.25.25 0 0 1 0-.354ZM3.75 2.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm0 9.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm8.25.75a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Z\",\r\n  },\r\n  \"git-pull-request-closed\": {\r\n    path: \"M3.25 1A2.25 2.25 0 0 1 4 5.372v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.251 2.251 0 0 1 3.25 1Zm9.5 5.5a.75.75 0 0 1 .75.75v3.378a2.251 2.251 0 1 1-1.5 0V7.25a.75.75 0 0 1 .75-.75Zm-2.03-5.273a.75.75 0 0 1 1.06 0l.97.97.97-.97a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.97.97.97.97a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-.97-.97-.97.97a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l.97-.97-.97-.97a.75.75 0 0 1 0-1.06ZM2.5 3.25a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0ZM3.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm9.5 0a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z\",\r\n  },\r\n  \"git-pull-request-draft\": {\r\n    path: \"M3.25 1A2.25 2.25 0 0 1 4 5.372v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.251 2.251 0 0 1 3.25 1Zm9.5 14a2.25 2.25 0 1 1 0-4.5 2.25 2.25 0 0 1 0 4.5ZM2.5 3.25a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0ZM3.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm9.5 0a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM14 7.5a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0Zm0-4.25a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0Z\",\r\n  },\r\n  \"git-merge\": {\r\n    path: \"M5.45 5.154A4.25 4.25 0 0 0 9.25 7.5h1.378a2.251 2.251 0 1 1 0 1.5H9.25A5.734 5.734 0 0 1 5 7.123v3.505a2.25 2.25 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.95-.218ZM4.25 13.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm8.5-4.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM5 3.25a.75.75 0 1 0 0 .005V3.25Z\",\r\n  },\r\n  blocked: {\r\n    path: \"M4.467.22a.749.749 0 0 1 .53-.22h6.006c.199 0 .389.079.53.22l4.247 4.247c.141.14.22.331.22.53v6.006a.749.749 0 0 1-.22.53l-4.247 4.247a.749.749 0 0 1-.53.22H4.997a.749.749 0 0 1-.53-.22L.22 11.533a.749.749 0 0 1-.22-.53V4.997c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.308v5.384L5.308 14.5h5.384l3.808-3.808V5.308L10.692 1.5ZM4 7.75A.75.75 0 0 1 4.75 7h6.5a.75.75 0 0 1 0 1.5h-6.5A.75.75 0 0 1 4 7.75Z\",\r\n  },\r\n\r\n  // Sorting and grouping\r\n  \"sort-asc\": {\r\n    path: \"m12.927 2.573 3 3A.25.25 0 0 1 15.75 6H13.5v6.75a.75.75 0 0 1-1.5 0V6H9.75a.25.25 0 0 1-.177-.427l3-3a.25.25 0 0 1 .354 0ZM0 12.25a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1-.75-.75Zm0-4a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 0 1.5H.75A.75.75 0 0 1 0 8.25Zm0-4a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5H.75A.75.75 0 0 1 0 4.25Z\",\r\n  },\r\n  \"sort-desc\": {\r\n    path: \"M0 4.25a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5H.75A.75.75 0 0 1 0 4.25Zm0 4a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 0 1.5H.75A.75.75 0 0 1 0 8.25Zm0 4a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1-.75-.75ZM13.5 10h2.25a.25.25 0 0 1 .177.427l-3 3a.25.25 0 0 1-.354 0l-3-3A.25.25 0 0 1 9.75 10H12V3.75a.75.75 0 0 1 1.5 0V10Z\",\r\n  },\r\n  rows: {\r\n    path: \"M16 10.75v2.5A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25v-2.5C0 9.784.784 9 1.75 9h12.5c.966 0 1.75.784 1.75 1.75Zm0-8v2.5A1.75 1.75 0 0 1 14.25 7H1.75A1.75 1.75 0 0 1 0 5.25v-2.5C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75Zm-1.75-.25H1.75a.25.25 0 0 0-.25.25v2.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-2.5a.25.25 0 0 0-.25-.25Zm0 8H1.75a.25.25 0 0 0-.25.25v2.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-2.5a.25.25 0 0 0-.25-.25Z\",\r\n  },\r\n  sliceby: {\r\n    path: \"M14.5 1.5H6.5V5H10C10.4142 5 10.75 5.33579 10.75 5.75C10.75 6.16421 10.4142 6.5 10 6.5H6.5V7.75C6.5 8.16421 6.16421 8.5 5.75 8.5C5.33579 8.5 5 8.16421 5 7.75V6.5H1.5V14.5H5V12.75C5 12.3358 5.33579 12 5.75 12C6.16421 12 6.5 12.3358 6.5 12.75V14.5H14.5V1.5ZM5 1.5V5H1.5V1.5H5ZM0 14.5V5.75V1.5C0 0.671573 0.671573 0 1.5 0H5.75H14.5C15.3284 0 16 0.671573 16 1.5V14.5C16 15.3284 15.3284 16 14.5 16H5.75H1.5C0.671573 16 0 15.3284 0 14.5ZM9.62012 9.58516C10.8677 9.59206 11.8826 8.58286 11.8826 7.33544V6.32279C11.8826 5.90857 12.2184 5.57279 12.6326 5.57279C13.0468 5.57279 13.3826 5.90857 13.3826 6.32279V7.33544C13.3826 9.4147 11.6909 11.0966 9.61182 11.0851L9.3826 11.0839L9.3826 12.9995C9.3826 13.2178 9.12245 13.3312 8.96248 13.1827L6.07989 10.506C5.97337 10.4071 5.97337 10.2385 6.07989 10.1396L8.96248 7.46291C9.12245 7.31438 9.3826 7.42782 9.3826 7.64611V9.58384L9.62012 9.58516Z\",\r\n  },\r\n\r\n  // Navigation and actions\r\n  \"eye-closed\": {\r\n    path: \"M.143 2.31a.75.75 0 0 1 1.047-.167l14.5 10.5a.75.75 0 1 1-.88 1.214l-2.248-1.628C11.346 13.19 9.792 14 8 14c-1.981 0-3.67-.992-4.933-2.078C1.797 10.832.88 9.577.43 8.9a1.619 1.619 0 0 1 0-1.797c.353-.533.995-1.42 1.868-2.305L.31 3.357A.75.75 0 0 1 .143 2.31Zm1.536 5.622A.12.12 0 0 0 1.657 8c0 .021.006.045.022.068.412.621 1.242 1.75 2.366 2.717C5.175 11.758 6.527 12.5 8 12.5c1.195 0 2.31-.488 3.29-1.191L9.063 9.695A2 2 0 0 1 6.058 7.52L3.529 5.688a14.207 14.207 0 0 0-1.85 2.244ZM8 3.5c-.516 0-1.017.09-1.499.251a.75.75 0 1 1-.473-1.423A6.207 6.207 0 0 1 8 2c1.981 0 3.67.992 4.933 2.078 1.27 1.091 2.187 2.345 2.637 3.023a1.62 1.62 0 0 1 0 1.798c-.11.166-.248.365-.41.587a.75.75 0 1 1-1.21-.887c.148-.201.272-.382.371-.53a.119.119 0 0 0 0-.137c-.412-.621-1.242-1.75-2.366-2.717C10.825 4.242 9.473 3.5 8 3.5Z\",\r\n  },\r\n  \"arrow-left\": {\r\n    path: \"M7.78 12.53a.75.75 0 0 1-1.06 0L2.47 8.28a.75.75 0 0 1 0-1.06l4.25-4.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L4.81 7h7.44a.75.75 0 0 1 0 1.5H4.81l2.97 2.97a.75.75 0 0 1 0 1.06Z\",\r\n  },\r\n  \"arrow-right\": {\r\n    path: \"M8.22 2.97a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l2.97-2.97H3.75a.75.75 0 0 1 0-1.5h7.44L8.22 4.03a.75.75 0 0 1 0-1.06Z\",\r\n  },\r\n  \"triangle-down\": {\r\n    path: \"M4.427 7.427l3.396 3.396a.25.25 0 00.354 0l3.396-3.396A.25.25 0 0011.396 7H4.604a.25.25 0 00-.177.427z\",\r\n  },\r\n  \"triangle-right\": {\r\n    path: \"M8.573 4.604a.25.25 0 01.427-.177l3.396 3.396a.25.25 0 010 .354l-3.396 3.396a.25.25 0 01-.427-.177V4.604z\",\r\n  },\r\n  note: {\r\n    path: \"M0 3.75C0 2.784.784 2 1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25Zm1.75-.25a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25ZM3.5 6.25a.75.75 0 0 1 .75-.75h7a.75.75 0 0 1 0 1.5h-7a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h4a.75.75 0 0 0 0-1.5h-4Z\",\r\n  },\r\n};\r\n\r\n/**\r\n * Options for customizing icon rendering\r\n */\r\nexport interface IconOptions {\r\n  /**\r\n   * Icon size (width and height in pixels, default: 14)\r\n   */\r\n  size?: number;\r\n  /**\r\n   * Additional CSS class names\r\n   */\r\n  className?: string;\r\n  /**\r\n   * Color fill (default: currentColor)\r\n   */\r\n  fill?: string;\r\n  /**\r\n   * ARIA label for accessibility (makes icon visible to screen readers)\r\n   */\r\n  ariaLabel?: string;\r\n  /**\r\n   * Title text for tooltip\r\n   */\r\n  title?: string;\r\n}\r\n\r\n/**\r\n * Get an inline SVG string for the specified icon\r\n * @param name - The icon name from the registry\r\n * @param options - Optional customization options\r\n * @returns HTML string containing the SVG element\r\n */\r\nexport function getIconSvg(name: IconName, options: IconOptions = {}): string {\r\n  const icon = ICON_DEFINITIONS[name];\r\n  if (!icon) {\r\n    console.warn(`Icon \"${name}\" not found in registry`);\r\n    return \"\";\r\n  }\r\n\r\n  const size = options.size ?? 14;\r\n  const className = options.className\r\n    ? `octicon octicon-${name} ${options.className}`\r\n    : `octicon octicon-${name}`;\r\n  const fill = options.fill ?? \"currentColor\";\r\n  const viewBox = icon.viewBox ?? \"0 0 16 16\";\r\n  const ariaHidden = options.ariaLabel ? \"false\" : \"true\";\r\n  const ariaLabel = options.ariaLabel\r\n    ? ` aria-label=\"${escapeHtml(options.ariaLabel)}\"`\r\n    : \"\";\r\n  const title = options.title\r\n    ? `<title>${escapeHtml(options.title)}</title>`\r\n    : \"\";\r\n\r\n  // Build SVG string\r\n  let innerContent: string;\r\n  if (icon.isInnerHTML) {\r\n    innerContent = icon.path;\r\n  } else {\r\n    innerContent = `<path d=\"${icon.path}\"/>`;\r\n  }\r\n\r\n  return `<svg class=\"${className}\" viewBox=\"${viewBox}\" width=\"${size}\" height=\"${size}\" fill=\"${fill}\" aria-hidden=\"${ariaHidden}\"${ariaLabel} focusable=\"false\">${title}${innerContent}</svg>`;\r\n}\r\n\r\n/**\r\n * Create a DOM element for the specified icon\r\n * @param name - The icon name from the registry\r\n * @param options - Optional customization options\r\n * @returns HTMLElement containing the icon\r\n */\r\nexport function createIconElement(\r\n  name: IconName,\r\n  options: IconOptions = {},\r\n): HTMLElement {\r\n  const wrapper = document.createElement(\"span\");\r\n  wrapper.innerHTML = getIconSvg(name, options);\r\n  return wrapper.firstElementChild as HTMLElement;\r\n}\r\n\r\n/**\r\n * Helper function to escape HTML special characters\r\n */\r\nfunction escapeHtml(text: string): string {\r\n  return text\r\n    .replace(/&/g, \"&amp;\")\r\n    .replace(/</g, \"&lt;\")\r\n    .replace(/>/g, \"&gt;\")\r\n    .replace(/\"/g, \"&quot;\")\r\n    .replace(/'/g, \"&#39;\");\r\n}\r\n\r\n/**\r\n * Map field data types to icon names\r\n * @param dataType - The field data type\r\n * @returns The corresponding icon name\r\n */\r\nexport function getIconNameForDataType(dataType: string): IconName {\r\n  const normalized = (dataType || \"\").toLowerCase();\r\n\r\n  switch (normalized) {\r\n    case \"title\":\r\n      return \"list\";\r\n    case \"assignees\":\r\n    case \"reviewers\":\r\n      return \"people\";\r\n    case \"single_select\":\r\n      return \"single-select\";\r\n    case \"labels\":\r\n      return \"tag\";\r\n    case \"parent_issue\":\r\n      return \"issue-tracks\";\r\n    case \"sub_issues_progress\":\r\n      return \"issue-tracked-by\";\r\n    case \"iteration\":\r\n      return \"iterations\";\r\n    case \"number\":\r\n    case \"numeric\":\r\n      return \"number\";\r\n    case \"date\":\r\n      return \"calendar\";\r\n    case \"linked_pull_request\":\r\n    case \"linked_pull_requests\":\r\n    case \"pull_request\":\r\n      return \"pull-request\";\r\n    case \"milestone\":\r\n      return \"milestone\";\r\n    case \"repository\":\r\n      return \"repo\";\r\n    case \"text\":\r\n    case \"string\":\r\n      return \"typography\";\r\n    default:\r\n      return \"tag\"; // fallback\r\n  }\r\n}\r\n", "import {\r\n  escapeHtml,\r\n  normalizeColor,\r\n  getContrastColor,\r\n  addAlpha,\r\n} from \"../../client/utils\";\r\nimport { getIconSvg } from \"../icons/iconRegistry\";\r\n\r\nexport interface CellRendererStrategy {\r\n  render(value: any, field: any, item: any, allItems: any): string;\r\n}\r\n\r\nexport class TitleRenderer implements CellRendererStrategy {\r\n  render(value: any, field: any, item: any, allItems: any): string {\r\n    let t =\r\n      (value &&\r\n        value.title &&\r\n        ((value.title.raw && value.title.raw.text) ||\r\n          (value.title.content &&\r\n            (value.title.content.title || value.title.content.name)) ||\r\n          (typeof value.title == \"string\" && value.title))) ||\r\n      (value && value.content && (value.content.title || value.content.name)) ||\r\n      (value && value.raw && value.raw.text) ||\r\n      \"\";\r\n    let o =\r\n      (value &&\r\n        value.title &&\r\n        value.title.content &&\r\n        value.title.content.number) ||\r\n      (value &&\r\n        value.raw &&\r\n        value.raw.itemContent &&\r\n        value.raw.itemContent.number) ||\r\n      (item && item.content && item.content.number) ||\r\n      \"\";\r\n    let l =\r\n      (value &&\r\n        value.title &&\r\n        value.title.content &&\r\n        value.title.content.url) ||\r\n      (value &&\r\n        value.raw &&\r\n        value.raw.itemContent &&\r\n        value.raw.itemContent.url) ||\r\n      (item && item.content && item.content.url) ||\r\n      \"\";\r\n    let r = null;\r\n    if (item && Array.isArray(item.fieldValues)) {\r\n      let w = item.fieldValues.find(\r\n        (x: any) =>\r\n          x &&\r\n          x.type === \"single_select\" &&\r\n          ((x.raw &&\r\n            x.raw.field &&\r\n            String(x.raw.field.name || \"\").toLowerCase() === \"status\") ||\r\n            (x.fieldName &&\r\n              String(x.fieldName || \"\").toLowerCase() === \"status\") ||\r\n            (x.field &&\r\n              x.field.name &&\r\n              String(x.field.name || \"\").toLowerCase() === \"status\")),\r\n      );\r\n      w &&\r\n        (r =\r\n          (w.option && (w.option.color || w.option.id || w.option.name)) ||\r\n          (w.raw && w.raw.color) ||\r\n          null);\r\n    }\r\n    let a = normalizeColor(r) || null,\r\n      p = a && /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(a) ? a : \"#666666\",\r\n      g = escapeHtml(String(t || \"\")),\r\n      f = o ? escapeHtml(String(o)) : \"\";\r\n\r\n    // Determine high-level content type (issue vs pull request) and state\r\n    const content =\r\n      (value && value.title && value.title.content) ||\r\n      (value && value.raw && value.raw.itemContent) ||\r\n      (item && item.content) ||\r\n      null;\r\n\r\n    let isPullRequest = false;\r\n    let isDraft = false;\r\n    let isClosed = false;\r\n    let isMerged = false;\r\n    let isBlocked = false;\r\n\r\n    let parentIsDoneByStatus = false;\r\n    try {\r\n      if (content && typeof content.__typename === \"string\") {\r\n        const tname = String(content.__typename).toLowerCase();\r\n        if (tname.includes(\"pullrequest\")) isPullRequest = true;\r\n      }\r\n      if (!isPullRequest && content && typeof content.state === \"string\") {\r\n        const st = String(content.state).toUpperCase();\r\n        if (st === \"CLOSED\") isClosed = true;\r\n        if (st === \"MERGED\") isMerged = true;\r\n      }\r\n      if (isPullRequest) {\r\n        if (typeof (content as any).isDraft === \"boolean\") {\r\n          isDraft = !!(content as any).isDraft;\r\n        }\r\n        const st =\r\n          (content as any).state &&\r\n          String((content as any).state).toUpperCase();\r\n        if (st === \"CLOSED\") isClosed = true;\r\n        if ((content as any).merged) isMerged = true;\r\n      }\r\n      const completedNames = [\"done\", \"closed\", \"completed\", \"finished\"];\r\n      // Canonical blocked state from GraphQL Issue dependencies\r\n      try {\r\n        const deps =\r\n          content && (content as any).issueDependenciesSummary\r\n            ? (content as any).issueDependenciesSummary\r\n            : null;\r\n        const blockedByCount =\r\n          deps && typeof deps.blockedBy === \"number\" ? deps.blockedBy : 0;\r\n        isBlocked = blockedByCount > 0;\r\n      } catch (_) {\r\n        isBlocked = false;\r\n      }\r\n\r\n      let hasDoneFromStatus = false;\r\n      if (Array.isArray(item && item.fieldValues)) {\r\n        const statusFv = (item.fieldValues as any[]).find((fv: any) => {\r\n          if (!fv || fv.type !== \"single_select\") return false;\r\n          const fname =\r\n            (fv.raw && fv.raw.field && fv.raw.field.name) ||\r\n            fv.fieldName ||\r\n            (fv.field && fv.field.name) ||\r\n            \"\";\r\n          return String(fname || \"\").toLowerCase() === \"status\";\r\n        });\r\n        if (statusFv && statusFv.option && statusFv.option.name) {\r\n          const optNameLower = String(statusFv.option.name).toLowerCase();\r\n          if (completedNames.includes(optNameLower)) {\r\n            hasDoneFromStatus = true;\r\n          }\r\n        }\r\n      }\r\n      // Treat issues/PRs as effectively closed when status or labels indicate \"done\"-like states\r\n      const hasDoneLabel = !!(\r\n        content &&\r\n        content.labels &&\r\n        Array.isArray(content.labels.nodes) &&\r\n        content.labels.nodes.some((l: any) =>\r\n          completedNames.includes(\r\n            String((l && l.name) || \"\").toLowerCase(),\r\n          ),\r\n        )\r\n      );\r\n\r\n      if (hasDoneFromStatus || hasDoneLabel) {\r\n        // Do not override \"merged\" (PRs still show merge icon),\r\n        // but otherwise consider this effectively closed for icon purposes.\r\n        if (!isMerged) {\r\n          isClosed = true;\r\n        }\r\n      }\r\n    } catch (e) {}\r\n\r\n    // Choose base icon based on type/state\r\n    let iconName = \"issue-opened\";\r\n    if (isPullRequest) {\r\n      if (isMerged) iconName = \"git-merge\";\r\n      else if (isClosed) iconName = \"git-pull-request-closed\";\r\n      else if (isDraft) iconName = \"git-pull-request-draft\";\r\n      else iconName = \"git-pull-request\";\r\n    } else {\r\n      if (isClosed) iconName = \"issue-closed\";\r\n      else if (isDraft) iconName = \"issue-draft\";\r\n      else iconName = \"issue-opened\";\r\n    }\r\n\r\n    const baseIcon = getIconSvg(iconName as any, {\r\n      size: 14,\r\n      className: \"field-icon title-icon\",\r\n      fill: p,\r\n    });\r\n\r\n    const blockedIcon = isBlocked\r\n      ? getIconSvg(\"blocked\" as any, {\r\n          size: 9,\r\n          className: \"field-icon blocked-icon\",\r\n          fill: \"#dc3545\",\r\n        })\r\n      : \"\";\r\n\r\n    return (\r\n      '<a href=\"' +\r\n      escapeHtml(String(l || \"\")) +\r\n      '\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"text-decoration:none;color:inherit;display:inline-flex;align-items:center;gap:8px;width:100%;\">' +\r\n      \"<span style='position:relative;display:inline-flex;align-items:center;justify-content:center;flex-shrink:0'>\" +\r\n      baseIcon +\r\n      (blockedIcon\r\n        ? \"<span class='blocked-overlay' style='position:absolute;right:-3px;bottom:-3px;width:14px;height:14px;border-radius:999px;background:var(--vscode-editor-background);display:flex;align-items:center;justify-content:center;box-sizing:border-box;'>\" +\r\n          blockedIcon +\r\n          \"</span>\"\r\n        : \"\") +\r\n      \"</span>\" +\r\n      '<span style=\"flex:1;min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:block\">' +\r\n      g +\r\n      \"</span>\" +\r\n      (f\r\n        ? '<span style=\"flex:none;margin-left:6px;color:var(--vscode-descriptionForeground);white-space:nowrap\">#' +\r\n          f +\r\n          \"</span>\"\r\n        : \"\") +\r\n      \"</a>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class TextRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    return (\r\n      \"<div>\" +\r\n      escapeHtml((value && value.text) != null ? value.text : \"\") +\r\n      \"</div>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class NumberRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    let t =\r\n      value.number !== void 0 && value.number !== null\r\n        ? String(value.number)\r\n        : \"\";\r\n    return (\r\n      '<div style=\"text-align:right;font-variant-numeric:tabular-nums\">' +\r\n      escapeHtml(t) +\r\n      \"</div>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class DateRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    let t = value.date || value.startDate || value.dueOn || null;\r\n    if (!t) return \"<div></div>\";\r\n    try {\r\n      let o = new Date(t);\r\n      if (isNaN(o.getTime())) return \"<div>\" + escapeHtml(String(t)) + \"</div>\";\r\n      let l = o.toLocaleDateString(\"en-US\", {\r\n        month: \"short\",\r\n        day: \"numeric\",\r\n        year: \"numeric\",\r\n      });\r\n      return \"<div>\" + escapeHtml(l) + \"</div>\";\r\n    } catch (e) {\r\n      return \"<div>\" + escapeHtml(String(t)) + \"</div>\";\r\n    }\r\n  }\r\n}\r\n\r\nexport class SingleSelectRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    let n =\r\n      (value && value.option && value.option.name) ||\r\n      (value && value.name) ||\r\n      \"\";\r\n    if (!n) return \"<div></div>\";\r\n    let c =\r\n      (value && value.option && (value.option.color || value.option.id)) ||\r\n      (value && value.color) ||\r\n      null;\r\n    // Match visual style of label field pills\r\n    let p = normalizeColor(c) || null,\r\n      hasHex = !!(p && /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(p)),\r\n      border = p || \"#999999\",\r\n      bg = (hasHex && addAlpha(p, 0.12)) || \"rgba(0,0,0,0.06)\",\r\n      fg = p || \"#333333\";\r\n    return (\r\n      \"<span style='display:inline-block;padding:2px 8px;margin-right:6px;border-radius:999px;border:1px solid \" +\r\n      escapeHtml(border) +\r\n      \";background:\" +\r\n      escapeHtml(bg) +\r\n      \";color:\" +\r\n      escapeHtml(fg) +\r\n      \";font-size:12px;line-height:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis'>\" +\r\n      escapeHtml(n) +\r\n      \"</span>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class IterationRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    let i = value.iteration || value;\r\n    if (!i || !i.title) return \"<div></div>\";\r\n    // Use same pill design as labels/single-select fields\r\n    const name = String(i.title || \"\");\r\n    const rawColor = i.color || i.colour || null;\r\n    let p = normalizeColor(rawColor) || null,\r\n      hasHex = !!(p && /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(p)),\r\n      border = p || \"#999999\",\r\n      bg = (hasHex && addAlpha(p, 0.12)) || \"rgba(0,0,0,0.06)\",\r\n      // Ensure text color matches the pill border color\r\n      fg = border;\r\n    return (\r\n      \"<span style='display:inline-block;padding:2px 8px;margin-right:6px;border-radius:999px;border:1px solid \" +\r\n      escapeHtml(border) +\r\n      \";background:\" +\r\n      escapeHtml(bg) +\r\n      \";color:\" +\r\n      escapeHtml(fg) +\r\n      \";font-size:12px;line-height:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis'>\" +\r\n      escapeHtml(name) +\r\n      \"</span>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class RepositoryRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    const r = value && (value.repository || value);\r\n    if (!r) return \"<div></div>\";\r\n\r\n    const name =\r\n      (r && (r.nameWithOwner || r.full_name || r.name || r.id || \"\")) || \"\";\r\n\r\n    if (!name) return \"<div></div>\";\r\n\r\n    const icon = getIconSvg(\"repo\", {\r\n      size: 16,\r\n      className: \"field-icon\",\r\n      ariaLabel: \"Repository\",\r\n    });\r\n\r\n    return (\r\n      '<div style=\"display:flex;align-items:center;gap:6px\">' +\r\n      icon +\r\n      \"<span>\" +\r\n      escapeHtml(String(name)) +\r\n      \"</span></div>\"\r\n    );\r\n  }\r\n}\r\n\r\n// Helper for contrast color (duplicated from utils to avoid circular deps if utils imports this, but utils is safe)\r\n// Removed local getContrastColor since we import it.\r\n\r\nexport class LabelsRenderer implements CellRendererStrategy {\r\n  render(value: any, field: any, item: any, allItems: any): string {\r\n    return (\r\n      \"<div>\" +\r\n      (value.labels || [])\r\n        .map((o: any) => {\r\n          let l = escapeHtml(o.name || \"\"),\r\n            r =\r\n              (item &&\r\n                ((item.content &&\r\n                  item.content.repository &&\r\n                  item.content.repository.nameWithOwner) ||\r\n                  (item.repository && item.repository.nameWithOwner))) ||\r\n              (value.raw &&\r\n                value.raw.itemContent &&\r\n                value.raw.itemContent.repository &&\r\n                value.raw.itemContent.repository.nameWithOwner) ||\r\n              null,\r\n            a = o.color || o.colour || null;\r\n          if (field && field.repoOptions && r && field.repoOptions[r]) {\r\n            let k = field.repoOptions[r].find(\r\n              (L: any) => L && L.name === o.name,\r\n            );\r\n            k && (a = k.color || k.colour || a);\r\n          }\r\n          let p = normalizeColor(a) || null,\r\n            g = !!(p && /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(p)),\r\n            f = p || \"#999999\",\r\n            h = (g && addAlpha(p, 0.12)) || \"rgba(0,0,0,0.06)\",\r\n            w = p || \"#333333\";\r\n          return (\r\n            \"<span style='display:inline-block;padding:2px 8px;margin-right:6px;border-radius:999px;border:1px solid \" +\r\n            escapeHtml(f) +\r\n            \";background:\" +\r\n            escapeHtml(h) +\r\n            \";color:\" +\r\n            escapeHtml(w) +\r\n            \";font-size:12px;line-height:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis'>\" +\r\n            l +\r\n            \"</span>\"\r\n          );\r\n        })\r\n        .join(\"\") +\r\n      \"</div>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class PullRequestRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    const prs = value.pullRequests || [];\r\n    if (!prs || prs.length === 0) return \"\";\r\n    let out =\r\n      \"<div style='display:flex;flex-wrap:wrap;gap:6px;align-items:center'>\";\r\n    for (let i = 0; i < prs.length; i++) {\r\n      let p = prs[i];\r\n      let num = escapeHtml(String((p && p.number) || \"\"));\r\n      let titleText = escapeHtml((p && p.title) || \"\");\r\n      let url = escapeHtml((p && p.url) || \"\");\r\n      let rawColor =\r\n        (p && (p.state_color || p.color || p.colour || p.state)) || null;\r\n      let normColor = normalizeColor(rawColor) || null;\r\n      let hasHex = !!(\r\n        normColor && /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(normColor)\r\n      );\r\n      let border = normColor || \"#999999\";\r\n      let bg = (hasHex && addAlpha(normColor, 0.12)) || \"rgba(0,0,0,0.06)\";\r\n      let fg = getContrastColor(normColor) || \"#333333\";\r\n      const isDraft = !!(p && (p as any).isDraft);\r\n      const state = (p && p.state && String(p.state).toUpperCase()) || \"\";\r\n      const isMerged = !!(p && p.merged);\r\n      const isClosed = !isMerged && state === \"CLOSED\";\r\n\r\n      let iconName = \"git-pull-request\";\r\n      if (isMerged) iconName = \"git-merge\";\r\n      else if (isClosed) iconName = \"git-pull-request-closed\";\r\n      else if (isDraft) iconName = \"git-pull-request-draft\";\r\n\r\n      const baseIcon = getIconSvg(iconName as any, {\r\n        size: 12,\r\n        className: \"field-icon pr-icon\",\r\n        fill: normColor || \"#666\",\r\n      });\r\n\r\n      // Blocked heuristic for PR: label named \"blocked\"\r\n      const hasBlockedLabel = !!(\r\n        p &&\r\n        Array.isArray(p.labels) &&\r\n        p.labels.some(\r\n          (l: any) =>\r\n            l &&\r\n            typeof l.name === \"string\" &&\r\n            String(l.name).toLowerCase() === \"blocked\",\r\n        )\r\n      );\r\n\r\n      const blockedIcon = hasBlockedLabel\r\n        ? getIconSvg(\"blocked\" as any, {\r\n            size: 8,\r\n            className: \"field-icon blocked-icon\",\r\n            fill: \"#dc3545\",\r\n          })\r\n        : \"\";\r\n\r\n      out +=\r\n        \"<a href='\" +\r\n        url +\r\n        \"' target='_blank' rel='noopener noreferrer' style='text-decoration:none;color:inherit'>\" +\r\n        \"<span title='\" +\r\n        titleText +\r\n        \"' style='display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;border:1px solid \" +\r\n        escapeHtml(border) +\r\n        \";background:\" +\r\n        escapeHtml(bg) +\r\n        \";color:\" +\r\n        escapeHtml(fg) +\r\n        \";font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;max-width:160px'>\" +\r\n        \"<span style='position:relative;display:inline-flex;align-items:center;justify-content:center'>\" +\r\n        baseIcon +\r\n        (blockedIcon\r\n          ? \"<span class='blocked-overlay' style='position:absolute;right:-3px;bottom:-3px;width:13px;height:13px;border-radius:999px;background:var(--vscode-editor-background);display:flex;align-items:center;justify-content:center;box-sizing:border-box;'>\" +\r\n            blockedIcon +\r\n            \"</span>\"\r\n          : \"\") +\r\n        \"</span>\" +\r\n        \"<span style='flex:1 1 auto;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap'>#\" +\r\n        num +\r\n        \"</span></span></a>\";\r\n    }\r\n    out += \"</div>\";\r\n    return out;\r\n  }\r\n}\r\n\r\nexport class IssueRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    return (value.issues || [])\r\n      .map(\r\n        (t: any) =>\r\n          \"<a href='\" +\r\n          escapeHtml(t.url || \"\") +\r\n          \"' target='_blank' rel='noopener noreferrer'>#\" +\r\n          escapeHtml(String(t.number || \"\")) +\r\n          \" \" +\r\n          escapeHtml(t.title || \"\") +\r\n          \"</a>\",\r\n      )\r\n      .join(\"<br/>\");\r\n  }\r\n}\r\n\r\nexport class AssigneesRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    let t = value.assignees || [];\r\n    if (t.length === 0) return \"<div></div>\";\r\n    let l = t\r\n        .slice(0, 3)\r\n        .map((g: any, f: any) => {\r\n          let h = escapeHtml(g.avatarUrl || g.avatar || \"\"),\r\n            w = f === 0 ? \"0px\" : f === 1 ? \"-8px\" : \"-14px\",\r\n            x = Math.max(1, 3 - f);\r\n          if (h)\r\n            return (\r\n              \"<span title='\" +\r\n              escapeHtml(g.login || g.name || \"\") +\r\n              \"' style='display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url(\" +\r\n              h +\r\n              \");border:2px solid var(--vscode-editor-background);margin-left:\" +\r\n              w +\r\n              \";vertical-align:middle;position:relative;z-index:\" +\r\n              x +\r\n              \"'></span>\"\r\n            );\r\n          let k = escapeHtml(\r\n            (g.name || g.login || \"\")\r\n              .split(\" \")\r\n              .map((L: any) => L[0] || \"\")\r\n              .join(\"\")\r\n              .toUpperCase()\r\n              .slice(0, 2),\r\n          );\r\n          return (\r\n            \"<span title='\" +\r\n            escapeHtml(g.login || g.name || \"\") +\r\n            \"' style='display:inline-flex;align-items:center;justify-content:center;width:20px;height:20px;border-radius:50%;background:#777;color:#fff;font-size:11px;border:2px solid var(--vscode-editor-background);margin-left:\" +\r\n            w +\r\n            \";vertical-align:middle;position:relative;z-index:\" +\r\n            x +\r\n            \"'>\" +\r\n            k +\r\n            \"</span>\"\r\n          );\r\n        })\r\n        .join(\"\"),\r\n      r = t.map((g: any) => g.login || g.name || \"\"),\r\n      a = \"\";\r\n    if (r.length === 1) a = r[0];\r\n    else if (r.length === 2) a = r[0] + \" and \" + r[1];\r\n    else a = r.slice(0, -1).join(\", \") + \" and \" + r.slice(-1)[0];\r\n\r\n    return (\r\n      \"<div style='display:flex;align-items:center;gap:8px'><span style='display:flex;align-items:center'>\" +\r\n      (\"<span style='display:inline-block;vertical-align:middle;height:20px;line-height:20px;margin-right:8px;'>\" +\r\n        l +\r\n        \"</span>\") +\r\n      \"</span><span style='white-space:nowrap;overflow:hidden;text-overflow:ellipsis'>\" +\r\n      escapeHtml(a) +\r\n      \"</span></div>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class RequestedReviewersRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    return (\r\n      \"<div>\" +\r\n      escapeHtml(\r\n        (value.reviewers || [])\r\n          .map((t: any) => t.login || t.name || t.kind || \"\")\r\n          .join(\", \"),\r\n      ) +\r\n      \"</div>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class MilestoneRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    return (\r\n      \"<div>\" +\r\n      escapeHtml((value.milestone && value.milestone.title) || \"\") +\r\n      \"</div>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class SubIssuesProgressRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    try {\r\n      if (!value || value.total == null || Number(value.total) <= 0) return \"\";\r\n      const totalCount = Math.max(0, Math.floor(Number(value.total) || 0));\r\n      const doneCount = Math.max(0, Math.floor(Number(value.done || 0)));\r\n      if (totalCount === 0) return \"\";\r\n      let pct = null;\r\n      if (value.percent !== void 0 && value.percent !== null)\r\n        pct = Number(value.percent);\r\n      else pct = Math.round((doneCount / totalCount) * 100);\r\n      if (pct == null || !isFinite(pct)) return \"\";\r\n      pct = Math.max(0, Math.min(100, pct));\r\n      const barHtml =\r\n        \"<div class='sub-issues-progress' style='display:flex;align-items:center;gap:8px;width:100%;'>\" +\r\n        \"<div class='sub-issues-progress-count' style='min-width:44px;text-align:left;font-variant-numeric:tabular-nums;color:var(--vscode-descriptionForeground)'>\" +\r\n        escapeHtml(String(doneCount) + \"/\" + String(totalCount)) +\r\n        \"</div>\" +\r\n        \"<div class='sub-issues-progress-bar' style='flex:1;min-width:0'>\" +\r\n        \"<div style='width:100%;height:12px;border-radius:6px;border:1px solid var(--vscode-focusBorder);overflow:hidden;background:transparent;box-sizing:border-box'>\" +\r\n        \"<div style='height:100%;width:\" +\r\n        String(pct) +\r\n        \"%;background:var(--vscode-focusBorder)'></div>\" +\r\n        \"</div>\" +\r\n        \"</div>\" +\r\n        \"<div class='sub-issues-progress-pct' style='min-width:44px;text-align:right;font-variant-numeric:tabular-nums;color:var(--vscode-descriptionForeground)'>\" +\r\n        escapeHtml(String(pct) + \"%\") +\r\n        \"</div>\" +\r\n        \"</div>\";\r\n      return barHtml;\r\n    } catch (e) {\r\n      return \"\";\r\n    }\r\n  }\r\n}\r\n\r\nexport class ParentIssueRenderer implements CellRendererStrategy {\r\n  render(value: any, field: any, item: any, allItems: any): string {\r\n    const completedNames = [\"done\", \"closed\", \"completed\", \"finished\"];\r\n    let parentIsDoneByStatus = false;\r\n\r\n    let t =\r\n        (value &&\r\n          (value.parent ||\r\n            value.parentIssue ||\r\n            value.issue ||\r\n            value.option ||\r\n            value.item ||\r\n            value.value)) ||\r\n        (value &&\r\n          value.raw &&\r\n          (value.raw.parent || value.raw.itemContent || value.raw.item)) ||\r\n        null,\r\n      o =\r\n        (t &&\r\n          (t.number || t.id || (t.raw && t.raw.number)) &&\r\n          (t.number || (t.raw && t.raw.number))) ||\r\n        \"\",\r\n      l =\r\n        (t &&\r\n          (t.title || t.name || (t.raw && t.raw.title)) &&\r\n          (t.title || t.name || (t.raw && t.raw.title))) ||\r\n        \"\",\r\n      r =\r\n        (t &&\r\n          (t.url || t.html_url || (t.raw && t.raw.url)) &&\r\n          (t.url || t.html_url || (t.raw && t.raw.url))) ||\r\n        \"\",\r\n      a = escapeHtml(String(l || \"\")),\r\n      p = o ? escapeHtml(String(o)) : \"\",\r\n      g = escapeHtml(String(r || \"\")),\r\n      f = null;\r\n    try {\r\n      var itemsList = Array.isArray(allItems) ? allItems : allItems || [];\r\n      if (Array.isArray(itemsList) && itemsList.length > 0 && (o || t)) {\r\n        let B =\r\n            (t &&\r\n              t.repository &&\r\n              (t.repository.nameWithOwner || t.repository.name)) ||\r\n            (t &&\r\n              t.content &&\r\n              t.content.repository &&\r\n              t.content.repository.nameWithOwner) ||\r\n            null,\r\n          O: string[] = [];\r\n        (o && O.push(String(o)),\r\n          t &&\r\n            (t.id || (t.raw && t.raw.id)) &&\r\n            O.push(String(t.id || (t.raw && t.raw.id))),\r\n          t &&\r\n            (t.url || (t.raw && t.raw.url)) &&\r\n            O.push(String(t.url || (t.raw && t.raw.url))),\r\n          t && (t.title || t.name) && O.push(String(t.title || t.name)));\r\n        let $ = itemsList.find((A) => {\r\n          let d = (A && (A.content || (A.raw && A.raw.itemContent))) || null;\r\n          if (!d) return !1;\r\n          let M = [];\r\n          if (\r\n            (d.number && M.push(String(d.number)),\r\n            d.id && M.push(String(d.id)),\r\n            d.url && M.push(String(d.url)),\r\n            d.title && M.push(String(d.title)),\r\n            d.name && M.push(String(d.name)),\r\n            d.raw && d.raw.number && M.push(String(d.raw.number)),\r\n            d.raw && d.raw.id && M.push(String(d.raw.id)),\r\n            d.raw && d.raw.url && M.push(String(d.raw.url)),\r\n            B)\r\n          ) {\r\n            let V =\r\n              (d.repository &&\r\n                (d.repository.nameWithOwner || d.repository.name)) ||\r\n              null;\r\n            if (V && String(V) !== String(B)) return !1;\r\n          }\r\n          for (let V = 0; V < O.length; V++)\r\n            for (let X = 0; X < M.length; X++)\r\n              if (O[V] && M[X] && String(O[V]) === String(M[X])) return !0;\r\n          return !1;\r\n        });\r\n        if ($ && Array.isArray($.fieldValues)) {\r\n          let A = $.fieldValues.find(\r\n            (d: any) =>\r\n              d &&\r\n              d.type === \"single_select\" &&\r\n              ((d.raw &&\r\n                d.raw.field &&\r\n                String(d.raw.field.name || \"\").toLowerCase() === \"status\") ||\r\n                (d.fieldName &&\r\n                  String(d.fieldName || \"\").toLowerCase() === \"status\") ||\r\n                (d.field &&\r\n                  d.field.name &&\r\n                  String(d.field.name || \"\").toLowerCase() === \"status\")),\r\n          );\r\n          if (A) {\r\n            f =\r\n              (A.option && (A.option.color || A.option.id || A.option.name)) ||\r\n              (A.raw && A.raw.color) ||\r\n              null;\r\n\r\n            // If the parent issue's Status option is a completed-like state,\r\n            // treat it as closed for icon purposes.\r\n            if (A.option && A.option.name) {\r\n              const optNameLower = String(A.option.name).toLowerCase();\r\n              if (completedNames.includes(optNameLower)) {\r\n                parentIsDoneByStatus = true;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    } catch (e) {}\r\n    f ||\r\n      (f =\r\n        (t &&\r\n          ((t.option && (t.option.color || t.option.id || t.option.name)) ||\r\n            t.color ||\r\n            t.colour)) ||\r\n        null);\r\n    let h = normalizeColor(f) || null,\r\n      w = !!(h && /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(h)),\r\n      x = h || \"#999999\",\r\n      k = (w && addAlpha(h, 0.12)) || \"rgba(0,0,0,0.06)\",\r\n      L = getContrastColor(h) || \"#333333\";\r\n\r\n    // Determine icon for parent issue based on state and blocked heuristics\r\n    let isClosed = false;\r\n    let isDraft = false;\r\n    let isBlocked = false;\r\n    try {\r\n      const state =\r\n        (t && t.state && String(t.state).toUpperCase()) ||\r\n        (t &&\r\n          t.parent &&\r\n          t.parent.state &&\r\n          String(t.parent.state).toUpperCase()) ||\r\n        \"\";\r\n      if (state === \"CLOSED\") isClosed = true;\r\n\r\n      const hasBlockedLabel = !!(\r\n        t &&\r\n        Array.isArray(t.labels) &&\r\n        t.labels.some(\r\n          (l: any) =>\r\n            l &&\r\n            typeof l.name === \"string\" &&\r\n            String(l.name).toLowerCase() === \"blocked\",\r\n        )\r\n      );\r\n      isBlocked = hasBlockedLabel;\r\n\r\n      // Treat parent issue as effectively closed when status or labels indicate\r\n      // \"done\"-like states, mirroring the TitleRenderer heuristics.\r\n      const hasDoneLabel = !!(\r\n        t &&\r\n        Array.isArray(t.labels) &&\r\n        t.labels.some((l: any) =>\r\n          completedNames.includes(String((l && l.name) || \"\").toLowerCase()),\r\n        )\r\n      );\r\n\r\n      if (hasDoneLabel || parentIsDoneByStatus) {\r\n        isClosed = true;\r\n      }\r\n    } catch (e) {}\r\n\r\n    let parentIconName = \"issue-opened\";\r\n    if (isClosed) parentIconName = \"issue-closed\";\r\n    else if (isDraft) parentIconName = \"issue-draft\";\r\n\r\n    const parentIcon = getIconSvg(parentIconName as any, {\r\n      size: 14,\r\n      className: \"field-icon parent-issue-icon\",\r\n      fill: h || \"#666\",\r\n    });\r\n\r\n    const blockedIcon = isBlocked\r\n      ? getIconSvg(\"blocked\" as any, {\r\n          size: 9,\r\n          className: \"field-icon blocked-icon\",\r\n          fill: \"#dc3545\",\r\n        })\r\n      : \"\";\r\n\r\n    let q =\r\n      \"<span style='display:block;width:100%;box-sizing:border-box'>\" +\r\n      \"<div style='display:inline-flex;align-items:center;gap:8px;padding:4px 10px;border:1px solid \" +\r\n      escapeHtml(x) +\r\n      \";border-radius:999px;color:\" +\r\n      escapeHtml(L) +\r\n      \";background:\" +\r\n      escapeHtml(k) +\r\n      \";font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;width:100%'>\" +\r\n      \"<span style='position:relative;display:inline-flex;align-items:center;justify-content:center'>\" +\r\n      parentIcon +\r\n      (blockedIcon\r\n        ? \"<span class='blocked-overlay' style='position:absolute;right:-3px;bottom:-3px;width:14px;height:14px;border-radius:999px;background:var(--vscode-editor-background);display:flex;align-items:center;justify-content:center;box-sizing:border-box;'>\" +\r\n          blockedIcon +\r\n          \"</span>\"\r\n        : \"\") +\r\n      \"</span>\" +\r\n      \"<span class='parent-issue-title' style='flex:1;min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:block'>\" +\r\n      a +\r\n      \"</span>\" +\r\n      (p\r\n        ? \"<span style='margin-left:6px;color:var(--vscode-descriptionForeground);white-space:nowrap'>#\" +\r\n          p +\r\n          \"</span>\"\r\n        : \"\") +\r\n      \"</div></span>\";\r\n    const parentWrapper =\r\n      \"<span data-gh-open='\" +\r\n      (g || \"\") +\r\n      \"' class='parent-issue-wrapper' style='display:block;width:100%;cursor:\" +\r\n      (g ? \"pointer\" : \"default\") +\r\n      \"'>\";\r\n    return g ? parentWrapper + q + \"</span>\" : q;\r\n  }\r\n}\r\n", "import {\r\n  CellRendererStrategy,\r\n  TitleRenderer,\r\n  TextRenderer,\r\n  NumberRenderer,\r\n  DateRenderer,\r\n  SingleSelectRenderer,\r\n  IterationRenderer,\r\n  RepositoryRenderer,\r\n  LabelsRenderer,\r\n  PullRequestRenderer,\r\n  IssueRenderer,\r\n  AssigneesRenderer,\r\n  RequestedReviewersRenderer,\r\n  MilestoneRenderer,\r\n  SubIssuesProgressRenderer,\r\n  ParentIssueRenderer,\r\n} from \"./strategies\";\r\n\r\nconst strategies: Record<string, CellRendererStrategy> = {\r\n  title: new TitleRenderer(),\r\n  text: new TextRenderer(),\r\n  number: new NumberRenderer(),\r\n  date: new DateRenderer(),\r\n  single_select: new SingleSelectRenderer(),\r\n  iteration: new IterationRenderer(),\r\n  repository: new RepositoryRenderer(),\r\n  labels: new LabelsRenderer(),\r\n  pull_request: new PullRequestRenderer(),\r\n  issue: new IssueRenderer(),\r\n  assignees: new AssigneesRenderer(),\r\n  reviewers: new RequestedReviewersRenderer(),\r\n  milestone: new MilestoneRenderer(),\r\n  sub_issues_progress: new SubIssuesProgressRenderer(),\r\n  parent_issue: new ParentIssueRenderer(),\r\n  linked_pull_requests: new PullRequestRenderer(),\r\n  tracks: new IssueRenderer(),\r\n};\r\n\r\nexport function renderCell(e: any, n: any, s: any, allItems: any) {\r\n  if (!e) return \"\";\r\n  try {\r\n    const strategy = strategies[e.type];\r\n    if (strategy) {\r\n      return strategy.render(e, n, s, allItems);\r\n    }\r\n    return \"\";\r\n  } catch (err) {\r\n    console.error(\"Error rendering cell\", err);\r\n    return \"\";\r\n  }\r\n}\r\n", "/**\r\n * Base Picker Component\r\n * Provides common functionality for all picker components including:\r\n * - Popover positioning and lifecycle\r\n * - Keyboard navigation\r\n * - Search/filter functionality\r\n * - Backdrop handling\r\n */\r\n\r\nexport interface BasePickerOptions {\r\n  anchorElement: HTMLElement;\r\n  title: string;\r\n  onClose: () => void;\r\n  onApply?: () => void;\r\n  searchPlaceholder?: string;\r\n  minWidth?: string;\r\n  maxHeight?: string;\r\n}\r\n\r\nexport abstract class BasePicker {\r\n  protected pickerElement: HTMLElement | null = null;\r\n  protected backdropElement: HTMLElement | null = null;\r\n  protected searchInput: HTMLInputElement | null = null;\r\n  protected contentContainer: HTMLElement | null = null;\r\n  protected options: BasePickerOptions;\r\n  protected focusedIndex: number = -1;\r\n  protected selectableItems: HTMLElement[] = [];\r\n\r\n  constructor(options: BasePickerOptions) {\r\n    this.options = options;\r\n  }\r\n\r\n  /**\r\n   * Show the picker anchored to the provided element\r\n   */\r\n  public show(): void {\r\n    this.hide();\r\n\r\n    // Create backdrop\r\n    this.backdropElement = document.createElement(\"div\");\r\n    this.backdropElement.style.position = \"fixed\";\r\n    this.backdropElement.style.top = \"0\";\r\n    this.backdropElement.style.left = \"0\";\r\n    this.backdropElement.style.right = \"0\";\r\n    this.backdropElement.style.bottom = \"0\";\r\n    this.backdropElement.style.zIndex = \"999\";\r\n    this.backdropElement.addEventListener(\"click\", () => this.close());\r\n    document.body.appendChild(this.backdropElement);\r\n\r\n    // Create picker container\r\n    this.pickerElement = document.createElement(\"div\");\r\n    this.pickerElement.className = \"field-picker\";\r\n    this.pickerElement.style.position = \"absolute\";\r\n    this.pickerElement.style.background = \"var(--vscode-menu-background)\";\r\n    this.pickerElement.style.border = \"1px solid var(--vscode-menu-border)\";\r\n    this.pickerElement.style.borderRadius = \"4px\";\r\n    this.pickerElement.style.boxShadow = \"0 2px 8px rgba(0, 0, 0, 0.15)\";\r\n    this.pickerElement.style.minWidth = this.options.minWidth || \"280px\";\r\n    this.pickerElement.style.maxWidth = \"400px\";\r\n    this.pickerElement.style.zIndex = \"1000\";\r\n    this.pickerElement.style.display = \"flex\";\r\n    this.pickerElement.style.flexDirection = \"column\";\r\n    this.pickerElement.style.overflow = \"hidden\";\r\n\r\n    // Position below anchor\r\n    const rect = this.options.anchorElement.getBoundingClientRect();\r\n    this.pickerElement.style.top = `${rect.bottom + 4}px`;\r\n    this.pickerElement.style.left = `${rect.left}px`;\r\n\r\n    // Build picker structure\r\n    this.buildHeader();\r\n    this.buildSearchBox();\r\n    this.buildContent();\r\n    this.buildFooter();\r\n\r\n    document.body.appendChild(this.pickerElement);\r\n\r\n    // Focus search input if available\r\n    if (this.searchInput) {\r\n      setTimeout(() => this.searchInput?.focus(), 0);\r\n    }\r\n\r\n    // Setup keyboard navigation\r\n    this.setupKeyboardNavigation();\r\n  }\r\n\r\n  /**\r\n   * Hide and cleanup the picker\r\n   */\r\n  public hide(): void {\r\n    if (this.pickerElement) {\r\n      this.pickerElement.remove();\r\n      this.pickerElement = null;\r\n    }\r\n    if (this.backdropElement) {\r\n      this.backdropElement.remove();\r\n      this.backdropElement = null;\r\n    }\r\n    this.searchInput = null;\r\n    this.contentContainer = null;\r\n    this.selectableItems = [];\r\n    this.focusedIndex = -1;\r\n  }\r\n\r\n  /**\r\n   * Close picker and trigger onClose callback\r\n   */\r\n  protected close(): void {\r\n    this.hide();\r\n    this.options.onClose();\r\n  }\r\n\r\n  /**\r\n   * Build the header section\r\n   */\r\n  private buildHeader(): void {\r\n    if (!this.pickerElement) return;\r\n\r\n    const header = document.createElement(\"div\");\r\n    header.style.padding = \"12px\";\r\n    header.style.borderBottom = \"1px solid var(--vscode-menu-separatorBackground)\";\r\n    header.style.fontWeight = \"600\";\r\n    header.style.fontSize = \"13px\";\r\n    header.style.color = \"var(--vscode-foreground)\";\r\n    header.textContent = this.options.title;\r\n\r\n    this.pickerElement.appendChild(header);\r\n  }\r\n\r\n  /**\r\n   * Build the search box\r\n   */\r\n  private buildSearchBox(): void {\r\n    if (!this.pickerElement || !this.options.searchPlaceholder) return;\r\n\r\n    const searchContainer = document.createElement(\"div\");\r\n    searchContainer.style.padding = \"8px 12px\";\r\n    searchContainer.style.borderBottom = \"1px solid var(--vscode-menu-separatorBackground)\";\r\n\r\n    this.searchInput = document.createElement(\"input\");\r\n    this.searchInput.type = \"text\";\r\n    this.searchInput.placeholder = this.options.searchPlaceholder;\r\n    this.searchInput.style.width = \"100%\";\r\n    this.searchInput.style.padding = \"6px 8px\";\r\n    this.searchInput.style.border = \"1px solid var(--vscode-input-border)\";\r\n    this.searchInput.style.background = \"var(--vscode-input-background)\";\r\n    this.searchInput.style.color = \"var(--vscode-input-foreground)\";\r\n    this.searchInput.style.borderRadius = \"2px\";\r\n    this.searchInput.style.fontSize = \"13px\";\r\n    this.searchInput.style.boxSizing = \"border-box\";\r\n\r\n    this.searchInput.addEventListener(\"input\", () => this.handleSearch());\r\n    this.searchInput.addEventListener(\"keydown\", (e) => {\r\n      if (e.key === \"Escape\") {\r\n        e.preventDefault();\r\n        this.close();\r\n      }\r\n    });\r\n\r\n    searchContainer.appendChild(this.searchInput);\r\n    this.pickerElement.appendChild(searchContainer);\r\n  }\r\n\r\n  /**\r\n   * Build the content area\r\n   */\r\n  private buildContent(): void {\r\n    if (!this.pickerElement) return;\r\n\r\n    this.contentContainer = document.createElement(\"div\");\r\n    this.contentContainer.className = \"picker-content\";\r\n    this.contentContainer.style.maxHeight = this.options.maxHeight || \"300px\";\r\n    this.contentContainer.style.overflowY = \"auto\";\r\n    this.contentContainer.style.padding = \"4px 0\";\r\n\r\n    this.renderContent();\r\n\r\n    this.pickerElement.appendChild(this.contentContainer);\r\n  }\r\n\r\n  /**\r\n   * Build the footer with action buttons\r\n   */\r\n  private buildFooter(): void {\r\n    if (!this.pickerElement) return;\r\n\r\n    const footer = document.createElement(\"div\");\r\n    footer.style.padding = \"8px 12px\";\r\n    footer.style.borderTop = \"1px solid var(--vscode-menu-separatorBackground)\";\r\n    footer.style.display = \"flex\";\r\n    footer.style.gap = \"8px\";\r\n    footer.style.justifyContent = \"flex-end\";\r\n\r\n    // Clear All button\r\n    const clearBtn = this.createButton(\"Clear All\", () => {\r\n      this.handleClearAll();\r\n    });\r\n    clearBtn.style.marginRight = \"auto\";\r\n    footer.appendChild(clearBtn);\r\n\r\n    // Apply button\r\n    if (this.options.onApply) {\r\n      const applyBtn = this.createButton(\"Apply\", () => {\r\n        this.handleApply();\r\n      });\r\n      applyBtn.style.background = \"var(--vscode-button-background)\";\r\n      applyBtn.style.color = \"var(--vscode-button-foreground)\";\r\n      applyBtn.addEventListener(\"mouseenter\", () => {\r\n        applyBtn.style.background = \"var(--vscode-button-hoverBackground)\";\r\n      });\r\n      applyBtn.addEventListener(\"mouseleave\", () => {\r\n        applyBtn.style.background = \"var(--vscode-button-background)\";\r\n      });\r\n      footer.appendChild(applyBtn);\r\n    }\r\n\r\n    this.pickerElement.appendChild(footer);\r\n  }\r\n\r\n  /**\r\n   * Create a button element\r\n   */\r\n  protected createButton(text: string, onClick: () => void): HTMLButtonElement {\r\n    const btn = document.createElement(\"button\");\r\n    btn.type = \"button\";\r\n    btn.textContent = text;\r\n    btn.style.padding = \"6px 12px\";\r\n    btn.style.border = \"1px solid var(--vscode-button-border)\";\r\n    btn.style.borderRadius = \"2px\";\r\n    btn.style.background = \"var(--vscode-button-secondaryBackground)\";\r\n    btn.style.color = \"var(--vscode-button-secondaryForeground)\";\r\n    btn.style.cursor = \"pointer\";\r\n    btn.style.fontSize = \"13px\";\r\n\r\n    btn.addEventListener(\"click\", onClick);\r\n\r\n    return btn;\r\n  }\r\n\r\n  /**\r\n   * Setup keyboard navigation\r\n   */\r\n  private setupKeyboardNavigation(): void {\r\n    if (!this.pickerElement) return;\r\n\r\n    this.pickerElement.addEventListener(\"keydown\", (e) => {\r\n      switch (e.key) {\r\n        case \"ArrowDown\":\r\n          e.preventDefault();\r\n          this.navigateDown();\r\n          break;\r\n        case \"ArrowUp\":\r\n          e.preventDefault();\r\n          this.navigateUp();\r\n          break;\r\n        case \"Enter\":\r\n          e.preventDefault();\r\n          this.handleEnter();\r\n          break;\r\n        case \"Escape\":\r\n          e.preventDefault();\r\n          this.close();\r\n          break;\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Navigate to next item\r\n   */\r\n  private navigateDown(): void {\r\n    if (this.selectableItems.length === 0) return;\r\n\r\n    this.focusedIndex = (this.focusedIndex + 1) % this.selectableItems.length;\r\n    this.updateFocus();\r\n  }\r\n\r\n  /**\r\n   * Navigate to previous item\r\n   */\r\n  private navigateUp(): void {\r\n    if (this.selectableItems.length === 0) return;\r\n\r\n    this.focusedIndex =\r\n      this.focusedIndex <= 0\r\n        ? this.selectableItems.length - 1\r\n        : this.focusedIndex - 1;\r\n    this.updateFocus();\r\n  }\r\n\r\n  /**\r\n   * Update focus highlight\r\n   */\r\n  private updateFocus(): void {\r\n    this.selectableItems.forEach((item, index) => {\r\n      if (index === this.focusedIndex) {\r\n        item.style.background = \"var(--vscode-list-focusBackground)\";\r\n        item.scrollIntoView({ block: \"nearest\" });\r\n      } else {\r\n        item.style.background = \"transparent\";\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle Enter key\r\n   */\r\n  private handleEnter(): void {\r\n    if (\r\n      this.focusedIndex >= 0 &&\r\n      this.focusedIndex < this.selectableItems.length\r\n    ) {\r\n      this.selectableItems[this.focusedIndex].click();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Abstract methods to be implemented by subclasses\r\n   */\r\n  protected abstract renderContent(): void;\r\n  protected abstract handleSearch(): void;\r\n  protected abstract handleApply(): void;\r\n  protected abstract handleClearAll(): void;\r\n}\r\n", "/**\r\n * Labels Picker Component\r\n * Allows users to select multiple labels for an item\r\n */\r\n\r\nimport { BasePicker, BasePickerOptions } from \"./BasePicker\";\r\nimport { escapeHtml, normalizeColor, addAlpha } from \"../utils\";\r\n\r\nexport interface LabelsPickerOptions extends Omit<BasePickerOptions, \"title\"> {\r\n  field: any;\r\n  item: any;\r\n  currentLabels: any[];\r\n  onUpdate: (labelIds: string[]) => void;\r\n  onError: (error: string) => void;\r\n}\r\n\r\ninterface LabelOption {\r\n  id: string;\r\n  name: string;\r\n  color: string;\r\n  description?: string;\r\n}\r\n\r\nexport class LabelsPicker extends BasePicker {\r\n  private field: any;\r\n  private item: any;\r\n  private availableLabels: LabelOption[] = [];\r\n  private selectedLabelIds: Set<string> = new Set();\r\n  private filteredLabels: LabelOption[] = [];\r\n  private onUpdate: (labelIds: string[]) => void;\r\n  private onError: (error: string) => void;\r\n\r\n  constructor(options: LabelsPickerOptions) {\r\n    super({\r\n      ...options,\r\n      title: \"Select Labels\",\r\n      searchPlaceholder: \"Filter labels...\",\r\n      onApply: () => {}, // Will be overridden by handleApply\r\n    });\r\n\r\n    this.field = options.field;\r\n    this.item = options.item;\r\n    this.onUpdate = options.onUpdate;\r\n    this.onError = options.onError;\r\n\r\n    // Initialize selected labels\r\n    options.currentLabels.forEach((label) => {\r\n      if (label.id) {\r\n        this.selectedLabelIds.add(String(label.id));\r\n      }\r\n    });\r\n\r\n    // Load available labels\r\n    this.loadAvailableLabels();\r\n  }\r\n\r\n  /**\r\n   * Load available labels from field options\r\n   */\r\n  private loadAvailableLabels(): void {\r\n    const repoName =\r\n      (this.item.content &&\r\n        this.item.content.repository &&\r\n        this.item.content.repository.nameWithOwner) ||\r\n      (this.item.repository && this.item.repository.nameWithOwner) ||\r\n      null;\r\n\r\n    let labels: any[] = [];\r\n\r\n    // Try repo-scoped options first\r\n    if (\r\n      repoName &&\r\n      this.field.repoOptions &&\r\n      this.field.repoOptions[repoName]\r\n    ) {\r\n      labels = this.field.repoOptions[repoName];\r\n    } else if (this.field.options) {\r\n      // Fallback to field-level options\r\n      labels = this.field.options;\r\n    }\r\n\r\n    this.availableLabels = labels.map((label) => ({\r\n      id: String(label.id || label.name),\r\n      name: label.name || \"\",\r\n      color: label.color || label.colour || \"#999999\",\r\n      description: label.description || \"\",\r\n    }));\r\n\r\n    this.filteredLabels = [...this.availableLabels];\r\n  }\r\n\r\n  /**\r\n   * Render the content area with label checkboxes\r\n   */\r\n  protected renderContent(): void {\r\n    if (!this.contentContainer) return;\r\n\r\n    this.contentContainer.innerHTML = \"\";\r\n    this.selectableItems = [];\r\n\r\n    if (this.filteredLabels.length === 0) {\r\n      const emptyState = document.createElement(\"div\");\r\n      emptyState.style.padding = \"20px\";\r\n      emptyState.style.textAlign = \"center\";\r\n      emptyState.style.color = \"var(--vscode-descriptionForeground)\";\r\n      emptyState.textContent = \"No labels found\";\r\n      this.contentContainer.appendChild(emptyState);\r\n      return;\r\n    }\r\n\r\n    this.filteredLabels.forEach((label) => {\r\n      const item = this.createLabelItem(label);\r\n      this.contentContainer?.appendChild(item);\r\n      this.selectableItems.push(item);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Create a label item with checkbox\r\n   */\r\n  private createLabelItem(label: LabelOption): HTMLElement {\r\n    const item = document.createElement(\"div\");\r\n    item.className = \"label-item\";\r\n    item.style.display = \"flex\";\r\n    item.style.alignItems = \"center\";\r\n    item.style.padding = \"8px 12px\";\r\n    item.style.cursor = \"pointer\";\r\n    item.style.gap = \"8px\";\r\n\r\n    item.addEventListener(\"mouseenter\", () => {\r\n      item.style.background = \"var(--vscode-list-hoverBackground)\";\r\n    });\r\n    item.addEventListener(\"mouseleave\", () => {\r\n      if (item.style.background !== \"var(--vscode-list-focusBackground)\") {\r\n        item.style.background = \"transparent\";\r\n      }\r\n    });\r\n\r\n    // Checkbox\r\n    const checkbox = document.createElement(\"input\");\r\n    checkbox.type = \"checkbox\";\r\n    checkbox.checked = this.selectedLabelIds.has(label.id);\r\n    checkbox.style.cursor = \"pointer\";\r\n    checkbox.style.flexShrink = \"0\";\r\n\r\n    // Color swatch\r\n    const normalizedColor = normalizeColor(label.color) || \"#999999\";\r\n    const hasHex = /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(normalizedColor);\r\n    const bg = hasHex ? addAlpha(normalizedColor, 0.12) || \"rgba(0,0,0,0.06)\" : \"rgba(0,0,0,0.06)\";\r\n\r\n    const swatch = document.createElement(\"span\");\r\n    swatch.style.width = \"16px\";\r\n    swatch.style.height = \"16px\";\r\n    swatch.style.borderRadius = \"2px\";\r\n    swatch.style.background = bg;\r\n    swatch.style.border = `1px solid ${normalizedColor}`;\r\n    swatch.style.flexShrink = \"0\";\r\n\r\n    // Label info\r\n    const info = document.createElement(\"div\");\r\n    info.style.flex = \"1\";\r\n    info.style.minWidth = \"0\";\r\n    info.style.display = \"flex\";\r\n    info.style.flexDirection = \"column\";\r\n    info.style.gap = \"2px\";\r\n\r\n    const nameEl = document.createElement(\"div\");\r\n    nameEl.textContent = label.name;\r\n    nameEl.style.fontSize = \"13px\";\r\n    nameEl.style.color = \"var(--vscode-foreground)\";\r\n    nameEl.style.overflow = \"hidden\";\r\n    nameEl.style.textOverflow = \"ellipsis\";\r\n    nameEl.style.whiteSpace = \"nowrap\";\r\n\r\n    info.appendChild(nameEl);\r\n\r\n    if (label.description) {\r\n      const descEl = document.createElement(\"div\");\r\n      descEl.textContent = label.description;\r\n      descEl.style.fontSize = \"11px\";\r\n      descEl.style.color = \"var(--vscode-descriptionForeground)\";\r\n      descEl.style.overflow = \"hidden\";\r\n      descEl.style.textOverflow = \"ellipsis\";\r\n      descEl.style.whiteSpace = \"nowrap\";\r\n      info.appendChild(descEl);\r\n    }\r\n\r\n    item.appendChild(checkbox);\r\n    item.appendChild(swatch);\r\n    item.appendChild(info);\r\n\r\n    // Toggle on click\r\n    item.addEventListener(\"click\", (e) => {\r\n      if (e.target !== checkbox) {\r\n        checkbox.checked = !checkbox.checked;\r\n      }\r\n      this.toggleLabel(label.id, checkbox.checked);\r\n    });\r\n\r\n    checkbox.addEventListener(\"change\", () => {\r\n      this.toggleLabel(label.id, checkbox.checked);\r\n    });\r\n\r\n    return item;\r\n  }\r\n\r\n  /**\r\n   * Toggle label selection\r\n   */\r\n  private toggleLabel(labelId: string, selected: boolean): void {\r\n    if (selected) {\r\n      this.selectedLabelIds.add(labelId);\r\n    } else {\r\n      this.selectedLabelIds.delete(labelId);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle search/filter\r\n   */\r\n  protected handleSearch(): void {\r\n    const searchTerm = this.searchInput?.value.toLowerCase() || \"\";\r\n\r\n    if (!searchTerm) {\r\n      this.filteredLabels = [...this.availableLabels];\r\n    } else {\r\n      this.filteredLabels = this.availableLabels.filter(\r\n        (label) =>\r\n          label.name.toLowerCase().includes(searchTerm) ||\r\n          (label.description &&\r\n            label.description.toLowerCase().includes(searchTerm)),\r\n      );\r\n    }\r\n\r\n    this.renderContent();\r\n  }\r\n\r\n  /**\r\n   * Handle Apply action\r\n   */\r\n  protected handleApply(): void {\r\n    const labelIds = Array.from(this.selectedLabelIds);\r\n    this.onUpdate(labelIds);\r\n    this.close();\r\n  }\r\n\r\n  /**\r\n   * Handle Clear All action\r\n   */\r\n  protected handleClearAll(): void {\r\n    this.selectedLabelIds.clear();\r\n    this.renderContent();\r\n  }\r\n}\r\n", "/**\r\n * Assignees Picker Component\r\n * Allows users to select multiple assignees for an item\r\n */\r\n\r\nimport { BasePicker, BasePickerOptions } from \"./BasePicker\";\r\nimport { escapeHtml } from \"../utils\";\r\n\r\nexport interface AssigneesPickerOptions\r\n  extends Omit<BasePickerOptions, \"title\"> {\r\n  field: any;\r\n  item: any;\r\n  currentAssignees: any[];\r\n  onUpdate: (assigneeLogins: string[]) => void;\r\n  onError: (error: string) => void;\r\n}\r\n\r\ninterface AssigneeOption {\r\n  login: string;\r\n  name?: string;\r\n  avatarUrl?: string;\r\n}\r\n\r\nexport class AssigneesPicker extends BasePicker {\r\n  private field: any;\r\n  private item: any;\r\n  private availableAssignees: AssigneeOption[] = [];\r\n  private selectedLogins: Set<string> = new Set();\r\n  private filteredAssignees: AssigneeOption[] = [];\r\n  private onUpdate: (assigneeLogins: string[]) => void;\r\n  private onError: (error: string) => void;\r\n\r\n  constructor(options: AssigneesPickerOptions) {\r\n    super({\r\n      ...options,\r\n      title: \"Select Assignees\",\r\n      searchPlaceholder: \"Filter assignees...\",\r\n      onApply: () => {}, // Will be overridden by handleApply\r\n    });\r\n\r\n    this.field = options.field;\r\n    this.item = options.item;\r\n    this.onUpdate = options.onUpdate;\r\n    this.onError = options.onError;\r\n\r\n    // Initialize selected assignees\r\n    options.currentAssignees.forEach((assignee) => {\r\n      if (assignee.login) {\r\n        this.selectedLogins.add(assignee.login);\r\n      }\r\n    });\r\n\r\n    // Load available assignees\r\n    this.loadAvailableAssignees();\r\n  }\r\n\r\n  /**\r\n   * Load available assignees from field options\r\n   */\r\n  private loadAvailableAssignees(): void {\r\n    // Try to get assignees from field options\r\n    // In a real implementation, this might need to fetch from repository collaborators\r\n    let assignees: any[] = [];\r\n\r\n    if (this.field.options) {\r\n      assignees = this.field.options;\r\n    }\r\n\r\n    this.availableAssignees = assignees.map((assignee) => ({\r\n      login: assignee.login || assignee.name || \"\",\r\n      name: assignee.name || assignee.login || \"\",\r\n      avatarUrl: assignee.avatarUrl || assignee.avatar || \"\",\r\n    }));\r\n\r\n    this.filteredAssignees = [...this.availableAssignees];\r\n  }\r\n\r\n  /**\r\n   * Render the content area with assignee checkboxes\r\n   */\r\n  protected renderContent(): void {\r\n    if (!this.contentContainer) return;\r\n\r\n    this.contentContainer.innerHTML = \"\";\r\n    this.selectableItems = [];\r\n\r\n    if (this.filteredAssignees.length === 0) {\r\n      const emptyState = document.createElement(\"div\");\r\n      emptyState.style.padding = \"20px\";\r\n      emptyState.style.textAlign = \"center\";\r\n      emptyState.style.color = \"var(--vscode-descriptionForeground)\";\r\n      emptyState.textContent = \"No assignees found\";\r\n      this.contentContainer.appendChild(emptyState);\r\n      return;\r\n    }\r\n\r\n    this.filteredAssignees.forEach((assignee) => {\r\n      const item = this.createAssigneeItem(assignee);\r\n      this.contentContainer?.appendChild(item);\r\n      this.selectableItems.push(item);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Create an assignee item with checkbox\r\n   */\r\n  private createAssigneeItem(assignee: AssigneeOption): HTMLElement {\r\n    const item = document.createElement(\"div\");\r\n    item.className = \"assignee-item\";\r\n    item.style.display = \"flex\";\r\n    item.style.alignItems = \"center\";\r\n    item.style.padding = \"8px 12px\";\r\n    item.style.cursor = \"pointer\";\r\n    item.style.gap = \"8px\";\r\n\r\n    item.addEventListener(\"mouseenter\", () => {\r\n      item.style.background = \"var(--vscode-list-hoverBackground)\";\r\n    });\r\n    item.addEventListener(\"mouseleave\", () => {\r\n      if (item.style.background !== \"var(--vscode-list-focusBackground)\") {\r\n        item.style.background = \"transparent\";\r\n      }\r\n    });\r\n\r\n    // Checkbox\r\n    const checkbox = document.createElement(\"input\");\r\n    checkbox.type = \"checkbox\";\r\n    checkbox.checked = this.selectedLogins.has(assignee.login);\r\n    checkbox.style.cursor = \"pointer\";\r\n    checkbox.style.flexShrink = \"0\";\r\n\r\n    // Avatar or initials\r\n    const avatar = document.createElement(\"span\");\r\n    avatar.style.width = \"24px\";\r\n    avatar.style.height = \"24px\";\r\n    avatar.style.borderRadius = \"50%\";\r\n    avatar.style.flexShrink = \"0\";\r\n    avatar.style.display = \"inline-flex\";\r\n    avatar.style.alignItems = \"center\";\r\n    avatar.style.justifyContent = \"center\";\r\n    avatar.style.fontSize = \"11px\";\r\n    avatar.style.fontWeight = \"600\";\r\n\r\n    if (assignee.avatarUrl) {\r\n      avatar.style.backgroundImage = `url(${escapeHtml(assignee.avatarUrl)})`;\r\n      avatar.style.backgroundSize = \"cover\";\r\n      avatar.style.backgroundPosition = \"center\";\r\n      avatar.style.border = \"1px solid var(--vscode-panel-border)\";\r\n    } else {\r\n      // Show initials\r\n      const initials = (assignee.name || assignee.login || \"\")\r\n        .split(\" \")\r\n        .map((part) => part[0] || \"\")\r\n        .join(\"\")\r\n        .toUpperCase()\r\n        .slice(0, 2);\r\n      avatar.textContent = initials;\r\n      avatar.style.background = \"#777\";\r\n      avatar.style.color = \"#fff\";\r\n    }\r\n\r\n    // User info\r\n    const info = document.createElement(\"div\");\r\n    info.style.flex = \"1\";\r\n    info.style.minWidth = \"0\";\r\n    info.style.display = \"flex\";\r\n    info.style.flexDirection = \"column\";\r\n\r\n    const loginEl = document.createElement(\"div\");\r\n    loginEl.textContent = assignee.login;\r\n    loginEl.style.fontSize = \"13px\";\r\n    loginEl.style.color = \"var(--vscode-foreground)\";\r\n    loginEl.style.overflow = \"hidden\";\r\n    loginEl.style.textOverflow = \"ellipsis\";\r\n    loginEl.style.whiteSpace = \"nowrap\";\r\n\r\n    info.appendChild(loginEl);\r\n\r\n    if (assignee.name && assignee.name !== assignee.login) {\r\n      const nameEl = document.createElement(\"div\");\r\n      nameEl.textContent = assignee.name;\r\n      nameEl.style.fontSize = \"11px\";\r\n      nameEl.style.color = \"var(--vscode-descriptionForeground)\";\r\n      nameEl.style.overflow = \"hidden\";\r\n      nameEl.style.textOverflow = \"ellipsis\";\r\n      nameEl.style.whiteSpace = \"nowrap\";\r\n      info.appendChild(nameEl);\r\n    }\r\n\r\n    item.appendChild(checkbox);\r\n    item.appendChild(avatar);\r\n    item.appendChild(info);\r\n\r\n    // Toggle on click\r\n    item.addEventListener(\"click\", (e) => {\r\n      if (e.target !== checkbox) {\r\n        checkbox.checked = !checkbox.checked;\r\n      }\r\n      this.toggleAssignee(assignee.login, checkbox.checked);\r\n    });\r\n\r\n    checkbox.addEventListener(\"change\", () => {\r\n      this.toggleAssignee(assignee.login, checkbox.checked);\r\n    });\r\n\r\n    return item;\r\n  }\r\n\r\n  /**\r\n   * Toggle assignee selection\r\n   */\r\n  private toggleAssignee(login: string, selected: boolean): void {\r\n    if (selected) {\r\n      this.selectedLogins.add(login);\r\n    } else {\r\n      this.selectedLogins.delete(login);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle search/filter\r\n   */\r\n  protected handleSearch(): void {\r\n    const searchTerm = this.searchInput?.value.toLowerCase() || \"\";\r\n\r\n    if (!searchTerm) {\r\n      this.filteredAssignees = [...this.availableAssignees];\r\n    } else {\r\n      this.filteredAssignees = this.availableAssignees.filter(\r\n        (assignee) =>\r\n          assignee.login.toLowerCase().includes(searchTerm) ||\r\n          (assignee.name && assignee.name.toLowerCase().includes(searchTerm)),\r\n      );\r\n    }\r\n\r\n    this.renderContent();\r\n  }\r\n\r\n  /**\r\n   * Handle Apply action\r\n   */\r\n  protected handleApply(): void {\r\n    const logins = Array.from(this.selectedLogins);\r\n    this.onUpdate(logins);\r\n    this.close();\r\n  }\r\n\r\n  /**\r\n   * Handle Clear All action\r\n   */\r\n  protected handleClearAll(): void {\r\n    this.selectedLogins.clear();\r\n    this.renderContent();\r\n  }\r\n}\r\n", "/**\r\n * Reviewers Picker Component\r\n * Allows users to select multiple reviewers (users and teams) for a pull request\r\n */\r\n\r\nimport { BasePicker, BasePickerOptions } from \"./BasePicker\";\r\nimport { escapeHtml } from \"../utils\";\r\n\r\nexport interface ReviewersPickerOptions\r\n  extends Omit<BasePickerOptions, \"title\"> {\r\n  field: any;\r\n  item: any;\r\n  currentReviewers: any[];\r\n  onUpdate: (reviewerLogins: string[]) => void;\r\n  onError: (error: string) => void;\r\n}\r\n\r\ninterface ReviewerOption {\r\n  login: string;\r\n  name?: string;\r\n  avatarUrl?: string;\r\n  kind?: string; // 'User' or 'Team'\r\n}\r\n\r\nexport class ReviewersPicker extends BasePicker {\r\n  private field: any;\r\n  private item: any;\r\n  private availableReviewers: ReviewerOption[] = [];\r\n  private selectedLogins: Set<string> = new Set();\r\n  private filteredReviewers: ReviewerOption[] = [];\r\n  private onUpdate: (reviewerLogins: string[]) => void;\r\n  private onError: (error: string) => void;\r\n\r\n  constructor(options: ReviewersPickerOptions) {\r\n    super({\r\n      ...options,\r\n      title: \"Select Reviewers\",\r\n      searchPlaceholder: \"Filter reviewers...\",\r\n      onApply: () => {}, // Will be overridden by handleApply\r\n    });\r\n\r\n    this.field = options.field;\r\n    this.item = options.item;\r\n    this.onUpdate = options.onUpdate;\r\n    this.onError = options.onError;\r\n\r\n    // Initialize selected reviewers\r\n    options.currentReviewers.forEach((reviewer) => {\r\n      if (reviewer.login) {\r\n        this.selectedLogins.add(reviewer.login);\r\n      }\r\n    });\r\n\r\n    // Load available reviewers\r\n    this.loadAvailableReviewers();\r\n  }\r\n\r\n  /**\r\n   * Load available reviewers from field options\r\n   */\r\n  private loadAvailableReviewers(): void {\r\n    let reviewers: any[] = [];\r\n\r\n    if (this.field.options) {\r\n      reviewers = this.field.options;\r\n    }\r\n\r\n    this.availableReviewers = reviewers.map((reviewer) => ({\r\n      login: reviewer.login || reviewer.name || \"\",\r\n      name: reviewer.name || reviewer.login || \"\",\r\n      avatarUrl: reviewer.avatarUrl || reviewer.avatar || \"\",\r\n      kind: reviewer.kind || reviewer.__typename || \"User\",\r\n    }));\r\n\r\n    this.filteredReviewers = [...this.availableReviewers];\r\n  }\r\n\r\n  /**\r\n   * Render the content area with reviewer checkboxes\r\n   */\r\n  protected renderContent(): void {\r\n    if (!this.contentContainer) return;\r\n\r\n    this.contentContainer.innerHTML = \"\";\r\n    this.selectableItems = [];\r\n\r\n    if (this.filteredReviewers.length === 0) {\r\n      const emptyState = document.createElement(\"div\");\r\n      emptyState.style.padding = \"20px\";\r\n      emptyState.style.textAlign = \"center\";\r\n      emptyState.style.color = \"var(--vscode-descriptionForeground)\";\r\n      emptyState.textContent = \"No reviewers found\";\r\n      this.contentContainer.appendChild(emptyState);\r\n      return;\r\n    }\r\n\r\n    this.filteredReviewers.forEach((reviewer) => {\r\n      const item = this.createReviewerItem(reviewer);\r\n      this.contentContainer?.appendChild(item);\r\n      this.selectableItems.push(item);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Create a reviewer item with checkbox\r\n   */\r\n  private createReviewerItem(reviewer: ReviewerOption): HTMLElement {\r\n    const item = document.createElement(\"div\");\r\n    item.className = \"reviewer-item\";\r\n    item.style.display = \"flex\";\r\n    item.style.alignItems = \"center\";\r\n    item.style.padding = \"8px 12px\";\r\n    item.style.cursor = \"pointer\";\r\n    item.style.gap = \"8px\";\r\n\r\n    item.addEventListener(\"mouseenter\", () => {\r\n      item.style.background = \"var(--vscode-list-hoverBackground)\";\r\n    });\r\n    item.addEventListener(\"mouseleave\", () => {\r\n      if (item.style.background !== \"var(--vscode-list-focusBackground)\") {\r\n        item.style.background = \"transparent\";\r\n      }\r\n    });\r\n\r\n    // Checkbox\r\n    const checkbox = document.createElement(\"input\");\r\n    checkbox.type = \"checkbox\";\r\n    checkbox.checked = this.selectedLogins.has(reviewer.login);\r\n    checkbox.style.cursor = \"pointer\";\r\n    checkbox.style.flexShrink = \"0\";\r\n\r\n    // Avatar or team icon\r\n    const avatar = document.createElement(\"span\");\r\n    avatar.style.width = \"24px\";\r\n    avatar.style.height = \"24px\";\r\n    avatar.style.borderRadius = \"50%\";\r\n    avatar.style.flexShrink = \"0\";\r\n    avatar.style.display = \"inline-flex\";\r\n    avatar.style.alignItems = \"center\";\r\n    avatar.style.justifyContent = \"center\";\r\n    avatar.style.fontSize = \"11px\";\r\n    avatar.style.fontWeight = \"600\";\r\n\r\n    const isTeam =\r\n      reviewer.kind &&\r\n      (reviewer.kind.toLowerCase().includes(\"team\") ||\r\n        reviewer.kind === \"Team\");\r\n\r\n    if (reviewer.avatarUrl) {\r\n      avatar.style.backgroundImage = `url(${escapeHtml(reviewer.avatarUrl)})`;\r\n      avatar.style.backgroundSize = \"cover\";\r\n      avatar.style.backgroundPosition = \"center\";\r\n      avatar.style.border = \"1px solid var(--vscode-panel-border)\";\r\n    } else {\r\n      // Show initials or team icon\r\n      if (isTeam) {\r\n        const TEAM_ICON = \"&#128101;\"; // \uD83D\uDC65 Two person silhouette emoji\r\n        avatar.innerHTML = TEAM_ICON;\r\n        avatar.style.background = \"#555\";\r\n        avatar.style.color = \"#fff\";\r\n      } else {\r\n        const initials = (reviewer.name || reviewer.login || \"\")\r\n          .split(\" \")\r\n          .map((part) => part[0] || \"\")\r\n          .join(\"\")\r\n          .toUpperCase()\r\n          .slice(0, 2);\r\n        avatar.textContent = initials;\r\n        avatar.style.background = \"#777\";\r\n        avatar.style.color = \"#fff\";\r\n      }\r\n    }\r\n\r\n    // Reviewer info\r\n    const info = document.createElement(\"div\");\r\n    info.style.flex = \"1\";\r\n    info.style.minWidth = \"0\";\r\n    info.style.display = \"flex\";\r\n    info.style.flexDirection = \"column\";\r\n\r\n    const loginEl = document.createElement(\"div\");\r\n    loginEl.textContent = reviewer.login;\r\n    loginEl.style.fontSize = \"13px\";\r\n    loginEl.style.color = \"var(--vscode-foreground)\";\r\n    loginEl.style.overflow = \"hidden\";\r\n    loginEl.style.textOverflow = \"ellipsis\";\r\n    loginEl.style.whiteSpace = \"nowrap\";\r\n\r\n    info.appendChild(loginEl);\r\n\r\n    if (reviewer.name && reviewer.name !== reviewer.login) {\r\n      const nameEl = document.createElement(\"div\");\r\n      nameEl.textContent = reviewer.name;\r\n      nameEl.style.fontSize = \"11px\";\r\n      nameEl.style.color = \"var(--vscode-descriptionForeground)\";\r\n      nameEl.style.overflow = \"hidden\";\r\n      nameEl.style.textOverflow = \"ellipsis\";\r\n      nameEl.style.whiteSpace = \"nowrap\";\r\n      info.appendChild(nameEl);\r\n    }\r\n\r\n    // Show kind badge for teams\r\n    if (isTeam) {\r\n      const kindBadge = document.createElement(\"span\");\r\n      kindBadge.textContent = \"Team\";\r\n      kindBadge.style.fontSize = \"10px\";\r\n      kindBadge.style.padding = \"2px 6px\";\r\n      kindBadge.style.background = \"var(--vscode-badge-background)\";\r\n      kindBadge.style.color = \"var(--vscode-badge-foreground)\";\r\n      kindBadge.style.borderRadius = \"2px\";\r\n      kindBadge.style.marginLeft = \"auto\";\r\n      kindBadge.style.flexShrink = \"0\";\r\n      item.appendChild(kindBadge);\r\n    }\r\n\r\n    item.appendChild(checkbox);\r\n    item.appendChild(avatar);\r\n    item.appendChild(info);\r\n\r\n    // Toggle on click\r\n    item.addEventListener(\"click\", (e) => {\r\n      if (e.target !== checkbox) {\r\n        checkbox.checked = !checkbox.checked;\r\n      }\r\n      this.toggleReviewer(reviewer.login, checkbox.checked);\r\n    });\r\n\r\n    checkbox.addEventListener(\"change\", () => {\r\n      this.toggleReviewer(reviewer.login, checkbox.checked);\r\n    });\r\n\r\n    return item;\r\n  }\r\n\r\n  /**\r\n   * Toggle reviewer selection\r\n   */\r\n  private toggleReviewer(login: string, selected: boolean): void {\r\n    if (selected) {\r\n      this.selectedLogins.add(login);\r\n    } else {\r\n      this.selectedLogins.delete(login);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle search/filter\r\n   */\r\n  protected handleSearch(): void {\r\n    const searchTerm = this.searchInput?.value.toLowerCase() || \"\";\r\n\r\n    if (!searchTerm) {\r\n      this.filteredReviewers = [...this.availableReviewers];\r\n    } else {\r\n      this.filteredReviewers = this.availableReviewers.filter(\r\n        (reviewer) =>\r\n          reviewer.login.toLowerCase().includes(searchTerm) ||\r\n          (reviewer.name && reviewer.name.toLowerCase().includes(searchTerm)),\r\n      );\r\n    }\r\n\r\n    this.renderContent();\r\n  }\r\n\r\n  /**\r\n   * Handle Apply action\r\n   */\r\n  protected handleApply(): void {\r\n    const logins = Array.from(this.selectedLogins);\r\n    this.onUpdate(logins);\r\n    this.close();\r\n  }\r\n\r\n  /**\r\n   * Handle Clear All action\r\n   */\r\n  protected handleClearAll(): void {\r\n    this.selectedLogins.clear();\r\n    this.renderContent();\r\n  }\r\n}\r\n", "/**\r\n * Milestone Picker Component\r\n * Allows users to select a single milestone for an item\r\n */\r\n\r\nimport { BasePicker, BasePickerOptions } from \"./BasePicker\";\r\nimport { escapeHtml } from \"../utils\";\r\n\r\nexport interface MilestonePickerOptions\r\n  extends Omit<BasePickerOptions, \"title\"> {\r\n  field: any;\r\n  item: any;\r\n  currentMilestone: any;\r\n  onUpdate: (milestoneId: string | null) => void;\r\n  onError: (error: string) => void;\r\n}\r\n\r\ninterface MilestoneOption {\r\n  id: string;\r\n  title: string;\r\n  dueOn?: string;\r\n  state?: string;\r\n}\r\n\r\nexport class MilestonePicker extends BasePicker {\r\n  private field: any;\r\n  private item: any;\r\n  private availableMilestones: MilestoneOption[] = [];\r\n  private selectedMilestoneId: string | null = null;\r\n  private filteredMilestones: MilestoneOption[] = [];\r\n  private onUpdate: (milestoneId: string | null) => void;\r\n  private onError: (error: string) => void;\r\n\r\n  constructor(options: MilestonePickerOptions) {\r\n    super({\r\n      ...options,\r\n      title: \"Select Milestone\",\r\n      searchPlaceholder: \"Filter milestones...\",\r\n      onApply: undefined, // Milestone selection is immediate, no apply button needed\r\n    });\r\n\r\n    this.field = options.field;\r\n    this.item = options.item;\r\n    this.onUpdate = options.onUpdate;\r\n    this.onError = options.onError;\r\n\r\n    // Initialize selected milestone\r\n    if (options.currentMilestone && options.currentMilestone.id) {\r\n      this.selectedMilestoneId = String(options.currentMilestone.id);\r\n    }\r\n\r\n    // Load available milestones\r\n    this.loadAvailableMilestones();\r\n  }\r\n\r\n  /**\r\n   * Load available milestones from field options\r\n   */\r\n  private loadAvailableMilestones(): void {\r\n    let milestones: any[] = [];\r\n\r\n    // Try to get repo-specific milestones\r\n    const repoName =\r\n      (this.item.content &&\r\n        this.item.content.repository &&\r\n        this.item.content.repository.nameWithOwner) ||\r\n      (this.item.repository && this.item.repository.nameWithOwner) ||\r\n      null;\r\n\r\n    if (\r\n      repoName &&\r\n      this.field.repoOptions &&\r\n      this.field.repoOptions[repoName]\r\n    ) {\r\n      milestones = this.field.repoOptions[repoName];\r\n    } else if (this.field.options) {\r\n      milestones = this.field.options;\r\n    }\r\n\r\n    this.availableMilestones = milestones.map((milestone) => ({\r\n      id: String(milestone.id || milestone.title),\r\n      title: milestone.title || \"\",\r\n      dueOn: milestone.dueOn || milestone.due_on || \"\",\r\n      state: milestone.state || \"\",\r\n    }));\r\n\r\n    this.filteredMilestones = [...this.availableMilestones];\r\n  }\r\n\r\n  /**\r\n   * Render the content area with milestone options\r\n   */\r\n  protected renderContent(): void {\r\n    if (!this.contentContainer) return;\r\n\r\n    this.contentContainer.innerHTML = \"\";\r\n    this.selectableItems = [];\r\n\r\n    // Add \"No milestone\" option\r\n    const clearItem = this.createClearMilestoneItem();\r\n    this.contentContainer.appendChild(clearItem);\r\n    this.selectableItems.push(clearItem);\r\n\r\n    if (this.filteredMilestones.length === 0) {\r\n      const emptyState = document.createElement(\"div\");\r\n      emptyState.style.padding = \"20px\";\r\n      emptyState.style.textAlign = \"center\";\r\n      emptyState.style.color = \"var(--vscode-descriptionForeground)\";\r\n      emptyState.textContent = \"No milestones found\";\r\n      this.contentContainer.appendChild(emptyState);\r\n      return;\r\n    }\r\n\r\n    // Add separator\r\n    const separator = document.createElement(\"div\");\r\n    separator.style.height = \"1px\";\r\n    separator.style.background = \"var(--vscode-menu-separatorBackground)\";\r\n    separator.style.margin = \"4px 0\";\r\n    this.contentContainer.appendChild(separator);\r\n\r\n    this.filteredMilestones.forEach((milestone) => {\r\n      const item = this.createMilestoneItem(milestone);\r\n      if (this.contentContainer) {\r\n        this.contentContainer.appendChild(item);\r\n      }\r\n      this.selectableItems.push(item);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Create \"No milestone\" option\r\n   */\r\n  private createClearMilestoneItem(): HTMLElement {\r\n    const item = document.createElement(\"div\");\r\n    item.className = \"milestone-item\";\r\n    item.style.display = \"flex\";\r\n    item.style.alignItems = \"center\";\r\n    item.style.padding = \"8px 12px\";\r\n    item.style.cursor = \"pointer\";\r\n    item.style.gap = \"8px\";\r\n\r\n    item.addEventListener(\"mouseenter\", () => {\r\n      item.style.background = \"var(--vscode-list-hoverBackground)\";\r\n    });\r\n    item.addEventListener(\"mouseleave\", () => {\r\n      if (item.style.background !== \"var(--vscode-list-focusBackground)\") {\r\n        item.style.background = \"transparent\";\r\n      }\r\n    });\r\n\r\n    // Radio button indicator\r\n    const radio = document.createElement(\"span\");\r\n    radio.style.width = \"16px\";\r\n    radio.style.height = \"16px\";\r\n    radio.style.borderRadius = \"50%\";\r\n    radio.style.border = \"2px solid var(--vscode-input-border)\";\r\n    radio.style.flexShrink = \"0\";\r\n    radio.style.display = \"inline-flex\";\r\n    radio.style.alignItems = \"center\";\r\n    radio.style.justifyContent = \"center\";\r\n\r\n    if (this.selectedMilestoneId === null) {\r\n      const dot = document.createElement(\"span\");\r\n      dot.style.width = \"8px\";\r\n      dot.style.height = \"8px\";\r\n      dot.style.borderRadius = \"50%\";\r\n      dot.style.background = \"var(--vscode-focusBorder)\";\r\n      radio.appendChild(dot);\r\n    }\r\n\r\n    const label = document.createElement(\"span\");\r\n    label.textContent = \"No milestone\";\r\n    label.style.fontSize = \"13px\";\r\n    label.style.color = \"var(--vscode-descriptionForeground)\";\r\n    label.style.fontStyle = \"italic\";\r\n\r\n    item.appendChild(radio);\r\n    item.appendChild(label);\r\n\r\n    item.addEventListener(\"click\", () => {\r\n      this.selectMilestone(null);\r\n    });\r\n\r\n    return item;\r\n  }\r\n\r\n  /**\r\n   * Create a milestone item\r\n   */\r\n  private createMilestoneItem(milestone: MilestoneOption): HTMLElement {\r\n    const item = document.createElement(\"div\");\r\n    item.className = \"milestone-item\";\r\n    item.style.display = \"flex\";\r\n    item.style.alignItems = \"center\";\r\n    item.style.padding = \"8px 12px\";\r\n    item.style.cursor = \"pointer\";\r\n    item.style.gap = \"8px\";\r\n\r\n    item.addEventListener(\"mouseenter\", () => {\r\n      item.style.background = \"var(--vscode-list-hoverBackground)\";\r\n    });\r\n    item.addEventListener(\"mouseleave\", () => {\r\n      if (item.style.background !== \"var(--vscode-list-focusBackground)\") {\r\n        item.style.background = \"transparent\";\r\n      }\r\n    });\r\n\r\n    // Radio button indicator\r\n    const radio = document.createElement(\"span\");\r\n    radio.style.width = \"16px\";\r\n    radio.style.height = \"16px\";\r\n    radio.style.borderRadius = \"50%\";\r\n    radio.style.border = \"2px solid var(--vscode-input-border)\";\r\n    radio.style.flexShrink = \"0\";\r\n    radio.style.display = \"inline-flex\";\r\n    radio.style.alignItems = \"center\";\r\n    radio.style.justifyContent = \"center\";\r\n\r\n    if (this.selectedMilestoneId === milestone.id) {\r\n      const dot = document.createElement(\"span\");\r\n      dot.style.width = \"8px\";\r\n      dot.style.height = \"8px\";\r\n      dot.style.borderRadius = \"50%\";\r\n      dot.style.background = \"var(--vscode-focusBorder)\";\r\n      radio.appendChild(dot);\r\n    }\r\n\r\n    // Milestone info\r\n    const info = document.createElement(\"div\");\r\n    info.style.flex = \"1\";\r\n    info.style.minWidth = \"0\";\r\n    info.style.display = \"flex\";\r\n    info.style.flexDirection = \"column\";\r\n    info.style.gap = \"2px\";\r\n\r\n    const titleEl = document.createElement(\"div\");\r\n    titleEl.textContent = milestone.title;\r\n    titleEl.style.fontSize = \"13px\";\r\n    titleEl.style.color = \"var(--vscode-foreground)\";\r\n    titleEl.style.overflow = \"hidden\";\r\n    titleEl.style.textOverflow = \"ellipsis\";\r\n    titleEl.style.whiteSpace = \"nowrap\";\r\n\r\n    info.appendChild(titleEl);\r\n\r\n    // Add due date if available\r\n    if (milestone.dueOn) {\r\n      try {\r\n        const dueDate = new Date(milestone.dueOn);\r\n        if (!isNaN(dueDate.getTime())) {\r\n          const formatted = dueDate.toLocaleDateString(\"en-US\", {\r\n            month: \"short\",\r\n            day: \"numeric\",\r\n            year: \"numeric\",\r\n          });\r\n          const dueEl = document.createElement(\"div\");\r\n          dueEl.textContent = `Due ${formatted}`;\r\n          dueEl.style.fontSize = \"11px\";\r\n          dueEl.style.color = \"var(--vscode-descriptionForeground)\";\r\n          info.appendChild(dueEl);\r\n        }\r\n      } catch (e) {\r\n        // Ignore date parsing errors\r\n      }\r\n    }\r\n\r\n    item.appendChild(radio);\r\n    item.appendChild(info);\r\n\r\n    item.addEventListener(\"click\", () => {\r\n      this.selectMilestone(milestone.id);\r\n    });\r\n\r\n    return item;\r\n  }\r\n\r\n  /**\r\n   * Select a milestone (immediately commits the change)\r\n   */\r\n  private selectMilestone(milestoneId: string | null): void {\r\n    this.selectedMilestoneId = milestoneId;\r\n    this.onUpdate(milestoneId);\r\n    this.close();\r\n  }\r\n\r\n  /**\r\n   * Handle search/filter\r\n   */\r\n  protected handleSearch(): void {\r\n    const searchTerm = this.searchInput?.value.toLowerCase() || \"\";\r\n\r\n    if (!searchTerm) {\r\n      this.filteredMilestones = [...this.availableMilestones];\r\n    } else {\r\n      this.filteredMilestones = this.availableMilestones.filter((milestone) =>\r\n        milestone.title.toLowerCase().includes(searchTerm),\r\n      );\r\n    }\r\n\r\n    this.renderContent();\r\n  }\r\n\r\n  /**\r\n   * Handle Apply action (not used for milestone picker)\r\n   */\r\n  protected handleApply(): void {\r\n    // Not used - milestone selection is immediate\r\n  }\r\n\r\n  /**\r\n   * Handle Clear All action\r\n   */\r\n  protected handleClearAll(): void {\r\n    this.selectMilestone(null);\r\n  }\r\n}\r\n", "// Constants\r\nconst UPDATE_TIMEOUT_MS = 10000; // 10 seconds\r\n\r\n/**\r\n * Base class for inline cell editors in the project table.\r\n * Provides common functionality for entering/exiting edit mode,\r\n * keyboard handling, and messaging with the extension backend.\r\n */\r\nexport abstract class CellEditor {\r\n  protected cell: HTMLTableCellElement;\r\n  protected fieldId: string;\r\n  protected fieldType: string;\r\n  protected itemId: string;\r\n  protected projectId: string;\r\n  protected viewKey: string;\r\n  protected originalValue: any;\r\n  protected editorElement: HTMLElement | null = null;\r\n  protected isActive = false;\r\n  protected onCommitCallback?: (value: any) => void;\r\n  protected onCancelCallback?: () => void;\r\n\r\n  constructor(\r\n    cell: HTMLTableCellElement,\r\n    fieldId: string,\r\n    fieldType: string,\r\n    itemId: string,\r\n    projectId: string,\r\n    viewKey: string,\r\n    originalValue: any,\r\n  ) {\r\n    this.cell = cell;\r\n    this.fieldId = fieldId;\r\n    this.fieldType = fieldType;\r\n    this.itemId = itemId;\r\n    this.projectId = projectId;\r\n    this.viewKey = viewKey;\r\n    this.originalValue = originalValue;\r\n  }\r\n\r\n  /**\r\n   * Enter edit mode by replacing cell content with an editor.\r\n   */\r\n  public async enter(): Promise<void> {\r\n    if (this.isActive) return;\r\n    this.isActive = true;\r\n\r\n    // Store original content\r\n    const originalContent = this.cell.innerHTML;\r\n\r\n    // Create editor element\r\n    this.editorElement = await this.createEditor();\r\n    if (!this.editorElement) {\r\n      this.isActive = false;\r\n      return;\r\n    }\r\n\r\n    // Replace cell content with editor\r\n    this.cell.innerHTML = \"\";\r\n    this.cell.appendChild(this.editorElement);\r\n    this.cell.classList.add(\"editing\");\r\n\r\n    // Attach keyboard handlers\r\n    this.attachKeyboardHandlers();\r\n\r\n    // Focus the editor\r\n    this.focusEditor();\r\n  }\r\n\r\n  /**\r\n   * Exit edit mode and restore the original cell content.\r\n   */\r\n  public exit(): void {\r\n    if (!this.isActive) return;\r\n    this.isActive = false;\r\n\r\n    this.cell.classList.remove(\"editing\", \"loading\", \"error\");\r\n    this.editorElement = null;\r\n  }\r\n\r\n  /**\r\n   * Commit the current value and persist to backend.\r\n   */\r\n  public async commit(): Promise<void> {\r\n    if (!this.isActive || !this.editorElement) return;\r\n\r\n    const newValue = this.getValue();\r\n\r\n    // Validate the value\r\n    const validation = this.validate(newValue);\r\n    if (!validation.valid) {\r\n      this.showError(validation.message || \"Invalid value\");\r\n      return;\r\n    }\r\n\r\n    // Show loading state\r\n    this.cell.classList.add(\"loading\");\r\n    if (this.editorElement) {\r\n      this.editorElement.style.opacity = \"0.6\";\r\n    }\r\n\r\n    try {\r\n      // Send update message to backend\r\n      await this.sendUpdate(newValue);\r\n\r\n      // On success, exit edit mode and notify callback\r\n      this.exit();\r\n      if (this.onCommitCallback) {\r\n        this.onCommitCallback(newValue);\r\n      }\r\n    } catch (error) {\r\n      // On error, show error state and remain in edit mode\r\n      this.cell.classList.remove(\"loading\");\r\n      if (this.editorElement) {\r\n        this.editorElement.style.opacity = \"1\";\r\n      }\r\n      this.showError(\r\n        error instanceof Error ? error.message : \"Failed to update field\",\r\n      );\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Cancel editing and restore the original value.\r\n   */\r\n  public cancel(): void {\r\n    if (!this.isActive) return;\r\n    this.exit();\r\n    if (this.onCancelCallback) {\r\n      this.onCancelCallback();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set callback to be called when the value is committed.\r\n   */\r\n  public onCommit(callback: (value: any) => void): void {\r\n    this.onCommitCallback = callback;\r\n  }\r\n\r\n  /**\r\n   * Set callback to be called when editing is cancelled.\r\n   */\r\n  public onCancel(callback: () => void): void {\r\n    this.onCancelCallback = callback;\r\n  }\r\n\r\n  /**\r\n   * Create the editor element for this field type.\r\n   * Must be implemented by subclasses.\r\n   */\r\n  protected abstract createEditor(): Promise<HTMLElement>;\r\n\r\n  /**\r\n   * Get the current value from the editor.\r\n   * Must be implemented by subclasses.\r\n   */\r\n  protected abstract getValue(): any;\r\n\r\n  /**\r\n   * Focus the editor element.\r\n   * Must be implemented by subclasses.\r\n   */\r\n  protected abstract focusEditor(): void;\r\n\r\n  /**\r\n   * Validate the value before committing.\r\n   * Returns {valid: true} if valid, or {valid: false, message: string} if invalid.\r\n   */\r\n  protected validate(value: any): { valid: boolean; message?: string } {\r\n    return { valid: true };\r\n  }\r\n\r\n  /**\r\n   * Attach common keyboard handlers (Esc to cancel, Enter to commit).\r\n   */\r\n  protected attachKeyboardHandlers(): void {\r\n    if (!this.editorElement) return;\r\n\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === \"Escape\") {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.cancel();\r\n      } else if (e.key === \"Enter\" && !e.shiftKey) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.commit();\r\n      } else if (e.key === \"Tab\") {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.commit().then(() => {\r\n          // Move to next cell\r\n          this.moveToNextCell(e.shiftKey);\r\n        });\r\n      }\r\n    };\r\n\r\n    this.editorElement.addEventListener(\"keydown\", handleKeyDown);\r\n  }\r\n\r\n  /**\r\n   * Send update message to the extension backend.\r\n   */\r\n  protected async sendUpdate(newValue: any): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      const messageId = `update-${Date.now()}-${Math.random()}`;\r\n      let timeoutId: number | undefined;\r\n\r\n      // Normalized handler that works for both raw window messages and the\r\n      // __APP_MESSAGING__ shim, which forwards just the data object.\r\n      const handleResponse = (eventOrData: any) => {\r\n        const msg =\r\n          eventOrData &&\r\n          typeof eventOrData === \"object\" &&\r\n          \"data\" in eventOrData\r\n            ? (eventOrData as MessageEvent).data\r\n            : eventOrData;\r\n\r\n        if (!msg || msg.command !== \"updateFieldValueResponse\") {\r\n          return;\r\n        }\r\n        if (msg.id !== messageId) {\r\n          return;\r\n        }\r\n\r\n        window.removeEventListener(\r\n          \"message\",\r\n          handleResponse as unknown as EventListener,\r\n        );\r\n\r\n        if (timeoutId !== undefined) {\r\n          clearTimeout(timeoutId);\r\n        }\r\n\r\n        if (msg.success) {\r\n          resolve();\r\n        } else {\r\n          reject(new Error(msg.error || \"Update failed\"));\r\n        }\r\n      };\r\n\r\n      const messaging = (window as any).__APP_MESSAGING__;\r\n\r\n      if (messaging && typeof messaging.onMessage === \"function\") {\r\n        try {\r\n          messaging.onMessage(handleResponse);\r\n        } catch (e) {\r\n          // Ignore and rely on window listener below.\r\n        }\r\n      }\r\n\r\n      window.addEventListener(\r\n        \"message\",\r\n        handleResponse as unknown as EventListener,\r\n      );\r\n\r\n      // Send the update message\r\n      const message = {\r\n        command: \"updateFieldValue\",\r\n        id: messageId,\r\n        projectId: this.projectId,\r\n        itemId: this.itemId,\r\n        fieldId: this.fieldId,\r\n        fieldType: this.fieldType,\r\n        newValue,\r\n        viewKey: this.viewKey,\r\n      };\r\n\r\n      if (messaging && typeof messaging.postMessage === \"function\") {\r\n        messaging.postMessage(message);\r\n      } else {\r\n        const vscode = (window as any).vscodeApi;\r\n        if (vscode && typeof vscode.postMessage === \"function\") {\r\n          vscode.postMessage(message);\r\n        } else {\r\n          window.removeEventListener(\r\n            \"message\",\r\n            handleResponse as unknown as EventListener,\r\n          );\r\n          reject(new Error(\"No messaging API available\"));\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Timeout after configured duration\r\n      timeoutId = window.setTimeout(() => {\r\n        window.removeEventListener(\r\n          \"message\",\r\n          handleResponse as unknown as EventListener,\r\n        );\r\n        reject(new Error(\"Update timeout\"));\r\n      }, UPDATE_TIMEOUT_MS);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Show an error message near the cell.\r\n   */\r\n  protected showError(message: string): void {\r\n    this.cell.classList.add(\"error\");\r\n\r\n    // Create error tooltip\r\n    const tooltip = document.createElement(\"div\");\r\n    tooltip.className = \"cell-editor-error\";\r\n    tooltip.textContent = message;\r\n    tooltip.style.position = \"absolute\";\r\n    tooltip.style.top = \"100%\";\r\n    tooltip.style.left = \"0\";\r\n    tooltip.style.background = \"var(--vscode-inputValidation-errorBackground)\";\r\n    tooltip.style.border = \"1px solid var(--vscode-inputValidation-errorBorder)\";\r\n    tooltip.style.color = \"var(--vscode-inputValidation-errorForeground)\";\r\n    tooltip.style.padding = \"4px 8px\";\r\n    tooltip.style.borderRadius = \"3px\";\r\n    tooltip.style.fontSize = \"12px\";\r\n    tooltip.style.zIndex = \"1000\";\r\n    tooltip.style.whiteSpace = \"nowrap\";\r\n    tooltip.style.marginTop = \"2px\";\r\n\r\n    this.cell.style.position = \"relative\";\r\n    this.cell.appendChild(tooltip);\r\n\r\n    // Remove error after 3 seconds\r\n    setTimeout(() => {\r\n      this.cell.classList.remove(\"error\");\r\n      if (tooltip.parentElement) {\r\n        tooltip.remove();\r\n      }\r\n    }, 3000);\r\n  }\r\n\r\n  /**\r\n   * Move focus to the next or previous editable cell.\r\n   */\r\n  protected moveToNextCell(reverse: boolean): void {\r\n    const row = this.cell.parentElement as HTMLTableRowElement;\r\n    if (!row) return;\r\n\r\n    const cells = Array.from(row.cells);\r\n    const currentIndex = cells.indexOf(this.cell);\r\n\r\n    if (reverse) {\r\n      // Move to previous cell\r\n      for (let i = currentIndex - 1; i >= 0; i--) {\r\n        const cell = cells[i];\r\n        if (cell.dataset.editable === \"true\") {\r\n          // Just focus the cell; user can press Enter/F2 to edit\r\n          (cell as HTMLTableCellElement).focus();\r\n          return;\r\n        }\r\n      }\r\n    } else {\r\n      // Move to next cell\r\n      for (let i = currentIndex + 1; i < cells.length; i++) {\r\n        const cell = cells[i];\r\n        if (cell.dataset.editable === \"true\") {\r\n          // Just focus the cell; user can press Enter/F2 to edit\r\n          (cell as HTMLTableCellElement).focus();\r\n          return;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n", "import { CellEditor } from \"./CellEditor\";\r\n\r\n/**\r\n * Inline editor for text fields.\r\n * Provides a single-line text input with support for empty strings.\r\n */\r\nexport class TextCellEditor extends CellEditor {\r\n  private input: HTMLInputElement | null = null;\r\n\r\n  protected async createEditor(): Promise<HTMLElement> {\r\n    this.input = document.createElement(\"input\");\r\n    this.input.type = \"text\";\r\n    this.input.value = this.originalValue?.text || \"\";\r\n    this.input.className = \"cell-editor-input\";\r\n\r\n    // Style the input to match VS Code theme\r\n    this.input.style.width = \"100%\";\r\n    this.input.style.height = \"100%\";\r\n    this.input.style.border = \"1px solid var(--vscode-focusBorder)\";\r\n    this.input.style.background = \"var(--vscode-input-background)\";\r\n    this.input.style.color = \"var(--vscode-input-foreground)\";\r\n    this.input.style.padding = \"4px 8px\";\r\n    this.input.style.fontSize = \"13px\";\r\n    this.input.style.fontFamily = \"var(--vscode-font-family)\";\r\n    this.input.style.outline = \"none\";\r\n    this.input.style.boxSizing = \"border-box\";\r\n\r\n    return this.input;\r\n  }\r\n\r\n  protected getValue(): any {\r\n    return this.input ? this.input.value : null;\r\n  }\r\n\r\n  protected focusEditor(): void {\r\n    if (this.input) {\r\n      this.input.focus();\r\n      // Select all text for easy replacement\r\n      this.input.select();\r\n    }\r\n  }\r\n\r\n  protected validate(value: any): { valid: boolean; message?: string } {\r\n    // Text fields can be empty, so any string is valid\r\n    return { valid: true };\r\n  }\r\n}\r\n", "import { CellEditor } from \"./CellEditor\";\r\n\r\n// Constants\r\nconst VALID_NUMBER_PATTERN = /^-?\\d*\\.?\\d*$/;\r\n\r\n/**\r\n * Inline editor for number fields.\r\n * Validates numeric input and allows clearing to null.\r\n */\r\nexport class NumberCellEditor extends CellEditor {\r\n  private input: HTMLInputElement | null = null;\r\n\r\n  protected async createEditor(): Promise<HTMLElement> {\r\n    this.input = document.createElement(\"input\");\r\n    this.input.type = \"text\"; // Use text to allow validation\r\n    this.input.value =\r\n      this.originalValue?.number !== undefined &&\r\n      this.originalValue?.number !== null\r\n        ? String(this.originalValue.number)\r\n        : \"\";\r\n    this.input.className = \"cell-editor-input\";\r\n\r\n    // Style the input to match VS Code theme and right-align for numbers\r\n    this.input.style.width = \"100%\";\r\n    this.input.style.height = \"100%\";\r\n    this.input.style.border = \"1px solid var(--vscode-focusBorder)\";\r\n    this.input.style.background = \"var(--vscode-input-background)\";\r\n    this.input.style.color = \"var(--vscode-input-foreground)\";\r\n    this.input.style.padding = \"4px 8px\";\r\n    this.input.style.fontSize = \"13px\";\r\n    this.input.style.fontFamily = \"var(--vscode-font-family)\";\r\n    this.input.style.outline = \"none\";\r\n    this.input.style.boxSizing = \"border-box\";\r\n    this.input.style.textAlign = \"right\";\r\n    this.input.style.fontVariantNumeric = \"tabular-nums\";\r\n\r\n    // Add input validation to prevent non-numeric characters\r\n    this.input.addEventListener(\"input\", (e) => {\r\n      const target = e.target as HTMLInputElement;\r\n      let value = target.value;\r\n\r\n      // Allow empty string\r\n      if (value === \"\") return;\r\n\r\n      // Remove any invalid characters first\r\n      value = value.replace(/[^0-9.-]/g, \"\");\r\n\r\n      // Ensure minus sign is only at the beginning\r\n      const minusCount = (value.match(/-/g) || []).length;\r\n      if (minusCount > 0) {\r\n        const hasMinus = value.startsWith(\"-\");\r\n        value = value.replace(/-/g, \"\");\r\n        if (hasMinus) {\r\n          value = \"-\" + value;\r\n        }\r\n      }\r\n\r\n      // Ensure only one decimal point\r\n      const decimalCount = (value.match(/\\./g) || []).length;\r\n      if (decimalCount > 1) {\r\n        const parts = value.split(\".\");\r\n        value = parts[0] + \".\" + parts.slice(1).join(\"\");\r\n      }\r\n\r\n      target.value = value;\r\n    });\r\n\r\n    return this.input;\r\n  }\r\n\r\n  protected getValue(): any {\r\n    if (!this.input) return null;\r\n\r\n    const value = this.input.value.trim();\r\n\r\n    // Empty string - return original value instead of null\r\n    // (GitHub API doesn't support clearing fields via this mutation)\r\n    if (value === \"\") {\r\n      return this.originalValue?.number !== undefined &&\r\n        this.originalValue?.number !== null\r\n        ? this.originalValue.number\r\n        : 0;\r\n    }\r\n\r\n    // Parse as number\r\n    const num = Number(value);\r\n    return isNaN(num) ? null : num;\r\n  }\r\n\r\n  protected focusEditor(): void {\r\n    if (this.input) {\r\n      this.input.focus();\r\n      // Select all text for easy replacement\r\n      this.input.select();\r\n    }\r\n  }\r\n\r\n  protected validate(value: any): { valid: boolean; message?: string } {\r\n    // Null is valid (empty field)\r\n    if (value === null) {\r\n      return { valid: true };\r\n    }\r\n\r\n    // Check if it's a valid number\r\n    if (typeof value === \"number\" && !isNaN(value) && isFinite(value)) {\r\n      return { valid: true };\r\n    }\r\n\r\n    return {\r\n      valid: false,\r\n      message: \"Please enter a valid number or leave empty\",\r\n    };\r\n  }\r\n}\r\n", "import { CellEditor } from \"./CellEditor\";\r\n\r\n/**\r\n * Inline editor for date fields.\r\n * Provides a text input with date validation and a clear button.\r\n */\r\nexport class DateCellEditor extends CellEditor {\r\n  private container: HTMLDivElement | null = null;\r\n  private input: HTMLInputElement | null = null;\r\n  private clearBtn: HTMLButtonElement | null = null;\r\n\r\n  protected async createEditor(): Promise<HTMLElement> {\r\n    this.container = document.createElement(\"div\");\r\n    this.container.className = \"cell-editor-date\";\r\n    this.container.style.display = \"flex\";\r\n    this.container.style.alignItems = \"center\";\r\n    this.container.style.gap = \"4px\";\r\n    this.container.style.width = \"100%\";\r\n    this.container.style.height = \"100%\";\r\n\r\n    // Create date input\r\n    this.input = document.createElement(\"input\");\r\n    this.input.type = \"date\"; // HTML5 date picker\r\n    this.input.className = \"cell-editor-input\";\r\n\r\n    // Parse original value\r\n    const dateValue =\r\n      this.originalValue?.date ||\r\n      this.originalValue?.startDate ||\r\n      this.originalValue?.dueOn;\r\n    if (dateValue) {\r\n      try {\r\n        // Convert to YYYY-MM-DD format for input\r\n        const date = new Date(dateValue);\r\n        if (!isNaN(date.getTime())) {\r\n          this.input.value = date.toISOString().split(\"T\")[0];\r\n        }\r\n      } catch (e) {\r\n        // Invalid date, leave empty\r\n      }\r\n    }\r\n\r\n    // Style the input to match VS Code input theme\r\n    this.input.style.flex = \"1\";\r\n    this.input.style.minWidth = \"0\";\r\n    this.input.style.border = \"1px solid var(--vscode-input-border)\";\r\n    this.input.style.background = \"var(--vscode-input-background)\";\r\n    this.input.style.color = \"var(--vscode-input-foreground)\";\r\n    this.input.style.padding = \"4px 8px\";\r\n    this.input.style.fontSize = \"13px\";\r\n    this.input.style.fontFamily = \"var(--vscode-font-family)\";\r\n    this.input.style.outline = \"none\";\r\n    this.input.style.boxSizing = \"border-box\";\r\n\r\n    // Create clear button\r\n    this.clearBtn = document.createElement(\"button\");\r\n    this.clearBtn.textContent = \"\u00D7\";\r\n    this.clearBtn.title = \"Clear date\";\r\n    this.clearBtn.className = \"cell-editor-clear\";\r\n    this.clearBtn.style.flex = \"0 0 auto\";\r\n    this.clearBtn.style.width = \"24px\";\r\n    this.clearBtn.style.height = \"24px\";\r\n    this.clearBtn.style.border = \"1px solid var(--vscode-button-border)\";\r\n    this.clearBtn.style.background = \"var(--vscode-button-secondaryBackground)\";\r\n    this.clearBtn.style.color = \"var(--vscode-button-secondaryForeground)\";\r\n    this.clearBtn.style.borderRadius = \"3px\";\r\n    this.clearBtn.style.cursor = \"pointer\";\r\n    this.clearBtn.style.fontSize = \"18px\";\r\n    this.clearBtn.style.lineHeight = \"1\";\r\n    this.clearBtn.style.padding = \"0\";\r\n    this.clearBtn.style.display = \"flex\";\r\n    this.clearBtn.style.alignItems = \"center\";\r\n    this.clearBtn.style.justifyContent = \"center\";\r\n\r\n    this.clearBtn.addEventListener(\"click\", (e) => {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      if (this.input) {\r\n        this.input.value = \"\";\r\n        this.input.focus();\r\n      }\r\n    });\r\n\r\n    this.clearBtn.addEventListener(\"mouseenter\", () => {\r\n      if (this.clearBtn) {\r\n        this.clearBtn.style.background =\r\n          \"var(--vscode-button-secondaryHoverBackground)\";\r\n      }\r\n    });\r\n\r\n    this.clearBtn.addEventListener(\"mouseleave\", () => {\r\n      if (this.clearBtn) {\r\n        this.clearBtn.style.background =\r\n          \"var(--vscode-button-secondaryBackground)\";\r\n      }\r\n    });\r\n\r\n    this.container.appendChild(this.input);\r\n    this.container.appendChild(this.clearBtn);\r\n\r\n    return this.container;\r\n  }\r\n\r\n  protected getValue(): any {\r\n    if (!this.input) return null;\r\n\r\n    const value = this.input.value.trim();\r\n\r\n    // Empty string - return original value instead of null\r\n    // (GitHub API doesn't support clearing fields via this mutation)\r\n    // Note: We preserve the original value rather than defaulting to today's date\r\n    // to avoid unexpected data changes when user clears and then cancels.\r\n    if (value === \"\") {\r\n      const originalDate =\r\n        this.originalValue?.date ||\r\n        this.originalValue?.startDate ||\r\n        this.originalValue?.dueOn;\r\n      // If there was no original date, this should not happen as the input\r\n      // would show empty initially. But if it does, we keep the empty input\r\n      // and validation will catch it.\r\n      return originalDate || null;\r\n    }\r\n\r\n    // Return ISO 8601 date string\r\n    try {\r\n      const date = new Date(value);\r\n      if (!isNaN(date.getTime())) {\r\n        return date.toISOString();\r\n      }\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  protected focusEditor(): void {\r\n    if (this.input) {\r\n      this.input.focus();\r\n    }\r\n  }\r\n\r\n  protected validate(value: any): { valid: boolean; message?: string } {\r\n    // Null is valid (empty field)\r\n    if (value === null) {\r\n      return { valid: true };\r\n    }\r\n\r\n    // Check if it's a valid ISO 8601 date string\r\n    if (typeof value === \"string\") {\r\n      try {\r\n        const date = new Date(value);\r\n        if (!isNaN(date.getTime())) {\r\n          return { valid: true };\r\n        }\r\n      } catch (e) {\r\n        // Invalid date\r\n      }\r\n    }\r\n\r\n    return {\r\n      valid: false,\r\n      message: \"Please enter a valid date or leave empty\",\r\n    };\r\n  }\r\n}\r\n", "import { CellEditor } from \"./CellEditor\";\r\nimport { TextCellEditor } from \"./TextCellEditor\";\r\nimport { NumberCellEditor } from \"./NumberCellEditor\";\r\nimport { DateCellEditor } from \"./DateCellEditor\";\r\nimport { renderCell } from \"../renderers/cellRenderer\";\r\n\r\n// Constants\r\nconst DOUBLE_CLICK_TIMEOUT_MS = 300;\r\n\r\n/**\r\n * Manages inline cell editors for the project table.\r\n * Handles editor lifecycle, tracks active editor, and coordinates with backend.\r\n */\r\nexport class EditorManager {\r\n  private activeEditor: CellEditor | null = null;\r\n  private projectId: string;\r\n  private viewKey: string;\r\n  private allItems: any[];\r\n\r\n  constructor(projectId: string, viewKey: string, allItems: any[]) {\r\n    this.projectId = projectId;\r\n    this.viewKey = viewKey;\r\n    this.allItems = allItems;\r\n  }\r\n\r\n  /**\r\n   * Enter edit mode for a specific cell (public API for programmatic editing).\r\n   */\r\n  public enterEditMode(\r\n    cell: HTMLTableCellElement,\r\n    fieldValue: any,\r\n    field: any,\r\n    item: any,\r\n  ): void {\r\n    this.enterEditModeInternal(cell, fieldValue, field, item);\r\n  }\r\n\r\n  /**\r\n   * Make a cell editable by attaching click and keyboard handlers.\r\n   */\r\n  public makeEditable(\r\n    cell: HTMLTableCellElement,\r\n    fieldValue: any,\r\n    field: any,\r\n    item: any,\r\n  ): void {\r\n    const rawFieldType = fieldValue?.type || field?.dataType || field?.type;\r\n    const fieldType =\r\n      typeof rawFieldType === \"string\"\r\n        ? rawFieldType.toLowerCase()\r\n        : rawFieldType;\r\n\r\n    // Only text, number, and date fields are editable\r\n    if (![\"text\", \"number\", \"date\"].includes(fieldType)) {\r\n      return;\r\n    }\r\n\r\n    // Mark cell as editable\r\n    cell.dataset.editable = \"true\";\r\n    cell.dataset.fieldType = fieldType;\r\n    cell.dataset.fieldId = String(field.id);\r\n    cell.dataset.itemId = String(item.id);\r\n\r\n    // Add visual indicator that cell is editable\r\n    cell.style.cursor = \"pointer\";\r\n    cell.title = cell.title || \"Click to edit, or press F2\";\r\n\r\n    // Track click count for double-click detection\r\n    let clickCount = 0;\r\n    let clickTimer: any = null;\r\n\r\n    const handleClick = (e: MouseEvent) => {\r\n      // Ignore clicks on resizer handles\r\n      const target = e.target as HTMLElement;\r\n      if (\r\n        target.classList.contains(\"column-resizer\") ||\r\n        target.closest(\".column-resizer\")\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      clickCount++;\r\n\r\n      if (clickCount === 1) {\r\n        // First click: focus the cell\r\n        cell.focus();\r\n\r\n        // Start timer to reset click count\r\n        clickTimer = setTimeout(() => {\r\n          clickCount = 0;\r\n        }, DOUBLE_CLICK_TIMEOUT_MS);\r\n      } else if (clickCount === 2) {\r\n        // Second click: enter edit mode\r\n        clearTimeout(clickTimer);\r\n        clickCount = 0;\r\n        this.enterEditModeInternal(cell, fieldValue, field, item);\r\n      }\r\n    };\r\n\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      // Enter or F2 to enter edit mode\r\n      if (e.key === \"Enter\" || e.key === \"F2\") {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.enterEditModeInternal(cell, fieldValue, field, item);\r\n      }\r\n    };\r\n\r\n    cell.addEventListener(\"click\", handleClick);\r\n    cell.addEventListener(\"keydown\", handleKeyDown);\r\n\r\n    // Make cell focusable\r\n    if (!cell.hasAttribute(\"tabindex\")) {\r\n      cell.setAttribute(\"tabindex\", \"0\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Enter edit mode for a cell (internal implementation).\r\n   */\r\n  private enterEditModeInternal(\r\n    cell: HTMLTableCellElement,\r\n    fieldValue: any,\r\n    field: any,\r\n    item: any,\r\n  ): void {\r\n    // Close any active editor\r\n    if (this.activeEditor) {\r\n      this.activeEditor.cancel();\r\n      this.activeEditor = null;\r\n    }\r\n\r\n    const rawFieldType = fieldValue?.type || field?.dataType || field?.type;\r\n    const fieldType =\r\n      typeof rawFieldType === \"string\"\r\n        ? rawFieldType.toLowerCase()\r\n        : rawFieldType;\r\n    const fieldId = String(field.id);\r\n    const itemId = String(item.id);\r\n\r\n    // Create appropriate editor\r\n    let editor: CellEditor | null = null;\r\n\r\n    switch (fieldType) {\r\n      case \"text\":\r\n        editor = new TextCellEditor(\r\n          cell,\r\n          fieldId,\r\n          fieldType,\r\n          itemId,\r\n          this.projectId,\r\n          this.viewKey,\r\n          fieldValue,\r\n        );\r\n        break;\r\n      case \"number\":\r\n        editor = new NumberCellEditor(\r\n          cell,\r\n          fieldId,\r\n          fieldType,\r\n          itemId,\r\n          this.projectId,\r\n          this.viewKey,\r\n          fieldValue,\r\n        );\r\n        break;\r\n      case \"date\":\r\n        editor = new DateCellEditor(\r\n          cell,\r\n          fieldId,\r\n          fieldType,\r\n          itemId,\r\n          this.projectId,\r\n          this.viewKey,\r\n          fieldValue,\r\n        );\r\n        break;\r\n      default:\r\n        return;\r\n    }\r\n\r\n    if (!editor) return;\r\n\r\n    // Set up callbacks\r\n    editor.onCommit((newValue) => {\r\n      // Update the field value in memory\r\n      this.updateFieldValue(item, field, newValue);\r\n\r\n      // Re-render the cell with the new value\r\n      const updatedFieldValue = this.getFieldValue(item, field);\r\n      cell.innerHTML = renderCell(updatedFieldValue, field, item, this.allItems);\r\n\r\n      // Make cell editable again\r\n      this.makeEditable(cell, updatedFieldValue, field, item);\r\n\r\n      this.activeEditor = null;\r\n    });\r\n\r\n    editor.onCancel(() => {\r\n      // Re-render cell with original value (or clear if none)\r\n      if (fieldValue) {\r\n        cell.innerHTML = renderCell(fieldValue, field, item, this.allItems);\r\n      } else {\r\n        cell.innerHTML = \"\";\r\n      }\r\n\r\n      // Make cell editable again\r\n      this.makeEditable(cell, fieldValue, field, item);\r\n\r\n      this.activeEditor = null;\r\n    });\r\n\r\n    // Enter edit mode\r\n    this.activeEditor = editor;\r\n    editor.enter();\r\n  }\r\n\r\n  /**\r\n   * Update a field value in the item's field values array.\r\n   */\r\n  private updateFieldValue(item: any, field: any, newValue: any): void {\r\n    const fieldId = String(field.id);\r\n    const rawFieldType = field?.dataType || field?.type;\r\n    const fieldType =\r\n      typeof rawFieldType === \"string\"\r\n        ? rawFieldType.toLowerCase()\r\n        : rawFieldType;\r\n\r\n    // Find the field value object\r\n    let fv = item.fieldValues.find(\r\n      (v: any) =>\r\n        String(v.fieldId) === fieldId || v.fieldName === field.name,\r\n    );\r\n\r\n    if (!fv) {\r\n      // Create new field value if it doesn't exist\r\n      fv = {\r\n        fieldId: fieldId,\r\n        fieldName: field.name,\r\n        type: fieldType,\r\n      };\r\n      item.fieldValues.push(fv);\r\n    }\r\n\r\n    // Update the value based on field type\r\n    switch (fieldType) {\r\n      case \"text\":\r\n        fv.text = newValue;\r\n        break;\r\n      case \"number\":\r\n        fv.number = newValue;\r\n        break;\r\n      case \"date\":\r\n        fv.date = newValue;\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the current field value for an item.\r\n   */\r\n  private getFieldValue(item: any, field: any): any {\r\n    return item.fieldValues.find(\r\n      (v: any) =>\r\n        String(v.fieldId) === String(field.id) || v.fieldName === field.name,\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Close any active editor.\r\n   */\r\n  public closeActiveEditor(): void {\r\n    if (this.activeEditor) {\r\n      this.activeEditor.cancel();\r\n      this.activeEditor = null;\r\n    }\r\n  }\r\n}\r\n", "import { renderCell } from \"../renderers/cellRenderer\";\r\n\r\n// Pickers (copilot)\r\nimport { LabelsPicker } from \"../components/LabelsPicker\";\r\nimport { AssigneesPicker } from \"../components/AssigneesPicker\";\r\nimport { ReviewersPicker } from \"../components/ReviewersPicker\";\r\nimport { MilestonePicker } from \"../components/MilestonePicker\";\r\n\r\n// Main branch editor manager\r\nimport { EditorManager } from \"../editors/EditorManager\";\r\n\r\nexport class RowRenderer {\r\n  private editorManager: EditorManager | null = null;\r\n  private activePicker: any = null;\r\n  private onFieldUpdate?: (\r\n    itemId: string,\r\n    fieldId: string,\r\n    value: any,\r\n  ) => Promise<void>;\r\n\r\n  constructor(\r\n    private fields: any[],\r\n    private allItems: any[],\r\n    private onResizeStart: (\r\n      colIndex: number,\r\n      pageX: number,\r\n      startWidth: number,\r\n    ) => void,\r\n\r\n    // main branch callback\r\n    private onCellRendered?: (\r\n      cell: HTMLElement,\r\n      field: any,\r\n      item: any,\r\n      fieldValue: any,\r\n    ) => void,\r\n\r\n    // optional project context\r\n    private projectId?: string,\r\n    private viewKey?: string,\r\n    onFieldUpdate?: (\r\n      itemId: string,\r\n      fieldId: string,\r\n      value: any,\r\n    ) => Promise<void>,\r\n  ) {\r\n    this.onFieldUpdate = onFieldUpdate;\r\n    if (projectId && viewKey) {\r\n      this.editorManager = new EditorManager(projectId, viewKey, allItems);\r\n    }\r\n  }\r\n\r\n  public createRow(item: any, index: number): HTMLTableRowElement {\r\n    const tr = document.createElement(\"tr\");\r\n    tr.classList.add(\"table-row\");\r\n    tr.setAttribute(\"data-gh-item-id\", item.id);\r\n    tr.setAttribute(\"role\", \"row\");\r\n    // aria-rowindex is 1-based and accounts for header row (header is row 1, data starts at 2)\r\n    tr.setAttribute(\"aria-rowindex\", String(index + 2));\r\n\r\n    tr.style.transition = \"background-color 0.15s ease\";\r\n    tr.addEventListener(\"mouseenter\", () => {\r\n      tr.style.backgroundColor = \"var(--vscode-list-hoverBackground)\";\r\n    });\r\n    tr.addEventListener(\"mouseleave\", () => {\r\n      tr.style.backgroundColor = \"transparent\";\r\n    });\r\n\r\n    const tdIndex = document.createElement(\"td\");\r\n    tdIndex.textContent = String(index + 1);\r\n    tdIndex.setAttribute(\"role\", \"gridcell\");\r\n    tdIndex.setAttribute(\"aria-colindex\", \"1\");\r\n    tdIndex.setAttribute(\"aria-label\", `Row ${index + 1}`);\r\n    this.styleCell(tdIndex);\r\n    tr.appendChild(tdIndex);\r\n\r\n    // Render all field cells\r\n    for (let colIndex = 0; colIndex < this.fields.length; colIndex++) {\r\n      const field = this.fields[colIndex];\r\n      const td = document.createElement(\"td\");\r\n      this.styleCell(td);\r\n      \r\n      // Add ARIA attributes for accessibility\r\n      td.setAttribute(\"role\", \"gridcell\");\r\n      td.setAttribute(\"aria-colindex\", String(colIndex + 2)); // +2 because index column is 1\r\n      \r\n      // Add field label for screen readers\r\n      const fieldLabel = field.name || field.id || \"Field\";\r\n      td.setAttribute(\"aria-label\", fieldLabel);\r\n\r\n      const fv = item.fieldValues.find(\r\n        (v: any) =>\r\n          String(v.fieldId) === String(field.id) ||\r\n          v.fieldName === field.name,\r\n      );\r\n\r\n      if (fv) {\r\n        td.innerHTML = renderCell(fv, field, item, this.allItems);\r\n      }\r\n\r\n      // Main branch editor system: attach inline editors for text/number/date\r\n      if (this.editorManager) {\r\n        this.editorManager.makeEditable(td, fv, field, item);\r\n      }\r\n\r\n      // Indicate if cell is editable and wire up pickers for supported field types\r\n      const dataType = String(field.dataType || field.type || \"\").toUpperCase();\r\n      const isSingleSelectOrIteration =\r\n        dataType === \"SINGLE_SELECT\" || dataType === \"ITERATION\";\r\n\r\n      const isPickerField =\r\n        dataType === \"LABELS\" ||\r\n        dataType === \"ASSIGNEES\" ||\r\n        dataType === \"REVIEWERS\" ||\r\n        dataType === \"MILESTONE\";\r\n\r\n      if (isSingleSelectOrIteration || isPickerField) {\r\n        td.setAttribute(\"aria-readonly\", \"false\");\r\n      } else {\r\n        td.setAttribute(\"aria-readonly\", \"true\");\r\n      }\r\n\r\n      // For labels/assignees/reviewers/milestone, open the appropriate picker\r\n      if (isPickerField) {\r\n        td.style.cursor = \"pointer\";\r\n\r\n        const handleClick = (e: MouseEvent) => {\r\n          const target = e.target as HTMLElement;\r\n          if (\r\n            target.classList.contains(\"column-resizer\") ||\r\n            target.closest(\".column-resizer\")\r\n          ) {\r\n            return;\r\n          }\r\n\r\n          e.stopPropagation();\r\n          this.openFieldPicker(td, field, item, fv);\r\n        };\r\n\r\n        const handleKeyDown = (e: KeyboardEvent) => {\r\n          if (e.key === \"Enter\" || e.key === \" \") {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            this.openFieldPicker(td, field, item, fv);\r\n          }\r\n        };\r\n\r\n        td.addEventListener(\"click\", handleClick);\r\n        td.addEventListener(\"keydown\", handleKeyDown);\r\n\r\n        if (!td.hasAttribute(\"tabindex\")) {\r\n          td.setAttribute(\"tabindex\", \"0\");\r\n        }\r\n      }\r\n\r\n      // Allow external callback (used by InteractiveCellManager for single_select/iteration)\r\n      if (this.onCellRendered) {\r\n        this.onCellRendered(td, field, item, fv);\r\n      }\r\n\r\n      // Add column resizer\r\n      td.style.position = \"relative\";\r\n      const resizer = document.createElement(\"div\");\r\n      resizer.className = \"column-resizer\";\r\n      resizer.style.position = \"absolute\";\r\n      resizer.style.top = \"0\";\r\n      resizer.style.right = \"0\";\r\n      resizer.style.width = \"6px\";\r\n      resizer.style.height = \"100%\";\r\n      resizer.style.cursor = \"col-resize\";\r\n      resizer.style.userSelect = \"none\";\r\n      resizer.style.zIndex = \"50\";\r\n\r\n      resizer.addEventListener(\r\n        \"mouseenter\",\r\n        () => (resizer.style.background = \"var(--vscode-focusBorder)\"),\r\n      );\r\n      resizer.addEventListener(\r\n        \"mouseleave\",\r\n        () => (resizer.style.background = \"transparent\"),\r\n      );\r\n\r\n      resizer.addEventListener(\"mousedown\", (e: MouseEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        const table = tr.closest(\"table\") as HTMLTableElement | null;\r\n        if (!table) return;\r\n\r\n        const cols = table.querySelectorAll(\"col\");\r\n        const col = cols[colIndex + 1] as HTMLTableColElement | undefined;\r\n        const startWidth = col\r\n          ? parseInt(col.style.width) || col.offsetWidth\r\n          : td.offsetWidth;\r\n\r\n        this.onResizeStart(colIndex + 1, e.pageX, startWidth);\r\n      });\r\n\r\n      td.appendChild(resizer);\r\n      tr.appendChild(td);\r\n    }\r\n\r\n    return tr;\r\n  }\r\n\r\n  private styleCell(td: HTMLTableCellElement) {\r\n    td.style.padding = \"8px\";\r\n    td.style.borderRight = \"1px solid var(--vscode-panel-border)\";\r\n    td.style.borderBottom = \"1px solid var(--vscode-panel-border)\";\r\n    td.style.whiteSpace = \"nowrap\";\r\n    td.style.overflow = \"hidden\";\r\n    td.style.textOverflow = \"ellipsis\";\r\n  }\r\n\r\n  /**\r\n   * Open the appropriate picker for a field\r\n   */\r\n  private openFieldPicker(\r\n    anchorElement: HTMLElement,\r\n    field: any,\r\n    item: any,\r\n    fieldValue: any,\r\n  ): void {\r\n    // Close any existing picker\r\n    if (this.activePicker) {\r\n      this.activePicker.hide();\r\n      this.activePicker = null;\r\n    }\r\n\r\n    const dataType = String(field.dataType || field.type || \"\").toUpperCase();\r\n\r\n    switch (dataType) {\r\n      case \"LABELS\":\r\n        this.openLabelsPicker(anchorElement, field, item, fieldValue);\r\n        break;\r\n      case \"ASSIGNEES\":\r\n        this.openAssigneesPicker(anchorElement, field, item, fieldValue);\r\n        break;\r\n      case \"REVIEWERS\":\r\n        this.openReviewersPicker(anchorElement, field, item, fieldValue);\r\n        break;\r\n      case \"MILESTONE\":\r\n        this.openMilestonePicker(anchorElement, field, item, fieldValue);\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Open labels picker\r\n   */\r\n  private openLabelsPicker(\r\n    anchorElement: HTMLElement,\r\n    field: any,\r\n    item: any,\r\n    fieldValue: any,\r\n  ): void {\r\n    const currentLabels = (fieldValue && fieldValue.labels) || [];\r\n\r\n    this.activePicker = new LabelsPicker({\r\n      anchorElement,\r\n      field,\r\n      item,\r\n      currentLabels,\r\n      onClose: () => {\r\n        this.activePicker = null;\r\n      },\r\n      onUpdate: async (labelIds: string[]) => {\r\n        if (this.onFieldUpdate) {\r\n          try {\r\n            await this.onFieldUpdate(item.id, field.id, { labelIds });\r\n            // Update will be reflected when snapshot is refreshed\r\n          } catch (error) {\r\n            console.error(\"Failed to update labels:\", error);\r\n            // Could show error UI here\r\n          }\r\n        }\r\n      },\r\n      onError: (error: string) => {\r\n        console.error(\"Labels picker error:\", error);\r\n      },\r\n    });\r\n\r\n    this.activePicker.show();\r\n  }\r\n\r\n  /**\r\n   * Open assignees picker\r\n   */\r\n  private openAssigneesPicker(\r\n    anchorElement: HTMLElement,\r\n    field: any,\r\n    item: any,\r\n    fieldValue: any,\r\n  ): void {\r\n    const currentAssignees = (fieldValue && fieldValue.assignees) || [];\r\n\r\n    this.activePicker = new AssigneesPicker({\r\n      anchorElement,\r\n      field,\r\n      item,\r\n      currentAssignees,\r\n      onClose: () => {\r\n        this.activePicker = null;\r\n      },\r\n      onUpdate: async (assigneeLogins: string[]) => {\r\n        if (this.onFieldUpdate) {\r\n          try {\r\n            await this.onFieldUpdate(item.id, field.id, { assigneeLogins });\r\n          } catch (error) {\r\n            console.error(\"Failed to update assignees:\", error);\r\n          }\r\n        }\r\n      },\r\n      onError: (error: string) => {\r\n        console.error(\"Assignees picker error:\", error);\r\n      },\r\n    });\r\n\r\n    this.activePicker.show();\r\n  }\r\n\r\n  /**\r\n   * Open reviewers picker\r\n   */\r\n  private openReviewersPicker(\r\n    anchorElement: HTMLElement,\r\n    field: any,\r\n    item: any,\r\n    fieldValue: any,\r\n  ): void {\r\n    const currentReviewers = (fieldValue && fieldValue.reviewers) || [];\r\n\r\n    this.activePicker = new ReviewersPicker({\r\n      anchorElement,\r\n      field,\r\n      item,\r\n      currentReviewers,\r\n      onClose: () => {\r\n        this.activePicker = null;\r\n      },\r\n      onUpdate: async (reviewerLogins: string[]) => {\r\n        if (this.onFieldUpdate) {\r\n          try {\r\n            await this.onFieldUpdate(item.id, field.id, { reviewerLogins });\r\n          } catch (error) {\r\n            console.error(\"Failed to update reviewers:\", error);\r\n          }\r\n        }\r\n      },\r\n      onError: (error: string) => {\r\n        console.error(\"Reviewers picker error:\", error);\r\n      },\r\n    });\r\n\r\n    this.activePicker.show();\r\n  }\r\n\r\n  /**\r\n   * Open milestone picker\r\n   */\r\n  private openMilestonePicker(\r\n    anchorElement: HTMLElement,\r\n    field: any,\r\n    item: any,\r\n    fieldValue: any,\r\n  ): void {\r\n    const currentMilestone = (fieldValue && fieldValue.milestone) || null;\r\n\r\n    this.activePicker = new MilestonePicker({\r\n      anchorElement,\r\n      field,\r\n      item,\r\n      currentMilestone,\r\n      onClose: () => {\r\n        this.activePicker = null;\r\n      },\r\n      onUpdate: async (milestoneId: string | null) => {\r\n        if (this.onFieldUpdate) {\r\n          try {\r\n            await this.onFieldUpdate(item.id, field.id, { milestoneId });\r\n          } catch (error) {\r\n            console.error(\"Failed to update milestone:\", error);\r\n          }\r\n        }\r\n      },\r\n      onError: (error: string) => {\r\n        console.error(\"Milestone picker error:\", error);\r\n      },\r\n    });\r\n\r\n    this.activePicker.show();\r\n  }\r\n}\r\n", "import { normalizeColor, escapeHtml } from \"../utils\";\r\nimport { RowRenderer } from \"./RowRenderer\";\r\n\r\nexport class GroupRenderer {\r\n  constructor(\r\n    private fields: any[],\r\n    private allItems: any[],\r\n  ) {}\r\n\r\n  /**\r\n   * Helper to get icon SVG from registry\r\n   * Note: iconName is a runtime string value, so we use 'as any' to bypass\r\n   * the IconName type check. This is safe because the function validates the icon name.\r\n   */\r\n  private getIconSvg(iconName: string, size: number = 14): string {\r\n    if (window.getIconSvg) {\r\n      return window.getIconSvg(iconName as any, { size });\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  public renderGroup(\r\n    tbody: HTMLTableSectionElement,\r\n    group: any,\r\n    groupingField: any,\r\n    rowRenderer: RowRenderer,\r\n  ) {\r\n    // Render Group Header\r\n    const trHeader = document.createElement(\"tr\");\r\n    const tdHeader = document.createElement(\"td\");\r\n    tdHeader.colSpan = this.fields.length + 1;\r\n    tdHeader.style.padding = \"8px\";\r\n    tdHeader.style.background = \"var(--vscode-editor-background)\"; // Ensure opaque background\r\n    tdHeader.style.fontWeight = \"600\";\r\n    tdHeader.style.borderTop = \"1px solid var(--vscode-editorGroup-border)\";\r\n    tdHeader.style.borderBottom = \"1px solid var(--vscode-editorGroup-border)\";\r\n    tdHeader.style.position = \"sticky\";\r\n    tdHeader.style.top = \"32px\"; // Matches fixed header height\r\n    tdHeader.style.zIndex = \"9\";\r\n    tdHeader.style.boxShadow = \"0 1px 2px rgba(0,0,0,0.1)\"; // Add shadow for better separation\r\n\r\n    // Group Header Content\r\n    const headerContent = document.createElement(\"div\");\r\n    headerContent.style.display = \"flex\";\r\n    headerContent.style.alignItems = \"center\";\r\n    headerContent.style.gap = \"8px\";\r\n\r\n    // Helper: find estimate field id (best-effort)\r\n    const estimateField =\r\n      this.fields.find(\r\n        (f) =>\r\n          f.dataType &&\r\n          String(f.dataType).toLowerCase() === \"number\" &&\r\n          String(f.name || \"\")\r\n            .toLowerCase()\r\n            .includes(\"estimate\"),\r\n      ) ||\r\n      this.fields.find(\r\n        (f) => f.dataType && String(f.dataType).toLowerCase() === \"number\",\r\n      );\r\n    const estimateFieldId = estimateField ? estimateField.id : null;\r\n\r\n    const sumEstimate = (itemsArr: any[]) => {\r\n      if (!estimateFieldId) return 0;\r\n      let sum = 0;\r\n      for (const gi of itemsArr) {\r\n        const it = gi.item || gi;\r\n        if (!it || !Array.isArray(it.fieldValues)) continue;\r\n        const fv = it.fieldValues.find(\r\n          (v: any) =>\r\n            (v.fieldId && String(v.fieldId) === String(estimateFieldId)) ||\r\n            (v.fieldName &&\r\n              String(v.fieldName).toLowerCase().includes(\"estimate\")) ||\r\n            v.type === \"number\",\r\n        );\r\n        if (fv) {\r\n          const num = Number(\r\n            fv.number != null ? fv.number : fv.value != null ? fv.value : NaN,\r\n          );\r\n          if (!isNaN(num)) sum += num;\r\n        }\r\n      }\r\n      return sum;\r\n    };\r\n\r\n    const formatEstimate = (n: number) => {\r\n      if (!isFinite(n)) return \"\";\r\n      return String(n);\r\n    };\r\n\r\n    // Toggle Button\r\n    const toggleBtn = document.createElement(\"span\");\r\n    // SVG Icons for GitHub-like look from icon registry\r\n    const iconExpanded = this.getIconSvg(\"triangle-down\", 16);\r\n    const iconCollapsed = this.getIconSvg(\"triangle-right\", 16);\r\n\r\n    toggleBtn.innerHTML = iconExpanded;\r\n    toggleBtn.style.cursor = \"pointer\";\r\n    toggleBtn.style.userSelect = \"none\";\r\n    toggleBtn.style.display = \"inline-flex\";\r\n    toggleBtn.style.alignItems = \"center\";\r\n    toggleBtn.style.justifyContent = \"center\";\r\n    toggleBtn.style.width = \"16px\";\r\n    toggleBtn.style.height = \"16px\";\r\n    toggleBtn.style.fill = \"var(--vscode-foreground)\";\r\n    toggleBtn.style.opacity = \"0.7\";\r\n\r\n    // Group Name & Color\r\n    const colorDot = document.createElement(\"div\");\r\n    colorDot.style.width = \"12px\";\r\n    colorDot.style.height = \"12px\";\r\n    colorDot.style.borderRadius = \"50%\";\r\n    colorDot.style.backgroundColor =\r\n      normalizeColor(group.option.color) || \"gray\";\r\n\r\n    const nameSpan = document.createElement(\"span\");\r\n    nameSpan.textContent =\r\n      group.option.name || group.option.title || \"Unassigned\";\r\n\r\n    // We'll keep the left-hand part of the group header (toggle, avatar/color, name, count)\r\n    // in a sticky left pane so it remains visible when horizontally scrolling.\r\n    const leftPane = document.createElement(\"div\");\r\n    leftPane.style.display = \"flex\";\r\n    leftPane.style.alignItems = \"center\";\r\n    leftPane.style.gap = \"8px\";\r\n    leftPane.style.position = \"sticky\";\r\n    leftPane.style.left = \"0\";\r\n    leftPane.style.zIndex = \"12\";\r\n    leftPane.style.background = tdHeader.style.background;\r\n    leftPane.style.paddingRight = \"8px\";\r\n\r\n    const rightPane = document.createElement(\"div\");\r\n    rightPane.style.display = \"flex\";\r\n    rightPane.style.alignItems = \"center\";\r\n    rightPane.style.gap = \"8px\";\r\n    rightPane.style.flex = \"1\";\r\n\r\n    leftPane.appendChild(toggleBtn);\r\n\r\n    // For parent_issue, try to extract parent metadata from the first child item\r\n    let parentMeta: any = null;\r\n    let resolvedParentItem: any = null;\r\n    if (String(groupingField.dataType || \"\").toLowerCase() === \"parent_issue\") {\r\n      const first =\r\n        group.items && group.items[0]\r\n          ? group.items[0].item || group.items[0]\r\n          : null;\r\n      if (first && Array.isArray(first.fieldValues)) {\r\n        const pfv = first.fieldValues.find(\r\n          (v: any) =>\r\n            String(v.fieldId) === String(groupingField.id) ||\r\n            v.fieldName === groupingField.name ||\r\n            v.type === \"parent_issue\",\r\n        );\r\n        if (pfv) {\r\n          parentMeta =\r\n            pfv.parent ||\r\n            pfv.parentIssue ||\r\n            pfv.issue ||\r\n            pfv.item ||\r\n            pfv.value ||\r\n            null;\r\n        }\r\n      }\r\n\r\n      // Try to resolve the full parent item from the current items snapshot (this.allItems)\r\n      if (parentMeta && Array.isArray(this.allItems)) {\r\n        try {\r\n          const identifiers: string[] = [];\r\n          if (parentMeta.number) identifiers.push(String(parentMeta.number));\r\n          if (parentMeta.id) identifiers.push(String(parentMeta.id));\r\n          if (parentMeta.url) identifiers.push(String(parentMeta.url));\r\n          if (parentMeta.title) identifiers.push(String(parentMeta.title));\r\n          // search in this.allItems for a matching content/raw identifiers\r\n          const found = this.allItems.find((A: any) => {\r\n            const d =\r\n              (A && (A.content || (A.raw && A.raw.itemContent))) || null;\r\n            if (!d) return false;\r\n            const M: string[] = [];\r\n            if (d.number) M.push(String(d.number));\r\n            if (d.id) M.push(String(d.id));\r\n            if (d.url) M.push(String(d.url));\r\n            if (d.title) M.push(String(d.title));\r\n            if (d.name) M.push(String(d.name));\r\n            if (d.raw && d.raw.number) M.push(String(d.raw.number));\r\n            if (d.raw && d.raw.id) M.push(String(d.raw.id));\r\n            if (d.raw && d.raw.url) M.push(String(d.raw.url));\r\n            for (let o of identifiers) {\r\n              for (let m of M) {\r\n                if (o && m && String(o) === String(m)) return true;\r\n              }\r\n            }\r\n            return false;\r\n          });\r\n          if (found) resolvedParentItem = found;\r\n        } catch (e) {}\r\n      }\r\n    }\r\n\r\n    // Avatar / color dot / repo icon depending on field type\r\n    if (\r\n      (group.option && group.option.avatarUrl) ||\r\n      (group.option && group.option.login) ||\r\n      (group.option &&\r\n        group.option.name &&\r\n        String(groupingField.dataType || \"\").toLowerCase() === \"assignees\")\r\n    ) {\r\n      // Try to render avatar for assignees\r\n      const avatarEl = document.createElement(\"span\");\r\n      const avatarUrl =\r\n        (group.option &&\r\n          (group.option.avatarUrl ||\r\n            group.option.avatar ||\r\n            group.option.imageUrl)) ||\r\n        (() => {\r\n          // try to find in items\r\n          for (const gi of group.items) {\r\n            const it = gi.item || gi;\r\n            if (!it || !Array.isArray(it.fieldValues)) continue;\r\n            const fv = it.fieldValues.find(\r\n              (v: any) =>\r\n                v.type === \"assignees\" ||\r\n                String(v.fieldId) === String(groupingField.id),\r\n            );\r\n            if (fv && fv.assignees && Array.isArray(fv.assignees)) {\r\n              const match = fv.assignees.find(\r\n                (a: any) =>\r\n                  String(a.login || a.name) ===\r\n                  String(group.option.name || group.option.id),\r\n              );\r\n              if (match && (match.avatarUrl || match.avatar))\r\n                return match.avatarUrl || match.avatar;\r\n            }\r\n          }\r\n          return null;\r\n        })();\r\n      if (avatarUrl) {\r\n        avatarEl.innerHTML =\r\n          '<span title=\"' +\r\n          escapeHtml(\r\n            (group.option && (group.option.login || group.option.name)) ||\r\n              \"Assignee\",\r\n          ) +\r\n          '\" style=\"display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url(' +\r\n          escapeHtml(avatarUrl) +\r\n          ');border:2px solid var(--vscode-editor-background)\"></span>';\r\n        leftPane.appendChild(avatarEl);\r\n      } else {\r\n        leftPane.appendChild(colorDot);\r\n      }\r\n    } else if (\r\n      String(groupingField.dataType || \"\").toLowerCase() === \"repository\"\r\n    ) {\r\n      // repository icon\r\n      const repoIcon = document.createElement(\"span\");\r\n      repoIcon.innerHTML =\r\n        '<svg width=\"14\" height=\"14\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style=\"flex-shrink:0;color:var(--vscode-icon-foreground)\"><path fill=\"currentColor\" d=\"M2 2.5A1.5 1.5 0 0 1 3.5 1h9A1.5 1.5 0 0 1 14 2.5v11A1.5 1.5 0 0 1 12.5 15h-9A1.5 1.5 0 0 1 2 13.5v-11zM3.5 2A.5.5 0 0 0 3 2.5V4h10V2.5a.5.5 0 0 0-.5-.5h-9z\"/></svg>';\r\n      leftPane.appendChild(repoIcon);\r\n    } else {\r\n      leftPane.appendChild(colorDot);\r\n    }\r\n\r\n    // Name\r\n    // For parent_issue, prefer the resolved parent item's title if available, else use parentMeta\r\n    if (resolvedParentItem) {\r\n      // Try to extract title and status color from resolved parent\r\n      const content =\r\n        resolvedParentItem.content ||\r\n        (resolvedParentItem.raw && resolvedParentItem.raw.itemContent) ||\r\n        null;\r\n      if (content) {\r\n        // title\r\n        try {\r\n          if (content.title) nameSpan.textContent = String(content.title);\r\n          else if (content.name) nameSpan.textContent = String(content.name);\r\n          else if (content.number)\r\n            nameSpan.textContent = String(content.number);\r\n        } catch (e) {}\r\n\r\n        // Try to get status color from parent's fieldValues (single_select status)\r\n        if (Array.isArray(resolvedParentItem.fieldValues)) {\r\n          const statusFV = resolvedParentItem.fieldValues.find(\r\n            (v: any) =>\r\n              v && v.type === \"single_select\" && v.option && v.option.name,\r\n          );\r\n          if (statusFV && statusFV.option) {\r\n            // If option has color, use it; otherwise try map by name\r\n            try {\r\n              const c =\r\n                statusFV.option.color ||\r\n                statusFV.option.id ||\r\n                statusFV.option.name ||\r\n                null;\r\n              if (c)\r\n                colorDot.style.backgroundColor =\r\n                  normalizeColor(c) || colorDot.style.backgroundColor;\r\n            } catch (e) {}\r\n          }\r\n        }\r\n      }\r\n    } else if (parentMeta) {\r\n      nameSpan.textContent =\r\n        parentMeta.title ||\r\n        parentMeta.name ||\r\n        parentMeta.number ||\r\n        parentMeta.id ||\r\n        nameSpan.textContent;\r\n      if (parentMeta.color) {\r\n        try {\r\n          colorDot.style.backgroundColor =\r\n            normalizeColor(parentMeta.color) || colorDot.style.backgroundColor;\r\n        } catch (e) {}\r\n      }\r\n    }\r\n    leftPane.appendChild(nameSpan);\r\n\r\n    // Count circle (placed before estimate pill)\r\n    const countCircle = document.createElement(\"span\");\r\n    countCircle.style.display = \"inline-flex\";\r\n    countCircle.style.alignItems = \"center\";\r\n    countCircle.style.justifyContent = \"center\";\r\n    countCircle.style.width = \"22px\";\r\n    countCircle.style.height = \"22px\";\r\n    countCircle.style.borderRadius = \"50%\";\r\n    countCircle.style.background = \"var(--vscode-input-background)\";\r\n    countCircle.style.border = \"1px solid var(--vscode-panel-border)\";\r\n    countCircle.style.color = \"var(--vscode-foreground)\";\r\n    countCircle.style.fontSize = \"12px\";\r\n    countCircle.style.fontWeight = \"600\";\r\n    countCircle.style.minWidth = \"22px\";\r\n    countCircle.style.boxSizing = \"border-box\";\r\n    countCircle.textContent = String(group.items.length || 0);\r\n    leftPane.appendChild(countCircle);\r\n\r\n    // Estimate pill and optional extra info\r\n    const estSum = sumEstimate(group.items || []);\r\n    if (estSum && estSum > 0) {\r\n      const estEl = document.createElement(\"div\");\r\n      estEl.style.display = \"inline-block\";\r\n      estEl.style.padding = \"2px 8px\";\r\n      estEl.style.borderRadius = \"999px\";\r\n      estEl.style.border = \"1px solid var(--vscode-panel-border)\";\r\n      estEl.style.background = \"var(--vscode-input-background)\";\r\n      estEl.style.color = \"var(--vscode-foreground)\";\r\n      estEl.style.fontSize = \"12px\";\r\n      estEl.style.lineHeight = \"18px\";\r\n      estEl.style.marginLeft = \"8px\";\r\n      estEl.textContent = \"Estimate: \" + formatEstimate(estSum);\r\n      // Put estimate pill into the left sticky pane so it remains visible when horizontally scrolling\r\n      leftPane.appendChild(estEl);\r\n\r\n      // If parent_issue, show completed/amount + progress bar (only for real parents)\r\n      if (\r\n        String(groupingField.dataType || \"\").toLowerCase() === \"parent_issue\" &&\r\n        !(\r\n          group.option &&\r\n          (group.option.name === \"Unassigned\" ||\r\n            group.option.title === \"Unassigned\")\r\n        )\r\n      ) {\r\n        const completedNames = [\"done\", \"closed\", \"completed\", \"finished\"];\r\n\r\n        // Helper: robust done detection for a single item\r\n        const isDoneByHeuristics = (it: any) => {\r\n          try {\r\n            const content =\r\n              it && (it.content || (it.raw && it.raw.itemContent));\r\n            if (content) {\r\n              const state = (\r\n                content.state ||\r\n                (content.merged ? \"MERGED\" : undefined) ||\r\n                \"\"\r\n              )\r\n                .toString()\r\n                .toUpperCase();\r\n              if (state === \"CLOSED\" || state === \"MERGED\") return true;\r\n            }\r\n\r\n            if (Array.isArray(it.fieldValues)) {\r\n              // single_select status matching\r\n              const ss = it.fieldValues.find(\r\n                (v: any) =>\r\n                  v &&\r\n                  v.type === \"single_select\" &&\r\n                  v.option &&\r\n                  v.option.name &&\r\n                  completedNames.includes(String(v.option.name).toLowerCase()),\r\n              );\r\n              if (ss) return true;\r\n\r\n              // numeric percent-like or explicit done flag\r\n              const percentFV = it.fieldValues.find(\r\n                (v: any) =>\r\n                  v &&\r\n                  (String(v.fieldName || \"\")\r\n                    .toLowerCase()\r\n                    .includes(\"progress\") ||\r\n                    String(v.fieldName || \"\")\r\n                      .toLowerCase()\r\n                      .includes(\"percent\") ||\r\n                    (v.type === \"number\" &&\r\n                      String(v.fieldName || \"\")\r\n                        .toLowerCase()\r\n                        .includes(\"progress\"))),\r\n              );\r\n              if (percentFV && percentFV.number != null) {\r\n                const pct = Number(percentFV.number || 0);\r\n                if (pct >= 100) return true;\r\n              }\r\n            }\r\n\r\n            if (\r\n              content &&\r\n              content.labels &&\r\n              Array.isArray(content.labels.nodes)\r\n            ) {\r\n              const labs = content.labels.nodes.map((l: any) =>\r\n                String(l.name || \"\").toLowerCase(),\r\n              );\r\n              for (const cn of completedNames)\r\n                if (labs.includes(cn)) return true;\r\n            }\r\n          } catch (e) {}\r\n          return false;\r\n        };\r\n\r\n        // Prefer parent-provided aggregate if available\r\n        let done = 0;\r\n        let total = 0;\r\n        if (\r\n          resolvedParentItem &&\r\n          Array.isArray(resolvedParentItem.fieldValues)\r\n        ) {\r\n          const agg = resolvedParentItem.fieldValues.find(\r\n            (v: any) =>\r\n              v &&\r\n              (v.type === \"sub_issues_progress\" ||\r\n                (v.total != null && v.done != null)),\r\n          );\r\n          if (agg && agg.total != null) {\r\n            total = Number(agg.total || 0);\r\n            done = Number(agg.done || 0);\r\n          }\r\n        }\r\n\r\n        // If no parent aggregate found, compute from children\r\n        if (!total) {\r\n          for (const gi of group.items) {\r\n            const it = gi.item || gi;\r\n            if (!it) continue;\r\n            total++;\r\n            if (isDoneByHeuristics(it)) done++;\r\n          }\r\n        }\r\n\r\n        // show completed/total BEFORE progress bar\r\n        const doneText = document.createElement(\"div\");\r\n        doneText.style.color = \"var(--vscode-descriptionForeground)\";\r\n        doneText.style.fontSize = \"12px\";\r\n        doneText.style.marginLeft = \"8px\";\r\n        doneText.style.fontVariantNumeric = \"tabular-nums\";\r\n        doneText.textContent = `${done}/${total}`;\r\n        // Keep completed/total near the left sticky area so it stays visible\r\n        leftPane.appendChild(doneText);\r\n\r\n        // show progress bar\r\n        const progWrapper = document.createElement(\"div\");\r\n        progWrapper.style.display = \"inline-flex\";\r\n        progWrapper.style.alignItems = \"center\";\r\n        progWrapper.style.gap = \"8px\";\r\n        progWrapper.style.marginLeft = \"8px\";\r\n        const pct = total > 0 ? Math.round((done / total) * 100) : 0;\r\n        const bar = document.createElement(\"div\");\r\n        bar.style.display = \"inline-block\";\r\n        bar.style.width = \"120px\";\r\n        bar.style.height = \"12px\";\r\n        bar.style.background = \"transparent\";\r\n        bar.style.border = \"1px solid var(--vscode-focusBorder)\";\r\n        bar.style.borderRadius = \"6px\";\r\n        bar.style.overflow = \"hidden\";\r\n        const fill = document.createElement(\"div\");\r\n        fill.style.height = \"100%\";\r\n        fill.style.width = String(pct) + \"%\";\r\n        fill.style.background = \"var(--vscode-focusBorder)\";\r\n        bar.appendChild(fill);\r\n        progWrapper.appendChild(bar);\r\n        // Progress bar is useful summary info \u2014 keep it in the sticky left pane\r\n        leftPane.appendChild(progWrapper);\r\n      }\r\n    }\r\n\r\n    // Single-select: show option description if available\r\n    if (\r\n      String(groupingField.dataType || \"\").toLowerCase() === \"single_select\"\r\n    ) {\r\n      try {\r\n        const opt = (groupingField.options || []).find(\r\n          (o: any) =>\r\n            String(o.name) === String(group.option && group.option.name),\r\n        );\r\n        if (opt && opt.description) {\r\n          const descEl = document.createElement(\"div\");\r\n          descEl.style.color = \"var(--vscode-descriptionForeground)\";\r\n          descEl.style.fontSize = \"12px\";\r\n          descEl.style.marginLeft = \"8px\";\r\n          descEl.textContent = String(opt.description).slice(0, 120);\r\n          // Keep description fixed in the left sticky pane so it remains visible\r\n          leftPane.appendChild(descEl);\r\n        }\r\n      } catch (e) {}\r\n    }\r\n\r\n    // Iteration: append iteration range (start - end) if startDate/duration available, else title\r\n    if (String(groupingField.dataType || \"\").toLowerCase() === \"iteration\") {\r\n      try {\r\n        const opt = group.option || {};\r\n        let iterText: string | null = null;\r\n        const start = opt.startDate || (opt.start && opt.startDate) || null;\r\n        const duration = opt.duration || opt.length || null;\r\n        if (start && duration) {\r\n          try {\r\n            const s = new Date(start);\r\n            const days = Number(duration) || 0;\r\n            const e = new Date(s.getTime() + days * 24 * 60 * 60 * 1000);\r\n            const sStr = s.toLocaleDateString(\"en-US\", {\r\n              month: \"short\",\r\n              day: \"numeric\",\r\n            });\r\n            const eStr = e.toLocaleDateString(\"en-US\", {\r\n              month: \"short\",\r\n              day: \"numeric\",\r\n            });\r\n            iterText = `${sStr} \u2014 ${eStr}`;\r\n          } catch (e) {\r\n            iterText = null;\r\n          }\r\n        }\r\n        if (!iterText) {\r\n          iterText =\r\n            opt.title || opt.name ? String(opt.title || opt.name) : null;\r\n        }\r\n        if (iterText) {\r\n          const iterEl = document.createElement(\"div\");\r\n          iterEl.style.color = \"var(--vscode-descriptionForeground)\";\r\n          iterEl.style.fontSize = \"12px\";\r\n          iterEl.style.marginLeft = \"8px\";\r\n          iterEl.textContent = String(iterText).slice(0, 120);\r\n          // Keep iteration info fixed in the left sticky pane\r\n          leftPane.appendChild(iterEl);\r\n        }\r\n      } catch (e) {}\r\n    }\r\n\r\n    // If this group corresponds to 'Unassigned', rename to 'No <fieldname>'\r\n    if (\r\n      group.option &&\r\n      (group.option.name === \"Unassigned\" ||\r\n        group.option.title === \"Unassigned\")\r\n    ) {\r\n      nameSpan.textContent = \"No \" + (groupingField.name || \"value\");\r\n    }\r\n\r\n    // Compose header: leftPane (sticky) + rightPane (scrolling content)\r\n    headerContent.appendChild(leftPane);\r\n    headerContent.appendChild(rightPane);\r\n\r\n    tdHeader.appendChild(headerContent);\r\n    trHeader.appendChild(tdHeader);\r\n    tbody.appendChild(trHeader);\r\n\r\n    // Render Items\r\n    const groupRows: HTMLTableRowElement[] = [];\r\n    group.items.forEach((groupItem: any) => {\r\n      const tr = rowRenderer.createRow(groupItem.item, groupItem.index);\r\n      tr.classList.add(\"group-row-\" + group.option.id); // Add class for group toggling\r\n      tbody.appendChild(tr);\r\n      groupRows.push(tr);\r\n    });\r\n\r\n    // Toggle Logic\r\n    let isCollapsed = false;\r\n    toggleBtn.addEventListener(\"click\", () => {\r\n      isCollapsed = !isCollapsed;\r\n      toggleBtn.innerHTML = isCollapsed ? iconCollapsed : iconExpanded;\r\n      groupRows.forEach((row) => {\r\n        row.style.display = isCollapsed ? \"none\" : \"table-row\";\r\n      });\r\n    });\r\n  }\r\n}\r\n", "export class TableResizer {\r\n  constructor(\r\n    private table: HTMLTableElement,\r\n    private fields: any[],\r\n    private options: any,\r\n  ) {}\r\n\r\n  public setupResizers() {\r\n    const headers = this.table.querySelectorAll(\"th\");\r\n\r\n    headers.forEach((th, index) => {\r\n      // Skip index column\r\n      if (index === 0) return;\r\n\r\n      // Create resizer element\r\n      const resizer = document.createElement(\"div\");\r\n      resizer.className = \"column-resizer\";\r\n      resizer.style.position = \"absolute\";\r\n      resizer.style.top = \"0\";\r\n      resizer.style.right = \"0\";\r\n      resizer.style.width = \"4px\";\r\n      resizer.style.height = \"100%\";\r\n      resizer.style.cursor = \"col-resize\";\r\n      resizer.style.userSelect = \"none\";\r\n      resizer.style.zIndex = \"100\";\r\n\r\n      // Visual feedback on hover\r\n      resizer.addEventListener(\"mouseenter\", () => {\r\n        resizer.style.background = \"var(--vscode-focusBorder)\";\r\n      });\r\n\r\n      resizer.addEventListener(\"mouseleave\", () => {\r\n        resizer.style.background = \"transparent\";\r\n      });\r\n\r\n      // Resize logic\r\n      resizer.addEventListener(\"mousedown\", (e: MouseEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const cols = this.table.querySelectorAll(\"col\");\r\n        const col = cols[index] as HTMLTableColElement | undefined; // index aligns with th\r\n        const startW = col\r\n          ? parseInt(col.style.width) || col.offsetWidth\r\n          : th.offsetWidth;\r\n        this.beginColumnResize(index, e.pageX, startW);\r\n      });\r\n\r\n      // Make th position relative for absolute positioning\r\n      (th as HTMLElement).style.position = \"relative\";\r\n      th.appendChild(resizer);\r\n    });\r\n\r\n    // Restore column widths from localStorage\r\n    this.restoreColumnWidths();\r\n  }\r\n\r\n  public beginColumnResize(\r\n    colIndex: number,\r\n    startX: number,\r\n    startWidth: number,\r\n  ) {\r\n    const onMouseMove = (e: MouseEvent) => {\r\n      const newWidth = Math.max(20, startWidth + (e.pageX - startX));\r\n      const cols = this.table.querySelectorAll(\"col\");\r\n      const col = cols[colIndex] as HTMLTableColElement | undefined;\r\n      if (col) {\r\n        col.style.width = `${newWidth}px`;\r\n        col.style.minWidth = `${newWidth}px`;\r\n        col.style.maxWidth = `${newWidth}px`;\r\n      }\r\n    };\r\n\r\n    const onMouseUp = (e?: MouseEvent) => {\r\n      document.removeEventListener(\"mousemove\", onMouseMove);\r\n      document.removeEventListener(\"mouseup\", onMouseUp);\r\n\r\n      // Save mapping to field id (colIndex - 1 => fields)\r\n      const fieldIndex = colIndex - 1;\r\n      if (fieldIndex >= 0 && fieldIndex < this.fields.length) {\r\n        const cols = this.table.querySelectorAll(\"col\");\r\n        const col = cols[colIndex] as HTMLTableColElement | undefined;\r\n        const widthToSave = col\r\n          ? parseInt(col.style.width) || col.offsetWidth\r\n          : undefined;\r\n        if (widthToSave) {\r\n          this.saveColumnWidth(this.fields[fieldIndex].id, widthToSave);\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"mousemove\", onMouseMove);\r\n    document.addEventListener(\"mouseup\", onMouseUp);\r\n  }\r\n\r\n  private saveColumnWidth(fieldId: string, width: number) {\r\n    const key = this.getStorageKey(\"columnWidths\");\r\n    if (!key) return;\r\n\r\n    try {\r\n      const stored = localStorage.getItem(key);\r\n      const widths = stored ? JSON.parse(stored) : {};\r\n      widths[fieldId] = width;\r\n      localStorage.setItem(key, JSON.stringify(widths));\r\n    } catch (e) {}\r\n  }\r\n\r\n  private restoreColumnWidths() {\r\n    const key = this.getStorageKey(\"columnWidths\");\r\n    if (!key) return;\r\n\r\n    try {\r\n      const stored = localStorage.getItem(key);\r\n      if (!stored) return;\r\n\r\n      const widths = JSON.parse(stored);\r\n      const cols = this.table.querySelectorAll(\"col\");\r\n\r\n      this.fields.forEach((field, index) => {\r\n        const width = widths[field.id];\r\n        if (width) {\r\n          const col = cols[index + 1] as HTMLTableColElement; // +1 for index column\r\n          if (col) {\r\n            col.style.width = `${width}px`;\r\n            col.style.minWidth = `${width}px`;\r\n            col.style.maxWidth = `${width}px`;\r\n          }\r\n        }\r\n      });\r\n    } catch (e) {}\r\n  }\r\n\r\n  private getStorageKey(suffix: string): string {\r\n    return this.options.viewKey\r\n      ? `ghProjects.table.${this.options.viewKey}.${suffix}`\r\n      : \"\";\r\n  }\r\n}\r\n", "import { escapeHtml, normalizeColor, addAlpha } from \"../utils\";\r\n\r\nexport interface DropdownOption {\r\n  id: string | null; // null for \"Clear\" option\r\n  label: string;\r\n  description?: string;\r\n  color?: string;\r\n  metadata?: any; // Additional data like iteration dates\r\n}\r\n\r\nexport interface DropdownConfig {\r\n  options: DropdownOption[];\r\n  currentValue: string | null; // ID of currently selected option\r\n  anchorElement: HTMLElement;\r\n  onSelect: (optionId: string | null) => void;\r\n  onClose: () => void;\r\n  title?: string;\r\n  emptyMessage?: string;\r\n}\r\n\r\n/**\r\n * Reusable dropdown component for field value selection.\r\n * Supports keyboard navigation and proper positioning.\r\n */\r\nexport class FieldDropdown {\r\n  private container: HTMLElement;\r\n  private backdrop: HTMLElement;\r\n  private config: DropdownConfig;\r\n  private selectedIndex: number = 0;\r\n  private mounted: boolean = false;\r\n\r\n  constructor(config: DropdownConfig) {\r\n    this.config = config;\r\n    this.container = this.createDropdown();\r\n    this.backdrop = this.createBackdrop();\r\n    \r\n    // Find currently selected index\r\n    this.selectedIndex = Math.max(\r\n      0,\r\n      this.config.options.findIndex((opt) => opt.id === this.config.currentValue)\r\n    );\r\n  }\r\n\r\n  private createBackdrop(): HTMLElement {\r\n    const backdrop = document.createElement(\"div\");\r\n    backdrop.className = \"field-dropdown-backdrop\";\r\n    backdrop.style.position = \"fixed\";\r\n    backdrop.style.top = \"0\";\r\n    backdrop.style.left = \"0\";\r\n    backdrop.style.right = \"0\";\r\n    backdrop.style.bottom = \"0\";\r\n    backdrop.style.zIndex = \"999\";\r\n    backdrop.style.background = \"transparent\";\r\n\r\n    backdrop.addEventListener(\"click\", (e) => {\r\n      e.stopPropagation();\r\n      this.close();\r\n    });\r\n\r\n    // Handle escape key\r\n    backdrop.addEventListener(\"keydown\", (e) => {\r\n      if (e.key === \"Escape\") {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.close();\r\n      }\r\n    });\r\n\r\n    return backdrop;\r\n  }\r\n\r\n  private createDropdown(): HTMLElement {\r\n    const dropdown = document.createElement(\"div\");\r\n    dropdown.className = \"field-dropdown\";\r\n    dropdown.style.position = \"absolute\";\r\n    dropdown.style.background = \"var(--vscode-menu-background)\";\r\n    dropdown.style.border = \"1px solid var(--vscode-menu-border)\";\r\n    dropdown.style.borderRadius = \"4px\";\r\n    dropdown.style.boxShadow = \"0 2px 8px rgba(0,0,0,0.2)\";\r\n    dropdown.style.minWidth = \"200px\";\r\n    dropdown.style.maxWidth = \"350px\";\r\n    dropdown.style.maxHeight = \"400px\";\r\n    dropdown.style.overflowY = \"auto\";\r\n    dropdown.style.zIndex = \"1000\";\r\n    dropdown.style.fontSize = \"13px\";\r\n    \r\n    // Add ARIA attributes for accessibility\r\n    dropdown.setAttribute(\"role\", \"listbox\");\r\n    dropdown.setAttribute(\"aria-label\", this.config.title || \"Select option\");\r\n    dropdown.setAttribute(\"aria-activedescendant\", \"\"); // Will be updated as selection changes\r\n\r\n    // Add title if provided\r\n    if (this.config.title) {\r\n      const title = document.createElement(\"div\");\r\n      title.className = \"field-dropdown-title\";\r\n      title.textContent = this.config.title;\r\n      title.style.padding = \"8px 12px\";\r\n      title.style.fontWeight = \"600\";\r\n      title.style.borderBottom = \"1px solid var(--vscode-menu-separatorBackground)\";\r\n      title.style.color = \"var(--vscode-descriptionForeground)\";\r\n      title.style.fontSize = \"11px\";\r\n      title.style.textTransform = \"uppercase\";\r\n      dropdown.appendChild(title);\r\n    }\r\n\r\n    // Add options\r\n    if (this.config.options.length === 0) {\r\n      const emptyMsg = document.createElement(\"div\");\r\n      emptyMsg.className = \"field-dropdown-empty\";\r\n      emptyMsg.textContent = this.config.emptyMessage || \"No options available\";\r\n      emptyMsg.style.padding = \"12px\";\r\n      emptyMsg.style.color = \"var(--vscode-descriptionForeground)\";\r\n      emptyMsg.style.fontStyle = \"italic\";\r\n      dropdown.appendChild(emptyMsg);\r\n    } else {\r\n      this.config.options.forEach((option, index) => {\r\n        const item = this.createOptionElement(option, index);\r\n        dropdown.appendChild(item);\r\n      });\r\n    }\r\n\r\n    // Keyboard navigation\r\n    dropdown.addEventListener(\"keydown\", (e) => {\r\n      this.handleKeyDown(e);\r\n    });\r\n\r\n    dropdown.tabIndex = 0; // Make focusable\r\n\r\n    return dropdown;\r\n  }\r\n\r\n  private createOptionElement(option: DropdownOption, index: number): HTMLElement {\r\n    const item = document.createElement(\"div\");\r\n    item.className = \"field-dropdown-option\";\r\n    item.dataset.index = String(index);\r\n    item.id = `dropdown-option-${index}`;\r\n    item.style.padding = \"8px 12px\";\r\n    item.style.cursor = \"pointer\";\r\n    item.style.display = \"flex\";\r\n    item.style.alignItems = \"center\";\r\n    item.style.gap = \"8px\";\r\n    item.style.color = \"var(--vscode-menu-foreground)\";\r\n    item.style.transition = \"background-color 0.1s ease\";\r\n    \r\n    // Add ARIA attributes\r\n    item.setAttribute(\"role\", \"option\");\r\n    item.setAttribute(\"aria-label\", option.label);\r\n    if (option.description) {\r\n      item.setAttribute(\"aria-description\", option.description);\r\n    }\r\n\r\n    // Highlight if selected\r\n    if (option.id === this.config.currentValue) {\r\n      item.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n      item.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n      item.classList.add(\"selected\");\r\n      item.setAttribute(\"aria-selected\", \"true\");\r\n    } else {\r\n      item.setAttribute(\"aria-selected\", \"false\");\r\n    }\r\n\r\n    // Color swatch (for single-select options)\r\n    if (option.color) {\r\n      const swatch = document.createElement(\"div\");\r\n      swatch.className = \"field-dropdown-swatch\";\r\n      const normalizedColor = normalizeColor(option.color) || \"#999\";\r\n      swatch.style.width = \"16px\";\r\n      swatch.style.height = \"16px\";\r\n      swatch.style.borderRadius = \"3px\";\r\n      swatch.style.background = normalizedColor;\r\n      swatch.style.border = \"1px solid rgba(0,0,0,0.2)\";\r\n      swatch.style.flexShrink = \"0\";\r\n      item.appendChild(swatch);\r\n    }\r\n\r\n    // Label and description container\r\n    const textContainer = document.createElement(\"div\");\r\n    textContainer.style.flex = \"1\";\r\n    textContainer.style.minWidth = \"0\";\r\n\r\n    const label = document.createElement(\"div\");\r\n    label.className = \"field-dropdown-label\";\r\n    label.textContent = option.label;\r\n    label.style.fontWeight = option.id === null ? \"600\" : \"normal\";\r\n    label.style.overflow = \"hidden\";\r\n    label.style.textOverflow = \"ellipsis\";\r\n    label.style.whiteSpace = \"nowrap\";\r\n    textContainer.appendChild(label);\r\n\r\n    // Description or metadata\r\n    if (option.description || option.metadata) {\r\n      const desc = document.createElement(\"div\");\r\n      desc.className = \"field-dropdown-description\";\r\n      desc.textContent = option.description || (option.metadata?.dateRange || \"\");\r\n      desc.style.fontSize = \"11px\";\r\n      desc.style.color = \"var(--vscode-descriptionForeground)\";\r\n      desc.style.overflow = \"hidden\";\r\n      desc.style.textOverflow = \"ellipsis\";\r\n      desc.style.whiteSpace = \"nowrap\";\r\n      desc.style.marginTop = \"2px\";\r\n      textContainer.appendChild(desc);\r\n    }\r\n\r\n    item.appendChild(textContainer);\r\n\r\n    // Hover effect\r\n    item.addEventListener(\"mouseenter\", () => {\r\n      this.highlightOption(index);\r\n    });\r\n\r\n    // Click handler\r\n    item.addEventListener(\"click\", (e) => {\r\n      e.stopPropagation();\r\n      this.selectOption(option.id);\r\n    });\r\n\r\n    return item;\r\n  }\r\n\r\n  private highlightOption(index: number) {\r\n    // Remove highlight from all options\r\n    const items = this.container.querySelectorAll(\".field-dropdown-option\");\r\n    items.forEach((item) => {\r\n      const el = item as HTMLElement;\r\n      if (!el.classList.contains(\"selected\")) {\r\n        el.style.background = \"transparent\";\r\n        el.style.color = \"var(--vscode-menu-foreground)\";\r\n      }\r\n    });\r\n\r\n    // Highlight the new option\r\n    this.selectedIndex = index;\r\n    const targetItem = items[index] as HTMLElement;\r\n    if (targetItem) {\r\n      if (!targetItem.classList.contains(\"selected\")) {\r\n        targetItem.style.background = \"var(--vscode-list-hoverBackground)\";\r\n        targetItem.style.color = \"var(--vscode-menu-foreground)\";\r\n      }\r\n    }\r\n    \r\n    // Update ARIA activedescendant for screen readers on the listbox element\r\n    if (targetItem) {\r\n      this.container.setAttribute(\"aria-activedescendant\", targetItem.id);\r\n    }\r\n  }\r\n\r\n  private handleKeyDown(e: KeyboardEvent) {\r\n    switch (e.key) {\r\n      case \"ArrowDown\":\r\n        e.preventDefault();\r\n        this.selectedIndex = Math.min(\r\n          this.selectedIndex + 1,\r\n          this.config.options.length - 1\r\n        );\r\n        this.highlightOption(this.selectedIndex);\r\n        this.scrollToOption(this.selectedIndex);\r\n        break;\r\n\r\n      case \"ArrowUp\":\r\n        e.preventDefault();\r\n        this.selectedIndex = Math.max(this.selectedIndex - 1, 0);\r\n        this.highlightOption(this.selectedIndex);\r\n        this.scrollToOption(this.selectedIndex);\r\n        break;\r\n\r\n      case \"Enter\":\r\n        e.preventDefault();\r\n        const selectedOption = this.config.options[this.selectedIndex];\r\n        if (selectedOption) {\r\n          this.selectOption(selectedOption.id);\r\n        }\r\n        break;\r\n\r\n      case \"Escape\":\r\n        e.preventDefault();\r\n        this.close();\r\n        break;\r\n    }\r\n  }\r\n\r\n  private scrollToOption(index: number) {\r\n    const items = this.container.querySelectorAll(\".field-dropdown-option\");\r\n    const item = items[index] as HTMLElement;\r\n    if (item) {\r\n      try {\r\n        item.scrollIntoView({ block: \"nearest\", behavior: \"smooth\" });\r\n      } catch (e) {\r\n        // Fallback for environments where scrollIntoView is not available (e.g., jsdom in tests)\r\n      }\r\n    }\r\n  }\r\n\r\n  private selectOption(optionId: string | null) {\r\n    this.config.onSelect(optionId);\r\n    this.close();\r\n  }\r\n\r\n  private close() {\r\n    if (!this.mounted) return;\r\n    this.mounted = false;\r\n    \r\n    if (this.container.parentElement) {\r\n      this.container.remove();\r\n    }\r\n    if (this.backdrop.parentElement) {\r\n      this.backdrop.remove();\r\n    }\r\n    \r\n    this.config.onClose();\r\n  }\r\n\r\n  public show() {\r\n    if (this.mounted) return;\r\n    \r\n    this.mounted = true;\r\n    document.body.appendChild(this.backdrop);\r\n    document.body.appendChild(this.container);\r\n\r\n    // Position dropdown relative to anchor\r\n    this.positionDropdown();\r\n\r\n    // Focus dropdown for keyboard navigation\r\n    setTimeout(() => {\r\n      this.container.focus();\r\n      // Scroll to selected option\r\n      if (this.selectedIndex >= 0) {\r\n        this.scrollToOption(this.selectedIndex);\r\n      }\r\n    }, 0);\r\n\r\n    // Reposition on scroll/resize\r\n    window.addEventListener(\"scroll\", this.handleScroll, true);\r\n    window.addEventListener(\"resize\", this.handleResize);\r\n  }\r\n\r\n  private handleScroll = () => {\r\n    this.positionDropdown();\r\n  };\r\n\r\n  private handleResize = () => {\r\n    this.positionDropdown();\r\n  };\r\n\r\n  private positionDropdown() {\r\n    const anchorRect = this.config.anchorElement.getBoundingClientRect();\r\n    const dropdownRect = this.container.getBoundingClientRect();\r\n    const viewportHeight = window.innerHeight;\r\n    const viewportWidth = window.innerWidth;\r\n\r\n    let top = anchorRect.bottom + 4;\r\n    let left = anchorRect.left;\r\n\r\n    // Flip above if not enough space below\r\n    if (top + dropdownRect.height > viewportHeight && anchorRect.top > dropdownRect.height) {\r\n      top = anchorRect.top - dropdownRect.height - 4;\r\n    }\r\n\r\n    // Adjust horizontal position if overflowing\r\n    if (left + dropdownRect.width > viewportWidth) {\r\n      left = Math.max(4, viewportWidth - dropdownRect.width - 4);\r\n    }\r\n\r\n    this.container.style.top = `${top}px`;\r\n    this.container.style.left = `${left}px`;\r\n  }\r\n\r\n  public destroy() {\r\n    window.removeEventListener(\"scroll\", this.handleScroll, true);\r\n    window.removeEventListener(\"resize\", this.handleResize);\r\n    this.close();\r\n  }\r\n}\r\n", "import { FieldDropdown, DropdownOption } from \"./FieldDropdown\";\r\n\r\nexport interface CellUpdateRequest {\r\n  itemId: string;\r\n  fieldId: string;\r\n  value: string | null; // optionId for single_select, iterationId for iteration, null for clear\r\n  projectId: string;\r\n  viewKey: string;\r\n}\r\n\r\nexport interface InteractiveCellConfig {\r\n  onUpdateRequest: (request: CellUpdateRequest) => Promise<void>;\r\n  onUpdateSuccess: (request: CellUpdateRequest) => void;\r\n  onUpdateError: (request: CellUpdateRequest, error: string) => void;\r\n}\r\n\r\n/**\r\n * Manages interactive behavior for single-select and iteration cells.\r\n * Handles click events, dropdown display, and update requests.\r\n */\r\nconst ERROR_TOOLTIP_DURATION_MS = 3000;\r\n\r\nexport class InteractiveCellManager {\r\n  private config: InteractiveCellConfig;\r\n  private activeDropdown: FieldDropdown | null = null;\r\n  private updatingCells: Set<string> = new Set(); // Track cells being updated\r\n\r\n  constructor(config: InteractiveCellConfig) {\r\n    this.config = config;\r\n  }\r\n\r\n  /**\r\n   * Attach interactive behavior to a table cell.\r\n   */\r\n  public attachToCell(\r\n    cell: HTMLElement,\r\n    field: any,\r\n    item: any,\r\n    currentValue: any,\r\n    projectId: string,\r\n    viewKey: string\r\n  ) {\r\n    const fieldType = field.dataType || field.type;\r\n    \r\n    if (fieldType !== \"SINGLE_SELECT\" && fieldType !== \"ITERATION\") {\r\n      return; // Only handle single_select and iteration fields\r\n    }\r\n\r\n    // Make cell clickable\r\n    cell.style.cursor = \"pointer\";\r\n    cell.style.userSelect = \"none\";\r\n    cell.classList.add(\"interactive-cell\");\r\n\r\n    // Add click handler\r\n    const clickHandler = (e: MouseEvent) => {\r\n      e.stopPropagation();\r\n      \r\n      // Don't open if cell is being updated\r\n      const cellKey = this.getCellKey(item.id, field.id);\r\n      if (this.updatingCells.has(cellKey)) {\r\n        return;\r\n      }\r\n\r\n      this.openDropdownForCell(cell, field, item, currentValue, projectId, viewKey);\r\n    };\r\n\r\n    cell.addEventListener(\"click\", clickHandler);\r\n\r\n    // Add keyboard handler\r\n    const keyHandler = (e: KeyboardEvent) => {\r\n      if (e.key === \"Enter\" || e.key === \" \") {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        \r\n        const cellKey = this.getCellKey(item.id, field.id);\r\n        if (this.updatingCells.has(cellKey)) {\r\n          return;\r\n        }\r\n\r\n        this.openDropdownForCell(cell, field, item, currentValue, projectId, viewKey);\r\n      }\r\n    };\r\n\r\n    cell.addEventListener(\"keydown\", keyHandler);\r\n\r\n    // Make cell focusable\r\n    cell.tabIndex = 0;\r\n\r\n    // Add hover effect\r\n    cell.addEventListener(\"mouseenter\", () => {\r\n      const cellKey = this.getCellKey(item.id, field.id);\r\n      if (!this.updatingCells.has(cellKey)) {\r\n        cell.style.outline = \"1px solid var(--vscode-focusBorder)\";\r\n        cell.style.outlineOffset = \"-1px\";\r\n      }\r\n    });\r\n\r\n    cell.addEventListener(\"mouseleave\", () => {\r\n      cell.style.outline = \"none\";\r\n    });\r\n  }\r\n\r\n  private openDropdownForCell(\r\n    cell: HTMLElement,\r\n    field: any,\r\n    item: any,\r\n    currentValue: any,\r\n    projectId: string,\r\n    viewKey: string\r\n  ) {\r\n    // Close existing dropdown\r\n    if (this.activeDropdown) {\r\n      this.activeDropdown.destroy();\r\n      this.activeDropdown = null;\r\n    }\r\n\r\n    const fieldType = field.dataType || field.type;\r\n    let options: DropdownOption[] = [];\r\n    let currentValueId: string | null = null;\r\n\r\n    if (fieldType === \"SINGLE_SELECT\") {\r\n      options = this.buildSingleSelectOptions(field, currentValue);\r\n      currentValueId = currentValue?.option?.id || null;\r\n    } else if (fieldType === \"ITERATION\") {\r\n      options = this.buildIterationOptions(field, currentValue);\r\n      currentValueId = currentValue?.iterationId || null;\r\n    }\r\n\r\n    this.activeDropdown = new FieldDropdown({\r\n      options,\r\n      currentValue: currentValueId,\r\n      anchorElement: cell,\r\n      title: field.name,\r\n      emptyMessage:\r\n        fieldType === \"SINGLE_SELECT\"\r\n          ? \"No options configured\"\r\n          : \"No iterations configured\",\r\n      onSelect: async (optionId) => {\r\n        await this.handleOptionSelect(\r\n          optionId,\r\n          item.id,\r\n          field.id,\r\n          projectId,\r\n          viewKey,\r\n          cell\r\n        );\r\n      },\r\n      onClose: () => {\r\n        this.activeDropdown = null;\r\n      },\r\n    });\r\n\r\n    this.activeDropdown.show();\r\n  }\r\n\r\n  private buildSingleSelectOptions(field: any, currentValue: any): DropdownOption[] {\r\n    const options: DropdownOption[] = [];\r\n\r\n    // Add \"Clear\" option\r\n    options.push({\r\n      id: null,\r\n      label: \"Clear\",\r\n      color: undefined,\r\n    });\r\n\r\n    // Add field options\r\n    if (field.options && Array.isArray(field.options)) {\r\n      field.options.forEach((opt: any) => {\r\n        options.push({\r\n          id: opt.id,\r\n          label: opt.name || opt.id,\r\n          description: opt.description,\r\n          color: opt.color,\r\n        });\r\n      });\r\n    }\r\n\r\n    return options;\r\n  }\r\n\r\n  private buildIterationOptions(field: any, currentValue: any): DropdownOption[] {\r\n    const options: DropdownOption[] = [];\r\n\r\n    // Add \"Clear\" option\r\n    options.push({\r\n      id: null,\r\n      label: \"No iteration\",\r\n      color: undefined,\r\n    });\r\n\r\n    // Add iteration options\r\n    if (\r\n      field.configuration &&\r\n      field.configuration.iterations &&\r\n      Array.isArray(field.configuration.iterations)\r\n    ) {\r\n      field.configuration.iterations.forEach((iter: any) => {\r\n        const dateRange = this.formatIterationDateRange(iter);\r\n        options.push({\r\n          id: iter.id,\r\n          label: iter.title || \"Untitled Iteration\",\r\n          metadata: { dateRange },\r\n        });\r\n      });\r\n    }\r\n\r\n    return options;\r\n  }\r\n\r\n  private formatIterationDateRange(iteration: any): string {\r\n    if (!iteration.startDate) {\r\n      return \"\";\r\n    }\r\n\r\n    try {\r\n      const start = new Date(iteration.startDate);\r\n      const startStr = start.toLocaleDateString(\"en-US\", {\r\n        month: \"short\",\r\n        day: \"numeric\",\r\n      });\r\n\r\n      // Calculate end date if duration is provided\r\n      if (iteration.duration) {\r\n        const end = new Date(start);\r\n        end.setDate(end.getDate() + iteration.duration);\r\n        const endStr = end.toLocaleDateString(\"en-US\", {\r\n          month: \"short\",\r\n          day: \"numeric\",\r\n        });\r\n        return `${startStr} - ${endStr}`;\r\n      }\r\n\r\n      return startStr;\r\n    } catch (e) {\r\n      return \"\";\r\n    }\r\n  }\r\n\r\n  private async handleOptionSelect(\r\n    optionId: string | null,\r\n    itemId: string,\r\n    fieldId: string,\r\n    projectId: string,\r\n    viewKey: string,\r\n    cell: HTMLElement\r\n  ) {\r\n    const cellKey = this.getCellKey(itemId, fieldId);\r\n\r\n    // Mark cell as updating\r\n    this.updatingCells.add(cellKey);\r\n    this.showCellLoading(cell);\r\n\r\n    const request: CellUpdateRequest = {\r\n      itemId,\r\n      fieldId,\r\n      value: optionId,\r\n      projectId,\r\n      viewKey,\r\n    };\r\n\r\n    try {\r\n      await this.config.onUpdateRequest(request);\r\n      this.config.onUpdateSuccess(request);\r\n      this.hideCellLoading(cell);\r\n    } catch (error: any) {\r\n      const errorMsg = error?.message || String(error) || \"Update failed\";\r\n      this.config.onUpdateError(request, errorMsg);\r\n      this.showCellError(cell, errorMsg);\r\n    } finally {\r\n      this.updatingCells.delete(cellKey);\r\n    }\r\n  }\r\n\r\n  private getCellKey(itemId: string, fieldId: string): string {\r\n    return `${itemId}:${fieldId}`;\r\n  }\r\n\r\n  private showCellLoading(cell: HTMLElement) {\r\n    cell.style.opacity = \"0.6\";\r\n    cell.style.pointerEvents = \"none\";\r\n    cell.classList.add(\"updating\");\r\n  }\r\n\r\n  private hideCellLoading(cell: HTMLElement) {\r\n    cell.style.opacity = \"1\";\r\n    cell.style.pointerEvents = \"auto\";\r\n    cell.classList.remove(\"updating\");\r\n  }\r\n\r\n  private showCellError(cell: HTMLElement, errorMsg: string) {\r\n    this.hideCellLoading(cell);\r\n    \r\n    // Add error styling\r\n    cell.style.outline = \"2px solid var(--vscode-errorForeground)\";\r\n    cell.style.outlineOffset = \"-2px\";\r\n\r\n    // Show error tooltip\r\n    const tooltip = document.createElement(\"div\");\r\n    tooltip.className = \"cell-error-tooltip\";\r\n    tooltip.textContent = errorMsg;\r\n    tooltip.style.position = \"absolute\";\r\n    tooltip.style.background = \"var(--vscode-inputValidation-errorBackground)\";\r\n    tooltip.style.border = \"1px solid var(--vscode-inputValidation-errorBorder)\";\r\n    tooltip.style.color = \"var(--vscode-inputValidation-errorForeground)\";\r\n    tooltip.style.padding = \"6px 10px\";\r\n    tooltip.style.borderRadius = \"4px\";\r\n    tooltip.style.fontSize = \"12px\";\r\n    tooltip.style.zIndex = \"1001\";\r\n    tooltip.style.maxWidth = \"300px\";\r\n    tooltip.style.wordWrap = \"break-word\";\r\n    tooltip.style.boxShadow = \"0 2px 8px rgba(0,0,0,0.3)\";\r\n\r\n    const cellRect = cell.getBoundingClientRect();\r\n    tooltip.style.top = `${cellRect.bottom + 4}px`;\r\n    tooltip.style.left = `${cellRect.left}px`;\r\n\r\n    document.body.appendChild(tooltip);\r\n\r\n    // Remove error styling and tooltip after configured duration\r\n    setTimeout(() => {\r\n      cell.style.outline = \"none\";\r\n      tooltip.remove();\r\n    }, ERROR_TOOLTIP_DURATION_MS);\r\n  }\r\n\r\n  public destroy() {\r\n    if (this.activeDropdown) {\r\n      this.activeDropdown.destroy();\r\n      this.activeDropdown = null;\r\n    }\r\n    this.updatingCells.clear();\r\n  }\r\n}\r\n", "/**\r\n * Manages keyboard navigation within the project table.\r\n * Handles arrow key navigation between cells, Enter/F2 for edit mode,\r\n * and Tab for moving between interactive elements.\r\n */\r\nexport interface CellPosition {\r\n  rowIndex: number;\r\n  colIndex: number;\r\n}\r\n\r\nexport interface NavigationCallbacks {\r\n  onEnterEditMode?: (cell: HTMLElement, position: CellPosition) => void;\r\n  onExitEditMode?: (commit: boolean) => void;\r\n  onCellFocus?: (cell: HTMLElement, position: CellPosition) => void;\r\n}\r\n\r\nexport class TableKeyboardNavigator {\r\n  private table: HTMLTableElement;\r\n  private callbacks: NavigationCallbacks;\r\n  private activePosition: CellPosition | null = null;\r\n  private editMode: boolean = false;\r\n\r\n  constructor(table: HTMLTableElement, callbacks: NavigationCallbacks = {}) {\r\n    this.table = table;\r\n    this.callbacks = callbacks;\r\n    this.attachKeyboardHandlers();\r\n  }\r\n\r\n  /**\r\n   * Attach keyboard event handlers to the table\r\n   */\r\n  private attachKeyboardHandlers() {\r\n    this.table.addEventListener(\"keydown\", (e) => this.handleTableKeyDown(e));\r\n    \r\n    // Handle focus on cells to track active position\r\n    this.table.addEventListener(\"focusin\", (e) => {\r\n      const target = e.target as HTMLElement;\r\n      if (target.tagName === \"TD\" || target.tagName === \"TH\") {\r\n        this.updateActivePosition(target);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Main keyboard event handler for table navigation\r\n   */\r\n  private handleTableKeyDown(e: KeyboardEvent) {\r\n    const target = e.target as HTMLElement;\r\n    \r\n    // Don't handle if we're in an input/textarea/select (except for Escape)\r\n    if (\r\n      (target.tagName === \"INPUT\" ||\r\n        target.tagName === \"TEXTAREA\" ||\r\n        target.tagName === \"SELECT\") &&\r\n      e.key !== \"Escape\"\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    // If in edit mode, handle edit-specific keys\r\n    if (this.editMode) {\r\n      this.handleEditModeKeys(e);\r\n      return;\r\n    }\r\n\r\n    // Handle navigation keys\r\n    switch (e.key) {\r\n      case \"ArrowUp\":\r\n      case \"ArrowDown\":\r\n      case \"ArrowLeft\":\r\n      case \"ArrowRight\":\r\n        e.preventDefault();\r\n        this.handleArrowNavigation(e.key);\r\n        break;\r\n\r\n      case \"Enter\":\r\n      case \"F2\":\r\n        e.preventDefault();\r\n        this.enterEditMode();\r\n        break;\r\n\r\n      case \"Tab\":\r\n        // Let default Tab behavior work for moving between interactive elements\r\n        // Only prevent if we want custom Tab handling\r\n        break;\r\n\r\n      case \" \":\r\n        // Space key - check if cell is interactive\r\n        const cell = this.getActiveCell();\r\n        if (cell && cell.classList.contains(\"interactive-cell\")) {\r\n          e.preventDefault();\r\n          this.enterEditMode();\r\n        }\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle keys while in edit mode\r\n   */\r\n  private handleEditModeKeys(e: KeyboardEvent) {\r\n    switch (e.key) {\r\n      case \"Escape\":\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.exitEditMode(false);\r\n        break;\r\n\r\n      case \"Enter\":\r\n        // Only handle Enter if not in a textarea or multiline input\r\n        const target = e.target as HTMLElement;\r\n        if (target.tagName !== \"TEXTAREA\") {\r\n          e.preventDefault();\r\n          this.exitEditMode(true);\r\n        }\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle arrow key navigation\r\n   */\r\n  private handleArrowNavigation(key: string) {\r\n    if (!this.activePosition) {\r\n      // Start from first data cell\r\n      this.activePosition = { rowIndex: 0, colIndex: 0 };\r\n    }\r\n\r\n    const { rowIndex, colIndex } = this.activePosition;\r\n    let newPosition = { ...this.activePosition };\r\n\r\n    switch (key) {\r\n      case \"ArrowUp\":\r\n        newPosition.rowIndex = Math.max(0, rowIndex - 1);\r\n        break;\r\n      case \"ArrowDown\":\r\n        newPosition.rowIndex = rowIndex + 1;\r\n        break;\r\n      case \"ArrowLeft\":\r\n        newPosition.colIndex = Math.max(0, colIndex - 1);\r\n        break;\r\n      case \"ArrowRight\":\r\n        newPosition.colIndex = colIndex + 1;\r\n        break;\r\n    }\r\n\r\n    this.moveToCell(newPosition);\r\n  }\r\n\r\n  /**\r\n   * Move focus to a specific cell position\r\n   */\r\n  private moveToCell(position: CellPosition) {\r\n    const tbody = this.table.querySelector(\"tbody\");\r\n    if (!tbody) return;\r\n\r\n    const rows = Array.from(tbody.querySelectorAll(\"tr[data-gh-item-id]\"));\r\n    if (position.rowIndex >= rows.length) return;\r\n\r\n    const row = rows[position.rowIndex] as HTMLTableRowElement;\r\n    const cells = Array.from(row.querySelectorAll(\"td\"));\r\n    \r\n    if (position.colIndex >= cells.length) return;\r\n\r\n    const cell = cells[position.colIndex] as HTMLTableCellElement;\r\n    if (!cell) return;\r\n\r\n    // Update active position\r\n    this.activePosition = position;\r\n\r\n    // Focus the cell\r\n    cell.focus();\r\n\r\n    // Scroll into view if needed (try/catch for test environments without full DOM API)\r\n    try {\r\n      cell.scrollIntoView({ block: \"nearest\", inline: \"nearest\", behavior: \"smooth\" });\r\n    } catch (e) {\r\n      // TypeError in environments like jsdom that don't support scrollIntoView options\r\n      // Silently fail for compatibility - scrolling is a progressive enhancement\r\n    }\r\n\r\n    // Notify callback\r\n    if (this.callbacks.onCellFocus) {\r\n      this.callbacks.onCellFocus(cell, position);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update active position based on focused cell\r\n   */\r\n  private updateActivePosition(cell: HTMLElement) {\r\n    const row = cell.closest(\"tr[data-gh-item-id]\") as HTMLTableRowElement;\r\n    if (!row) return;\r\n\r\n    const tbody = this.table.querySelector(\"tbody\");\r\n    if (!tbody) return;\r\n\r\n    const rows = Array.from(tbody.querySelectorAll(\"tr[data-gh-item-id]\"));\r\n    const rowIndex = rows.indexOf(row);\r\n    if (rowIndex === -1) return;\r\n\r\n    const cells = Array.from(row.querySelectorAll(\"td\"));\r\n    const colIndex = cells.indexOf(cell as HTMLTableCellElement);\r\n    if (colIndex === -1) return;\r\n\r\n    this.activePosition = { rowIndex, colIndex };\r\n  }\r\n\r\n  /**\r\n   * Enter edit mode for the active cell\r\n   */\r\n  private enterEditMode() {\r\n    const cell = this.getActiveCell();\r\n    if (!cell || !this.activePosition) return;\r\n\r\n    // Check if cell is editable (has interactive-cell class or contains input)\r\n    const isEditable =\r\n      cell.classList.contains(\"interactive-cell\") ||\r\n      cell.querySelector(\"input, textarea, select\");\r\n\r\n    if (!isEditable) return;\r\n\r\n    this.editMode = true;\r\n\r\n    // Notify callback\r\n    if (this.callbacks.onEnterEditMode) {\r\n      this.callbacks.onEnterEditMode(cell, this.activePosition);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Exit edit mode\r\n   */\r\n  private exitEditMode(commit: boolean) {\r\n    this.editMode = false;\r\n\r\n    // Notify callback\r\n    if (this.callbacks.onExitEditMode) {\r\n      this.callbacks.onExitEditMode(commit);\r\n    }\r\n\r\n    // Return focus to the cell\r\n    const cell = this.getActiveCell();\r\n    if (cell) {\r\n      cell.focus();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the currently active cell\r\n   */\r\n  private getActiveCell(): HTMLTableCellElement | null {\r\n    if (!this.activePosition) return null;\r\n\r\n    const tbody = this.table.querySelector(\"tbody\");\r\n    if (!tbody) return null;\r\n\r\n    const rows = Array.from(tbody.querySelectorAll(\"tr[data-gh-item-id]\"));\r\n    const row = rows[this.activePosition.rowIndex] as HTMLTableRowElement;\r\n    if (!row) return null;\r\n\r\n    const cells = Array.from(row.querySelectorAll(\"td\"));\r\n    return cells[this.activePosition.colIndex] as HTMLTableCellElement || null;\r\n  }\r\n\r\n  /**\r\n   * Make all cells in the table focusable\r\n   */\r\n  public makeCellsFocusable() {\r\n    const tbody = this.table.querySelector(\"tbody\");\r\n    if (!tbody) return;\r\n\r\n    const cells = tbody.querySelectorAll(\"td\");\r\n    cells.forEach((cell) => {\r\n      const td = cell as HTMLTableCellElement;\r\n      // Only make cells focusable if they don't already have tabIndex set\r\n      if (!td.hasAttribute(\"tabindex\")) {\r\n        td.tabIndex = -1; // Focusable but not in tab order\r\n      }\r\n    });\r\n\r\n    // Make the first cell in the first row tabbable\r\n    const firstRow = tbody.querySelector(\"tr[data-gh-item-id]\");\r\n    if (firstRow) {\r\n      const firstCell = firstRow.querySelector(\"td\") as HTMLTableCellElement;\r\n      if (firstCell) {\r\n        firstCell.tabIndex = 0; // Tabbable\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clean up event listeners\r\n   */\r\n  public destroy() {\r\n    // Event listeners are attached directly to table, will be cleaned up with table\r\n  }\r\n\r\n  /**\r\n   * Manually set edit mode (used by external components)\r\n   */\r\n  public setEditMode(enabled: boolean) {\r\n    this.editMode = enabled;\r\n  }\r\n\r\n  /**\r\n   * Get current edit mode state\r\n   */\r\n  public isInEditMode(): boolean {\r\n    return this.editMode;\r\n  }\r\n}\r\n", "import { renderCell } from \"../renderers/cellRenderer\";\r\nimport { normalizeColor, getContrastColor, escapeHtml } from \"../utils\";\r\nimport { ColumnHeaderMenu } from \"./ColumnHeaderMenu\";\r\nimport { ColumnHeaderRenderer } from \"../renderers/columnHeaderRenderer\";\r\nimport FieldsMenu from \"./FieldsMenu\";\r\nimport { SlicePanel } from \"./SlicePanel\";\r\nimport type { SortConfig } from \"../utils/tableSorting\";\r\nimport { sortItems } from \"../utils/tableSorting\";\r\nimport { GroupDataService } from \"../services/GroupDataService\";\r\nimport { RowRenderer } from \"../renderers/RowRenderer\";\r\nimport { GroupRenderer } from \"../renderers/GroupRenderer\";\r\nimport { TableResizer } from \"./TableResizer\";\r\nimport { InteractiveCellManager, CellUpdateRequest } from \"./InteractiveCellManager\";\r\nimport { TableKeyboardNavigator } from \"./TableKeyboardNavigator\";\r\n\r\nexport interface TableOptions {\r\n  groupingFieldName?: string;\r\n  sortConfig?: SortConfig | null;\r\n  viewKey?: string;\r\n  projectId?: string;\r\n  hiddenFields?: string[];\r\n  onSortChange?: (config: SortConfig) => void;\r\n  onGroupChange?: (fieldName: string) => void;\r\n  onSliceChange?: (field: any) => void;\r\n  onHiddenFieldsChange?: (hiddenIds: string[]) => void;\r\n  onFieldUpdate?: (request: CellUpdateRequest) => Promise<void>; // Callback for field value updates\r\n}\r\n\r\nexport class ProjectTable {\r\n  private container: HTMLElement;\r\n  private allFields: any[]; // All fields including hidden\r\n  private fields: any[]; // Visible fields only\r\n  private items: any[];\r\n  private options: TableOptions;\r\n  private hiddenFieldIds: Set<string>;\r\n  private activeMenu: ColumnHeaderMenu | null = null;\r\n  private activeFieldsMenu: FieldsMenu | null = null;\r\n  private activeSlicePanel: SlicePanel | null = null;\r\n  private activeSlice: { fieldId: string; value: any } | null = null;\r\n  // Track which field the active slice panel is for (panel may be open before a value is selected)\r\n  private activeSlicePanelFieldId: string | null = null;\r\n  private tableResizer: TableResizer | null = null;\r\n  private interactiveCellManager: InteractiveCellManager | null = null;\r\n  private keyboardNavigator: TableKeyboardNavigator | null = null;\r\n\r\n  constructor(\r\n    container: HTMLElement,\r\n    fields: any[],\r\n    items: any[],\r\n    options: TableOptions = {},\r\n  ) {\r\n    this.container = container;\r\n    // Normalize all field ids to strings to avoid type mismatches\r\n    this.allFields = (fields || []).map((f) => ({ ...f, id: String(f.id) }));\r\n    this.options = options;\r\n    this.items = items;\r\n\r\n    // Load hidden fields from options or localStorage\r\n    const hiddenFromStorage = this.loadHiddenFields().map((id) => String(id));\r\n    const hiddenFromOptions = (options.hiddenFields || []).map((id) =>\r\n      String(id),\r\n    );\r\n    this.hiddenFieldIds = new Set<string>([\r\n      ...hiddenFromStorage,\r\n      ...hiddenFromOptions,\r\n    ]);\r\n\r\n    // Filter visible fields (ids already normalized on allFields)\r\n    this.fields = this.allFields.filter((f) => !this.hiddenFieldIds.has(f.id));\r\n\r\n    // Debug: log initial hidden/visible sets\r\n    try {\r\n      console.debug(\r\n        \"[ProjectTable] init: allFieldIds=\",\r\n        this.allFields.map((f) => f.id),\r\n      );\r\n      console.debug(\r\n        \"[ProjectTable] init: hiddenFieldIds=\",\r\n        Array.from(this.hiddenFieldIds),\r\n      );\r\n      console.debug(\r\n        \"[ProjectTable] init: visibleFieldIds=\",\r\n        this.fields.map((f) => f.id),\r\n      );\r\n    } catch (e) {}\r\n\r\n    // Also forward debug info to the extension output channel so it's visible\r\n    try {\r\n      const dbg = {\r\n        allFieldIds: this.allFields.map((f: any) => String(f.id)),\r\n        hiddenFieldIds: Array.from(this.hiddenFieldIds),\r\n        visibleFieldIds: this.fields.map((f: any) => String(f.id)),\r\n      };\r\n      if (\r\n        (window as any).__APP_MESSAGING__ &&\r\n        typeof (window as any).__APP_MESSAGING__.postMessage === \"function\"\r\n      ) {\r\n        (window as any).__APP_MESSAGING__.postMessage({\r\n          command: \"debugLog\",\r\n          level: \"debug\",\r\n          message: \"ProjectTable init\",\r\n          data: dbg,\r\n          viewKey: this.options.viewKey,\r\n        });\r\n      }\r\n    } catch (e) {}\r\n\r\n    // Load and apply field order if stored\r\n    this.applyFieldOrder();\r\n\r\n    // Initialize interactive cell manager if field updates are supported\r\n    if (this.options.onFieldUpdate) {\r\n      this.interactiveCellManager = new InteractiveCellManager({\r\n        onUpdateRequest: async (request: CellUpdateRequest) => {\r\n          if (this.options.onFieldUpdate) {\r\n            await this.options.onFieldUpdate(request);\r\n          }\r\n        },\r\n        onUpdateSuccess: (request: CellUpdateRequest) => {\r\n          // Refresh the table to show updated value\r\n          // The snapshot should be updated by the parent component before this is called\r\n          this.render();\r\n        },\r\n        onUpdateError: (request: CellUpdateRequest, error: string) => {\r\n          console.error(\"Field update error:\", error);\r\n          // Error is already shown by the InteractiveCellManager\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    // Preserve slice panel if it exists\r\n    const existingSlicePanel = this.container.querySelector(\".slice-panel\");\r\n\r\n    this.container.innerHTML = \"\";\r\n\r\n    // Re-add slice panel if it existed\r\n    if (existingSlicePanel) {\r\n      this.container.appendChild(existingSlicePanel);\r\n    }\r\n\r\n    const tableContainer = document.createElement(\"div\");\r\n    tableContainer.className = \"table-wrapper\";\r\n    tableContainer.style.overflowX = \"auto\";\r\n    tableContainer.style.overflowY = \"auto\";\r\n    tableContainer.style.width = \"100%\";\r\n    tableContainer.style.display = \"block\";\r\n    tableContainer.style.height = \"100%\"; // Let it grow\r\n\r\n    const table = document.createElement(\"table\");\r\n    table.style.borderCollapse = \"separate\";\r\n    table.style.borderSpacing = \"0\";\r\n    // Use fixed layout so explicit <col> widths are honored and columns can be\r\n    // resized smaller than their content (content will be ellipsised).\r\n    table.style.tableLayout = \"fixed\";\r\n    // Let container control horizontal scrolling while table fills width\r\n    table.style.width = \"100%\";\r\n    \r\n    // Add ARIA attributes for accessibility\r\n    table.setAttribute(\"role\", \"grid\");\r\n    table.setAttribute(\"aria-label\", \"Project items table\");\r\n    table.setAttribute(\"aria-rowcount\", String(this.items.length));\r\n    table.setAttribute(\"aria-colcount\", String(this.fields.length + 1)); // +1 for index column\r\n\r\n    this.renderColGroup(table);\r\n    new ColumnHeaderRenderer({\r\n      fields: this.fields,\r\n      sortConfig: this.options.sortConfig,\r\n      groupingFieldName: this.options.groupingFieldName,\r\n      activeSlice: this.activeSlice,\r\n      activeSlicePanelFieldId: this.activeSlicePanelFieldId,\r\n      onHeaderMenu: this.showHeaderMenu.bind(this),\r\n      onShowFieldsMenu: this.showFieldsMenu.bind(this),\r\n      onClearGroup: this.clearGroup.bind(this),\r\n      onClearSlice: this.clearSlice.bind(this),\r\n    }).render(table);\r\n    this.renderBody(table);\r\n\r\n    tableContainer.appendChild(table);\r\n    this.container.appendChild(tableContainer);\r\n\r\n    // Post-render: adjust column widths based on content (simple heuristic)\r\n    // This was in the original code, we can keep it or improve it.\r\n    // For now, let's keep the sticky header logic and resizers.\r\n    this.tableResizer = new TableResizer(table, this.fields, this.options);\r\n    this.tableResizer.setupResizers();\r\n    \r\n    // Initialize keyboard navigation\r\n    this.keyboardNavigator = new TableKeyboardNavigator(table, {\r\n      onEnterEditMode: (cell, position) => {\r\n        // Trigger interactive cell behavior if cell has it\r\n        if (cell.classList.contains(\"interactive-cell\")) {\r\n          // Simulate click to open dropdown\r\n          cell.click();\r\n        }\r\n      },\r\n      onExitEditMode: (commit) => {\r\n        // Exit edit mode - focus is automatically returned to cell by navigator\r\n        // No additional cleanup needed as InteractiveCellManager handles state\r\n      },\r\n      onCellFocus: (cell, position) => {\r\n        // Update visual focus indicator\r\n        this.updateCellFocusIndicator(cell);\r\n      },\r\n    });\r\n    \r\n    // Make cells focusable for keyboard navigation\r\n    this.keyboardNavigator.makeCellsFocusable();\r\n  }\r\n\r\n  private renderColGroup(table: HTMLTableElement) {\r\n    const colgroup = document.createElement(\"colgroup\");\r\n    // Index column\r\n    const colIndex = document.createElement(\"col\");\r\n    colIndex.style.width = \"40px\";\r\n    colgroup.appendChild(colIndex);\r\n\r\n    for (const field of this.fields) {\r\n      const col = document.createElement(\"col\");\r\n      col.style.width = \"150px\"; // Default width\r\n      // Attach field id so resizer can update the correct <col>\r\n      col.dataset.fieldId = field.id;\r\n      colgroup.appendChild(col);\r\n    }\r\n\r\n    // Add Field column\r\n    const colAddField = document.createElement(\"col\");\r\n    colAddField.style.width = \"50px\";\r\n    colgroup.appendChild(colAddField);\r\n\r\n    table.appendChild(colgroup);\r\n  }\r\n\r\n  private showFieldsMenu(anchorElement: HTMLElement) {\r\n    // Hide existing menus\r\n    if (this.activeMenu) {\r\n      this.activeMenu.hide();\r\n      this.activeMenu = null;\r\n    }\r\n    if (this.activeFieldsMenu) {\r\n      this.activeFieldsMenu.hide();\r\n      this.activeFieldsMenu = null;\r\n    }\r\n\r\n    // Build visible id set from hiddenFieldIds to ensure consistent detection (normalize ids)\r\n    const visibleSet = new Set<string>(\r\n      this.allFields\r\n        .filter((f) => !this.hiddenFieldIds.has(String(f.id)))\r\n        .map((f) => String(f.id)),\r\n    );\r\n\r\n    // Debug: log current hidden/visible sets before showing menu\r\n    try {\r\n      console.debug(\r\n        \"[ProjectTable] showFieldsMenu: hiddenFieldIds=\",\r\n        Array.from(this.hiddenFieldIds),\r\n      );\r\n      console.debug(\r\n        \"[ProjectTable] showFieldsMenu: allFieldIds=\",\r\n        this.allFields.map((f) => f.id),\r\n      );\r\n    } catch (e) {}\r\n\r\n    const menu = new FieldsMenu({\r\n      fields: this.allFields.map((f) => ({\r\n        id: f.id,\r\n        name: f.name,\r\n        iconClass: f.iconClass,\r\n        dataType: f.dataType || f.type,\r\n      })),\r\n      visibleFieldIds: visibleSet,\r\n      onToggleVisibility: (fieldId: string, visible: boolean) => {\r\n        if (visible) this.showField(fieldId);\r\n        else this.hideField(fieldId);\r\n      },\r\n      onCreateField: () => {\r\n        // Placeholder: open create field flow if available\r\n        try {\r\n          console.log(\"Create field requested\");\r\n        } catch (e) {}\r\n      },\r\n    });\r\n\r\n    this.activeFieldsMenu = menu;\r\n    menu.show(anchorElement);\r\n  }\r\n\r\n  private renderBody(table: HTMLTableElement) {\r\n    const tbody = document.createElement(\"tbody\");\r\n\r\n    // Apply sorting\r\n    let displayItems = this.items;\r\n    if (this.options.sortConfig) {\r\n      displayItems = sortItems(\r\n        this.items,\r\n        this.fields,\r\n        this.options.sortConfig,\r\n      );\r\n    }\r\n\r\n    // Apply Slice Filter\r\n    if (this.activeSlice) {\r\n      displayItems = displayItems.filter((item) => {\r\n        const fv = item.fieldValues.find(\r\n          (v: any) => String(v.fieldId) === String(this.activeSlice!.fieldId),\r\n        );\r\n        if (!fv) return this.activeSlice!.value === null; // Match empty if value is null\r\n\r\n        // Extract value logic similar to SlicePanel\r\n        let val = null;\r\n        if (fv.text !== undefined) val = fv.text;\r\n        else if (fv.title !== undefined) val = fv.title;\r\n        else if (fv.number !== undefined) val = fv.number;\r\n        else if (fv.date !== undefined) val = fv.date;\r\n        else if (fv.option) val = fv.option.name;\r\n        else if (fv.iteration) val = fv.iteration.title;\r\n        else val = fv.value;\r\n\r\n        return val === this.activeSlice!.value;\r\n      });\r\n    }\r\n\r\n    // Check for grouping\r\n    const groupingField = this.getGroupingField();\r\n    const rowRenderer = new RowRenderer(\r\n      this.fields,\r\n      this.items,\r\n      (colIndex, pageX, startWidth) => {\r\n        if (this.tableResizer) {\r\n          this.tableResizer.beginColumnResize(colIndex, pageX, startWidth);\r\n        }\r\n      },\r\n      (cell, field, item, fieldValue) => {\r\n        if (\r\n          this.interactiveCellManager &&\r\n          this.options.projectId &&\r\n          this.options.viewKey\r\n        ) {\r\n          this.interactiveCellManager.attachToCell(\r\n            cell,\r\n            field,\r\n            item,\r\n            fieldValue,\r\n            this.options.projectId,\r\n            this.options.viewKey,\r\n          );\r\n        }\r\n      },\r\n      this.options.projectId,\r\n      this.options.viewKey,\r\n      this.options.onFieldUpdate &&\r\n        this.options.projectId &&\r\n        this.options.viewKey\r\n        ? (itemId: string, fieldId: string, value: any) =>\r\n            this.options.onFieldUpdate!({\r\n              itemId,\r\n              fieldId,\r\n              value,\r\n              projectId: this.options.projectId as string,\r\n              viewKey: this.options.viewKey as string,\r\n            })\r\n        : undefined,\r\n    );\r\n\r\n    if (groupingField) {\r\n      this.renderGroupedRows(tbody, groupingField, displayItems, rowRenderer);\r\n    } else {\r\n      this.renderFlatRows(tbody, displayItems, rowRenderer);\r\n    }\r\n\r\n    table.appendChild(tbody);\r\n  }\r\n\r\n  private getGroupingField() {\r\n    // Logic to determine grouping field from options or view details\r\n    // Passed via options.groupingFieldName or similar\r\n    if (this.options.groupingFieldName) {\r\n      return this.fields.find(\r\n        (f) =>\r\n          (f.name &&\r\n            f.name.toLowerCase() ===\r\n              this.options.groupingFieldName?.toLowerCase()) ||\r\n          (f.id && f.id === this.options.groupingFieldName),\r\n      );\r\n    }\r\n    return null;\r\n  }\r\n\r\n  private renderFlatRows(\r\n    tbody: HTMLTableSectionElement,\r\n    items: any[],\r\n    rowRenderer: RowRenderer,\r\n  ) {\r\n    items.forEach((item, index) => {\r\n      const tr = rowRenderer.createRow(item, index);\r\n      tbody.appendChild(tr);\r\n    });\r\n  }\r\n\r\n  private renderGroupedRows(\r\n    tbody: HTMLTableSectionElement,\r\n    groupingField: any,\r\n    items: any[],\r\n    rowRenderer: RowRenderer,\r\n  ) {\r\n    // Group items\r\n    const groups = GroupDataService.groupItems(items, groupingField);\r\n    const groupRenderer = new GroupRenderer(this.fields, this.items);\r\n\r\n    for (const group of groups) {\r\n      groupRenderer.renderGroup(tbody, group, groupingField, rowRenderer);\r\n    }\r\n  }\r\n\r\n  private showHeaderMenu(\r\n    event: MouseEvent,\r\n    field: any,\r\n    headerElement: HTMLElement,\r\n  ) {\r\n    event.stopPropagation();\r\n\r\n    // Hide existing menu\r\n    if (this.activeMenu) {\r\n      this.activeMenu.hide();\r\n    }\r\n\r\n    // Determine capabilities based on field type\r\n    const dataType = (field.dataType || \"\").toLowerCase();\r\n    // Mapping of GitHub ProjectV2 field data types to allowed operations\r\n    // Groupable: assignees, single_select, parent_issue, iteration, number, date, milestone, repository\r\n    const groupableTypes = new Set([\r\n      \"assignees\",\r\n      \"single_select\",\r\n      \"parent_issue\",\r\n      \"iteration\",\r\n      \"number\",\r\n      \"date\",\r\n      \"milestone\",\r\n      \"repository\",\r\n    ]);\r\n\r\n    // Sliceable: same as groupable, plus labels (multi-value) which can be sliced but not grouped\r\n    const sliceableTypes = new Set([\r\n      \"assignees\",\r\n      \"single_select\",\r\n      \"parent_issue\",\r\n      \"iteration\",\r\n      \"number\",\r\n      \"date\",\r\n      \"milestone\",\r\n      \"repository\",\r\n      \"labels\",\r\n    ]);\r\n\r\n    const canGroup = groupableTypes.has(dataType);\r\n    const canSlice = sliceableTypes.has(dataType);\r\n\r\n    // Determine current state (grouped/sliced/sorted)\r\n    const isGrouped = !!(\r\n      this.options.groupingFieldName &&\r\n      field.name &&\r\n      field.name.toLowerCase() === this.options.groupingFieldName.toLowerCase()\r\n    );\r\n    const isSliced = !!(\r\n      (this.activeSlice && this.activeSlice.fieldId === field.id) ||\r\n      (this.activeSlicePanelFieldId &&\r\n        String(this.activeSlicePanelFieldId) === String(field.id))\r\n    );\r\n    const currentSort =\r\n      this.options.sortConfig && this.options.sortConfig.fieldId === field.id\r\n        ? this.options.sortConfig.direction\r\n        : null;\r\n\r\n    // Create and show menu\r\n    const fieldIndex = this.fields.findIndex((f) => f.id === field.id);\r\n    const isFirst = fieldIndex === 0;\r\n    const isLast = fieldIndex === this.fields.length - 1;\r\n\r\n    this.activeMenu = new ColumnHeaderMenu(field, {\r\n      canGroup,\r\n      canSlice,\r\n      canFilter: false, // Optional feature for later\r\n      isGrouped,\r\n      isSliced,\r\n      currentSort,\r\n      isFirst,\r\n      isLast,\r\n      onSort: (direction) => this.handleSort(field, direction),\r\n      onClearSort: () => this.clearSort(field),\r\n      onGroup: () => this.handleGroup(field),\r\n      onClearGroup: () => this.clearGroup(field),\r\n      onSlice: () => this.handleSlice(field),\r\n      onClearSlice: () => this.clearSlice(field),\r\n      onHide: () => this.hideField(field.id),\r\n      onMove: (direction) => this.handleMove(field, direction),\r\n    });\r\n\r\n    this.activeMenu.show(headerElement);\r\n  }\r\n\r\n  private clearGroup(field: any) {\r\n    // Clear local grouping state and notify parent\r\n    this.options.groupingFieldName = undefined;\r\n    if (this.options.onGroupChange) {\r\n      try {\r\n        // Notify parent that grouping was cleared\r\n        this.options.onGroupChange(\"\");\r\n      } catch (e) {}\r\n    }\r\n    this.render();\r\n  }\r\n\r\n  private clearSlice(field: any) {\r\n    this.activeSlice = null;\r\n    if (this.activeSlicePanel) {\r\n      this.activeSlicePanel.close();\r\n      this.activeSlicePanel = null;\r\n    }\r\n    this.activeSlicePanelFieldId = null;\r\n    // Reset container layout\r\n    this.container.style.display = \"block\";\r\n    this.render();\r\n    if (this.options.onSliceChange) {\r\n      this.options.onSliceChange(null as any);\r\n    }\r\n  }\r\n\r\n  private clearSort(field: any) {\r\n    // Clear local sort state; persistence and discard are managed by the caller\r\n    this.options.sortConfig = undefined;\r\n    this.render();\r\n    if (this.options.onSortChange) {\r\n      this.options.onSortChange(null as any);\r\n    }\r\n  }\r\n\r\n  private showHiddenFieldsMenu(anchorElement: HTMLElement) {\r\n    // Hide any existing menu\r\n    if (this.activeMenu) {\r\n      this.activeMenu.hide();\r\n    }\r\n\r\n    // Get hidden fields\r\n    const hiddenFields = this.allFields.filter((f) =>\r\n      this.hiddenFieldIds.has(String(f.id)),\r\n    );\r\n\r\n    if (hiddenFields.length === 0) {\r\n      // Show message that no fields are hidden\r\n      const message = document.createElement(\"div\");\r\n      message.textContent = \"No hidden fields\";\r\n      message.style.position = \"absolute\";\r\n      message.style.background = \"var(--vscode-menu-background)\";\r\n      message.style.border = \"1px solid var(--vscode-menu-border)\";\r\n      message.style.borderRadius = \"4px\";\r\n      message.style.padding = \"12px\";\r\n      message.style.fontSize = \"13px\";\r\n      message.style.color = \"var(--vscode-descriptionForeground)\";\r\n      message.style.zIndex = \"1000\";\r\n\r\n      const rect = anchorElement.getBoundingClientRect();\r\n      message.style.top = `${rect.bottom + 4}px`;\r\n      message.style.left = `${rect.left}px`;\r\n\r\n      document.body.appendChild(message);\r\n\r\n      setTimeout(() => message.remove(), 2000);\r\n      return;\r\n    }\r\n\r\n    // Create simple menu for hidden fields\r\n    const menu = document.createElement(\"div\");\r\n    menu.style.position = \"absolute\";\r\n    menu.style.background = \"var(--vscode-menu-background)\";\r\n    menu.style.border = \"1px solid var(--vscode-menu-border)\";\r\n    menu.style.borderRadius = \"4px\";\r\n    menu.style.padding = \"4px 0\";\r\n    menu.style.minWidth = \"180px\";\r\n    menu.style.zIndex = \"1000\";\r\n    menu.style.fontSize = \"13px\";\r\n\r\n    const rect = anchorElement.getBoundingClientRect();\r\n    menu.style.top = `${rect.bottom + 4}px`;\r\n    menu.style.left = `${rect.left}px`;\r\n\r\n    // Header\r\n    const header = document.createElement(\"div\");\r\n    header.textContent = \"Show field\";\r\n    header.style.padding = \"6px 12px\";\r\n    header.style.fontWeight = \"600\";\r\n    header.style.color = \"var(--vscode-descriptionForeground)\";\r\n    header.style.fontSize = \"11px\";\r\n    header.style.textTransform = \"uppercase\";\r\n    menu.appendChild(header);\r\n\r\n    const separator = document.createElement(\"div\");\r\n    separator.style.height = \"1px\";\r\n    separator.style.background = \"var(--vscode-menu-separatorBackground)\";\r\n    separator.style.margin = \"4px 0\";\r\n    menu.appendChild(separator);\r\n\r\n    // Field items\r\n    hiddenFields.forEach((field) => {\r\n      const item = document.createElement(\"div\");\r\n      item.textContent = field.name || field.id;\r\n      item.style.padding = \"6px 12px\";\r\n      item.style.cursor = \"pointer\";\r\n      item.style.color = \"var(--vscode-menu-foreground)\";\r\n\r\n      item.addEventListener(\"mouseenter\", () => {\r\n        item.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n        item.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n      });\r\n\r\n      item.addEventListener(\"mouseleave\", () => {\r\n        item.style.background = \"transparent\";\r\n        item.style.color = \"var(--vscode-menu-foreground)\";\r\n      });\r\n\r\n      item.addEventListener(\"click\", () => {\r\n        this.showField(field.id);\r\n        menu.remove();\r\n        backdrop.remove();\r\n      });\r\n\r\n      menu.appendChild(item);\r\n    });\r\n\r\n    // Backdrop\r\n    const backdrop = document.createElement(\"div\");\r\n    backdrop.style.position = \"fixed\";\r\n    backdrop.style.top = \"0\";\r\n    backdrop.style.left = \"0\";\r\n    backdrop.style.right = \"0\";\r\n    backdrop.style.bottom = \"0\";\r\n    backdrop.style.zIndex = \"999\";\r\n\r\n    // Clicking the backdrop closes the menu\r\n    backdrop.addEventListener(\"click\", () => {\r\n      if (menu.parentElement) menu.remove();\r\n      if (backdrop.parentElement) backdrop.remove();\r\n    });\r\n\r\n    // Append to body\r\n    document.body.appendChild(menu);\r\n    document.body.appendChild(backdrop);\r\n\r\n    // End of showHiddenFieldsMenu\r\n  }\r\n\r\n  private handleSort(field: any, direction: \"ASC\" | \"DESC\") {\r\n    const sortConfig: SortConfig = {\r\n      fieldId: field.id,\r\n      direction,\r\n    };\r\n\r\n    // Update local sort state so the UI reflects the change immediately\r\n    this.options.sortConfig = sortConfig;\r\n    this.render();\r\n\r\n    // Notify parent component so it can track unsaved sort state\r\n    if (this.options.onSortChange) {\r\n      this.options.onSortChange(sortConfig);\r\n    }\r\n  }\r\n\r\n  private handleGroup(field: any) {\r\n    // Update local grouping state so the UI reflects the change immediately\r\n    if (field && field.name) {\r\n      this.options.groupingFieldName = field.name;\r\n      this.render();\r\n      if (this.options.onGroupChange) {\r\n        try {\r\n          this.options.onGroupChange(field.name);\r\n        } catch (e) {}\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleSlice(field: any) {\r\n    // Close existing panel\r\n    if (this.activeSlicePanel) {\r\n      this.activeSlicePanel.close();\r\n      this.activeSlicePanel = null;\r\n    }\r\n\r\n    // Create and show new panel in the container (left side)\r\n    this.activeSlicePanel = new SlicePanel(\r\n      this.container,\r\n      field,\r\n      this.items,\r\n      this.allFields,\r\n    );\r\n    this.activeSlicePanel.render();\r\n    // Remember which field the panel belongs to so header menu can show an \"unslice\" button\r\n    try {\r\n      this.activeSlicePanelFieldId = String(field.id);\r\n    } catch (e) {\r\n      this.activeSlicePanelFieldId = null;\r\n    }\r\n\r\n    // Make sure the slice panel appears before the table wrapper\r\n    const tableWrapper = this.container.querySelector(\".table-wrapper\");\r\n    if (tableWrapper) {\r\n      const sliceEl = this.container.querySelector(\".slice-panel\");\r\n      if (sliceEl) {\r\n        this.container.insertBefore(sliceEl, tableWrapper);\r\n      }\r\n    }\r\n\r\n    // Setup layout: container should use flexbox to show panel + table side by side\r\n    this.container.style.display = \"flex\";\r\n    this.container.style.flexDirection = \"row\";\r\n    this.container.style.gap = \"0\";\r\n\r\n    // Re-render so header reflects the active slice panel (shows slice icon)\r\n    // We preserve the existing slice panel in render(), so this is safe.\r\n    this.render();\r\n\r\n    this.activeSlicePanel.onValueSelect((value) => {\r\n      // Filter table by this value\r\n      this.activeSlice = { fieldId: field.id, value };\r\n      this.render();\r\n    });\r\n\r\n    // Handle field change\r\n    this.activeSlicePanel.onFieldChange((newField) => {\r\n      // Update active slice field\r\n      this.activeSlice = null; // Reset slice value when changing field\r\n      this.handleSlice(newField); // Re-render with new field\r\n\r\n      // Notify parent\r\n      if (this.options.onSliceChange) {\r\n        this.options.onSliceChange(newField);\r\n      }\r\n    });\r\n\r\n    // Notify parent\r\n    if (this.options.onSliceChange) {\r\n      this.options.onSliceChange(field);\r\n    }\r\n  }\r\n\r\n  public hideField(fieldId: string) {\r\n    const fid = String(fieldId);\r\n    this.hiddenFieldIds.add(fid);\r\n    try {\r\n      console.debug(\r\n        \"[ProjectTable] hideField -> added\",\r\n        fid,\r\n        \"hiddenFieldIds=\",\r\n        Array.from(this.hiddenFieldIds),\r\n      );\r\n    } catch (e) {}\r\n    // If a parent callback is provided (e.g. tableViewFetcher managing Save/Discard),\r\n    // notify it instead of immediately persisting to localStorage. This allows hide/unhide\r\n    // to be treated as an unsaved view-level change which can be saved/discarded by the user.\r\n    if (this.options.onHiddenFieldsChange) {\r\n      // update in-memory state and notify parent (do not persist to localStorage yet)\r\n      this.fields = this.allFields.filter(\r\n        (f) => !this.hiddenFieldIds.has(f.id),\r\n      );\r\n      // Re-apply stored field order so the UI appears consistent after toggling\r\n      try {\r\n        this.applyFieldOrder();\r\n      } catch (e) {}\r\n      try {\r\n        this.options.onHiddenFieldsChange(Array.from(this.hiddenFieldIds));\r\n      } catch (e) {}\r\n      this.render();\r\n    } else {\r\n      this.saveHiddenFields();\r\n      this.fields = this.allFields.filter(\r\n        (f) => !this.hiddenFieldIds.has(f.id),\r\n      );\r\n      try {\r\n        this.applyFieldOrder();\r\n      } catch (e) {}\r\n      this.render();\r\n    }\r\n  }\r\n\r\n  public showField(fieldId: string) {\r\n    const fid = String(fieldId);\r\n    this.hiddenFieldIds.delete(fid);\r\n    try {\r\n      console.debug(\r\n        \"[ProjectTable] showField -> removed\",\r\n        fid,\r\n        \"hiddenFieldIds=\",\r\n        Array.from(this.hiddenFieldIds),\r\n      );\r\n    } catch (e) {}\r\n    if (this.options.onHiddenFieldsChange) {\r\n      this.fields = this.allFields.filter(\r\n        (f) => !this.hiddenFieldIds.has(f.id),\r\n      );\r\n      try {\r\n        this.applyFieldOrder();\r\n      } catch (e) {}\r\n      try {\r\n        this.options.onHiddenFieldsChange(Array.from(this.hiddenFieldIds));\r\n      } catch (e) {}\r\n      this.render();\r\n    } else {\r\n      this.saveHiddenFields();\r\n      this.fields = this.allFields.filter(\r\n        (f) => !this.hiddenFieldIds.has(f.id),\r\n      );\r\n      try {\r\n        this.applyFieldOrder();\r\n      } catch (e) {}\r\n      this.render();\r\n    }\r\n  }\r\n\r\n  private handleMove(field: any, direction: \"left\" | \"right\") {\r\n    const currentIndex = this.fields.findIndex((f) => f.id === field.id);\r\n\r\n    if (direction === \"left\" && currentIndex > 0) {\r\n      // Swap with previous\r\n      [this.fields[currentIndex], this.fields[currentIndex - 1]] = [\r\n        this.fields[currentIndex - 1],\r\n        this.fields[currentIndex],\r\n      ];\r\n    } else if (direction === \"right\" && currentIndex < this.fields.length - 1) {\r\n      // Swap with next\r\n      [this.fields[currentIndex], this.fields[currentIndex + 1]] = [\r\n        this.fields[currentIndex + 1],\r\n        this.fields[currentIndex],\r\n      ];\r\n    }\r\n\r\n    this.saveFieldOrder();\r\n    this.render();\r\n  }\r\n\r\n  // LocalStorage persistence methods\r\n  private getStorageKey(suffix: string): string {\r\n    return this.options.viewKey\r\n      ? `ghProjects.table.${this.options.viewKey}.${suffix}`\r\n      : \"\";\r\n  }\r\n\r\n  private loadHiddenFields(): string[] {\r\n    const key = this.getStorageKey(\"hiddenFields\");\r\n    if (!key) return [];\r\n\r\n    try {\r\n      const stored = localStorage.getItem(key);\r\n      const arr = stored ? JSON.parse(stored) : [];\r\n      // Normalize stored ids to strings\r\n      const normalized = (arr || []).map((id: any) => String(id));\r\n      try {\r\n        console.debug(\"[ProjectTable] loadHiddenFields ->\", normalized);\r\n      } catch (e) {}\r\n      return normalized;\r\n    } catch (e) {\r\n      return [];\r\n    }\r\n  }\r\n\r\n  private saveHiddenFields() {\r\n    const key = this.getStorageKey(\"hiddenFields\");\r\n    if (!key) return;\r\n\r\n    const arr = Array.from(this.hiddenFieldIds).map((id) => String(id));\r\n    try {\r\n      console.debug(\"[ProjectTable] saveHiddenFields ->\", arr);\r\n    } catch (e) {}\r\n    localStorage.setItem(key, JSON.stringify(arr));\r\n  }\r\n\r\n  private saveSortConfig(config: SortConfig) {\r\n    const key = this.getStorageKey(\"sortConfig\");\r\n    if (!key) return;\r\n\r\n    localStorage.setItem(key, JSON.stringify(config));\r\n  }\r\n\r\n  private saveFieldOrder() {\r\n    const key = this.getStorageKey(\"fieldOrder\");\r\n    if (!key) return;\r\n\r\n    const order = this.fields.map((f) => f.id);\r\n    localStorage.setItem(key, JSON.stringify(order));\r\n  }\r\n\r\n  private applyFieldOrder() {\r\n    const key = this.getStorageKey(\"fieldOrder\");\r\n    if (!key) return;\r\n\r\n    try {\r\n      const stored = localStorage.getItem(key);\r\n      if (!stored) return;\r\n\r\n      const order: string[] = JSON.parse(stored);\r\n      const orderedFields: any[] = [];\r\n\r\n      // Add fields in stored order\r\n      for (const fieldId of order) {\r\n        const field = this.fields.find((f) => String(f.id) === String(fieldId));\r\n        if (field) {\r\n          orderedFields.push(field);\r\n        }\r\n      }\r\n\r\n      // Add any new fields not in stored order\r\n      for (const field of this.fields) {\r\n        if (!orderedFields.find((f) => f.id === field.id)) {\r\n          orderedFields.push(field);\r\n        }\r\n      }\r\n\r\n      this.fields = orderedFields;\r\n    } catch (e) {\r\n      // Ignore errors, use default order\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle field value update from pickers\r\n   */\r\n  private async handleFieldUpdate(\r\n    itemId: string,\r\n    fieldId: string,\r\n    value: any,\r\n  ): Promise<void> {\r\n    try {\r\n      // Send update message to extension\r\n      if (\r\n        (window as any).__APP_MESSAGING__ &&\r\n        typeof (window as any).__APP_MESSAGING__.postMessage === \"function\"\r\n      ) {\r\n        (window as any).__APP_MESSAGING__.postMessage({\r\n          command: \"updateFieldValue\",\r\n          viewKey: this.options.viewKey,\r\n          itemId,\r\n          fieldId,\r\n          value,\r\n        });\r\n\r\n        // Optimistically update the local item data\r\n        const item = this.items.find((i) => String(i.id) === String(itemId));\r\n        if (item) {\r\n          const fieldValue = item.fieldValues.find(\r\n            (fv: any) =>\r\n              String(fv.fieldId) === String(fieldId) ||\r\n              fv.fieldName === this.fields.find((f) => String(f.id) === String(fieldId))?.name,\r\n          );\r\n\r\n          if (fieldValue) {\r\n            // Update the field value based on type\r\n            if (value.labelIds !== undefined) {\r\n              // Labels update\r\n              fieldValue.labels = value.labelIds.map((id: string) => ({ id }));\r\n            } else if (value.assigneeLogins !== undefined) {\r\n              // Assignees update\r\n              fieldValue.assignees = value.assigneeLogins.map((login: string) => ({\r\n                login,\r\n              }));\r\n            } else if (value.reviewerLogins !== undefined) {\r\n              // Reviewers update\r\n              fieldValue.reviewers = value.reviewerLogins.map((login: string) => ({\r\n                login,\r\n              }));\r\n            } else if (value.milestoneId !== undefined) {\r\n              // Milestone update\r\n              fieldValue.milestone = value.milestoneId\r\n                ? { id: value.milestoneId }\r\n                : null;\r\n            }\r\n          }\r\n\r\n          // Re-render the table to reflect changes\r\n          this.render();\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Failed to update field value:\", error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update visual focus indicator for the current cell\r\n   */\r\n  private updateCellFocusIndicator(cell: HTMLElement) {\r\n    // Remove focus indicator from all cells\r\n    const allCells = this.container.querySelectorAll(\"td.focused\");\r\n    allCells.forEach((c) => {\r\n      c.classList.remove(\"focused\");\r\n    });\r\n\r\n    // Add focus indicator to current cell\r\n    cell.classList.add(\"focused\");\r\n  }\r\n}\r\n", "export function setLoadingState(container: HTMLElement, titleText: string) {\r\n  container.innerHTML =\r\n    '<div class=\"title\">' +\r\n    titleText +\r\n    '</div><div class=\"loading\"><em>Loading...</em></div>';\r\n}\r\n\r\nexport function setErrorState(\r\n  container: HTMLElement,\r\n  titleText: string,\r\n  error: string,\r\n) {\r\n  container.innerHTML =\r\n    '<div class=\"title\">' +\r\n    titleText +\r\n    '</div><div style=\"color:var(--vscode-editor-foreground)\">' +\r\n    error +\r\n    \"</div>\";\r\n}\r\n\r\nexport function createLoadMoreButton(onClick: () => void): HTMLButtonElement {\r\n  const btn = document.createElement(\"button\");\r\n  btn.type = \"button\";\r\n  btn.textContent = \"Load more\";\r\n  btn.style.marginLeft = \"8px\";\r\n  btn.style.border = \"1px solid var(--vscode-editorWidget-border)\";\r\n  btn.addEventListener(\"click\", () => {\r\n    onClick();\r\n    btn.disabled = true;\r\n    btn.textContent = \"Loading...\";\r\n  });\r\n  return btn;\r\n}\r\n\r\nexport function clearElement(element: HTMLElement) {\r\n  while (element.firstChild) {\r\n    element.removeChild(element.firstChild);\r\n  }\r\n}\r\n\r\nexport function toggleClass(\r\n  element: HTMLElement,\r\n  className: string,\r\n  force?: boolean,\r\n) {\r\n  element.classList.toggle(className, force);\r\n}\r\n", "/// <reference path=\"./global.d.ts\" />\r\nimport { logDebug } from \"./utils/logger\";\r\nimport {\r\n  setLoadingState,\r\n  setErrorState,\r\n  createLoadMoreButton,\r\n} from \"./utils/domUtils\";\r\n\r\nexport { logDebug, setLoadingState, setErrorState, createLoadMoreButton };\r\n\r\n/**\r\n * Initializes the filter bar using the shared filterBarHelper.\r\n * Returns the barApi if successful, or null.\r\n */\r\nexport function initFilterBar(\r\n  container: HTMLElement,\r\n  viewKey: string,\r\n  options: {\r\n    suffix?: string;\r\n    step?: number;\r\n    effFilter?: string;\r\n    onLoadMore?: () => void;\r\n    onSave?: (filter: any) => void;\r\n    onDiscard?: () => void;\r\n  },\r\n): any {\r\n  if (\r\n    window.filterBarHelper &&\r\n    typeof window.filterBarHelper.create === \"function\"\r\n  ) {\r\n    try {\r\n      return window.filterBarHelper.create({\r\n        parent: container,\r\n        suffix: options.suffix || viewKey,\r\n        effFilter:\r\n          typeof options.effFilter === \"string\" ? options.effFilter : undefined,\r\n        viewKey: viewKey,\r\n        step: options.step || 50,\r\n        onLoadMore: options.onLoadMore,\r\n        onSave: options.onSave,\r\n        onDiscard: options.onDiscard,\r\n      });\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\n/**\r\n * Toggles visibility of elements based on matched IDs from the filter.\r\n */\r\nexport function applyFilterVisibility(\r\n  root: HTMLElement | Document,\r\n  selector: string,\r\n  matchedIds: Set<string>,\r\n  displayStyle: string = \"block\",\r\n) {\r\n  try {\r\n    const elements = Array.from(root.querySelectorAll(selector));\r\n    for (let i = 0; i < elements.length; i++) {\r\n      try {\r\n        const el = elements[i] as HTMLElement;\r\n        const id = el.getAttribute(\"data-gh-item-id\");\r\n        el.style.display = matchedIds.has(String(id)) ? displayStyle : \"none\";\r\n      } catch (e) {}\r\n    }\r\n  } catch (e) {}\r\n}\r\n", "import { ProjectTable } from \"./components/ProjectTable\";\r\nimport {\r\n  setLoadingState,\r\n  setErrorState,\r\n  initFilterBar,\r\n  createLoadMoreButton,\r\n  logDebug,\r\n} from \"./viewFetcherUtils\";\r\nimport { parseSortByFields, sortItems } from \"./utils/tableSorting\";\r\nimport type { SortConfig } from \"./utils/tableSorting\";\r\n\r\n/// <reference path=\"./global.d.ts\" />\r\n\r\nconst UPDATE_TIMEOUT_MS = 10000;\r\n\r\nwindow.tableViewFetcher = function (\r\n  view: any,\r\n  container: HTMLElement,\r\n  viewKey: any,\r\n) {\r\n  const viewName =\r\n    view && (view.name || view.id) ? view.name || view.id : \"Table View\";\r\n  try {\r\n    setLoadingState(container, viewName);\r\n  } catch (e) {}\r\n\r\n  // Extract projectId from global project data\r\n  const projectId =\r\n    ((window as any).__project_data__ && (window as any).__project_data__.id) ||\r\n    undefined;\r\n\r\n  let itemsLimit = 30;\r\n\r\n  function render(payload: any, effectiveFilter?: string) {\r\n    const snapshot = payload || {};\r\n    const fields = snapshot.fields || [];\r\n    const allItems = snapshot.items || [];\r\n    const items = allItems.slice(0, itemsLimit);\r\n\r\n    // Reset container layout\r\n    container.innerHTML = \"\";\r\n    container.style.margin = \"0\";\r\n    container.style.padding = \"0\";\r\n    container.style.height = \"100%\";\r\n    container.style.display = \"flex\";\r\n    container.style.flexDirection = \"column\";\r\n    container.style.overflow = \"hidden\";\r\n\r\n    // Header / Filter Bar Container\r\n    const headerContainer = document.createElement(\"div\");\r\n    headerContainer.style.flex = \"0 0 auto\";\r\n    headerContainer.style.background = \"var(--vscode-editor-background)\";\r\n    headerContainer.style.zIndex = \"20\";\r\n    headerContainer.style.position = \"relative\";\r\n    headerContainer.style.display = \"flex\";\r\n    headerContainer.style.justifyContent = \"space-between\";\r\n    headerContainer.style.alignItems = \"center\";\r\n    headerContainer.style.width = \"100%\"; // Ensure full width\r\n\r\n    // Filter Wrapper to take available space\r\n    const filterWrapper = document.createElement(\"div\");\r\n    filterWrapper.style.flex = \"1 1 auto\";\r\n    filterWrapper.style.marginRight = \"8px\";\r\n    headerContainer.appendChild(filterWrapper);\r\n\r\n    // Init Filter Bar\r\n    // Track unsaved view-level changes (grouping) and wire Save/Discard hooks\r\n    let unsavedGrouping: string | null = null;\r\n    // Track unsaved hidden fields changes (shown/hidden via the plus-column menu)\r\n    let unsavedHiddenFields: Set<string> | null = null;\r\n    // Track unsaved slice changes\r\n    let unsavedSlice: { fieldId: string; value: any } | null = null;\r\n    // Track unsaved sort changes (local-only view state). We use\r\n    // `undefined` = no pending change, non-null = new sort, null = clear sort.\r\n    let unsavedSort: SortConfig | null | undefined = undefined;\r\n    let barApi = initFilterBar(filterWrapper, viewKey, {\r\n      suffix: viewKey ? String(viewKey).split(\":\").pop() : \"\",\r\n      step: itemsLimit,\r\n      onLoadMore: () => {\r\n        itemsLimit += 30;\r\n        requestFields();\r\n      },\r\n      onSave: (newFilter: any) => {\r\n        try {\r\n          // Save grouping if changed\r\n          if (unsavedGrouping !== null) {\r\n            if (\r\n              (window as any).__APP_MESSAGING__ &&\r\n              typeof (window as any).__APP_MESSAGING__.postMessage ===\r\n                \"function\"\r\n            ) {\r\n              (window as any).__APP_MESSAGING__.postMessage({\r\n                command: \"setViewGrouping\",\r\n                viewKey: viewKey,\r\n                grouping: unsavedGrouping,\r\n              });\r\n            }\r\n            unsavedGrouping = null;\r\n          }\r\n\r\n          // Save hidden fields if changed\r\n          if (unsavedHiddenFields !== null) {\r\n            const hiddenArr = Array.from(unsavedHiddenFields);\r\n            if (\r\n              (window as any).__APP_MESSAGING__ &&\r\n              typeof (window as any).__APP_MESSAGING__.postMessage ===\r\n                \"function\"\r\n            ) {\r\n              (window as any).__APP_MESSAGING__.postMessage({\r\n                command: \"setViewHiddenFields\",\r\n                viewKey: viewKey,\r\n                hiddenFields: hiddenArr,\r\n              });\r\n            }\r\n            // Persist to localStorage as well so UI persists across reloads (server may also return updated snapshot)\r\n            try {\r\n              const key = viewKey\r\n                ? `ghProjects.table.${viewKey}.hiddenFields`\r\n                : null;\r\n              if (key) localStorage.setItem(key, JSON.stringify(hiddenArr));\r\n            } catch (e) {}\r\n            unsavedHiddenFields = null;\r\n          }\r\n\r\n          // Save slice if changed\r\n          if (unsavedSlice !== null) {\r\n            if (\r\n              (window as any).__APP_MESSAGING__ &&\r\n              typeof (window as any).__APP_MESSAGING__.postMessage ===\r\n                \"function\"\r\n            ) {\r\n              (window as any).__APP_MESSAGING__.postMessage({\r\n                command: \"setViewSlice\",\r\n                viewKey: viewKey,\r\n                slice: unsavedSlice,\r\n              });\r\n            }\r\n            // Persist to localStorage as well\r\n            try {\r\n              const key = viewKey ? `ghProjects.table.${viewKey}.slice` : null;\r\n              if (key) localStorage.setItem(key, JSON.stringify(unsavedSlice));\r\n            } catch (e) {}\r\n            unsavedSlice = null;\r\n          }\r\n\r\n          // Save sort if changed (persist local override only)\r\n          if (unsavedSort !== undefined) {\r\n            try {\r\n              const key = viewKey\r\n                ? `ghProjects.table.${viewKey}.sortConfig`\r\n                : null;\r\n              if (key) {\r\n                if (unsavedSort === null) {\r\n                  // User cleared sort: remove override\r\n                  localStorage.removeItem(key);\r\n                } else {\r\n                  // User set a new sort: store override\r\n                  localStorage.setItem(key, JSON.stringify(unsavedSort));\r\n                }\r\n              }\r\n            } catch (e) {}\r\n            unsavedSort = undefined;\r\n          }\r\n        } catch (e) {}\r\n      },\r\n      onDiscard: () => {\r\n        try {\r\n          // Discard grouping changes\r\n          if (unsavedGrouping !== null) {\r\n            if (\r\n              (window as any).__APP_MESSAGING__ &&\r\n              typeof (window as any).__APP_MESSAGING__.postMessage ===\r\n                \"function\"\r\n            ) {\r\n              (window as any).__APP_MESSAGING__.postMessage({\r\n                command: \"discardViewGrouping\",\r\n                viewKey: viewKey,\r\n              });\r\n            }\r\n            unsavedGrouping = null;\r\n          }\r\n\r\n          // Discard hidden fields changes: request fresh snapshot from extension\r\n          if (unsavedHiddenFields !== null) {\r\n            if (\r\n              (window as any).__APP_MESSAGING__ &&\r\n              typeof (window as any).__APP_MESSAGING__.postMessage ===\r\n                \"function\"\r\n            ) {\r\n              (window as any).__APP_MESSAGING__.postMessage({\r\n                command: \"discardViewHiddenFields\",\r\n                viewKey: viewKey,\r\n              });\r\n            }\r\n            unsavedHiddenFields = null;\r\n            // Re-request fields to refresh UI from server state\r\n            requestFields();\r\n          }\r\n\r\n          // Discard slice changes: clear slice and refresh UI\r\n          if (unsavedSlice !== null) {\r\n            if (\r\n              (window as any).__APP_MESSAGING__ &&\r\n              typeof (window as any).__APP_MESSAGING__.postMessage ===\r\n                \"function\"\r\n            ) {\r\n              (window as any).__APP_MESSAGING__.postMessage({\r\n                command: \"discardViewSlice\",\r\n                viewKey: viewKey,\r\n              });\r\n            }\r\n            unsavedSlice = null;\r\n            // Clear localStorage\r\n            try {\r\n              const key = viewKey ? `ghProjects.table.${viewKey}.slice` : null;\r\n              if (key) localStorage.removeItem(key);\r\n            } catch (e) {}\r\n            // Re-request fields to refresh UI from server state\r\n            requestFields();\r\n          }\r\n\r\n          // Discard sort changes: forget pending change and\r\n          // refresh UI from persisted server/local override state.\r\n          if (unsavedSort !== undefined) {\r\n            unsavedSort = undefined;\r\n            // Re-request fields to refresh UI from server/default + stored sort\r\n            requestFields();\r\n          }\r\n        } catch (e) {}\r\n      },\r\n    });\r\n\r\n    // If the server provided an effective filter, apply it via the bar API\r\n    // rather than passing it in the options object. This avoids typing\r\n    // mismatches while still initializing the input value at runtime.\r\n    try {\r\n      if (\r\n        effectiveFilter &&\r\n        barApi &&\r\n        typeof barApi.setEffectiveFilter === \"function\"\r\n      ) {\r\n        try {\r\n          barApi.setEffectiveFilter(effectiveFilter);\r\n        } catch (e) {}\r\n      }\r\n    } catch (e) {}\r\n\r\n    // Fallback Header if Filter Bar fails or returns null\r\n    if (!barApi) {\r\n      const title = document.createElement(\"div\");\r\n      title.className = \"title\";\r\n      title.textContent = viewName;\r\n      title.style.padding = \"8px\";\r\n      headerContainer.appendChild(title);\r\n\r\n      const controls = document.createElement(\"div\");\r\n      controls.style.padding = \"8px\";\r\n\r\n      if (allItems.length > itemsLimit) {\r\n        const loadMore = createLoadMoreButton(() => {\r\n          itemsLimit += 30;\r\n          requestFields();\r\n        });\r\n        controls.appendChild(loadMore);\r\n      } else {\r\n        const span = document.createElement(\"span\");\r\n        span.textContent = \"All loaded\";\r\n        span.style.color = \"var(--vscode-descriptionForeground)\";\r\n        controls.appendChild(span);\r\n      }\r\n      headerContainer.appendChild(controls);\r\n    } else {\r\n      // Update load state in barApi\r\n      if (typeof barApi.setLoadState === \"function\") {\r\n        barApi.setLoadState(\r\n          allItems.length < itemsLimit,\r\n          allItems.length >= itemsLimit ? \"Load more\" : \"All loaded\",\r\n        );\r\n      }\r\n      // Register items for filtering\r\n      if (typeof barApi.registerItems === \"function\") {\r\n        barApi.registerItems(allItems, { fields });\r\n      }\r\n    }\r\n\r\n    container.appendChild(headerContainer);\r\n\r\n    // Table Container\r\n    const tableContainer = document.createElement(\"div\");\r\n    tableContainer.style.flex = \"1 1 auto\";\r\n    tableContainer.style.overflow = \"hidden\";\r\n    tableContainer.style.position = \"relative\";\r\n    container.appendChild(tableContainer);\r\n\r\n    // Determine Grouping\r\n    const groupingFieldName = getGroupingFieldName(snapshot);\r\n\r\n    // Parse sort config from GitHub\r\n    let sortConfig = parseSortByFields(snapshot.details?.sortByFields);\r\n\r\n    // Check for local override\r\n    if (viewKey) {\r\n      try {\r\n        const stored = localStorage.getItem(\r\n          `ghProjects.table.${viewKey}.sortConfig`,\r\n        );\r\n        if (stored) sortConfig = JSON.parse(stored);\r\n      } catch (e) {}\r\n    }\r\n\r\n    // Apply sorting\r\n    let displayItems = items;\r\n    if (sortConfig) {\r\n      displayItems = sortItems(items, fields, sortConfig);\r\n    }\r\n\r\n    // Render Table\r\n    // Use `allFields` if provided (full project fields), otherwise fall back to `fields` (view-visible fields)\r\n    const allFields =\r\n      (snapshot as any).allFields && Array.isArray((snapshot as any).allFields)\r\n        ? (snapshot as any).allFields\r\n        : snapshot.fields || [];\r\n\r\n    // Determine which fields the view exposes (visible). If view details contain a fields.nodes\r\n    // list, compute the hidden fields (allFields - viewFields) and pass them to ProjectTable so\r\n    // it picks up view-default hidden fields.\r\n    const viewFieldNodes =\r\n      (snapshot as any).details &&\r\n      (snapshot as any).details.fields &&\r\n      Array.isArray((snapshot as any).details.fields.nodes)\r\n        ? (snapshot as any).details.fields.nodes\r\n        : null;\r\n\r\n    let viewHiddenFieldIds: string[] | undefined = undefined;\r\n    if (viewFieldNodes && Array.isArray(viewFieldNodes)) {\r\n      const visibleIds = new Set(viewFieldNodes.map((n: any) => String(n.id)));\r\n      viewHiddenFieldIds = (allFields || [])\r\n        .map((f: any) => String(f.id))\r\n        .filter((id: string) => !visibleIds.has(id));\r\n    }\r\n\r\n    // Send debug info to extension output (via postMessage) so we can see what the webview computed\r\n    try {\r\n      const dbg = {\r\n        allFieldIds: (allFields || []).map((f: any) => String(f.id)),\r\n        viewFieldIds: viewFieldNodes\r\n          ? viewFieldNodes.map((n: any) => String(n.id))\r\n          : null,\r\n        viewHiddenFieldIds,\r\n      };\r\n      if (\r\n        (window as any).__APP_MESSAGING__ &&\r\n        typeof (window as any).__APP_MESSAGING__.postMessage === \"function\"\r\n      ) {\r\n        (window as any).__APP_MESSAGING__.postMessage({\r\n          command: \"debugLog\",\r\n          level: \"debug\",\r\n          message: \"tableViewFetcher field debug\",\r\n          data: dbg,\r\n          viewKey,\r\n        });\r\n      }\r\n    } catch (e) {}\r\n\r\n    const table = new ProjectTable(tableContainer, allFields, displayItems, {\r\n      groupingFieldName: groupingFieldName || undefined,\r\n      sortConfig,\r\n      viewKey,\r\n      \r\n      // merged logic: projectId from top-level, fallback to snapshot.project.id\r\n      projectId: projectId || snapshot.project?.id,\r\n      \r\n      hiddenFields: viewHiddenFieldIds,\r\n      onFieldUpdate: async (request) => {\r\n        // Send update request to extension\r\n        if (\r\n          (window as any).__APP_MESSAGING__ &&\r\n          typeof (window as any).__APP_MESSAGING__.postMessage === \"function\"\r\n        ) {\r\n          (window as any).__APP_MESSAGING__.postMessage({\r\n            command: \"updateFieldValue\",\r\n            itemId: request.itemId,\r\n            fieldId: request.fieldId,\r\n            value: request.value,\r\n            projectId: request.projectId,\r\n            viewKey: request.viewKey,\r\n          });\r\n\r\n          // Wait for response via message listener\r\n          return new Promise((resolve, reject) => {\r\n            const handleResponse = (event: MessageEvent) => {\r\n              const msg = event.data;\r\n              if (msg.command === \"updateFieldValueResult\") {\r\n                window.removeEventListener(\"message\", handleResponse);\r\n                if (msg.success) {\r\n                  // Update local snapshot with response payload\r\n                  if (msg.payload) {\r\n                    // Re-render table with updated data\r\n                    render(msg.payload, msg.effectiveFilter);\r\n                  }\r\n                  resolve();\r\n                } else {\r\n                  reject(new Error(msg.error || \"Update failed\"));\r\n                }\r\n              }\r\n            };\r\n            window.addEventListener(\"message\", handleResponse);\r\n\r\n            // Timeout after configured duration\r\n            setTimeout(() => {\r\n              window.removeEventListener(\"message\", handleResponse);\r\n              reject(new Error(\"Update timeout\"));\r\n            }, UPDATE_TIMEOUT_MS);\r\n          });\r\n        } else {\r\n          throw new Error(\"Messaging not available\");\r\n        }\r\n      },\r\n      onHiddenFieldsChange: (hiddenIds: string[]) => {\r\n        try {\r\n          unsavedHiddenFields = new Set(\r\n            (hiddenIds || []).map((h: any) => String(h)),\r\n          );\r\n          // Enable Save/Discard buttons in the filter bar if present\r\n          if (barApi && barApi.saveBtn && barApi.discardBtn) {\r\n            try {\r\n              barApi.saveBtn.disabled = false;\r\n              barApi.discardBtn.disabled = false;\r\n              barApi.saveBtn.style.opacity = \"1\";\r\n              barApi.saveBtn.style.cursor = \"pointer\";\r\n              barApi.discardBtn.style.opacity = \"1\";\r\n              barApi.discardBtn.style.cursor = \"pointer\";\r\n            } catch (e) {}\r\n          }\r\n        } catch (e) {}\r\n      },\r\n      onSortChange: (config: SortConfig | null) => {\r\n        try {\r\n          unsavedSort = config || null;\r\n          // Enable Save/Discard buttons in the filter bar if present\r\n          if (barApi && barApi.saveBtn && barApi.discardBtn) {\r\n            try {\r\n              barApi.saveBtn.disabled = false;\r\n              barApi.discardBtn.disabled = false;\r\n              barApi.saveBtn.style.opacity = \"1\";\r\n              barApi.saveBtn.style.cursor = \"pointer\";\r\n              barApi.discardBtn.style.opacity = \"1\";\r\n              barApi.discardBtn.style.cursor = \"pointer\";\r\n            } catch (e) {}\r\n          }\r\n        } catch (e) {}\r\n      },\r\n      onGroupChange: (fieldName: string) => {\r\n        // Defer persistence of grouping until user explicitly Saves from the filter bar\r\n        try {\r\n          unsavedGrouping = fieldName || null;\r\n          // Enable Save/Discard buttons in the filter bar if present\r\n          if (barApi && barApi.saveBtn && barApi.discardBtn) {\r\n            try {\r\n              barApi.saveBtn.disabled = false;\r\n              barApi.discardBtn.disabled = false;\r\n              barApi.saveBtn.style.opacity = \"1\";\r\n              barApi.saveBtn.style.cursor = \"pointer\";\r\n              barApi.discardBtn.style.opacity = \"1\";\r\n              barApi.discardBtn.style.cursor = \"pointer\";\r\n            } catch (e) {}\r\n          }\r\n        } catch (e) {}\r\n      },\r\n      onSliceChange: (field: any) => {\r\n        // Track slice as unsaved change (requires Save/Discard)\r\n        try {\r\n          unsavedSlice = field ? { fieldId: field.id, value: null } : null;\r\n\r\n          // Enable Save/Discard buttons in the filter bar if present\r\n          if (barApi && barApi.saveBtn && barApi.discardBtn) {\r\n            try {\r\n              barApi.saveBtn.disabled = false;\r\n              barApi.discardBtn.disabled = false;\r\n              barApi.saveBtn.style.opacity = \"1\";\r\n              barApi.saveBtn.style.cursor = \"pointer\";\r\n              barApi.discardBtn.style.opacity = \"1\";\r\n              barApi.discardBtn.style.cursor = \"pointer\";\r\n            } catch (e) {}\r\n          }\r\n\r\n          // Log for debugging\r\n          if (\r\n            (window as any).__APP_MESSAGING__ &&\r\n            typeof (window as any).__APP_MESSAGING__.postMessage === \"function\"\r\n          ) {\r\n            (window as any).__APP_MESSAGING__.postMessage({\r\n              command: \"debugLog\",\r\n              level: \"debug\",\r\n              message: field\r\n                ? `Slice activated on field: ${field.name}`\r\n                : \"Slice cleared\",\r\n              viewKey: viewKey,\r\n            });\r\n          }\r\n        } catch (e) {}\r\n      },\r\n    });\r\n    table.render();\r\n\r\n    // Connect Filter to Table Visibility\r\n    if (barApi && typeof barApi.onFilterChange === \"function\") {\r\n      barApi.onFilterChange((matchedIds: Set<string>) => {\r\n        // Apply visibility to table rows\r\n        const rows = tableContainer.querySelectorAll(\"tr[data-gh-item-id]\");\r\n        rows.forEach((row: any) => {\r\n          const id = row.getAttribute(\"data-gh-item-id\");\r\n          if (id && matchedIds.has(id)) {\r\n            row.style.display = \"table-row\";\r\n          } else {\r\n            row.style.display = \"none\";\r\n          }\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  function onMessage(ev: MessageEvent) {\r\n    const msg = ev && ev.data ? ev.data : ev;\r\n    try {\r\n      if (msg && msg.command === \"fields\") {\r\n        if (msg.viewKey && viewKey && String(msg.viewKey) !== String(viewKey))\r\n          return;\r\n\r\n        if (msg.error) {\r\n          setErrorState(container, viewName, String(msg.error));\r\n        } else {\r\n          render(msg.payload, msg.effectiveFilter);\r\n        }\r\n      }\r\n    } catch (e) {}\r\n  }\r\n\r\n  function requestFields() {\r\n    try {\r\n      if (\r\n        (window as any).__APP_MESSAGING__ &&\r\n        typeof (window as any).__APP_MESSAGING__.postMessage === \"function\"\r\n      ) {\r\n        (window as any).__APP_MESSAGING__.postMessage({\r\n          command: \"requestFields\",\r\n          first: itemsLimit,\r\n          viewKey: viewKey,\r\n        });\r\n      }\r\n    } catch (e) {}\r\n  }\r\n\r\n  try {\r\n    (window as any).__APP_MESSAGING__.onMessage(onMessage);\r\n  } catch (e) {\r\n    window.addEventListener(\"message\", onMessage);\r\n  }\r\n  requestFields();\r\n};\r\n\r\nfunction getGroupingFieldName(snapshot: any): string | null {\r\n  try {\r\n    if (snapshot && snapshot.details) {\r\n      const vgb =\r\n        snapshot.details.verticalGroupByFields &&\r\n        snapshot.details.verticalGroupByFields.nodes;\r\n      const gb =\r\n        snapshot.details.groupByFields && snapshot.details.groupByFields.nodes;\r\n\r\n      if (vgb && vgb.length > 0) return vgb[0].name || null;\r\n      if (gb && gb.length > 0) return gb[0].name || null;\r\n    }\r\n  } catch (e) {}\r\n  return null;\r\n}\r\n"],
  "mappings": "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",
  "names": ["ColumnHeaderMenu", "field", "options", "iconName", "anchorElement", "rect", "disableLeft", "disableRight", "label", "onClick", "item", "iconEl", "labelEl", "clearBtn", "e", "separator", "ColumnHeaderRenderer", "options", "iconName", "table", "thead", "tr", "thIndex", "fieldIndex", "field", "th", "isSorted", "sortDirection", "headerContent", "nameSpan", "headerText", "isGrouped", "isSliced", "iconsContainer", "sortIcon", "direction", "groupIcon", "ev", "sliceIcon", "menuBtn", "e", "thAddField", "addFieldBtn", "FieldsMenu", "options", "anchorElement", "rect", "menuRect", "margin", "vw", "vh", "top", "left", "title", "icon", "label", "newField", "visible", "f", "hidden", "text", "h", "r", "field", "row", "c", "s", "iconHtml", "newVisible", "dataType", "iconName", "FieldsMenu_default", "escapeHtml", "s", "normalizeColor", "color", "n", "b", "u", "addAlpha", "alpha", "S", "v", "C", "getContrastColor", "SlicePanel", "container", "field", "items", "allFields", "stored", "debugOverlay", "resizer", "startX", "startWidth", "onMouseMove", "e", "dx", "newW", "onMouseUp", "ev", "header", "headerTop", "sliceLabel", "fieldButton", "arrow", "content", "anchorButton", "sliceableTypes", "sliceableFields", "f", "dataType", "dropdown", "item", "iconSpan", "labelSpan", "backdrop", "iconName", "valueCounts", "empty", "sorted", "a", "b", "resolveParentProgress", "parentMeta", "result", "identifiers", "found", "A", "d", "M", "o", "m", "statusFV", "v", "c", "normalizeColor", "agg", "key", "value", "count", "rawValue", "parentMetaForIteration", "leftVisual", "makeColorDot", "dot", "visualAppended", "avatarUrl", "avatarEl", "escapeHtml", "repoIcon", "prog", "dotColor", "pd", "lab", "colorCandidate", "normalized", "colorVal", "iter", "it", "labelColumn", "label", "descText", "desc", "p", "titleText", "titleEl", "tspan", "displayedTitle", "summary", "doneText", "bar", "fill", "iterObj", "iterCandidate", "start", "duration", "s", "sStr", "eStr", "rangeEl", "countCircle", "counts", "fv", "existing", "labelsArr", "name", "ass", "fieldValue", "callback", "parseSortByFields", "sortByFields", "primary", "config", "secondary", "sortItems", "items", "fields", "sortConfig", "field", "f", "sorted", "a", "b", "primaryResult", "compareFieldValues", "secondaryField", "direction", "aValue", "getFieldValue", "bValue", "result", "compareText", "compareNumber", "compareDate", "compareSingleSelect", "compareIteration", "compareLabels", "item", "fieldValue", "fv", "extractTitleLikeString", "list", "first", "repo", "m", "parent", "prs", "issues", "rawNode", "content", "aStr", "bStr", "aNum", "bNum", "aDate", "bDate", "aOption", "bOption", "aIndex", "opt", "bIndex", "aLabels", "bLabels", "GroupDataService", "items", "field", "options", "dType", "groups", "opt", "unassigned", "item", "index", "fv", "v", "placed", "matchId", "matchName", "group", "g", "map", "unassignedFallback", "val", "p", "a", "key", "groupsArr", "ICON_DEFINITIONS", "getIconSvg", "name", "options", "icon", "size", "className", "fill", "viewBox", "ariaHidden", "ariaLabel", "escapeHtml", "title", "innerContent", "escapeHtml", "text", "TitleRenderer", "value", "field", "item", "allItems", "t", "l", "r", "w", "x", "normalizeColor", "p", "g", "escapeHtml", "f", "content", "isPullRequest", "isDraft", "isClosed", "isMerged", "isBlocked", "parentIsDoneByStatus", "st", "completedNames", "deps", "hasDoneFromStatus", "statusFv", "fv", "fname", "optNameLower", "hasDoneLabel", "iconName", "baseIcon", "getIconSvg", "blockedIcon", "TextRenderer", "NumberRenderer", "DateRenderer", "o", "SingleSelectRenderer", "n", "c", "hasHex", "border", "bg", "addAlpha", "fg", "IterationRenderer", "i", "name", "rawColor", "RepositoryRenderer", "LabelsRenderer", "a", "k", "L", "h", "PullRequestRenderer", "prs", "out", "num", "titleText", "url", "normColor", "getContrastColor", "state", "IssueRenderer", "AssigneesRenderer", "RequestedReviewersRenderer", "MilestoneRenderer", "SubIssuesProgressRenderer", "totalCount", "doneCount", "pct", "ParentIssueRenderer", "itemsList", "B", "O", "$", "A", "d", "M", "V", "X", "parentIconName", "parentIcon", "q", "parentWrapper", "strategies", "TitleRenderer", "TextRenderer", "NumberRenderer", "DateRenderer", "SingleSelectRenderer", "IterationRenderer", "RepositoryRenderer", "LabelsRenderer", "PullRequestRenderer", "IssueRenderer", "AssigneesRenderer", "RequestedReviewersRenderer", "MilestoneRenderer", "SubIssuesProgressRenderer", "ParentIssueRenderer", "renderCell", "e", "n", "s", "allItems", "strategy", "err", "BasePicker", "options", "rect", "header", "searchContainer", "footer", "clearBtn", "applyBtn", "text", "onClick", "btn", "e", "item", "index", "LabelsPicker", "BasePicker", "options", "label", "repoName", "labels", "emptyState", "item", "checkbox", "normalizedColor", "normalizeColor", "bg", "addAlpha", "swatch", "info", "nameEl", "descEl", "e", "labelId", "selected", "searchTerm", "labelIds", "AssigneesPicker", "BasePicker", "options", "assignee", "assignees", "emptyState", "item", "checkbox", "avatar", "escapeHtml", "initials", "part", "info", "loginEl", "nameEl", "e", "login", "selected", "searchTerm", "logins", "ReviewersPicker", "BasePicker", "options", "reviewer", "reviewers", "emptyState", "item", "checkbox", "avatar", "isTeam", "escapeHtml", "TEAM_ICON", "initials", "part", "info", "loginEl", "nameEl", "kindBadge", "e", "login", "selected", "searchTerm", "logins", "MilestonePicker", "BasePicker", "options", "milestones", "repoName", "milestone", "clearItem", "emptyState", "separator", "item", "radio", "dot", "label", "info", "titleEl", "dueDate", "formatted", "dueEl", "milestoneId", "searchTerm", "CellEditor", "cell", "fieldId", "fieldType", "itemId", "projectId", "viewKey", "originalValue", "originalContent", "newValue", "validation", "error", "callback", "value", "handleKeyDown", "resolve", "reject", "messageId", "timeoutId", "handleResponse", "eventOrData", "msg", "messaging", "message", "vscode", "tooltip", "reverse", "row", "cells", "currentIndex", "i", "TextCellEditor", "CellEditor", "value", "NumberCellEditor", "CellEditor", "target", "value", "hasMinus", "parts", "num", "DateCellEditor", "CellEditor", "dateValue", "date", "e", "value", "DOUBLE_CLICK_TIMEOUT_MS", "EditorManager", "projectId", "viewKey", "allItems", "cell", "fieldValue", "field", "item", "rawFieldType", "fieldType", "clickCount", "clickTimer", "handleClick", "e", "target", "handleKeyDown", "fieldId", "itemId", "editor", "TextCellEditor", "NumberCellEditor", "DateCellEditor", "newValue", "updatedFieldValue", "renderCell", "fv", "v", "RowRenderer", "fields", "allItems", "onResizeStart", "onCellRendered", "projectId", "viewKey", "onFieldUpdate", "EditorManager", "item", "index", "tr", "tdIndex", "colIndex", "field", "td", "fieldLabel", "fv", "v", "renderCell", "dataType", "isSingleSelectOrIteration", "isPickerField", "handleClick", "e", "target", "handleKeyDown", "resizer", "table", "col", "startWidth", "anchorElement", "fieldValue", "currentLabels", "LabelsPicker", "labelIds", "error", "currentAssignees", "AssigneesPicker", "assigneeLogins", "currentReviewers", "ReviewersPicker", "reviewerLogins", "currentMilestone", "MilestonePicker", "milestoneId", "GroupRenderer", "fields", "allItems", "iconName", "size", "tbody", "group", "groupingField", "rowRenderer", "trHeader", "tdHeader", "headerContent", "estimateField", "f", "estimateFieldId", "sumEstimate", "itemsArr", "sum", "gi", "it", "fv", "num", "formatEstimate", "n", "toggleBtn", "iconExpanded", "iconCollapsed", "colorDot", "normalizeColor", "nameSpan", "leftPane", "rightPane", "parentMeta", "resolvedParentItem", "first", "pfv", "v", "identifiers", "found", "A", "d", "M", "o", "m", "avatarEl", "avatarUrl", "match", "a", "escapeHtml", "repoIcon", "content", "statusFV", "c", "countCircle", "estSum", "estEl", "completedNames", "isDoneByHeuristics", "state", "percentFV", "labs", "l", "cn", "done", "total", "agg", "doneText", "progWrapper", "pct", "bar", "fill", "opt", "descEl", "iterText", "start", "duration", "s", "days", "e", "sStr", "eStr", "iterEl", "groupRows", "groupItem", "tr", "isCollapsed", "row", "TableResizer", "table", "fields", "options", "th", "index", "resizer", "e", "col", "startW", "colIndex", "startX", "startWidth", "onMouseMove", "newWidth", "onMouseUp", "fieldIndex", "widthToSave", "fieldId", "width", "key", "stored", "widths", "cols", "field", "suffix", "FieldDropdown", "config", "opt", "backdrop", "dropdown", "title", "emptyMsg", "option", "index", "item", "swatch", "normalizedColor", "normalizeColor", "textContainer", "label", "desc", "e", "items", "el", "targetItem", "selectedOption", "optionId", "anchorRect", "dropdownRect", "viewportHeight", "viewportWidth", "top", "left", "ERROR_TOOLTIP_DURATION_MS", "InteractiveCellManager", "config", "cell", "field", "item", "currentValue", "projectId", "viewKey", "fieldType", "clickHandler", "e", "cellKey", "keyHandler", "options", "currentValueId", "FieldDropdown", "optionId", "opt", "iter", "dateRange", "iteration", "start", "startStr", "end", "endStr", "itemId", "fieldId", "request", "error", "errorMsg", "tooltip", "cellRect", "TableKeyboardNavigator", "table", "callbacks", "e", "target", "cell", "key", "rowIndex", "colIndex", "newPosition", "position", "tbody", "rows", "row", "cells", "commit", "td", "firstRow", "firstCell", "enabled", "ProjectTable", "container", "fields", "items", "options", "f", "hiddenFromStorage", "id", "hiddenFromOptions", "dbg", "InteractiveCellManager", "request", "error", "existingSlicePanel", "tableContainer", "table", "ColumnHeaderRenderer", "TableResizer", "TableKeyboardNavigator", "cell", "position", "commit", "colgroup", "colIndex", "field", "col", "colAddField", "anchorElement", "visibleSet", "menu", "FieldsMenu_default", "fieldId", "visible", "tbody", "displayItems", "sortItems", "item", "fv", "v", "val", "groupingField", "rowRenderer", "RowRenderer", "pageX", "startWidth", "fieldValue", "itemId", "value", "index", "tr", "groups", "GroupDataService", "groupRenderer", "GroupRenderer", "group", "event", "headerElement", "dataType", "groupableTypes", "sliceableTypes", "canGroup", "canSlice", "isGrouped", "isSliced", "currentSort", "fieldIndex", "isFirst", "isLast", "ColumnHeaderMenu", "direction", "hiddenFields", "message", "rect", "header", "separator", "backdrop", "sortConfig", "SlicePanel", "tableWrapper", "sliceEl", "newField", "fid", "currentIndex", "suffix", "key", "stored", "normalized", "arr", "config", "order", "orderedFields", "i", "login", "c", "setLoadingState", "container", "titleText", "setErrorState", "error", "createLoadMoreButton", "onClick", "btn", "initFilterBar", "container", "viewKey", "options", "UPDATE_TIMEOUT_MS", "view", "container", "viewKey", "viewName", "setLoadingState", "projectId", "itemsLimit", "render", "payload", "effectiveFilter", "snapshot", "fields", "allItems", "items", "headerContainer", "filterWrapper", "unsavedGrouping", "unsavedHiddenFields", "unsavedSlice", "unsavedSort", "barApi", "initFilterBar", "requestFields", "newFilter", "hiddenArr", "key", "title", "controls", "loadMore", "createLoadMoreButton", "span", "tableContainer", "groupingFieldName", "getGroupingFieldName", "sortConfig", "parseSortByFields", "stored", "displayItems", "sortItems", "allFields", "viewFieldNodes", "viewHiddenFieldIds", "visibleIds", "n", "f", "id", "dbg", "ProjectTable", "request", "resolve", "reject", "handleResponse", "event", "msg", "hiddenIds", "h", "config", "fieldName", "field", "matchedIds", "row", "onMessage", "ev", "setErrorState", "vgb", "gb"]
}
