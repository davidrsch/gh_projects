{
  "version": 3,
  "sources": ["../../src/webviews/client/components/ColumnHeaderMenu.ts", "../../src/webviews/client/renderers/columnHeaderRenderer.ts", "../../src/webviews/client/components/FieldsMenu.ts", "../../src/webviews/client/utils.ts", "../../src/webviews/client/components/SlicePanel.ts", "../../src/webviews/client/utils/tableSorting.ts", "../../src/webviews/client/services/GroupDataService.ts", "../../src/webviews/client/renderers/strategies.ts", "../../src/webviews/client/renderers/cellRenderer.ts", "../../src/webviews/client/renderers/RowRenderer.ts", "../../src/webviews/client/renderers/GroupRenderer.ts", "../../src/webviews/client/components/TableResizer.ts", "../../src/webviews/client/components/ProjectTable.ts", "../../src/webviews/client/utils/domUtils.ts", "../../src/webviews/client/viewFetcherUtils.ts", "../../src/webviews/client/tableViewFetcher.ts"],
  "sourcesContent": ["/**\r\n * Column Header Dropdown Menu Component\r\n * Shows context menu when clicking column header with actions like sort, group, slice, hide, move\r\n */\r\n\r\nexport interface MenuOptions {\r\n  canGroup: boolean;\r\n  canSlice: boolean;\r\n  canFilter: boolean;\r\n  isGrouped?: boolean;\r\n  isSliced?: boolean;\r\n  currentSort?: \"ASC\" | \"DESC\" | null;\r\n  onSort?: (direction: \"ASC\" | \"DESC\") => void;\r\n  onGroup?: () => void;\r\n  onSlice?: () => void;\r\n  onClearGroup?: () => void;\r\n  onClearSlice?: () => void;\r\n  onClearSort?: () => void;\r\n  onHide?: () => void;\r\n  onMove?: (direction: \"left\" | \"right\") => void;\r\n  onFilter?: () => void;\r\n  // positional info for disabling move actions\r\n  isFirst?: boolean;\r\n  isLast?: boolean;\r\n}\r\n\r\nexport class ColumnHeaderMenu {\r\n  private field: any;\r\n  private options: MenuOptions;\r\n  private menuElement: HTMLElement | null = null;\r\n  private backdropElement: HTMLElement | null = null;\r\n\r\n  constructor(field: any, options: MenuOptions) {\r\n    this.field = field;\r\n    this.options = options;\r\n  }\r\n\r\n  /**\r\n   * Helper to get icon SVG from registry\r\n   */\r\n  private getIconSvg(iconName: string): string {\r\n    if (typeof (window as any).getIconSvg === \"function\") {\r\n      return (window as any).getIconSvg(iconName);\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  /**\r\n   * Show the menu anchored below the header element\r\n   */\r\n  public show(anchorElement: HTMLElement): void {\r\n    // Hide any existing menu\r\n    this.hide();\r\n\r\n    // Create backdrop to detect outside clicks\r\n    this.backdropElement = document.createElement(\"div\");\r\n    this.backdropElement.style.position = \"fixed\";\r\n    this.backdropElement.style.top = \"0\";\r\n    this.backdropElement.style.left = \"0\";\r\n    this.backdropElement.style.right = \"0\";\r\n    this.backdropElement.style.bottom = \"0\";\r\n    this.backdropElement.style.zIndex = \"999\";\r\n    this.backdropElement.addEventListener(\"click\", () => this.hide());\r\n    document.body.appendChild(this.backdropElement);\r\n\r\n    // Create menu\r\n    this.menuElement = document.createElement(\"div\");\r\n    this.menuElement.className = \"column-header-menu\";\r\n    this.menuElement.style.position = \"absolute\";\r\n    this.menuElement.style.background = \"var(--vscode-menu-background)\";\r\n    this.menuElement.style.border = \"1px solid var(--vscode-menu-border)\";\r\n    this.menuElement.style.borderRadius = \"4px\";\r\n    this.menuElement.style.boxShadow = \"0 2px 8px rgba(0, 0, 0, 0.15)\";\r\n    this.menuElement.style.minWidth = \"180px\";\r\n    this.menuElement.style.padding = \"4px 0\";\r\n    this.menuElement.style.zIndex = \"1000\";\r\n    this.menuElement.style.fontSize = \"13px\";\r\n\r\n    // Position below anchor\r\n    const rect = anchorElement.getBoundingClientRect();\r\n    this.menuElement.style.top = `${rect.bottom + 4}px`;\r\n    this.menuElement.style.left = `${rect.left}px`;\r\n\r\n    // Build menu items\r\n    this.buildMenuItems();\r\n\r\n    document.body.appendChild(this.menuElement);\r\n  }\r\n\r\n  /**\r\n   * Hide and remove the menu\r\n   */\r\n  public hide(): void {\r\n    if (this.menuElement) {\r\n      this.menuElement.remove();\r\n      this.menuElement = null;\r\n    }\r\n    if (this.backdropElement) {\r\n      this.backdropElement.remove();\r\n      this.backdropElement = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Build menu items based on options\r\n   */\r\n  private buildMenuItems(): void {\r\n    if (!this.menuElement) return;\r\n\r\n    // Header\r\n    this.addMenuItem(\"Select column\", null, { isHeader: true });\r\n    this.addSeparator();\r\n\r\n    // Sort options (always available). If the column is currently sorted, show an 'x' clear button\r\n    this.addMenuItem(\r\n      \"Sort ascending\",\r\n      () => {\r\n        this.options.onSort?.(\"ASC\");\r\n        this.hide();\r\n      },\r\n      {\r\n        icon: this.getIconSvg(\"sort-asc\"),\r\n        showClear: !!(this.options.currentSort === \"ASC\"),\r\n        clearAction: this.options.onClearSort,\r\n      },\r\n    );\r\n\r\n    this.addMenuItem(\r\n      \"Sort descending\",\r\n      () => {\r\n        this.options.onSort?.(\"DESC\");\r\n        this.hide();\r\n      },\r\n      {\r\n        icon: this.getIconSvg(\"sort-desc\"),\r\n        showClear: !!(this.options.currentSort === \"DESC\"),\r\n        clearAction: this.options.onClearSort,\r\n      },\r\n    );\r\n\r\n    this.addSeparator();\r\n\r\n    // Group by (conditional)\r\n    if (this.options.canGroup) {\r\n      this.addMenuItem(\r\n        \"Group by values\",\r\n        () => {\r\n          this.options.onGroup?.();\r\n          this.hide();\r\n        },\r\n        {\r\n          icon: this.getIconSvg(\"rows\"),\r\n          showClear: !!this.options.isGrouped,\r\n          clearAction: this.options.onClearGroup,\r\n        },\r\n      );\r\n    }\r\n\r\n    // Slice by (conditional)\r\n    if (this.options.canSlice) {\r\n      this.addMenuItem(\r\n        \"Slice by values\",\r\n        () => {\r\n          this.options.onSlice?.();\r\n          this.hide();\r\n        },\r\n        {\r\n          icon: this.getIconSvg(\"sliceby\"),\r\n          showClear: !!this.options.isSliced,\r\n          clearAction: this.options.onClearSlice,\r\n        },\r\n      );\r\n    }\r\n\r\n    // Filter (conditional)\r\n    if (this.options.canFilter) {\r\n      this.addMenuItem(\"Filter by values...\", () => {\r\n        this.options.onFilter?.();\r\n        this.hide();\r\n      });\r\n    }\r\n\r\n    // Always available actions\r\n    if (\r\n      this.options.canGroup ||\r\n      this.options.canSlice ||\r\n      this.options.canFilter\r\n    ) {\r\n      this.addSeparator();\r\n    }\r\n\r\n    // Do not show hide for title fields\r\n    const isTitle = !!(\r\n      this.field &&\r\n      (this.field.type === \"title\" ||\r\n        String(this.field.name || \"\").toLowerCase() === \"title\" ||\r\n        String(this.field.id || \"\").toLowerCase() === \"title\")\r\n    );\r\n    if (!isTitle) {\r\n      this.addMenuItem(\r\n        \"Hide field\",\r\n        () => {\r\n          this.options.onHide?.();\r\n          this.hide();\r\n        },\r\n        {\r\n          icon: this.getIconSvg(\"eye-closed\"),\r\n        },\r\n      );\r\n    }\r\n\r\n    this.addSeparator();\r\n\r\n    const disableLeft = !!this.options.isFirst;\r\n    const disableRight = !!this.options.isLast;\r\n\r\n    this.addMenuItem(\r\n      \"Move left\",\r\n      () => {\r\n        if (disableLeft) return;\r\n        this.options.onMove?.(\"left\");\r\n        this.hide();\r\n      },\r\n      {\r\n        icon: this.getIconSvg(\"arrow-left\"),\r\n        disabled: disableLeft,\r\n      },\r\n    );\r\n\r\n    this.addMenuItem(\r\n      \"Move right\",\r\n      () => {\r\n        if (disableRight) return;\r\n        this.options.onMove?.(\"right\");\r\n        this.hide();\r\n      },\r\n      {\r\n        icon: this.getIconSvg(\"arrow-right\"),\r\n        disabled: disableRight,\r\n      },\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Add a menu item\r\n   */\r\n  private addMenuItem(\r\n    label: string,\r\n    onClick: (() => void) | null,\r\n    options?: {\r\n      isHeader?: boolean;\r\n      icon?: string;\r\n      showClear?: boolean;\r\n      clearAction?: (() => void) | null;\r\n      disabled?: boolean;\r\n    },\r\n  ): void {\r\n    if (!this.menuElement) return;\r\n    const item = document.createElement(\"div\");\r\n    item.className = \"menu-item\";\r\n\r\n    if (options?.isHeader) {\r\n      item.textContent = label;\r\n      item.style.padding = \"6px 12px\";\r\n      item.style.fontWeight = \"600\";\r\n      item.style.color = \"var(--vscode-descriptionForeground)\";\r\n      item.style.fontSize = \"11px\";\r\n      item.style.textTransform = \"uppercase\";\r\n      item.style.cursor = \"default\";\r\n      this.menuElement.appendChild(item);\r\n      return;\r\n    }\r\n\r\n    // Non-header item layout: optional icon on left, label, optional clear 'x' button on the right\r\n    item.style.display = \"flex\";\r\n    item.style.alignItems = \"center\";\r\n    item.style.justifyContent = \"space-between\";\r\n    item.style.padding = \"6px 12px\";\r\n    item.style.cursor = \"pointer\";\r\n    item.style.color = \"var(--vscode-menu-foreground)\";\r\n\r\n    // Left icon\r\n    if (options?.icon) {\r\n      const iconEl = document.createElement(\"span\");\r\n      iconEl.className = \"menu-item-icon\";\r\n      iconEl.style.display = \"inline-block\";\r\n      iconEl.style.width = \"14px\";\r\n      iconEl.style.marginRight = \"8px\";\r\n      iconEl.style.flex = \"0 0 auto\";\r\n      // allow callers to pass either a short glyph or full SVG string\r\n      iconEl.innerHTML = options.icon;\r\n      item.appendChild(iconEl);\r\n    }\r\n\r\n    const labelEl = document.createElement(\"span\");\r\n    labelEl.textContent = label;\r\n    labelEl.style.flex = \"1\";\r\n    labelEl.style.whiteSpace = \"nowrap\";\r\n    labelEl.style.overflow = \"hidden\";\r\n    labelEl.style.textOverflow = \"ellipsis\";\r\n\r\n    item.appendChild(labelEl);\r\n\r\n    // Optional clear 'x' button\r\n    if (options?.showClear && options?.clearAction) {\r\n      const clearBtn = document.createElement(\"button\");\r\n      clearBtn.type = \"button\";\r\n      clearBtn.textContent = \"\u2715\";\r\n      clearBtn.title = \"Clear\";\r\n      clearBtn.style.border = \"none\";\r\n      clearBtn.style.background = \"transparent\";\r\n      clearBtn.style.cursor = \"pointer\";\r\n      clearBtn.style.padding = \"2px 6px\";\r\n      clearBtn.style.marginLeft = \"8px\";\r\n      clearBtn.style.color = \"var(--vscode-menu-foreground)\";\r\n\r\n      clearBtn.addEventListener(\"mouseenter\", () => {\r\n        clearBtn.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n        clearBtn.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n      });\r\n      clearBtn.addEventListener(\"mouseleave\", () => {\r\n        clearBtn.style.color = \"var(--vscode-menu-foreground)\";\r\n        clearBtn.style.background = \"transparent\";\r\n      });\r\n\r\n      clearBtn.addEventListener(\"click\", (e) => {\r\n        e.stopPropagation();\r\n        options.clearAction && options.clearAction();\r\n        this.hide();\r\n      });\r\n\r\n      item.appendChild(clearBtn);\r\n    }\r\n\r\n    // Disabled state\r\n    if (options?.disabled) {\r\n      item.style.opacity = \"0.5\";\r\n      item.style.cursor = \"default\";\r\n    }\r\n\r\n    if (onClick) {\r\n      item.addEventListener(\"mouseenter\", () => {\r\n        item.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n        item.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n      });\r\n\r\n      item.addEventListener(\"mouseleave\", () => {\r\n        item.style.background = \"transparent\";\r\n        item.style.color = \"var(--vscode-menu-foreground)\";\r\n      });\r\n\r\n      item.addEventListener(\"click\", () => {\r\n        if (options?.disabled) return;\r\n        onClick();\r\n      });\r\n    }\r\n\r\n    this.menuElement.appendChild(item);\r\n  }\r\n\r\n  /**\r\n   * Add menu separator\r\n   */\r\n  private addSeparator(): void {\r\n    if (!this.menuElement) return;\r\n\r\n    const separator = document.createElement(\"div\");\r\n    separator.style.height = \"1px\";\r\n    separator.style.background = \"var(--vscode-menu-separatorBackground)\";\r\n    separator.style.margin = \"4px 0\";\r\n\r\n    this.menuElement.appendChild(separator);\r\n  }\r\n}\r\n", "export interface ColumnHeaderOptions {\r\n  fields: any[];\r\n  sortConfig: any;\r\n  groupingFieldName?: string;\r\n  activeSlice: any;\r\n  activeSlicePanelFieldId: string | null;\r\n  onHeaderMenu: (e: MouseEvent, field: any, th: HTMLElement) => void;\r\n  onShowFieldsMenu: (anchor: HTMLElement) => void;\r\n  onClearGroup: (field: any) => void;\r\n  onClearSlice: (field: any) => void;\r\n}\r\n\r\nexport class ColumnHeaderRenderer {\r\n  constructor(private options: ColumnHeaderOptions) {}\r\n\r\n  /**\r\n   * Helper to get icon SVG from registry\r\n   */\r\n  private getIconSvg(iconName: string): string {\r\n    if (typeof (window as any).getIconSvg === \"function\") {\r\n      return (window as any).getIconSvg(iconName);\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  public render(table: HTMLTableElement) {\r\n    const thead = document.createElement(\"thead\");\r\n    thead.style.background = \"var(--vscode-sideBar-background)\";\r\n    thead.style.position = \"sticky\";\r\n    thead.style.top = \"0\";\r\n    thead.style.zIndex = \"10\";\r\n\r\n    const tr = document.createElement(\"tr\");\r\n\r\n    // Index Header\r\n    const thIndex = document.createElement(\"th\");\r\n    thIndex.textContent = \"#\";\r\n    this.styleHeaderCell(thIndex);\r\n    tr.appendChild(thIndex);\r\n\r\n    // Field Headers\r\n    for (const field of this.options.fields) {\r\n      const th = document.createElement(\"th\");\r\n\r\n      // Create header content wrapper\r\n      const headerContent = document.createElement(\"div\");\r\n      headerContent.style.display = \"flex\";\r\n      headerContent.style.alignItems = \"center\";\r\n      headerContent.style.justifyContent = \"space-between\";\r\n      headerContent.style.width = \"100%\";\r\n      headerContent.style.gap = \"4px\";\r\n\r\n      // Field name span\r\n      const nameSpan = document.createElement(\"span\");\r\n      const headerText = field.name || field.id || \"\";\r\n      nameSpan.textContent = headerText;\r\n      nameSpan.style.flex = \"1\";\r\n      nameSpan.style.overflow = \"hidden\";\r\n      nameSpan.style.textOverflow = \"ellipsis\";\r\n      nameSpan.style.whiteSpace = \"nowrap\";\r\n\r\n      // Check if this field is grouped\r\n      const isGrouped =\r\n        field.name?.toLowerCase() ===\r\n        this.options.groupingFieldName?.toLowerCase();\r\n\r\n      // Check if this field is being sliced\r\n      const isSliced =\r\n        (this.options.activeSlice &&\r\n          this.options.activeSlice.fieldId === field.id) ||\r\n        (this.options.activeSlicePanelFieldId &&\r\n          String(this.options.activeSlicePanelFieldId) === String(field.id));\r\n\r\n      // Check if this field is sorted\r\n      const isSorted = this.options.sortConfig?.fieldId === field.id;\r\n\r\n      // Icons container (for sort / group / slice indicators)\r\n      const iconsContainer = document.createElement(\"span\");\r\n      iconsContainer.style.display = \"flex\";\r\n      iconsContainer.style.alignItems = \"center\";\r\n      iconsContainer.style.gap = \"6px\";\r\n\r\n      // Show Sort icon\r\n      if (isSorted) {\r\n        const sortIcon = document.createElement(\"span\");\r\n        sortIcon.className = \"column-sort-icon\";\r\n        const direction =\r\n          this.options.sortConfig?.direction === \"ASC\" ? \"sort-asc\" : \"sort-desc\";\r\n        sortIcon.innerHTML = this.getIconSvg(direction);\r\n        sortIcon.style.display = \"inline-flex\";\r\n        sortIcon.style.alignItems = \"center\";\r\n        sortIcon.style.color = \"var(--vscode-foreground)\";\r\n        sortIcon.style.opacity = \"0.85\";\r\n        sortIcon.title =\r\n          this.options.sortConfig?.direction === \"ASC\"\r\n            ? \"Sorted ascending\"\r\n            : \"Sorted descending\";\r\n        iconsContainer.appendChild(sortIcon);\r\n      }\r\n\r\n      // Show Group icon\r\n      if (isGrouped) {\r\n        const groupIcon = document.createElement(\"span\");\r\n        groupIcon.className = \"column-group-icon\";\r\n        groupIcon.innerHTML = this.getIconSvg(\"rows\");\r\n        groupIcon.style.display = \"inline-flex\";\r\n        groupIcon.style.alignItems = \"center\";\r\n        groupIcon.style.color = \"var(--vscode-foreground)\";\r\n        groupIcon.style.opacity = \"0.85\";\r\n        groupIcon.title = \"Grouped by this field (click to clear)\";\r\n        groupIcon.style.cursor = \"pointer\";\r\n        groupIcon.addEventListener(\"click\", (ev) => {\r\n          ev.stopPropagation();\r\n          this.options.onClearGroup(field);\r\n        });\r\n        iconsContainer.appendChild(groupIcon);\r\n      }\r\n\r\n      // Show Slice icon\r\n      if (isSliced) {\r\n        const sliceIcon = document.createElement(\"span\");\r\n        sliceIcon.className = \"column-slice-icon\";\r\n        sliceIcon.innerHTML = this.getIconSvg(\"sliceby\");\r\n        sliceIcon.style.display = \"inline-flex\";\r\n        sliceIcon.style.alignItems = \"center\";\r\n        sliceIcon.style.color = \"var(--vscode-foreground)\";\r\n        sliceIcon.style.opacity = \"0.85\";\r\n        sliceIcon.title = \"Sliced by this field (click to clear)\";\r\n        sliceIcon.style.cursor = \"pointer\";\r\n        sliceIcon.addEventListener(\"click\", (ev) => {\r\n          ev.stopPropagation();\r\n          this.options.onClearSlice(field);\r\n        });\r\n        iconsContainer.appendChild(sliceIcon);\r\n      }\r\n\r\n      // Menu button (\u22EE)\r\n      const menuBtn = document.createElement(\"button\");\r\n      menuBtn.textContent = \"\u22EE\";\r\n      menuBtn.style.background = \"transparent\";\r\n      menuBtn.style.border = \"none\";\r\n      menuBtn.style.cursor = \"pointer\";\r\n      menuBtn.style.fontSize = \"16px\";\r\n      menuBtn.style.padding = \"2px 4px\";\r\n      menuBtn.style.color = \"var(--vscode-foreground)\";\r\n      menuBtn.style.opacity = \"0.6\";\r\n      menuBtn.style.borderRadius = \"3px\";\r\n      menuBtn.title = `${field.name} options`;\r\n\r\n      menuBtn.addEventListener(\"mouseenter\", () => {\r\n        menuBtn.style.opacity = \"1\";\r\n        menuBtn.style.background = \"var(--vscode-toolbar-hoverBackground)\";\r\n      });\r\n\r\n      menuBtn.addEventListener(\"mouseleave\", () => {\r\n        menuBtn.style.opacity = \"0.6\";\r\n        menuBtn.style.background = \"transparent\";\r\n      });\r\n\r\n      menuBtn.addEventListener(\"click\", (e) => {\r\n        e.stopPropagation();\r\n        (th as HTMLElement).style.background =\r\n          \"var(--vscode-sideBar-background)\";\r\n        this.options.onHeaderMenu(e, field, th);\r\n      });\r\n\r\n      headerContent.appendChild(nameSpan);\r\n      if (isSorted || isGrouped || isSliced) {\r\n        headerContent.appendChild(iconsContainer);\r\n      }\r\n      headerContent.appendChild(menuBtn);\r\n      th.appendChild(headerContent);\r\n\r\n      th.addEventListener(\"pointerenter\", () => {\r\n        th.style.background = \"var(--vscode-list-hoverBackground)\";\r\n      });\r\n\r\n      th.addEventListener(\"pointerleave\", () => {\r\n        th.style.background = \"var(--vscode-sideBar-background)\";\r\n      });\r\n\r\n      this.styleHeaderCell(th);\r\n      tr.appendChild(th);\r\n    }\r\n\r\n    // Add Field column (+)\r\n    const thAddField = document.createElement(\"th\");\r\n    const addFieldBtn = document.createElement(\"button\");\r\n    addFieldBtn.textContent = \"+\";\r\n    addFieldBtn.style.background = \"transparent\";\r\n    addFieldBtn.style.border = \"none\";\r\n    addFieldBtn.style.cursor = \"pointer\";\r\n    addFieldBtn.style.fontSize = \"18px\";\r\n    addFieldBtn.style.fontWeight = \"bold\";\r\n    addFieldBtn.style.color = \"var(--vscode-foreground)\";\r\n    addFieldBtn.style.width = \"100%\";\r\n    addFieldBtn.style.height = \"100%\";\r\n    addFieldBtn.title = \"Show hidden fields\";\r\n\r\n    addFieldBtn.addEventListener(\"click\", () =>\r\n      this.options.onShowFieldsMenu(addFieldBtn),\r\n    );\r\n\r\n    thAddField.appendChild(addFieldBtn);\r\n    this.styleHeaderCell(thAddField);\r\n    thAddField.style.textAlign = \"center\";\r\n    thAddField.style.width = \"50px\";\r\n    tr.appendChild(thAddField);\r\n\r\n    thead.appendChild(tr);\r\n    table.appendChild(thead);\r\n  }\r\n\r\n  private styleHeaderCell(th: HTMLTableCellElement) {\r\n    th.style.padding = \"8px\";\r\n    th.style.textAlign = \"left\";\r\n    th.style.whiteSpace = \"nowrap\";\r\n    th.style.overflow = \"hidden\";\r\n    th.style.textOverflow = \"ellipsis\";\r\n    th.style.borderRight = \"1px solid var(--vscode-panel-border)\";\r\n    th.style.borderBottom = \"1px solid var(--vscode-panel-border)\";\r\n    th.style.position = \"sticky\";\r\n    th.style.top = \"0\";\r\n    th.style.zIndex = \"11\";\r\n    th.style.background = \"var(--vscode-sideBar-background)\";\r\n    th.style.height = \"32px\";\r\n    th.style.boxSizing = \"border-box\";\r\n  }\r\n}\r\n", "/**\r\n * Fields Menu\r\n * Dropdown used from table plus-column. Shows project fields split into Visible / Hidden sections\r\n * First item is a \"+ New field\" button. Visible fields show a leading checkmark.\r\n */\r\n\r\nexport interface FieldItem {\r\n  id: string;\r\n  name: string;\r\n  iconClass?: string;\r\n  dataType?: string;\r\n}\r\n\r\nexport interface FieldsMenuOptions {\r\n  fields: FieldItem[];\r\n  visibleFieldIds: Set<string>;\r\n  onToggleVisibility?: (fieldId: string, visible: boolean) => void;\r\n  onCreateField?: () => void;\r\n}\r\n\r\nexport class FieldsMenu {\r\n  private options: FieldsMenuOptions;\r\n  private menuElement: HTMLElement | null = null;\r\n  private backdropElement: HTMLElement | null = null;\r\n\r\n  constructor(options: FieldsMenuOptions) {\r\n    this.options = options;\r\n  }\r\n\r\n  public show(anchorElement: HTMLElement) {\r\n    this.hide();\r\n\r\n    // Backdrop to detect outside clicks\r\n    this.backdropElement = document.createElement(\"div\");\r\n    this.backdropElement.style.position = \"fixed\";\r\n    this.backdropElement.style.top = \"0\";\r\n    this.backdropElement.style.left = \"0\";\r\n    this.backdropElement.style.right = \"0\";\r\n    this.backdropElement.style.bottom = \"0\";\r\n    this.backdropElement.style.zIndex = \"998\";\r\n    this.backdropElement.addEventListener(\"click\", () => this.hide());\r\n    document.body.appendChild(this.backdropElement);\r\n\r\n    // Create menu offscreen first so we can measure size and pick best placement\r\n    this.menuElement = document.createElement(\"div\");\r\n    this.menuElement.className = \"fields-menu\";\r\n    this.menuElement.style.position = \"absolute\";\r\n    this.menuElement.style.visibility = \"hidden\";\r\n    this.menuElement.style.left = \"0px\";\r\n    this.menuElement.style.top = \"0px\";\r\n    this.menuElement.style.background = \"var(--vscode-menu-background)\";\r\n    this.menuElement.style.border = \"1px solid var(--vscode-menu-border)\";\r\n    this.menuElement.style.borderRadius = \"4px\";\r\n    this.menuElement.style.boxShadow = \"0 2px 8px rgba(0,0,0,0.15)\";\r\n    this.menuElement.style.minWidth = \"220px\";\r\n    this.menuElement.style.padding = \"6px 0\";\r\n    // When there are many fields, allow the menu to scroll vertically instead of growing off-screen\r\n    this.menuElement.style.maxHeight = \"60vh\";\r\n    this.menuElement.style.overflowY = \"auto\";\r\n    this.menuElement.style.boxSizing = \"border-box\";\r\n    this.menuElement.style.zIndex = \"1000\";\r\n    this.menuElement.style.fontSize = \"13px\";\r\n\r\n    // Append hidden, build, measure, then position\r\n    document.body.appendChild(this.menuElement);\r\n    this.buildMenu();\r\n\r\n    const rect = anchorElement.getBoundingClientRect();\r\n    const menuRect = this.menuElement.getBoundingClientRect();\r\n    const margin = 8;\r\n    const vw = window.innerWidth || document.documentElement.clientWidth;\r\n    const vh = window.innerHeight || document.documentElement.clientHeight;\r\n\r\n    // Vertical placement: prefer below, otherwise above, else clamp\r\n    let top = rect.bottom + margin;\r\n    if (rect.bottom + menuRect.height + margin > vh) {\r\n      // try above\r\n      if (rect.top - menuRect.height - margin >= 0) {\r\n        top = rect.top - menuRect.height - margin;\r\n      } else {\r\n        // clamp within viewport\r\n        top = Math.max(\r\n          margin,\r\n          Math.min(vh - menuRect.height - margin, rect.bottom + margin),\r\n        );\r\n      }\r\n    }\r\n\r\n    // Horizontal placement: align left by default, but adjust if overflowing\r\n    let left = rect.left;\r\n    if (rect.left + menuRect.width + margin > vw) {\r\n      // try align to right edge of anchor\r\n      left = Math.max(margin, rect.right - menuRect.width);\r\n    }\r\n    // Clamp left\r\n    left = Math.max(margin, Math.min(left, vw - menuRect.width - margin));\r\n\r\n    this.menuElement.style.top = `${Math.round(top)}px`;\r\n    this.menuElement.style.left = `${Math.round(left)}px`;\r\n    this.menuElement.style.visibility = \"visible\";\r\n  }\r\n\r\n  public hide() {\r\n    if (this.menuElement) {\r\n      this.menuElement.remove();\r\n      this.menuElement = null;\r\n    }\r\n    if (this.backdropElement) {\r\n      this.backdropElement.remove();\r\n      this.backdropElement = null;\r\n    }\r\n  }\r\n\r\n  private buildMenu() {\r\n    if (!this.menuElement) return;\r\n\r\n    // Header\r\n    const title = document.createElement(\"div\");\r\n    title.style.display = \"flex\";\r\n    title.style.alignItems = \"center\";\r\n    title.style.padding = \"6px 12px\";\r\n    title.style.fontWeight = \"600\";\r\n    title.style.color = \"var(--vscode-descriptionForeground)\";\r\n    title.style.fontSize = \"12px\";\r\n    title.style.textTransform = \"uppercase\";\r\n\r\n    const icon = document.createElement(\"i\");\r\n    icon.className = \"octicon octicon-note\";\r\n    icon.style.marginRight = \"8px\";\r\n    title.appendChild(icon);\r\n\r\n    const label = document.createElement(\"span\");\r\n    label.textContent = \"Fields\";\r\n    title.appendChild(label);\r\n\r\n    this.menuElement.appendChild(title);\r\n    this.addSeparator();\r\n\r\n    // + New field\r\n    const newField = document.createElement(\"div\");\r\n    newField.style.display = \"flex\";\r\n    newField.style.alignItems = \"center\";\r\n    newField.style.padding = \"6px 12px\";\r\n    newField.style.cursor = \"pointer\";\r\n    newField.style.color = \"var(--vscode-menu-foreground)\";\r\n    newField.innerHTML = `<span style=\"margin-right:8px;font-weight:700\">+</span><span>New field</span>`;\r\n    newField.addEventListener(\"mouseenter\", () => {\r\n      newField.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n      newField.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n    });\r\n    newField.addEventListener(\"mouseleave\", () => {\r\n      newField.style.background = \"transparent\";\r\n      newField.style.color = \"var(--vscode-menu-foreground)\";\r\n    });\r\n    newField.addEventListener(\"click\", () => {\r\n      this.options.onCreateField?.();\r\n      this.hide();\r\n    });\r\n    this.menuElement.appendChild(newField);\r\n\r\n    this.addSeparator();\r\n\r\n    const visible = this.options.fields.filter((f) =>\r\n      this.options.visibleFieldIds.has(f.id),\r\n    );\r\n    const hidden = this.options.fields.filter(\r\n      (f) => !this.options.visibleFieldIds.has(f.id),\r\n    );\r\n\r\n    this.addSectionHeader(\"Visible fields\");\r\n    if (visible.length === 0) this.addEmptyRow(\"No visible fields\");\r\n    else visible.forEach((f) => this.addFieldRow(f, true));\r\n\r\n    this.addSeparator();\r\n\r\n    this.addSectionHeader(\"Hidden fields\");\r\n    if (hidden.length === 0) this.addEmptyRow(\"No hidden fields\");\r\n    else hidden.forEach((f) => this.addFieldRow(f, false));\r\n  }\r\n\r\n  private addSectionHeader(text: string) {\r\n    if (!this.menuElement) return;\r\n    const h = document.createElement(\"div\");\r\n    h.textContent = text;\r\n    h.style.padding = \"6px 12px\";\r\n    h.style.fontSize = \"11px\";\r\n    h.style.fontWeight = \"600\";\r\n    h.style.color = \"var(--vscode-descriptionForeground)\";\r\n    h.style.textTransform = \"uppercase\";\r\n    this.menuElement.appendChild(h);\r\n  }\r\n  private addEmptyRow(text: string) {\r\n    if (!this.menuElement) return;\r\n    const r = document.createElement(\"div\");\r\n    r.textContent = text;\r\n    r.style.padding = \"6px 12px\";\r\n    r.style.color = \"var(--vscode-menu-foreground)\";\r\n    r.style.opacity = \"0.8\";\r\n    this.menuElement.appendChild(r);\r\n  }\r\n\r\n  private addFieldRow(field: FieldItem, visible: boolean) {\r\n    if (!this.menuElement) return;\r\n    const row = document.createElement(\"div\");\r\n    row.style.display = \"flex\";\r\n    row.style.alignItems = \"center\";\r\n    row.style.padding = \"6px 12px\";\r\n    row.style.cursor = \"pointer\";\r\n    row.style.color = \"var(--vscode-menu-foreground)\";\r\n\r\n    if (visible) {\r\n      const c = document.createElement(\"span\");\r\n      c.textContent = \"\u2713\";\r\n      c.style.marginRight = \"8px\";\r\n      c.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n      row.appendChild(c);\r\n    } else {\r\n      const s = document.createElement(\"span\");\r\n      s.style.display = \"inline-block\";\r\n      s.style.width = \"14px\";\r\n      s.style.marginRight = \"8px\";\r\n      row.appendChild(s);\r\n    }\r\n\r\n    // Determine icon SVG based on field dataType or provided iconClass. Use placeholder tokens for octicon paths so user can replace them later.\r\n    const iconHtml = this.getIconForField(field);\r\n    const icon = document.createElement(\"span\");\r\n    icon.innerHTML = iconHtml;\r\n    icon.style.marginRight = \"8px\";\r\n    icon.style.display = \"inline-flex\";\r\n    icon.style.alignItems = \"center\";\r\n    row.appendChild(icon);\r\n    const label = document.createElement(\"span\");\r\n    label.textContent = field.name;\r\n    label.style.flex = \"1\";\r\n    label.style.whiteSpace = \"nowrap\";\r\n    label.style.overflow = \"hidden\";\r\n    label.style.textOverflow = \"ellipsis\";\r\n    row.appendChild(label);\r\n\r\n    row.addEventListener(\"mouseenter\", () => {\r\n      row.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n      row.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n    });\r\n    row.addEventListener(\"mouseleave\", () => {\r\n      row.style.background = \"transparent\";\r\n      row.style.color = \"var(--vscode-menu-foreground)\";\r\n    });\r\n    row.addEventListener(\"click\", () => {\r\n      const newVisible = !visible;\r\n      this.options.onToggleVisibility?.(field.id, newVisible);\r\n      if (newVisible) this.options.visibleFieldIds.add(field.id);\r\n      else this.options.visibleFieldIds.delete(field.id);\r\n      this.menuElement && ((this.menuElement.innerHTML = \"\"), this.buildMenu());\r\n    });\r\n\r\n    this.menuElement.appendChild(row);\r\n  }\r\n\r\n  private addSeparator() {\r\n    if (!this.menuElement) return;\r\n    const s = document.createElement(\"div\");\r\n    s.style.height = \"1px\";\r\n    s.style.background = \"var(--vscode-menu-separatorBackground)\";\r\n    s.style.margin = \"6px 0\";\r\n    this.menuElement.appendChild(s);\r\n  }\r\n\r\n  /**\r\n   * Return inline SVG HTML for the given field using the icon registry.\r\n   */\r\n  private getIconForField(field: FieldItem): string {\r\n    const dataType = (field.dataType || \"\").toString().toLowerCase();\r\n\r\n    // If getIconNameForDataType is available from the icon registry, use it\r\n    if (typeof (window as any).getIconNameForDataType === \"function\" && typeof (window as any).getIconSvg === \"function\") {\r\n      const iconName = (window as any).getIconNameForDataType(dataType);\r\n      return (window as any).getIconSvg(iconName);\r\n    }\r\n\r\n    // Fallback: use provided CSS iconClass if available\r\n    if (field.iconClass) {\r\n      return `<i class=\"${field.iconClass}\"></i>`;\r\n    }\r\n\r\n    // Ultimate fallback: empty span\r\n    return '<span></span>';\r\n  }\r\n}\r\n\r\nexport default FieldsMenu;\r\n", "export function escapeHtml(s: any): string {\r\n  return s\r\n    ? String(s)\r\n        .replace(/&/g, \"&amp;\")\r\n        .replace(/</g, \"&lt;\")\r\n        .replace(/>/g, \"&gt;\")\r\n    : \"\";\r\n}\r\n\r\nexport function normalizeColor(color: any): string | null {\r\n  if (!color) return null;\r\n  let n = String(color).trim();\r\n  if (\r\n    /^#?[0-9a-f]{3}$/i.test(n) ||\r\n    /^#?[0-9a-f]{6}$/i.test(n) ||\r\n    /^#?[0-9a-f]{8}$/i.test(n)\r\n  ) {\r\n    let b = n[0] === \"#\" ? n.slice(1) : n;\r\n    return \"#\" + (b.length === 8 ? b.substring(0, 6) : b);\r\n  }\r\n  let s = {\r\n    GRAY: \"#848d97\",\r\n    RED: \"#f85149\",\r\n    ORANGE: \"#db6d28\",\r\n    YELLOW: \"#d29922\",\r\n    GREEN: \"#3fb950\",\r\n    BLUE: \"#2f81f7\",\r\n    PURPLE: \"#a371f7\",\r\n    PINK: \"#db61a2\",\r\n    BLACK: \"#000000\",\r\n    WHITE: \"#ffffff\",\r\n  };\r\n  let u = n.toUpperCase();\r\n  return (s as any)[u] || null;\r\n}\r\n\r\nexport function addAlpha(color: any, alpha: any): string | null {\r\n  if (!color) return null;\r\n  let s = color.replace(\"#\", \"\");\r\n  let u = (b: any) => parseInt(b, 16);\r\n  if (s.length === 3) {\r\n    let b = u(s[0] + s[0]),\r\n      S = u(s[1] + s[1]),\r\n      v = u(s[2] + s[2]);\r\n    return \"rgba(\" + b + \",\" + S + \",\" + v + \",\" + alpha + \")\";\r\n  }\r\n  if (s.length === 6 || s.length === 8) {\r\n    let b = s.length === 8 ? s.substring(0, 6) : s,\r\n      S = u(s.substring(0, 2)),\r\n      v = u(b.substring(2, 4)),\r\n      C = u(b.substring(4, 6));\r\n    return \"rgba(\" + S + \",\" + v + \",\" + C + \",\" + alpha + \")\";\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function getContrastColor(color: any): string {\r\n  if (!color) return \"#333333\";\r\n  let n = color.replace(\"#\", \"\");\r\n  let s = (C: any) => parseInt(C, 16);\r\n  let u, b, S;\r\n  if (n.length === 3)\r\n    ((u = s(n[0] + n[0])), (b = s(n[1] + n[1])), (S = s(n[2] + n[2])));\r\n  else if (n.length === 6 || n.length === 8) {\r\n    let C = n.length === 8 ? n.substring(0, 6) : n;\r\n    ((u = s(C.substring(0, 2))),\r\n      (b = s(C.substring(2, 4))),\r\n      (S = s(C.substring(4, 6))));\r\n  } else return \"#333333\";\r\n  return 0.2126 * (u / 255) + 0.7152 * (b / 255) + 0.0722 * (S / 255) > 0.6\r\n    ? \"#111111\"\r\n    : \"#ffffff\";\r\n}\r\n", "/**\r\n * Slice Panel Component\r\n * Shows unique values for a field with counts, allowing quick filtering\r\n */\r\n\r\nimport { normalizeColor, escapeHtml } from \"../utils\";\r\n\r\nexport class SlicePanel {\r\n  private container: HTMLElement;\r\n  private field: any;\r\n  private items: any[];\r\n  private panelElement: HTMLElement | null = null;\r\n  private onValueSelectCallback?: (value: any) => void;\r\n  private onFieldChangeCallback?: (field: any) => void;\r\n  private allFields: any[];\r\n\r\n  constructor(\r\n    container: HTMLElement,\r\n    field: any,\r\n    items: any[],\r\n    allFields?: any[],\r\n  ) {\r\n    this.container = container;\r\n    this.field = field;\r\n    this.items = items;\r\n    this.allFields = allFields || [];\r\n  }\r\n\r\n  /**\r\n   * Render the slice panel\r\n   */\r\n  public render(): void {\r\n    this.close(); // Close any existing panel\r\n\r\n    // Create panel\r\n    this.panelElement = document.createElement(\"div\");\r\n    this.panelElement.className = \"slice-panel\";\r\n    this.panelElement.style.position = \"relative\";\r\n    this.panelElement.style.float = \"left\";\r\n    // Restore persisted width if available\r\n    try {\r\n      const stored = localStorage.getItem(\"ghProjects.slicePanel.width\");\r\n      if (stored) this.panelElement.style.width = stored;\r\n      else this.panelElement.style.width = \"280px\";\r\n    } catch (e) {\r\n      this.panelElement.style.width = \"280px\";\r\n    }\r\n    this.panelElement.style.marginRight = \"12px\";\r\n    this.panelElement.style.background = \"var(--vscode-sideBar-background)\";\r\n    this.panelElement.style.border = \"1px solid var(--vscode-sideBar-border)\";\r\n    this.panelElement.style.borderRadius = \"6px\";\r\n    this.panelElement.style.display = \"flex\";\r\n    this.panelElement.style.flexDirection = \"column\";\r\n    this.panelElement.style.overflow = \"hidden\";\r\n    this.panelElement.style.maxHeight = \"600px\";\r\n\r\n    // Temporary debug overlay: shows last resolved parent metadata and progress\r\n    const debugOverlay = document.createElement(\"pre\");\r\n    debugOverlay.className = \"slice-panel-debug-overlay\";\r\n    debugOverlay.style.position = \"absolute\";\r\n    debugOverlay.style.left = \"8px\";\r\n    debugOverlay.style.bottom = \"8px\";\r\n    debugOverlay.style.right = \"8px\";\r\n    debugOverlay.style.maxHeight = \"120px\";\r\n    debugOverlay.style.overflow = \"auto\";\r\n    debugOverlay.style.background = \"rgba(0,0,0,0.6)\";\r\n    debugOverlay.style.color = \"white\";\r\n    debugOverlay.style.fontSize = \"11px\";\r\n    debugOverlay.style.padding = \"8px\";\r\n    debugOverlay.style.borderRadius = \"6px\";\r\n    debugOverlay.style.zIndex = \"200\";\r\n    debugOverlay.style.display = \"none\"; // hidden by default\r\n    debugOverlay.title = \"SlicePanel debug (click to show/hide)\";\r\n    debugOverlay.addEventListener(\"click\", () => {\r\n      debugOverlay.style.display =\r\n        debugOverlay.style.display === \"none\" ? \"block\" : \"none\";\r\n    });\r\n    this.panelElement.appendChild(debugOverlay);\r\n\r\n    // Add resizer on the right edge to allow adjusting panel width\r\n    const resizer = document.createElement(\"div\");\r\n    resizer.className = \"slice-panel-resizer\";\r\n    resizer.style.position = \"absolute\";\r\n    resizer.style.top = \"0\";\r\n    resizer.style.right = \"0\";\r\n    resizer.style.bottom = \"0\";\r\n    resizer.style.width = \"6px\";\r\n    resizer.style.cursor = \"col-resize\";\r\n    resizer.style.zIndex = \"100\";\r\n    this.panelElement.appendChild(resizer);\r\n\r\n    let startX: number | null = null;\r\n    let startWidth: number | null = null;\r\n\r\n    const onMouseMove = (e: MouseEvent) => {\r\n      if (startX == null || startWidth == null) return;\r\n      const dx = e.pageX - startX;\r\n      const newW = Math.max(160, startWidth + dx);\r\n      this.panelElement!.style.width = newW + \"px\";\r\n    };\r\n\r\n    const onMouseUp = () => {\r\n      if (startX == null) return;\r\n      document.removeEventListener(\"mousemove\", onMouseMove);\r\n      document.removeEventListener(\"mouseup\", onMouseUp);\r\n      try {\r\n        localStorage.setItem(\r\n          \"ghProjects.slicePanel.width\",\r\n          this.panelElement!.style.width,\r\n        );\r\n      } catch (e) {}\r\n      startX = null;\r\n      startWidth = null;\r\n    };\r\n\r\n    resizer.addEventListener(\"mousedown\", (ev: MouseEvent) => {\r\n      ev.preventDefault();\r\n      startX = ev.pageX;\r\n      startWidth = this.panelElement ? this.panelElement.offsetWidth : 280;\r\n      document.addEventListener(\"mousemove\", onMouseMove);\r\n      document.addEventListener(\"mouseup\", onMouseUp);\r\n    });\r\n\r\n    // Header with dropdown\r\n    const header = document.createElement(\"div\");\r\n    header.style.padding = \"12px\";\r\n    header.style.borderBottom = \"1px solid var(--vscode-sideBar-border)\";\r\n    header.style.display = \"flex\";\r\n    header.style.flexDirection = \"column\";\r\n    header.style.gap = \"8px\";\r\n\r\n    const headerTop = document.createElement(\"div\");\r\n    headerTop.style.display = \"flex\";\r\n    headerTop.style.alignItems = \"center\";\r\n    headerTop.style.gap = \"8px\";\r\n\r\n    const sliceLabel = document.createElement(\"span\");\r\n    sliceLabel.textContent = \"Slice by\";\r\n    sliceLabel.style.fontSize = \"11px\";\r\n    sliceLabel.style.fontWeight = \"600\";\r\n    sliceLabel.style.color = \"var(--vscode-descriptionForeground)\";\r\n    sliceLabel.style.textTransform = \"uppercase\";\r\n    sliceLabel.style.letterSpacing = \"0.5px\";\r\n    headerTop.appendChild(sliceLabel);\r\n\r\n    // Field dropdown/button\r\n    const fieldButton = document.createElement(\"button\");\r\n    fieldButton.textContent = this.field.name;\r\n    fieldButton.style.flex = \"1\";\r\n    fieldButton.style.padding = \"6px 12px\";\r\n    fieldButton.style.background = \"var(--vscode-button-secondaryBackground)\";\r\n    fieldButton.style.color = \"var(--vscode-button-secondaryForeground)\";\r\n    fieldButton.style.border = \"1px solid var(--vscode-button-border)\";\r\n    fieldButton.style.borderRadius = \"4px\";\r\n    fieldButton.style.cursor = \"pointer\";\r\n    fieldButton.style.fontSize = \"13px\";\r\n    fieldButton.style.fontWeight = \"500\";\r\n    fieldButton.style.textAlign = \"left\";\r\n    fieldButton.style.display = \"flex\";\r\n    fieldButton.style.justifyContent = \"space-between\";\r\n    fieldButton.style.alignItems = \"center\";\r\n\r\n    // Add dropdown arrow\r\n    const arrow = document.createElement(\"span\");\r\n    arrow.textContent = \"\u25BC\";\r\n    arrow.style.fontSize = \"10px\";\r\n    arrow.style.marginLeft = \"auto\";\r\n    fieldButton.appendChild(arrow);\r\n\r\n    // Add dropdown menu on click\r\n    fieldButton.addEventListener(\"click\", (e) => {\r\n      e.stopPropagation();\r\n      this.showFieldDropdown(fieldButton);\r\n    });\r\n\r\n    headerTop.appendChild(fieldButton);\r\n    header.appendChild(headerTop);\r\n\r\n    this.panelElement.appendChild(header);\r\n\r\n    // Content\r\n    const content = document.createElement(\"div\");\r\n    content.style.flex = \"1\";\r\n    content.style.overflow = \"auto\";\r\n    content.style.padding = \"8px\";\r\n\r\n    this.renderValues(content);\r\n\r\n    this.panelElement.appendChild(content);\r\n    this.container.appendChild(this.panelElement);\r\n  }\r\n\r\n  /**\r\n   * Show dropdown menu to select a different field\r\n   */\r\n  private showFieldDropdown(anchorButton: HTMLElement): void {\r\n    // Get sliceable fields\r\n    const sliceableTypes = new Set([\r\n      \"assignees\",\r\n      \"single_select\",\r\n      \"parent_issue\",\r\n      \"iteration\",\r\n      \"number\",\r\n      \"date\",\r\n      \"milestone\",\r\n      \"repository\",\r\n      \"labels\",\r\n    ]);\r\n\r\n    const sliceableFields = this.allFields.filter((f) => {\r\n      const dataType = (f.dataType || \"\").toLowerCase();\r\n      return sliceableTypes.has(dataType);\r\n    });\r\n\r\n    if (sliceableFields.length === 0) return;\r\n\r\n    // Create dropdown\r\n    const dropdown = document.createElement(\"div\");\r\n    dropdown.style.position = \"absolute\";\r\n    dropdown.style.top = `${anchorButton.getBoundingClientRect().bottom + 4}px`;\r\n    dropdown.style.left = `${anchorButton.getBoundingClientRect().left}px`;\r\n    dropdown.style.minWidth = `${anchorButton.offsetWidth}px`;\r\n    dropdown.style.background = \"var(--vscode-dropdown-background)\";\r\n    dropdown.style.border = \"1px solid var(--vscode-dropdown-border)\";\r\n    dropdown.style.borderRadius = \"4px\";\r\n    dropdown.style.boxShadow = \"0 4px 8px rgba(0,0,0,0.2)\";\r\n    dropdown.style.zIndex = \"1000\";\r\n    dropdown.style.maxHeight = \"300px\";\r\n    dropdown.style.overflowY = \"auto\";\r\n\r\n    sliceableFields.forEach((field) => {\r\n      const item = document.createElement(\"div\");\r\n      item.style.display = \"flex\";\r\n      item.style.alignItems = \"center\";\r\n\r\n      // Icon for field type\r\n      const iconSpan = document.createElement(\"span\");\r\n      iconSpan.style.display = \"inline-flex\";\r\n      iconSpan.style.alignItems = \"center\";\r\n      iconSpan.style.justifyContent = \"center\";\r\n      iconSpan.style.width = \"18px\";\r\n      iconSpan.style.marginRight = \"8px\";\r\n      iconSpan.innerHTML = this.getIconForDataType(\r\n        (field.dataType || \"\").toString().toLowerCase(),\r\n      );\r\n      item.appendChild(iconSpan);\r\n\r\n      const labelSpan = document.createElement(\"span\");\r\n      labelSpan.textContent = field.name;\r\n      item.appendChild(labelSpan);\r\n      item.style.padding = \"8px 12px\";\r\n      item.style.cursor = \"pointer\";\r\n      item.style.fontSize = \"13px\";\r\n      item.style.color = \"var(--vscode-dropdown-foreground)\";\r\n\r\n      if (field.id === this.field.id) {\r\n        item.style.background = \"var(--vscode-list-activeSelectionBackground)\";\r\n        item.style.color = \"var(--vscode-list-activeSelectionForeground)\";\r\n      }\r\n\r\n      item.addEventListener(\"mouseenter\", () => {\r\n        if (field.id !== this.field.id) {\r\n          item.style.background = \"var(--vscode-list-hoverBackground)\";\r\n        }\r\n      });\r\n\r\n      item.addEventListener(\"mouseleave\", () => {\r\n        if (field.id !== this.field.id) {\r\n          item.style.background = \"transparent\";\r\n        }\r\n      });\r\n\r\n      item.addEventListener(\"click\", () => {\r\n        this.field = field;\r\n        dropdown.remove();\r\n        backdrop.remove();\r\n        this.render();\r\n        if (this.onFieldChangeCallback) {\r\n          this.onFieldChangeCallback(field);\r\n        }\r\n      });\r\n\r\n      dropdown.appendChild(item);\r\n    });\r\n\r\n    // Backdrop to close dropdown\r\n    const backdrop = document.createElement(\"div\");\r\n    backdrop.style.position = \"fixed\";\r\n    backdrop.style.top = \"0\";\r\n    backdrop.style.left = \"0\";\r\n    backdrop.style.right = \"0\";\r\n    backdrop.style.bottom = \"0\";\r\n    backdrop.style.zIndex = \"999\";\r\n\r\n    backdrop.addEventListener(\"click\", () => {\r\n      dropdown.remove();\r\n      backdrop.remove();\r\n    });\r\n\r\n    document.body.appendChild(backdrop);\r\n    document.body.appendChild(dropdown);\r\n  }\r\n\r\n  /**\r\n   * Return inline SVG HTML for a given dataType using the icon registry.\r\n   */\r\n  private getIconForDataType(dataType: string): string {\r\n    // Use the icon registry if available (shared with FieldsMenu)\r\n    if (typeof (window as any).getIconNameForDataType === \"function\" && typeof (window as any).getIconSvg === \"function\") {\r\n      const iconName = (window as any).getIconNameForDataType(dataType);\r\n      return (window as any).getIconSvg(iconName);\r\n    }\r\n\r\n    // Fallback: empty span\r\n    return '<span></span>';\r\n  }\r\n\r\n  /**\r\n   * Render the list of unique values with counts\r\n   */\r\n  private renderValues(container: HTMLElement): void {\r\n    // Get unique values and their counts\r\n    const valueCounts = this.getValueCounts();\r\n\r\n    if (valueCounts.size === 0) {\r\n      const empty = document.createElement(\"div\");\r\n      empty.textContent = \"No values\";\r\n      empty.style.padding = \"8px\";\r\n      empty.style.color = \"var(--vscode-descriptionForeground)\";\r\n      container.appendChild(empty);\r\n      return;\r\n    }\r\n\r\n    // Sort by count (descending)\r\n    const sorted = Array.from(valueCounts.entries()).sort(\r\n      (a, b) => b[1].count - a[1].count,\r\n    );\r\n\r\n    // Helper: resolve parent item and compute progress (done/total/pct)\r\n    const resolveParentProgress = (parentMeta: any) => {\r\n      const result: any = {\r\n        resolved: null,\r\n        statusColor: null,\r\n        number: null,\r\n        title: null,\r\n        done: 0,\r\n        total: 0,\r\n        pct: 0,\r\n      };\r\n      if (!parentMeta) return result;\r\n\r\n      // Build identifier list from parentMeta\r\n      const identifiers: string[] = [];\r\n      if (parentMeta.number) identifiers.push(String(parentMeta.number));\r\n      if (parentMeta.id) identifiers.push(String(parentMeta.id));\r\n      if (parentMeta.url) identifiers.push(String(parentMeta.url));\r\n      if (parentMeta.title) identifiers.push(String(parentMeta.title));\r\n\r\n      // Try to find a matching item in this.items (same logic as grouping header resolution)\r\n      const found = this.items.find((A: any) => {\r\n        const d = (A && (A.content || (A.raw && A.raw.itemContent))) || null;\r\n        if (!d) return false;\r\n        const M: string[] = [];\r\n        if (d.number) M.push(String(d.number));\r\n        if (d.id) M.push(String(d.id));\r\n        if (d.url) M.push(String(d.url));\r\n        if (d.title) M.push(String(d.title));\r\n        if (d.name) M.push(String(d.name));\r\n        if (d.raw && d.raw.number) M.push(String(d.raw.number));\r\n        if (d.raw && d.raw.id) M.push(String(d.raw.id));\r\n        if (d.raw && d.raw.url) M.push(String(d.raw.url));\r\n        for (let o of identifiers) {\r\n          for (let m of M) {\r\n            if (o && m && String(o) === String(m)) return true;\r\n          }\r\n        }\r\n        return false;\r\n      });\r\n\r\n      if (!found) return result; // single strategy: only use resolved item in snapshot\r\n\r\n      result.resolved = found;\r\n      const content =\r\n        found.content || (found.raw && found.raw.itemContent) || null;\r\n      result.title =\r\n        content && (content.title || content.name)\r\n          ? content.title || content.name\r\n          : found.title || found.name || null;\r\n      result.number =\r\n        content && content.number\r\n          ? String(content.number)\r\n          : found.number || found.id || null;\r\n\r\n      // Determine status color from single_select field in parent (if present)\r\n      if (Array.isArray(found.fieldValues)) {\r\n        const statusFV = found.fieldValues.find(\r\n          (v: any) =>\r\n            v && v.type === \"single_select\" && v.option && v.option.name,\r\n        );\r\n        if (statusFV && statusFV.option) {\r\n          try {\r\n            const c =\r\n              statusFV.option.color ||\r\n              statusFV.option.id ||\r\n              statusFV.option.name ||\r\n              null;\r\n            result.statusColor = normalizeColor(c) || null;\r\n          } catch (e) {}\r\n        }\r\n\r\n        // Try to read aggregate progress field (sub_issues_progress or synthesized with total/done)\r\n        const agg = found.fieldValues.find(\r\n          (v: any) =>\r\n            v &&\r\n            (v.type === \"sub_issues_progress\" ||\r\n              (v.total != null && v.done != null)),\r\n        );\r\n        if (agg && agg.total != null) {\r\n          result.total = Number(agg.total || 0);\r\n          result.done = Number(agg.done || 0);\r\n          result.pct =\r\n            result.total > 0\r\n              ? Math.round((result.done / result.total) * 100)\r\n              : 0;\r\n        }\r\n      }\r\n\r\n      return result;\r\n    };\r\n\r\n    // Render each value with grouping-style presentation\r\n    sorted.forEach(([key, { value, count, rawValue }]) => {\r\n      const item = document.createElement(\"div\");\r\n      item.className = \"slice-value-item\";\r\n      item.style.padding = \"10px 12px\";\r\n      item.style.cursor = \"pointer\";\r\n      item.style.borderRadius = \"4px\";\r\n      item.style.marginBottom = \"4px\";\r\n      item.style.display = \"flex\";\r\n      item.style.alignItems = \"center\";\r\n      item.style.gap = \"8px\";\r\n      item.style.transition = \"background-color 0.15s ease\";\r\n\r\n      const dataType = (this.field.dataType || \"\").toLowerCase();\r\n\r\n      // Normalize parent meta for this iteration so both visual and label rendering use the same source\r\n      let parentMetaForIteration: any = null;\r\n      if (dataType === \"parent_issue\" && rawValue) {\r\n        parentMetaForIteration =\r\n          rawValue.parent ||\r\n          rawValue.parentIssue ||\r\n          rawValue.issue ||\r\n          rawValue.item ||\r\n          rawValue.value ||\r\n          rawValue;\r\n      }\r\n\r\n      // Left visual area: avatar / color dot / repo icon\r\n      const leftVisual = document.createElement(\"div\");\r\n      leftVisual.style.display = \"flex\";\r\n      leftVisual.style.alignItems = \"center\";\r\n      leftVisual.style.gap = \"8px\";\r\n      leftVisual.style.flex = \"0 0 auto\";\r\n\r\n      // Helper: create a color dot\r\n      const makeColorDot = (c: string | null) => {\r\n        const dot = document.createElement(\"span\");\r\n        dot.style.display = \"inline-block\";\r\n        dot.style.width = \"12px\";\r\n        dot.style.height = \"12px\";\r\n        dot.style.borderRadius = \"50%\";\r\n        dot.style.flexShrink = \"0\";\r\n        dot.style.backgroundColor = c || \"var(--vscode-descriptionForeground)\";\r\n        return dot;\r\n      };\r\n\r\n      let visualAppended = false;\r\n\r\n      // Assignees: rawValue may be an individual assignee object (from getValueCounts)\r\n      if (dataType === \"assignees\" && rawValue) {\r\n        const a = rawValue;\r\n        const avatarUrl =\r\n          a && (a.avatarUrl || a.avatar || a.imageUrl || a.avatar_url);\r\n        if (avatarUrl) {\r\n          const avatarEl = document.createElement(\"span\");\r\n          avatarEl.innerHTML =\r\n            '<span title=\"' +\r\n            escapeHtml(a.login || a.name || a.id || \"\") +\r\n            '\" style=\"display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url(' +\r\n            escapeHtml(avatarUrl) +\r\n            ');border:2px solid var(--vscode-editor-background)\"></span>';\r\n          leftVisual.appendChild(avatarEl);\r\n          visualAppended = true;\r\n        } else {\r\n          // fallback color dot\r\n          leftVisual.appendChild(makeColorDot(null));\r\n          visualAppended = true;\r\n        }\r\n      }\r\n\r\n      // Repository: show repo icon\r\n      if (!visualAppended && dataType === \"repository\") {\r\n        const repoIcon = document.createElement(\"span\");\r\n        repoIcon.innerHTML =\r\n          '<svg width=\"14\" height=\"14\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style=\"flex-shrink:0;color:var(--vscode-icon-foreground)\"><path fill=\"currentColor\" d=\"M2 2.5A1.5 1.5 0 0 1 3.5 1h9A1.5 1.5 0 0 1 14 2.5v11A1.5 1.5 0 0 1 12.5 15h-9A1.5 1.5 0 0 1 2 13.5v-11zM3.5 2A.5.5 0 0 0 3 2.5V4h10V2.5a.5.5 0 0 0-.5-.5h-9z\"/></svg>';\r\n        leftVisual.appendChild(repoIcon);\r\n        visualAppended = true;\r\n      }\r\n\r\n      // Parent issue: try to extract parent title and show a color dot (use resolved parent status color if possible)\r\n      if (!visualAppended && dataType === \"parent_issue\") {\r\n        const prog = parentMetaForIteration\r\n          ? resolveParentProgress(parentMetaForIteration)\r\n          : null;\r\n        // Prefer status color from resolved parent progress, then try parentMeta.option/color fields\r\n        let dotColor = prog && prog.statusColor ? prog.statusColor : null;\r\n        if (!dotColor && parentMetaForIteration) {\r\n          dotColor =\r\n            normalizeColor(\r\n              parentMetaForIteration.color ||\r\n                (parentMetaForIteration.option &&\r\n                  parentMetaForIteration.option.color) ||\r\n                parentMetaForIteration.statusColor ||\r\n                parentMetaForIteration.status?.color,\r\n            ) || null;\r\n        }\r\n\r\n        if (\r\n          parentMetaForIteration &&\r\n          (parentMetaForIteration.title ||\r\n            parentMetaForIteration.name ||\r\n            parentMetaForIteration.number ||\r\n            (prog && (prog.title || prog.number)))\r\n        ) {\r\n          const pd = makeColorDot(dotColor);\r\n          leftVisual.appendChild(pd);\r\n          visualAppended = true;\r\n        }\r\n      }\r\n\r\n      // Labels: ensure label color dot comes from label metadata\r\n      if (!visualAppended && dataType === \"labels\" && rawValue) {\r\n        // rawValue here is the individual label object\r\n        const lab = rawValue;\r\n        const colorCandidate =\r\n          lab && (lab.color || lab.colorName || lab.hex || lab.name);\r\n        const normalized = normalizeColor(colorCandidate);\r\n        leftVisual.appendChild(makeColorDot(normalized));\r\n        visualAppended = true;\r\n      }\r\n\r\n      // If still no specialized visual, fall back to normalized color from options/iterations\r\n      if (!visualAppended) {\r\n        let colorVal: any = null;\r\n        if (dataType === \"single_select\" && rawValue && rawValue.option) {\r\n          colorVal =\r\n            rawValue.option.color || rawValue.option.name || rawValue.option.id;\r\n        }\r\n        // If repository/parent/iteration/milestone provide color directly, prefer it\r\n        if (!colorVal && rawValue && (rawValue.color || rawValue.colorName)) {\r\n          colorVal = rawValue.color || rawValue.colorName;\r\n        }\r\n        if (!colorVal && Array.isArray(this.field.options)) {\r\n          try {\r\n            const found = (this.field.options || []).find(\r\n              (o: any) =>\r\n                String(o.name) === String(key) ||\r\n                String(o.id) ===\r\n                  String(\r\n                    rawValue &&\r\n                      (rawValue.optionId ||\r\n                        (rawValue.option && rawValue.option.id)),\r\n                  ),\r\n            );\r\n            if (found) colorVal = found.color || found.name || found.id;\r\n          } catch (e) {}\r\n        }\r\n        if (\r\n          !colorVal &&\r\n          this.field &&\r\n          this.field.configuration &&\r\n          Array.isArray(this.field.configuration.iterations)\r\n        ) {\r\n          try {\r\n            const iter = (this.field.configuration.iterations || []).find(\r\n              (it: any) =>\r\n                String(it.title) === String(key) ||\r\n                String(it.id) ===\r\n                  String(\r\n                    rawValue &&\r\n                      (rawValue.iterationId ||\r\n                        (rawValue.iteration && rawValue.iteration.id)),\r\n                  ),\r\n            );\r\n            if (iter)\r\n              colorVal = iter.color || iter.name || iter.title || iter.id;\r\n          } catch (e) {}\r\n        }\r\n        const normalized = normalizeColor(colorVal);\r\n        leftVisual.appendChild(makeColorDot(normalized));\r\n      }\r\n\r\n      item.appendChild(leftVisual);\r\n\r\n      // Label column\r\n      const labelColumn = document.createElement(\"div\");\r\n      labelColumn.style.flex = \"1\";\r\n      labelColumn.style.display = \"flex\";\r\n      labelColumn.style.flexDirection = \"column\";\r\n      labelColumn.style.minWidth = \"0\";\r\n\r\n      // For parent_issue we render a custom header below (avoid duplicating the generic label)\r\n      let label: HTMLElement | null = null;\r\n      if (dataType !== \"parent_issue\") {\r\n        label = document.createElement(\"span\");\r\n        label.textContent = key;\r\n        label.style.fontSize = \"13px\";\r\n        label.style.fontWeight = \"500\";\r\n        // Allow wrapping to next line instead of overflowing\r\n        label.style.whiteSpace = \"normal\";\r\n        label.style.wordBreak = \"break-word\";\r\n        label.style.overflow = \"hidden\";\r\n        labelColumn.appendChild(label);\r\n      }\r\n\r\n      // Add description for single_select\r\n      if (dataType === \"single_select\") {\r\n        // Prefer metadata description from field.options if available, else rawValue.option.description\r\n        let descText: string | null = null;\r\n        try {\r\n          if (rawValue && rawValue.option && rawValue.option.description)\r\n            descText = rawValue.option.description;\r\n          else if (Array.isArray(this.field.options)) {\r\n            const found = (this.field.options || []).find(\r\n              (o: any) =>\r\n                String(o.name) === String(key) ||\r\n                String(o.id) ===\r\n                  String(\r\n                    rawValue &&\r\n                      (rawValue.optionId ||\r\n                        (rawValue.option && rawValue.option.id)),\r\n                  ),\r\n            );\r\n            if (found && found.description) descText = found.description;\r\n          }\r\n        } catch (e) {}\r\n\r\n        if (descText) {\r\n          const desc = document.createElement(\"span\");\r\n          desc.textContent = descText;\r\n          desc.style.fontSize = \"11px\";\r\n          desc.style.color = \"var(--vscode-descriptionForeground)\";\r\n          desc.style.whiteSpace = \"normal\";\r\n          desc.style.wordBreak = \"break-word\";\r\n          desc.style.overflow = \"hidden\";\r\n          desc.style.maxHeight = \"3.6em\";\r\n          labelColumn.appendChild(desc);\r\n        }\r\n      }\r\n\r\n      // For parent_issue, show title snippet if available\r\n      if (dataType === \"parent_issue\" && rawValue) {\r\n        const p =\r\n          parentMetaForIteration ||\r\n          rawValue.parent ||\r\n          rawValue.parentIssue ||\r\n          rawValue.issue ||\r\n          rawValue.item ||\r\n          rawValue.value ||\r\n          null;\r\n        const prog = resolveParentProgress(p);\r\n        // Title + number\r\n        const titleText = prog.title || (p && (p.title || p.name)) || key;\r\n        const titleEl = document.createElement(\"div\");\r\n        titleEl.style.display = \"flex\";\r\n        titleEl.style.gap = \"8px\";\r\n        titleEl.style.alignItems = \"baseline\";\r\n        const tspan = document.createElement(\"span\");\r\n        // Append number inline into the title text so it appears immediately after the title\r\n        const displayedTitle = String(titleText).slice(0, 120);\r\n        tspan.textContent = prog.number\r\n          ? `${displayedTitle} #${String(prog.number)}`\r\n          : displayedTitle;\r\n        tspan.style.fontSize = \"13px\";\r\n        tspan.style.fontWeight = \"600\";\r\n        tspan.style.whiteSpace = \"normal\";\r\n        tspan.style.wordBreak = \"break-word\";\r\n        titleEl.appendChild(tspan);\r\n        labelColumn.appendChild(titleEl);\r\n\r\n        // Progress summary and bar\r\n        if (prog.total && prog.total > 0) {\r\n          const summary = document.createElement(\"div\");\r\n          summary.style.display = \"flex\";\r\n          summary.style.alignItems = \"center\";\r\n          summary.style.gap = \"8px\";\r\n          summary.style.marginTop = \"6px\";\r\n\r\n          const doneText = document.createElement(\"div\");\r\n          doneText.textContent = `${prog.done}/${prog.total}`;\r\n          doneText.style.color = \"var(--vscode-descriptionForeground)\";\r\n          doneText.style.fontSize = \"12px\";\r\n          doneText.style.fontVariantNumeric = \"tabular-nums\";\r\n          summary.appendChild(doneText);\r\n\r\n          const bar = document.createElement(\"div\");\r\n          bar.style.display = \"inline-block\";\r\n          bar.style.width = \"120px\";\r\n          bar.style.height = \"10px\";\r\n          bar.style.background = \"transparent\";\r\n          bar.style.border = \"1px solid var(--vscode-focusBorder)\";\r\n          bar.style.borderRadius = \"6px\";\r\n          bar.style.overflow = \"hidden\";\r\n          const fill = document.createElement(\"div\");\r\n          fill.style.height = \"100%\";\r\n          fill.style.width = String(prog.pct) + \"%\";\r\n          fill.style.background = \"var(--vscode-focusBorder)\";\r\n          bar.appendChild(fill);\r\n          summary.appendChild(bar);\r\n\r\n          labelColumn.appendChild(summary);\r\n        }\r\n      }\r\n\r\n      // Iteration: show date range if available\r\n      if (dataType === \"iteration\") {\r\n        try {\r\n          // rawValue may be an FV with iteration object, or we can look up field.configuration.iterations\r\n          const iterObj =\r\n            (rawValue &&\r\n              (rawValue.iteration || rawValue.configuration || rawValue)) ||\r\n            null;\r\n          let iterCandidate: any = null;\r\n          if (\r\n            iterObj &&\r\n            iterObj.startDate &&\r\n            (iterObj.duration || iterObj.length)\r\n          ) {\r\n            iterCandidate = iterObj;\r\n          } else if (\r\n            this.field &&\r\n            this.field.configuration &&\r\n            Array.isArray(this.field.configuration.iterations)\r\n          ) {\r\n            const found = (this.field.configuration.iterations || []).find(\r\n              (it: any) =>\r\n                String(it.title || it.name) === String(key) ||\r\n                String(it.id) ===\r\n                  String(\r\n                    rawValue &&\r\n                      (rawValue.iterationId ||\r\n                        (rawValue.iteration && rawValue.iteration.id)),\r\n                  ),\r\n            );\r\n            if (found) iterCandidate = found;\r\n          }\r\n\r\n          if (iterCandidate) {\r\n            const start = iterCandidate.startDate || iterCandidate.start;\r\n            const duration =\r\n              iterCandidate.duration ||\r\n              iterCandidate.length ||\r\n              iterCandidate.days;\r\n            if (start && duration) {\r\n              const s = new Date(start);\r\n              const e = new Date(\r\n                s.getTime() + Number(duration || 0) * 24 * 60 * 60 * 1000,\r\n              );\r\n              const sStr = s.toLocaleDateString(\"en-US\", {\r\n                month: \"short\",\r\n                day: \"numeric\",\r\n              });\r\n              const eStr = e.toLocaleDateString(\"en-US\", {\r\n                month: \"short\",\r\n                day: \"numeric\",\r\n              });\r\n              const rangeEl = document.createElement(\"div\");\r\n              rangeEl.textContent = `${sStr} \u2014 ${eStr}`;\r\n              rangeEl.style.fontSize = \"11px\";\r\n              rangeEl.style.color = \"var(--vscode-descriptionForeground)\";\r\n              rangeEl.style.marginTop = \"4px\";\r\n              labelColumn.appendChild(rangeEl);\r\n            }\r\n          }\r\n        } catch (e) {}\r\n      }\r\n\r\n      item.appendChild(labelColumn);\r\n\r\n      // Count circle (like grouping)\r\n      const countCircle = document.createElement(\"span\");\r\n      countCircle.style.display = \"inline-flex\";\r\n      countCircle.style.alignItems = \"center\";\r\n      countCircle.style.justifyContent = \"center\";\r\n      countCircle.style.minWidth = \"24px\";\r\n      countCircle.style.height = \"24px\";\r\n      countCircle.style.borderRadius = \"50%\";\r\n      countCircle.style.background = \"var(--vscode-input-background)\";\r\n      countCircle.style.border = \"1px solid var(--vscode-panel-border)\";\r\n      countCircle.style.color = \"var(--vscode-foreground)\";\r\n      countCircle.style.fontSize = \"12px\";\r\n      countCircle.style.fontWeight = \"600\";\r\n      countCircle.style.padding = \"0 6px\";\r\n      countCircle.style.boxSizing = \"border-box\";\r\n      countCircle.textContent = String(count);\r\n\r\n      item.appendChild(countCircle);\r\n\r\n      // Hover effect\r\n      item.addEventListener(\"mouseenter\", () => {\r\n        item.style.background = \"var(--vscode-list-hoverBackground)\";\r\n      });\r\n\r\n      item.addEventListener(\"mouseleave\", () => {\r\n        item.style.background = \"transparent\";\r\n      });\r\n\r\n      // Click handler\r\n      item.addEventListener(\"click\", () => {\r\n        if (this.onValueSelectCallback) {\r\n          this.onValueSelectCallback(value);\r\n        }\r\n      });\r\n\r\n      container.appendChild(item);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get unique values and their counts\r\n   */\r\n  private getValueCounts(): Map<\r\n    string,\r\n    { value: any; count: number; rawValue: any }\r\n  > {\r\n    const counts = new Map<\r\n      string,\r\n      { value: any; count: number; rawValue: any }\r\n    >();\r\n\r\n    const dataType = (this.field.dataType || \"\").toLowerCase();\r\n\r\n    this.items.forEach((item) => {\r\n      const fv = item.fieldValues?.find(\r\n        (f: any) =>\r\n          f.fieldId === this.field.id || f.fieldName === this.field.name,\r\n      );\r\n      if (!fv) {\r\n        const key = \"(empty)\";\r\n        const existing = counts.get(key);\r\n        if (existing) existing.count++;\r\n        else counts.set(key, { value: null, count: 1, rawValue: null });\r\n        return;\r\n      }\r\n\r\n      // Handle multi-value fields (labels, assignees)\r\n      if (dataType === \"labels\") {\r\n        // GitHub sometimes nests labels under .labels.nodes or .labels\r\n        const labelsArr =\r\n          fv.labels && Array.isArray(fv.labels.nodes)\r\n            ? fv.labels.nodes\r\n            : Array.isArray(fv.labels)\r\n              ? fv.labels\r\n              : null;\r\n        if (Array.isArray(labelsArr) && labelsArr.length > 0) {\r\n          labelsArr.forEach((lab: any) => {\r\n            const name =\r\n              lab && (lab.name || lab.title)\r\n                ? String(lab.name || lab.title)\r\n                : \"(empty)\";\r\n            const key = this.formatValue(name);\r\n            const existing = counts.get(key);\r\n            if (existing) existing.count++;\r\n            else counts.set(key, { value: name, count: 1, rawValue: lab });\r\n          });\r\n          return;\r\n        }\r\n      }\r\n\r\n      if (dataType === \"assignees\") {\r\n        const ass = fv.assignees || (fv.assignee ? [fv.assignee] : null);\r\n        if (Array.isArray(ass) && ass.length > 0) {\r\n          ass.forEach((a: any) => {\r\n            const name = String(a.login || a.name || a.id || \"(unknown)\");\r\n            const key = this.formatValue(name);\r\n            const existing = counts.get(key);\r\n            if (existing) existing.count++;\r\n            else counts.set(key, { value: a, count: 1, rawValue: a });\r\n          });\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Single-value fields and other complex types\r\n      let value: any = null;\r\n      let rawValue: any = null;\r\n\r\n      try {\r\n        if (dataType === \"single_select\") {\r\n          value = fv.option?.name || fv.name || fv.value;\r\n          rawValue = fv;\r\n        } else if (dataType === \"iteration\") {\r\n          value = fv.iteration?.title || fv.title || fv.value;\r\n          rawValue = fv;\r\n        } else if (dataType === \"parent_issue\") {\r\n          const p =\r\n            fv.parent ||\r\n            fv.parentIssue ||\r\n            fv.issue ||\r\n            fv.item ||\r\n            fv.value ||\r\n            null;\r\n          if (p) value = p.title || p.name || p.number || p.id || p.url || null;\r\n          rawValue = p || fv;\r\n        } else if (dataType === \"milestone\") {\r\n          value = fv.milestone?.title || fv.milestone?.name || fv.value || null;\r\n          rawValue = fv.milestone || fv;\r\n        } else if (dataType === \"repository\") {\r\n          value =\r\n            fv.repository?.nameWithOwner ||\r\n            fv.repository?.full_name ||\r\n            fv.repository?.name ||\r\n            fv.value ||\r\n            null;\r\n          rawValue = fv.repository || fv;\r\n        } else if (dataType === \"number\") {\r\n          value = fv.number != null ? fv.number : fv.value;\r\n          rawValue = fv;\r\n        } else if (dataType === \"date\") {\r\n          value = fv.date || fv.value || null;\r\n          rawValue = fv;\r\n        } else {\r\n          // fallback: text, title, other simple values\r\n          value = fv.text || fv.title || fv.value || null;\r\n          rawValue = fv;\r\n        }\r\n      } catch (e) {\r\n        value = fv.text || fv.title || fv.value || null;\r\n        rawValue = fv;\r\n      }\r\n\r\n      const key =\r\n        value === null || value === undefined || value === \"\"\r\n          ? \"(empty)\"\r\n          : this.formatValue(value);\r\n      const existing = counts.get(key);\r\n      if (existing) existing.count++;\r\n      else counts.set(key, { value, count: 1, rawValue });\r\n    });\r\n\r\n    return counts;\r\n  }\r\n\r\n  /**\r\n   * Extract value from field value object\r\n   */\r\n  private extractValue(fieldValue: any): any {\r\n    // Deprecated: primary logic moved into getValueCounts which handles multi-value types.\r\n    const dataType = (this.field.dataType || \"\").toLowerCase();\r\n    if (!fieldValue) return null;\r\n    if (dataType === \"single_select\")\r\n      return fieldValue.option?.name || fieldValue.name || fieldValue.value;\r\n    if (dataType === \"iteration\")\r\n      return (\r\n        fieldValue.iteration?.title || fieldValue.title || fieldValue.value\r\n      );\r\n    if (dataType === \"assignees\")\r\n      return fieldValue.assignees || fieldValue.assignee || null;\r\n    if (dataType === \"labels\") return fieldValue.labels || null;\r\n    if (dataType === \"parent_issue\")\r\n      return (\r\n        fieldValue.parent ||\r\n        fieldValue.parentIssue ||\r\n        fieldValue.issue ||\r\n        fieldValue.item ||\r\n        fieldValue.value ||\r\n        null\r\n      );\r\n    if (dataType === \"milestone\")\r\n      return fieldValue.milestone || fieldValue.value || null;\r\n    if (dataType === \"repository\")\r\n      return fieldValue.repository || fieldValue.value || null;\r\n    if (dataType === \"number\")\r\n      return fieldValue.number != null ? fieldValue.number : fieldValue.value;\r\n    if (dataType === \"date\") return fieldValue.date || fieldValue.value || null;\r\n    return fieldValue.text || fieldValue.title || fieldValue.value || null;\r\n  }\r\n\r\n  /**\r\n   * Format value for display\r\n   */\r\n  private formatValue(value: any): string {\r\n    if (value === null || value === undefined) {\r\n      return \"(empty)\";\r\n    }\r\n    return String(value);\r\n  }\r\n\r\n  /**\r\n   * Register callback for value selection\r\n   */\r\n  public onValueSelect(callback: (value: any) => void): void {\r\n    this.onValueSelectCallback = callback;\r\n  }\r\n\r\n  /**\r\n   * Register callback for field change\r\n   */\r\n  public onFieldChange(callback: (field: any) => void): void {\r\n    this.onFieldChangeCallback = callback;\r\n  }\r\n\r\n  /**\r\n   * Close and remove the panel\r\n   */\r\n  public close(): void {\r\n    if (this.panelElement) {\r\n      this.panelElement.remove();\r\n      this.panelElement = null;\r\n    }\r\n  }\r\n}\r\n", "import type { FieldConfig } from \"../../../lib/types\";\r\n\r\nexport interface SortConfig {\r\n  fieldId: string;\r\n  direction: \"ASC\" | \"DESC\";\r\n  secondary?: {\r\n    fieldId: string;\r\n    direction: \"ASC\" | \"DESC\";\r\n  };\r\n}\r\n\r\n/**\r\n * Parse sortByFields from GitHub GraphQL response into SortConfig\r\n */\r\nexport function parseSortByFields(sortByFields: any): SortConfig | null {\r\n  if (!sortByFields || !sortByFields.nodes || sortByFields.nodes.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  const primary = sortByFields.nodes[0];\r\n  if (!primary || !primary.field) {\r\n    return null;\r\n  }\r\n\r\n  const config: SortConfig = {\r\n    fieldId: primary.field.id || primary.field.name,\r\n    direction: primary.direction || \"ASC\",\r\n  };\r\n\r\n  // Add secondary sort if available\r\n  if (sortByFields.nodes.length > 1) {\r\n    const secondary = sortByFields.nodes[1];\r\n    if (secondary && secondary.field) {\r\n      config.secondary = {\r\n        fieldId: secondary.field.id || secondary.field.name,\r\n        direction: secondary.direction || \"ASC\",\r\n      };\r\n    }\r\n  }\r\n\r\n  return config;\r\n}\r\n\r\n/**\r\n * Sort items array based on sort configuration\r\n */\r\nexport function sortItems(\r\n  items: any[],\r\n  fields: FieldConfig[],\r\n  sortConfig: SortConfig,\r\n): any[] {\r\n  if (!sortConfig || items.length === 0) {\r\n    return items;\r\n  }\r\n\r\n  const field = fields.find(\r\n    (f) => f.id === sortConfig.fieldId || f.name === sortConfig.fieldId,\r\n  );\r\n  if (!field) {\r\n    return items;\r\n  }\r\n\r\n  // Create a copy to avoid mutating original\r\n  const sorted = [...items];\r\n\r\n  sorted.sort((a, b) => {\r\n    // Primary sort\r\n    const primaryResult = compareFieldValues(a, b, field, sortConfig.direction);\r\n\r\n    // If equal and secondary sort exists, use secondary\r\n    if (primaryResult === 0 && sortConfig.secondary) {\r\n      const secondaryField = fields.find(\r\n        (f) =>\r\n          f.id === sortConfig.secondary!.fieldId ||\r\n          f.name === sortConfig.secondary!.fieldId,\r\n      );\r\n      if (secondaryField) {\r\n        return compareFieldValues(\r\n          a,\r\n          b,\r\n          secondaryField,\r\n          sortConfig.secondary.direction,\r\n        );\r\n      }\r\n    }\r\n\r\n    return primaryResult;\r\n  });\r\n\r\n  return sorted;\r\n}\r\n\r\n/**\r\n * Compare two items by a specific field\r\n */\r\nexport function compareFieldValues(\r\n  a: any,\r\n  b: any,\r\n  field: FieldConfig,\r\n  direction: \"ASC\" | \"DESC\",\r\n): number {\r\n  // Find field values for both items\r\n  const aValue = getFieldValue(a, field);\r\n  const bValue = getFieldValue(b, field);\r\n\r\n  // Handle null/undefined\r\n  if (aValue === null && bValue === null) return 0;\r\n  if (aValue === null) return direction === \"ASC\" ? 1 : -1;\r\n  if (bValue === null) return direction === \"ASC\" ? -1 : 1;\r\n\r\n  let result = 0;\r\n  const dataType = (field.dataType || \"\").toLowerCase();\r\n\r\n  switch (dataType) {\r\n    case \"text\":\r\n    case \"title\":\r\n      result = compareText(aValue, bValue);\r\n      break;\r\n\r\n    case \"number\":\r\n      result = compareNumber(aValue, bValue);\r\n      break;\r\n\r\n    case \"date\":\r\n      result = compareDate(aValue, bValue);\r\n      break;\r\n\r\n    case \"single_select\":\r\n      result = compareSingleSelect(aValue, bValue, field);\r\n      break;\r\n\r\n    case \"iteration\":\r\n      result = compareIteration(aValue, bValue);\r\n      break;\r\n\r\n    case \"labels\":\r\n      result = compareLabels(aValue, bValue);\r\n      break;\r\n\r\n    default:\r\n      // Fallback to string comparison\r\n      result = String(aValue).localeCompare(String(bValue));\r\n  }\r\n\r\n  return direction === \"ASC\" ? result : -result;\r\n}\r\n\r\n/**\r\n * Extract field value from item\r\n */\r\nfunction getFieldValue(item: any, field: FieldConfig): any {\r\n  const fieldValue = item.fieldValues?.find(\r\n    (fv: any) => fv.fieldId === field.id || fv.fieldName === field.name,\r\n  );\r\n\r\n  if (!fieldValue) return null;\r\n\r\n  const dataType = (field.dataType || \"\").toLowerCase();\r\n\r\n  switch (dataType) {\r\n    case \"text\":\r\n    case \"title\":\r\n      return fieldValue.text || fieldValue.title || null;\r\n\r\n    case \"number\":\r\n      return fieldValue.number !== undefined ? fieldValue.number : null;\r\n\r\n    case \"date\":\r\n      return (\r\n        fieldValue.date || fieldValue.startDate || fieldValue.dueOn || null\r\n      );\r\n\r\n    case \"single_select\":\r\n      return fieldValue.option || fieldValue;\r\n\r\n    case \"iteration\":\r\n      return fieldValue;\r\n\r\n    case \"labels\":\r\n      return fieldValue.labels || [];\r\n\r\n    default:\r\n      return fieldValue;\r\n  }\r\n}\r\n\r\n/**\r\n * Compare text values\r\n */\r\nfunction compareText(a: any, b: any): number {\r\n  const aStr = String(a || \"\").toLowerCase();\r\n  const bStr = String(b || \"\").toLowerCase();\r\n  return aStr.localeCompare(bStr);\r\n}\r\n\r\n/**\r\n * Compare number values\r\n */\r\nfunction compareNumber(a: any, b: any): number {\r\n  const aNum = typeof a === \"number\" ? a : parseFloat(a);\r\n  const bNum = typeof b === \"number\" ? b : parseFloat(b);\r\n\r\n  if (isNaN(aNum) && isNaN(bNum)) return 0;\r\n  if (isNaN(aNum)) return 1;\r\n  if (isNaN(bNum)) return -1;\r\n\r\n  return aNum - bNum;\r\n}\r\n\r\n/**\r\n * Compare date values\r\n */\r\nfunction compareDate(a: any, b: any): number {\r\n  const aDate = new Date(a);\r\n  const bDate = new Date(b);\r\n\r\n  if (isNaN(aDate.getTime()) && isNaN(bDate.getTime())) return 0;\r\n  if (isNaN(aDate.getTime())) return 1;\r\n  if (isNaN(bDate.getTime())) return -1;\r\n\r\n  return aDate.getTime() - bDate.getTime();\r\n}\r\n\r\n/**\r\n * Compare single select values by option order\r\n */\r\nfunction compareSingleSelect(a: any, b: any, field: FieldConfig): number {\r\n  const aOption = a.option || a;\r\n  const bOption = b.option || b;\r\n\r\n  if (!aOption || !bOption) {\r\n    return compareText(aOption?.name || \"\", bOption?.name || \"\");\r\n  }\r\n\r\n  // If field has options array, sort by position in array\r\n  if (field.options && Array.isArray(field.options)) {\r\n    const aIndex = field.options.findIndex(\r\n      (opt: any) => opt.id === aOption.id || opt.name === aOption.name,\r\n    );\r\n    const bIndex = field.options.findIndex(\r\n      (opt: any) => opt.id === bOption.id || opt.name === bOption.name,\r\n    );\r\n\r\n    if (aIndex !== -1 && bIndex !== -1) {\r\n      return aIndex - bIndex;\r\n    }\r\n  }\r\n\r\n  // Fallback to name comparison\r\n  return compareText(aOption.name, bOption.name);\r\n}\r\n\r\n/**\r\n * Compare iteration values by start date\r\n */\r\nfunction compareIteration(a: any, b: any): number {\r\n  const aDate = a.startDate || a.iteration?.startDate;\r\n  const bDate = b.startDate || b.iteration?.startDate;\r\n\r\n  if (!aDate && !bDate) {\r\n    // Sort by title if no dates\r\n    return compareText(\r\n      a.title || a.iteration?.title,\r\n      b.title || b.iteration?.title,\r\n    );\r\n  }\r\n\r\n  return compareDate(aDate, bDate);\r\n}\r\n\r\n/**\r\n * Compare labels by first label name\r\n */\r\nfunction compareLabels(a: any, b: any): number {\r\n  const aLabels = Array.isArray(a) ? a : [];\r\n  const bLabels = Array.isArray(b) ? b : [];\r\n\r\n  if (aLabels.length === 0 && bLabels.length === 0) return 0;\r\n  if (aLabels.length === 0) return 1;\r\n  if (bLabels.length === 0) return -1;\r\n\r\n  return compareText(aLabels[0].name, bLabels[0].name);\r\n}\r\n", "export class GroupDataService {\r\n  public static groupItems(items: any[], field: any): any[] {\r\n    // Normalize options: Single Select uses .options, Iteration uses .configuration.iterations\r\n    let options: any[] = [];\r\n    const dType = (field.dataType || \"\").toLowerCase();\r\n    if (dType === \"single_select\") {\r\n      options = field.options || [];\r\n    } else if (dType === \"iteration\") {\r\n      options = (field.configuration && field.configuration.iterations) || [];\r\n    }\r\n    // If we have explicit options (single select/iteration), use them to group.\r\n    if (options && options.length > 0) {\r\n      const groups: any[] = options.map((opt: any) => ({\r\n        option: opt,\r\n        items: [],\r\n      }));\r\n      const unassigned: any[] = [];\r\n\r\n      items.forEach((item, index) => {\r\n        const fv = item.fieldValues.find(\r\n          (v: any) =>\r\n            String(v.fieldId) === String(field.id) ||\r\n            v.fieldName === field.name,\r\n        );\r\n        let placed = false;\r\n\r\n        if (fv) {\r\n          // Match logic\r\n          let matchId: string | null = null;\r\n          let matchName: string | null = null;\r\n\r\n          if (dType === \"single_select\") {\r\n            matchId = fv.optionId || (fv.option && fv.option.id);\r\n            matchName = fv.name || (fv.option && fv.option.name);\r\n          } else if (dType === \"iteration\") {\r\n            matchId =\r\n              fv.iterationId || (fv.iteration && fv.iteration.id) || fv.id;\r\n            matchName = fv.title || (fv.iteration && fv.iteration.title);\r\n          }\r\n\r\n          if (matchId || matchName) {\r\n            const group = groups.find(\r\n              (g: any) =>\r\n                (matchId && String(g.option.id) === String(matchId)) ||\r\n                (matchName &&\r\n                  (String(g.option.name) === String(matchName) ||\r\n                    String(g.option.title) === String(matchName))),\r\n            );\r\n            if (group) {\r\n              group.items.push({ item, index });\r\n              placed = true;\r\n            }\r\n          }\r\n        }\r\n\r\n        if (!placed) {\r\n          unassigned.push({ item, index });\r\n        }\r\n      });\r\n\r\n      if (unassigned.length > 0) {\r\n        groups.push({\r\n          option: { name: \"Unassigned\", title: \"Unassigned\", color: \"GRAY\" },\r\n          items: unassigned,\r\n        });\r\n      }\r\n\r\n      return groups.filter((g: any) => g.items.length > 0);\r\n    }\r\n\r\n    // Fallback grouping: build groups based on actual item values (useful for assignees, repository, date, number, etc.)\r\n    const map = new Map<string, { option: any; items: any[] }>();\r\n    const unassignedFallback: any[] = [];\r\n\r\n    items.forEach((item, index) => {\r\n      const fv = item.fieldValues.find(\r\n        (v: any) =>\r\n          String(v.fieldId) === String(field.id) || v.fieldName === field.name,\r\n      );\r\n      let val: any = null;\r\n      if (fv) {\r\n        // Text/title/number/date straightforward\r\n        if (fv.text !== undefined) val = fv.text;\r\n        else if (fv.title !== undefined) val = fv.title;\r\n        else if (fv.number !== undefined) val = fv.number;\r\n        else if (fv.date !== undefined) val = fv.date;\r\n        // single_select / option\r\n        else if (fv.option)\r\n          val = fv.option.name || fv.option.title || fv.option.id;\r\n        // iteration\r\n        else if (fv.iteration) val = fv.iteration.title || fv.iteration.id;\r\n        // parent_issue - try parent/parentIssue/issue/item/value/raw\r\n        else if (\r\n          fv.parent ||\r\n          fv.parentIssue ||\r\n          fv.issue ||\r\n          fv.item ||\r\n          fv.value\r\n        ) {\r\n          const p =\r\n            fv.parent || fv.parentIssue || fv.issue || fv.item || fv.value;\r\n          if (p) {\r\n            // Prefer number, then id, then url, then title\r\n            val =\r\n              p.number ||\r\n              p.id ||\r\n              (p.raw && (p.raw.number || p.raw.id)) ||\r\n              p.url ||\r\n              p.title ||\r\n              p.name ||\r\n              null;\r\n          }\r\n        }\r\n        // assignees\r\n        else if (fv.assignees)\r\n          val = Array.isArray(fv.assignees)\r\n            ? fv.assignees.map((a: any) => a.login || a.name).join(\", \")\r\n            : fv.assignees;\r\n        // repository\r\n        else if (fv.repository)\r\n          val =\r\n            fv.repository.nameWithOwner ||\r\n            fv.repository.name ||\r\n            fv.repository.full_name ||\r\n            fv.repository.id;\r\n        // milestone\r\n        else if (fv.milestone)\r\n          val = fv.milestone.title || fv.milestone.id || fv.milestone.name;\r\n        else val = fv.value !== undefined ? fv.value : null;\r\n      }\r\n\r\n      if (val === null || val === undefined || val === \"\") {\r\n        unassignedFallback.push({ item, index });\r\n        return;\r\n      }\r\n\r\n      const key = String(val);\r\n      if (!map.has(key)) {\r\n        map.set(key, { option: { id: key, name: key, title: key }, items: [] });\r\n      }\r\n      map.get(key)!.items.push({ item, index });\r\n    });\r\n\r\n    const groupsArr = Array.from(map.values());\r\n    if (unassignedFallback.length > 0) {\r\n      groupsArr.push({\r\n        option: { name: \"Unassigned\", title: \"Unassigned\", color: \"GRAY\" },\r\n        items: unassignedFallback,\r\n      });\r\n    }\r\n\r\n    return groupsArr;\r\n  }\r\n}\r\n", "import {\r\n  escapeHtml,\r\n  normalizeColor,\r\n  getContrastColor,\r\n  addAlpha,\r\n} from \"../../client/utils\";\r\n\r\nexport interface CellRendererStrategy {\r\n  render(value: any, field: any, item: any, allItems: any): string;\r\n}\r\n\r\nexport class TitleRenderer implements CellRendererStrategy {\r\n  render(value: any, field: any, item: any, allItems: any): string {\r\n    let t =\r\n      (value &&\r\n        value.title &&\r\n        ((value.title.raw && value.title.raw.text) ||\r\n          (value.title.content &&\r\n            (value.title.content.title || value.title.content.name)) ||\r\n          (typeof value.title == \"string\" && value.title))) ||\r\n      (value && value.content && (value.content.title || value.content.name)) ||\r\n      (value && value.raw && value.raw.text) ||\r\n      \"\";\r\n    let o =\r\n      (value &&\r\n        value.title &&\r\n        value.title.content &&\r\n        value.title.content.number) ||\r\n      (value &&\r\n        value.raw &&\r\n        value.raw.itemContent &&\r\n        value.raw.itemContent.number) ||\r\n      (item && item.content && item.content.number) ||\r\n      \"\";\r\n    let l =\r\n      (value &&\r\n        value.title &&\r\n        value.title.content &&\r\n        value.title.content.url) ||\r\n      (value &&\r\n        value.raw &&\r\n        value.raw.itemContent &&\r\n        value.raw.itemContent.url) ||\r\n      (item && item.content && item.content.url) ||\r\n      \"\";\r\n    let r = null;\r\n    if (item && Array.isArray(item.fieldValues)) {\r\n      let w = item.fieldValues.find(\r\n        (x: any) =>\r\n          x &&\r\n          x.type === \"single_select\" &&\r\n          ((x.raw &&\r\n            x.raw.field &&\r\n            String(x.raw.field.name || \"\").toLowerCase() === \"status\") ||\r\n            (x.fieldName &&\r\n              String(x.fieldName || \"\").toLowerCase() === \"status\") ||\r\n            (x.field &&\r\n              x.field.name &&\r\n              String(x.field.name || \"\").toLowerCase() === \"status\")),\r\n      );\r\n      w &&\r\n        (r =\r\n          (w.option && (w.option.color || w.option.id || w.option.name)) ||\r\n          (w.raw && w.raw.color) ||\r\n          null);\r\n    }\r\n    let a = normalizeColor(r) || null,\r\n      p = a && /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(a) ? a : \"#666666\",\r\n      g = escapeHtml(String(t || \"\")),\r\n      f = o ? escapeHtml(String(o)) : \"\";\r\n    return (\r\n      '<a href=\"' +\r\n      escapeHtml(String(l || \"\")) +\r\n      '\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"text-decoration:none;color:inherit;display:inline-flex;align-items:center;gap:8px;width:100%;\"><svg width=\"14\" height=\"14\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style=\"flex-shrink:0;color:' +\r\n      escapeHtml(p) +\r\n      '\"><circle cx=\"8\" cy=\"8\" r=\"6\" fill=\"currentColor\" /></svg><span style=\"flex:1;min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:block\">' +\r\n      g +\r\n      \"</span>\" +\r\n      (f\r\n        ? '<span style=\"flex:none;margin-left:6px;color:var(--vscode-descriptionForeground);white-space:nowrap\">#' +\r\n          f +\r\n          \"</span>\"\r\n        : \"\") +\r\n      \"</a>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class TextRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    return (\r\n      \"<div>\" +\r\n      escapeHtml((value && value.text) != null ? value.text : \"\") +\r\n      \"</div>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class NumberRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    let t =\r\n      value.number !== void 0 && value.number !== null\r\n        ? String(value.number)\r\n        : \"\";\r\n    return (\r\n      '<div style=\"text-align:right;font-variant-numeric:tabular-nums\">' +\r\n      escapeHtml(t) +\r\n      \"</div>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class DateRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    let t = value.date || value.startDate || value.dueOn || null;\r\n    if (!t) return \"<div></div>\";\r\n    try {\r\n      let o = new Date(t);\r\n      if (isNaN(o.getTime())) return \"<div>\" + escapeHtml(String(t)) + \"</div>\";\r\n      let l = o.toLocaleDateString(\"en-US\", {\r\n        month: \"short\",\r\n        day: \"numeric\",\r\n        year: \"numeric\",\r\n      });\r\n      return \"<div>\" + escapeHtml(l) + \"</div>\";\r\n    } catch (e) {\r\n      return \"<div>\" + escapeHtml(String(t)) + \"</div>\";\r\n    }\r\n  }\r\n}\r\n\r\nexport class SingleSelectRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    let n =\r\n      (value && value.option && value.option.name) ||\r\n      (value && value.name) ||\r\n      \"\";\r\n    if (!n) return \"<div></div>\";\r\n    let c =\r\n      (value && value.option && (value.option.color || value.option.id)) ||\r\n      (value && value.color) ||\r\n      null;\r\n    let bg = normalizeColor(c) || \"var(--vscode-badge-background)\";\r\n    let fg = getContrastColor(bg);\r\n    return (\r\n      '<span style=\"display:inline-block;padding:2px 8px;border-radius:10px;font-size:12px;line-height:18px;background-color:' +\r\n      escapeHtml(bg) +\r\n      \";color:\" +\r\n      escapeHtml(fg) +\r\n      '\">' +\r\n      escapeHtml(n) +\r\n      \"</span>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class IterationRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    let i = value.iteration || value;\r\n    if (!i || !i.title) return \"<div></div>\";\r\n    return (\r\n      '<div style=\"display:flex;align-items:center;gap:6px\"><span style=\"display:inline-block;width:14px;height:14px;border-radius:50%;border:2px solid var(--vscode-charts-blue);box-sizing:border-box\"></span><span>' +\r\n      escapeHtml(i.title) +\r\n      \"</span></div>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class RepositoryRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    let r = value.repository || value;\r\n    if (!r || !r.name) return \"<div></div>\";\r\n    return (\r\n      '<div style=\"display:flex;align-items:center;gap:6px\"><svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-repo\" style=\"color:var(--vscode-textLink-foreground)\"><path d=\"M2 2.5A1.5 1.5 0 0 1 3.5 1h9A1.5 1.5 0 0 1 14 2.5v11A1.5 1.5 0 0 1 12.5 15h-9A1.5 1.5 0 0 1 2 13.5v-11zM3.5 2A.5.5 0 0 0 3 2.5V4h10V2.5a.5.5 0 0 0-.5-.5h-9z\"></path></svg><span>' +\r\n      escapeHtml(r.name) +\r\n      \"</span></div>\"\r\n    );\r\n  }\r\n}\r\n\r\n// Helper for contrast color (duplicated from utils to avoid circular deps if utils imports this, but utils is safe)\r\n// Removed local getContrastColor since we import it.\r\n\r\nexport class LabelsRenderer implements CellRendererStrategy {\r\n  render(value: any, field: any, item: any, allItems: any): string {\r\n    return (\r\n      \"<div>\" +\r\n      (value.labels || [])\r\n        .map((o: any) => {\r\n          let l = escapeHtml(o.name || \"\"),\r\n            r =\r\n              (item &&\r\n                ((item.content &&\r\n                  item.content.repository &&\r\n                  item.content.repository.nameWithOwner) ||\r\n                  (item.repository && item.repository.nameWithOwner))) ||\r\n              (value.raw &&\r\n                value.raw.itemContent &&\r\n                value.raw.itemContent.repository &&\r\n                value.raw.itemContent.repository.nameWithOwner) ||\r\n              null,\r\n            a = o.color || o.colour || null;\r\n          if (field && field.repoOptions && r && field.repoOptions[r]) {\r\n            let k = field.repoOptions[r].find(\r\n              (L: any) => L && L.name === o.name,\r\n            );\r\n            k && (a = k.color || k.colour || a);\r\n          }\r\n          let p = normalizeColor(a) || null,\r\n            g = !!(p && /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(p)),\r\n            f = p || \"#999999\",\r\n            h = (g && addAlpha(p, 0.12)) || \"rgba(0,0,0,0.06)\",\r\n            w = p || \"#333333\";\r\n          return (\r\n            \"<span style='display:inline-block;padding:2px 8px;margin-right:6px;border-radius:999px;border:1px solid \" +\r\n            escapeHtml(f) +\r\n            \";background:\" +\r\n            escapeHtml(h) +\r\n            \";color:\" +\r\n            escapeHtml(w) +\r\n            \";font-size:12px;line-height:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis'>\" +\r\n            l +\r\n            \"</span>\"\r\n          );\r\n        })\r\n        .join(\"\") +\r\n      \"</div>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class PullRequestRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    const prs = value.pullRequests || [];\r\n    if (!prs || prs.length === 0) return \"\";\r\n    let out =\r\n      \"<div style='display:flex;flex-wrap:wrap;gap:6px;align-items:center'>\";\r\n    for (let i = 0; i < prs.length; i++) {\r\n      let p = prs[i];\r\n      let num = escapeHtml(String((p && p.number) || \"\"));\r\n      let titleText = escapeHtml((p && p.title) || \"\");\r\n      let url = escapeHtml((p && p.url) || \"\");\r\n      let rawColor =\r\n        (p && (p.state_color || p.color || p.colour || p.state)) || null;\r\n      let normColor = normalizeColor(rawColor) || null;\r\n      let hasHex = !!(\r\n        normColor && /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(normColor)\r\n      );\r\n      let border = normColor || \"#999999\";\r\n      let bg = (hasHex && addAlpha(normColor, 0.12)) || \"rgba(0,0,0,0.06)\";\r\n      let fg = getContrastColor(normColor) || \"#333333\";\r\n      out +=\r\n        \"<a href='\" +\r\n        url +\r\n        \"' target='_blank' rel='noopener noreferrer' style='text-decoration:none;color:inherit'>\" +\r\n        \"<span title='\" +\r\n        titleText +\r\n        \"' style='display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;border:1px solid \" +\r\n        escapeHtml(border) +\r\n        \";background:\" +\r\n        escapeHtml(bg) +\r\n        \";color:\" +\r\n        escapeHtml(fg) +\r\n        \";font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;max-width:160px'>\" +\r\n        \"<svg width='12' height='12' viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' style='flex-shrink:0;color:\" +\r\n        escapeHtml(normColor || \"#666\") +\r\n        \"'><circle cx='8' cy='8' r='6' fill='currentColor' /></svg>\" +\r\n        \"<span style='flex:1 1 auto;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap'>#\" +\r\n        num +\r\n        \"</span></span></a>\";\r\n    }\r\n    out += \"</div>\";\r\n    return out;\r\n  }\r\n}\r\n\r\nexport class IssueRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    return (value.issues || [])\r\n      .map(\r\n        (t: any) =>\r\n          \"<a href='\" +\r\n          escapeHtml(t.url || \"\") +\r\n          \"' target='_blank' rel='noopener noreferrer'>#\" +\r\n          escapeHtml(String(t.number || \"\")) +\r\n          \" \" +\r\n          escapeHtml(t.title || \"\") +\r\n          \"</a>\",\r\n      )\r\n      .join(\"<br/>\");\r\n  }\r\n}\r\n\r\nexport class AssigneesRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    let t = value.assignees || [];\r\n    if (t.length === 0) return \"<div></div>\";\r\n    let l = t\r\n        .slice(0, 3)\r\n        .map((g: any, f: any) => {\r\n          let h = escapeHtml(g.avatarUrl || g.avatar || \"\"),\r\n            w = f === 0 ? \"0px\" : f === 1 ? \"-8px\" : \"-14px\",\r\n            x = Math.max(1, 3 - f);\r\n          if (h)\r\n            return (\r\n              \"<span title='\" +\r\n              escapeHtml(g.login || g.name || \"\") +\r\n              \"' style='display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url(\" +\r\n              h +\r\n              \");border:2px solid var(--vscode-editor-background);margin-left:\" +\r\n              w +\r\n              \";vertical-align:middle;position:relative;z-index:\" +\r\n              x +\r\n              \"'></span>\"\r\n            );\r\n          let k = escapeHtml(\r\n            (g.name || g.login || \"\")\r\n              .split(\" \")\r\n              .map((L: any) => L[0] || \"\")\r\n              .join(\"\")\r\n              .toUpperCase()\r\n              .slice(0, 2),\r\n          );\r\n          return (\r\n            \"<span title='\" +\r\n            escapeHtml(g.login || g.name || \"\") +\r\n            \"' style='display:inline-flex;align-items:center;justify-content:center;width:20px;height:20px;border-radius:50%;background:#777;color:#fff;font-size:11px;border:2px solid var(--vscode-editor-background);margin-left:\" +\r\n            w +\r\n            \";vertical-align:middle;position:relative;z-index:\" +\r\n            x +\r\n            \"'>\" +\r\n            k +\r\n            \"</span>\"\r\n          );\r\n        })\r\n        .join(\"\"),\r\n      r = t.map((g: any) => g.login || g.name || \"\"),\r\n      a = \"\";\r\n    if (r.length === 1) a = r[0];\r\n    else if (r.length === 2) a = r[0] + \" and \" + r[1];\r\n    else a = r.slice(0, -1).join(\", \") + \" and \" + r.slice(-1)[0];\r\n\r\n    return (\r\n      \"<div style='display:flex;align-items:center;gap:8px'><span style='display:flex;align-items:center'>\" +\r\n      (\"<span style='display:inline-block;vertical-align:middle;height:20px;line-height:20px;margin-right:8px;'>\" +\r\n        l +\r\n        \"</span>\") +\r\n      \"</span><span style='white-space:nowrap;overflow:hidden;text-overflow:ellipsis'>\" +\r\n      escapeHtml(a) +\r\n      \"</span></div>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class RequestedReviewersRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    return (\r\n      \"<div>\" +\r\n      escapeHtml(\r\n        (value.reviewers || [])\r\n          .map((t: any) => t.login || t.name || t.kind || \"\")\r\n          .join(\", \"),\r\n      ) +\r\n      \"</div>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class MilestoneRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    return (\r\n      \"<div>\" +\r\n      escapeHtml((value.milestone && value.milestone.title) || \"\") +\r\n      \"</div>\"\r\n    );\r\n  }\r\n}\r\n\r\nexport class SubIssuesProgressRenderer implements CellRendererStrategy {\r\n  render(value: any): string {\r\n    try {\r\n      if (!value || value.total == null || Number(value.total) <= 0) return \"\";\r\n      const totalCount = Math.max(0, Math.floor(Number(value.total) || 0));\r\n      const doneCount = Math.max(0, Math.floor(Number(value.done || 0)));\r\n      if (totalCount === 0) return \"\";\r\n      let pct = null;\r\n      if (value.percent !== void 0 && value.percent !== null)\r\n        pct = Number(value.percent);\r\n      else pct = Math.round((doneCount / totalCount) * 100);\r\n      if (pct == null || !isFinite(pct)) return \"\";\r\n      pct = Math.max(0, Math.min(100, pct));\r\n      const barHtml =\r\n        \"<div class='sub-issues-progress' style='display:flex;align-items:center;gap:8px;width:100%;'>\" +\r\n        \"<div class='sub-issues-progress-bar' style='flex:1;min-width:0'>\" +\r\n        \"<div style='width:100%;height:12px;border-radius:6px;border:1px solid var(--vscode-focusBorder);overflow:hidden;background:transparent;box-sizing:border-box'>\" +\r\n        \"<div style='height:100%;width:\" +\r\n        String(pct) +\r\n        \"%;background:var(--vscode-focusBorder)'></div>\" +\r\n        \"</div>\" +\r\n        \"</div>\" +\r\n        \"<div class='sub-issues-progress-pct' style='min-width:44px;text-align:right;font-variant-numeric:tabular-nums;color:var(--vscode-descriptionForeground)'>\" +\r\n        escapeHtml(String(pct) + \"%\") +\r\n        \"</div>\" +\r\n        \"</div>\";\r\n      return barHtml;\r\n    } catch (e) {\r\n      return \"\";\r\n    }\r\n  }\r\n}\r\n\r\nexport class ParentIssueRenderer implements CellRendererStrategy {\r\n  render(value: any, field: any, item: any, allItems: any): string {\r\n    let t =\r\n        (value &&\r\n          (value.parent ||\r\n            value.parentIssue ||\r\n            value.issue ||\r\n            value.option ||\r\n            value.item ||\r\n            value.value)) ||\r\n        (value &&\r\n          value.raw &&\r\n          (value.raw.parent || value.raw.itemContent || value.raw.item)) ||\r\n        null,\r\n      o =\r\n        (t &&\r\n          (t.number || t.id || (t.raw && t.raw.number)) &&\r\n          (t.number || (t.raw && t.raw.number))) ||\r\n        \"\",\r\n      l =\r\n        (t &&\r\n          (t.title || t.name || (t.raw && t.raw.title)) &&\r\n          (t.title || t.name || (t.raw && t.raw.title))) ||\r\n        \"\",\r\n      r =\r\n        (t &&\r\n          (t.url || t.html_url || (t.raw && t.raw.url)) &&\r\n          (t.url || t.html_url || (t.raw && t.raw.url))) ||\r\n        \"\",\r\n      a = escapeHtml(String(l || \"\")),\r\n      p = o ? escapeHtml(String(o)) : \"\",\r\n      g = escapeHtml(String(r || \"\")),\r\n      f = null;\r\n    try {\r\n      var itemsList = Array.isArray(allItems) ? allItems : allItems || [];\r\n      if (Array.isArray(itemsList) && itemsList.length > 0 && (o || t)) {\r\n        let B =\r\n            (t &&\r\n              t.repository &&\r\n              (t.repository.nameWithOwner || t.repository.name)) ||\r\n            (t &&\r\n              t.content &&\r\n              t.content.repository &&\r\n              t.content.repository.nameWithOwner) ||\r\n            null,\r\n          O: string[] = [];\r\n        (o && O.push(String(o)),\r\n          t &&\r\n            (t.id || (t.raw && t.raw.id)) &&\r\n            O.push(String(t.id || (t.raw && t.raw.id))),\r\n          t &&\r\n            (t.url || (t.raw && t.raw.url)) &&\r\n            O.push(String(t.url || (t.raw && t.raw.url))),\r\n          t && (t.title || t.name) && O.push(String(t.title || t.name)));\r\n        let $ = itemsList.find((A) => {\r\n          let d = (A && (A.content || (A.raw && A.raw.itemContent))) || null;\r\n          if (!d) return !1;\r\n          let M = [];\r\n          if (\r\n            (d.number && M.push(String(d.number)),\r\n            d.id && M.push(String(d.id)),\r\n            d.url && M.push(String(d.url)),\r\n            d.title && M.push(String(d.title)),\r\n            d.name && M.push(String(d.name)),\r\n            d.raw && d.raw.number && M.push(String(d.raw.number)),\r\n            d.raw && d.raw.id && M.push(String(d.raw.id)),\r\n            d.raw && d.raw.url && M.push(String(d.raw.url)),\r\n            B)\r\n          ) {\r\n            let V =\r\n              (d.repository &&\r\n                (d.repository.nameWithOwner || d.repository.name)) ||\r\n              null;\r\n            if (V && String(V) !== String(B)) return !1;\r\n          }\r\n          for (let V = 0; V < O.length; V++)\r\n            for (let X = 0; X < M.length; X++)\r\n              if (O[V] && M[X] && String(O[V]) === String(M[X])) return !0;\r\n          return !1;\r\n        });\r\n        if ($ && Array.isArray($.fieldValues)) {\r\n          let A = $.fieldValues.find(\r\n            (d: any) =>\r\n              d &&\r\n              d.type === \"single_select\" &&\r\n              ((d.raw &&\r\n                d.raw.field &&\r\n                String(d.raw.field.name || \"\").toLowerCase() === \"status\") ||\r\n                (d.fieldName &&\r\n                  String(d.fieldName || \"\").toLowerCase() === \"status\") ||\r\n                (d.field &&\r\n                  d.field.name &&\r\n                  String(d.field.name || \"\").toLowerCase() === \"status\")),\r\n          );\r\n          A &&\r\n            (f =\r\n              (A.option && (A.option.color || A.option.id || A.option.name)) ||\r\n              (A.raw && A.raw.color) ||\r\n              null);\r\n        }\r\n      }\r\n    } catch (e) {}\r\n    f ||\r\n      (f =\r\n        (t &&\r\n          ((t.option && (t.option.color || t.option.id || t.option.name)) ||\r\n            t.color ||\r\n            t.colour)) ||\r\n        null);\r\n    let h = normalizeColor(f) || null,\r\n      w = !!(h && /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(h)),\r\n      x = h || \"#999999\",\r\n      k = (w && addAlpha(h, 0.12)) || \"rgba(0,0,0,0.06)\",\r\n      L = getContrastColor(h) || \"#333333\",\r\n      q =\r\n        \"<span style='display:block;width:100%;box-sizing:border-box'>\" +\r\n        \"<div style='display:inline-flex;align-items:center;gap:8px;padding:4px 10px;border:1px solid \" +\r\n        escapeHtml(x) +\r\n        \";border-radius:999px;color:\" +\r\n        escapeHtml(L) +\r\n        \";background:\" +\r\n        escapeHtml(k) +\r\n        \";font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;width:100%'>\" +\r\n        \"<svg width='14' height='14' viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' style='flex-shrink:0;color:\" +\r\n        escapeHtml(h || \"#666\") +\r\n        \"'><circle cx='8' cy='8' r='6' fill='currentColor' /></svg>\" +\r\n        \"<span class='parent-issue-title' style='flex:1;min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:block'>\" +\r\n        a +\r\n        \"</span>\" +\r\n        (p\r\n          ? \"<span style='margin-left:6px;color:var(--vscode-descriptionForeground);white-space:nowrap'>#\" +\r\n            p +\r\n            \"</span>\"\r\n          : \"\") +\r\n        \"</div></span>\";\r\n    const parentWrapper =\r\n      \"<span data-gh-open='\" +\r\n      (g || \"\") +\r\n      \"' class='parent-issue-wrapper' style='display:block;width:100%;cursor:\" +\r\n      (g ? \"pointer\" : \"default\") +\r\n      \"'>\";\r\n    return g ? parentWrapper + q + \"</span>\" : q;\r\n  }\r\n}\r\n", "import {\r\n  CellRendererStrategy,\r\n  TitleRenderer,\r\n  TextRenderer,\r\n  NumberRenderer,\r\n  DateRenderer,\r\n  SingleSelectRenderer,\r\n  IterationRenderer,\r\n  RepositoryRenderer,\r\n  LabelsRenderer,\r\n  PullRequestRenderer,\r\n  IssueRenderer,\r\n  AssigneesRenderer,\r\n  RequestedReviewersRenderer,\r\n  MilestoneRenderer,\r\n  SubIssuesProgressRenderer,\r\n  ParentIssueRenderer,\r\n} from \"./strategies\";\r\n\r\nconst strategies: Record<string, CellRendererStrategy> = {\r\n  title: new TitleRenderer(),\r\n  text: new TextRenderer(),\r\n  number: new NumberRenderer(),\r\n  date: new DateRenderer(),\r\n  single_select: new SingleSelectRenderer(),\r\n  iteration: new IterationRenderer(),\r\n  repository: new RepositoryRenderer(),\r\n  labels: new LabelsRenderer(),\r\n  pull_request: new PullRequestRenderer(),\r\n  issue: new IssueRenderer(),\r\n  assignees: new AssigneesRenderer(),\r\n  reviewers: new RequestedReviewersRenderer(),\r\n  milestone: new MilestoneRenderer(),\r\n  sub_issues_progress: new SubIssuesProgressRenderer(),\r\n  parent_issue: new ParentIssueRenderer(),\r\n  linked_pull_requests: new PullRequestRenderer(),\r\n  tracks: new IssueRenderer(),\r\n};\r\n\r\nexport function renderCell(e: any, n: any, s: any, allItems: any) {\r\n  if (!e) return \"\";\r\n  try {\r\n    const strategy = strategies[e.type];\r\n    if (strategy) {\r\n      return strategy.render(e, n, s, allItems);\r\n    }\r\n    return \"\";\r\n  } catch (err) {\r\n    console.error(\"Error rendering cell\", err);\r\n    return \"\";\r\n  }\r\n}\r\n", "import { renderCell } from \"../renderers/cellRenderer\";\r\n\r\nexport class RowRenderer {\r\n  constructor(\r\n    private fields: any[],\r\n    private allItems: any[],\r\n    private onResizeStart: (\r\n      colIndex: number,\r\n      pageX: number,\r\n      startWidth: number,\r\n    ) => void,\r\n  ) {}\r\n\r\n  public createRow(item: any, index: number): HTMLTableRowElement {\r\n    const tr = document.createElement(\"tr\");\r\n    tr.classList.add(\"table-row\");\r\n    tr.setAttribute(\"data-gh-item-id\", item.id);\r\n\r\n    // Add row hover effect\r\n    tr.style.transition = \"background-color 0.15s ease\";\r\n    tr.addEventListener(\"mouseenter\", () => {\r\n      tr.style.backgroundColor = \"var(--vscode-list-hoverBackground)\";\r\n    });\r\n    tr.addEventListener(\"mouseleave\", () => {\r\n      tr.style.backgroundColor = \"transparent\";\r\n    });\r\n\r\n    // Index Cell\r\n    const tdIndex = document.createElement(\"td\");\r\n    tdIndex.textContent = String(index + 1);\r\n    this.styleCell(tdIndex);\r\n    tr.appendChild(tdIndex);\r\n\r\n    // Field Cells\r\n    for (let colIndex = 0; colIndex < this.fields.length; colIndex++) {\r\n      const field = this.fields[colIndex];\r\n      const td = document.createElement(\"td\");\r\n      this.styleCell(td);\r\n\r\n      const fv = item.fieldValues.find(\r\n        (v: any) =>\r\n          String(v.fieldId) === String(field.id) || v.fieldName === field.name,\r\n      );\r\n      if (fv) {\r\n        td.innerHTML = renderCell(fv, field, item, this.allItems);\r\n      }\r\n\r\n      // Make td position relative so we can position a resizer inside it\r\n      td.style.position = \"relative\";\r\n\r\n      // Add a small resizer handle to every cell so columns can be resized from any row\r\n      const cellResizer = document.createElement(\"div\");\r\n      cellResizer.className = \"column-resizer\";\r\n      cellResizer.style.position = \"absolute\";\r\n      cellResizer.style.top = \"0\";\r\n      cellResizer.style.right = \"0\";\r\n      cellResizer.style.width = \"6px\";\r\n      cellResizer.style.height = \"100%\";\r\n      cellResizer.style.cursor = \"col-resize\";\r\n      cellResizer.style.userSelect = \"none\";\r\n      cellResizer.style.zIndex = \"50\";\r\n\r\n      cellResizer.addEventListener(\r\n        \"mouseenter\",\r\n        () => (cellResizer.style.background = \"var(--vscode-focusBorder)\"),\r\n      );\r\n      cellResizer.addEventListener(\r\n        \"mouseleave\",\r\n        () => (cellResizer.style.background = \"transparent\"),\r\n      );\r\n\r\n      cellResizer.addEventListener(\"mousedown\", (e: MouseEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        // We need to find the table and column width.\r\n        // Since the row is attached to the table when this runs, we can find closest table.\r\n        const table = tr.closest(\"table\") as HTMLTableElement | null;\r\n        if (!table) return;\r\n\r\n        const cols = table.querySelectorAll(\"col\");\r\n        const col = cols[colIndex + 1] as HTMLTableColElement | undefined; // +1 for index column\r\n        const startWidth = col\r\n          ? parseInt(col.style.width) || col.offsetWidth\r\n          : td.offsetWidth;\r\n\r\n        this.onResizeStart(colIndex + 1, e.pageX, startWidth);\r\n      });\r\n\r\n      td.appendChild(cellResizer);\r\n      tr.appendChild(td);\r\n    }\r\n\r\n    return tr;\r\n  }\r\n\r\n  private styleCell(td: HTMLTableCellElement) {\r\n    td.style.padding = \"8px\";\r\n    td.style.borderRight = \"1px solid var(--vscode-panel-border)\";\r\n    td.style.borderBottom = \"1px solid var(--vscode-panel-border)\";\r\n    td.style.whiteSpace = \"nowrap\";\r\n    td.style.overflow = \"hidden\";\r\n    td.style.textOverflow = \"ellipsis\";\r\n  }\r\n}\r\n", "import { normalizeColor, escapeHtml } from \"../utils\";\r\nimport { RowRenderer } from \"./RowRenderer\";\r\n\r\nexport class GroupRenderer {\r\n  constructor(\r\n    private fields: any[],\r\n    private allItems: any[],\r\n  ) {}\r\n\r\n  /**\r\n   * Helper to get icon SVG from registry\r\n   */\r\n  private getIconSvg(iconName: string, size: number = 14): string {\r\n    if (typeof (window as any).getIconSvg === \"function\") {\r\n      return (window as any).getIconSvg(iconName, { size });\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  public renderGroup(\r\n    tbody: HTMLTableSectionElement,\r\n    group: any,\r\n    groupingField: any,\r\n    rowRenderer: RowRenderer,\r\n  ) {\r\n    // Render Group Header\r\n    const trHeader = document.createElement(\"tr\");\r\n    const tdHeader = document.createElement(\"td\");\r\n    tdHeader.colSpan = this.fields.length + 1;\r\n    tdHeader.style.padding = \"8px\";\r\n    tdHeader.style.background = \"var(--vscode-editor-background)\"; // Ensure opaque background\r\n    tdHeader.style.fontWeight = \"600\";\r\n    tdHeader.style.borderTop = \"1px solid var(--vscode-editorGroup-border)\";\r\n    tdHeader.style.borderBottom = \"1px solid var(--vscode-editorGroup-border)\";\r\n    tdHeader.style.position = \"sticky\";\r\n    tdHeader.style.top = \"32px\"; // Matches fixed header height\r\n    tdHeader.style.zIndex = \"9\";\r\n    tdHeader.style.boxShadow = \"0 1px 2px rgba(0,0,0,0.1)\"; // Add shadow for better separation\r\n\r\n    // Group Header Content\r\n    const headerContent = document.createElement(\"div\");\r\n    headerContent.style.display = \"flex\";\r\n    headerContent.style.alignItems = \"center\";\r\n    headerContent.style.gap = \"8px\";\r\n\r\n    // Helper: find estimate field id (best-effort)\r\n    const estimateField =\r\n      this.fields.find(\r\n        (f) =>\r\n          f.dataType &&\r\n          String(f.dataType).toLowerCase() === \"number\" &&\r\n          String(f.name || \"\")\r\n            .toLowerCase()\r\n            .includes(\"estimate\"),\r\n      ) ||\r\n      this.fields.find(\r\n        (f) => f.dataType && String(f.dataType).toLowerCase() === \"number\",\r\n      );\r\n    const estimateFieldId = estimateField ? estimateField.id : null;\r\n\r\n    const sumEstimate = (itemsArr: any[]) => {\r\n      if (!estimateFieldId) return 0;\r\n      let sum = 0;\r\n      for (const gi of itemsArr) {\r\n        const it = gi.item || gi;\r\n        if (!it || !Array.isArray(it.fieldValues)) continue;\r\n        const fv = it.fieldValues.find(\r\n          (v: any) =>\r\n            (v.fieldId && String(v.fieldId) === String(estimateFieldId)) ||\r\n            (v.fieldName &&\r\n              String(v.fieldName).toLowerCase().includes(\"estimate\")) ||\r\n            v.type === \"number\",\r\n        );\r\n        if (fv) {\r\n          const num = Number(\r\n            fv.number != null ? fv.number : fv.value != null ? fv.value : NaN,\r\n          );\r\n          if (!isNaN(num)) sum += num;\r\n        }\r\n      }\r\n      return sum;\r\n    };\r\n\r\n    const formatEstimate = (n: number) => {\r\n      if (!isFinite(n)) return \"\";\r\n      return String(n);\r\n    };\r\n\r\n    // Toggle Button\r\n    const toggleBtn = document.createElement(\"span\");\r\n    // SVG Icons for GitHub-like look from icon registry\r\n    const iconExpanded = this.getIconSvg(\"triangle-down\", 16);\r\n    const iconCollapsed = this.getIconSvg(\"triangle-right\", 16);\r\n\r\n    toggleBtn.innerHTML = iconExpanded;\r\n    toggleBtn.style.cursor = \"pointer\";\r\n    toggleBtn.style.userSelect = \"none\";\r\n    toggleBtn.style.display = \"inline-flex\";\r\n    toggleBtn.style.alignItems = \"center\";\r\n    toggleBtn.style.justifyContent = \"center\";\r\n    toggleBtn.style.width = \"16px\";\r\n    toggleBtn.style.height = \"16px\";\r\n    toggleBtn.style.fill = \"var(--vscode-foreground)\";\r\n    toggleBtn.style.opacity = \"0.7\";\r\n\r\n    // Group Name & Color\r\n    const colorDot = document.createElement(\"div\");\r\n    colorDot.style.width = \"12px\";\r\n    colorDot.style.height = \"12px\";\r\n    colorDot.style.borderRadius = \"50%\";\r\n    colorDot.style.backgroundColor =\r\n      normalizeColor(group.option.color) || \"gray\";\r\n\r\n    const nameSpan = document.createElement(\"span\");\r\n    nameSpan.textContent =\r\n      group.option.name || group.option.title || \"Unassigned\";\r\n\r\n    // We'll keep the left-hand part of the group header (toggle, avatar/color, name, count)\r\n    // in a sticky left pane so it remains visible when horizontally scrolling.\r\n    const leftPane = document.createElement(\"div\");\r\n    leftPane.style.display = \"flex\";\r\n    leftPane.style.alignItems = \"center\";\r\n    leftPane.style.gap = \"8px\";\r\n    leftPane.style.position = \"sticky\";\r\n    leftPane.style.left = \"0\";\r\n    leftPane.style.zIndex = \"12\";\r\n    leftPane.style.background = tdHeader.style.background;\r\n    leftPane.style.paddingRight = \"8px\";\r\n\r\n    const rightPane = document.createElement(\"div\");\r\n    rightPane.style.display = \"flex\";\r\n    rightPane.style.alignItems = \"center\";\r\n    rightPane.style.gap = \"8px\";\r\n    rightPane.style.flex = \"1\";\r\n\r\n    leftPane.appendChild(toggleBtn);\r\n\r\n    // For parent_issue, try to extract parent metadata from the first child item\r\n    let parentMeta: any = null;\r\n    let resolvedParentItem: any = null;\r\n    if (String(groupingField.dataType || \"\").toLowerCase() === \"parent_issue\") {\r\n      const first =\r\n        group.items && group.items[0]\r\n          ? group.items[0].item || group.items[0]\r\n          : null;\r\n      if (first && Array.isArray(first.fieldValues)) {\r\n        const pfv = first.fieldValues.find(\r\n          (v: any) =>\r\n            String(v.fieldId) === String(groupingField.id) ||\r\n            v.fieldName === groupingField.name ||\r\n            v.type === \"parent_issue\",\r\n        );\r\n        if (pfv) {\r\n          parentMeta =\r\n            pfv.parent ||\r\n            pfv.parentIssue ||\r\n            pfv.issue ||\r\n            pfv.item ||\r\n            pfv.value ||\r\n            null;\r\n        }\r\n      }\r\n\r\n      // Try to resolve the full parent item from the current items snapshot (this.allItems)\r\n      if (parentMeta && Array.isArray(this.allItems)) {\r\n        try {\r\n          const identifiers: string[] = [];\r\n          if (parentMeta.number) identifiers.push(String(parentMeta.number));\r\n          if (parentMeta.id) identifiers.push(String(parentMeta.id));\r\n          if (parentMeta.url) identifiers.push(String(parentMeta.url));\r\n          if (parentMeta.title) identifiers.push(String(parentMeta.title));\r\n          // search in this.allItems for a matching content/raw identifiers\r\n          const found = this.allItems.find((A: any) => {\r\n            const d =\r\n              (A && (A.content || (A.raw && A.raw.itemContent))) || null;\r\n            if (!d) return false;\r\n            const M: string[] = [];\r\n            if (d.number) M.push(String(d.number));\r\n            if (d.id) M.push(String(d.id));\r\n            if (d.url) M.push(String(d.url));\r\n            if (d.title) M.push(String(d.title));\r\n            if (d.name) M.push(String(d.name));\r\n            if (d.raw && d.raw.number) M.push(String(d.raw.number));\r\n            if (d.raw && d.raw.id) M.push(String(d.raw.id));\r\n            if (d.raw && d.raw.url) M.push(String(d.raw.url));\r\n            for (let o of identifiers) {\r\n              for (let m of M) {\r\n                if (o && m && String(o) === String(m)) return true;\r\n              }\r\n            }\r\n            return false;\r\n          });\r\n          if (found) resolvedParentItem = found;\r\n        } catch (e) {}\r\n      }\r\n    }\r\n\r\n    // Avatar / color dot / repo icon depending on field type\r\n    if (\r\n      (group.option && group.option.avatarUrl) ||\r\n      (group.option && group.option.login) ||\r\n      (group.option &&\r\n        group.option.name &&\r\n        String(groupingField.dataType || \"\").toLowerCase() === \"assignees\")\r\n    ) {\r\n      // Try to render avatar for assignees\r\n      const avatarEl = document.createElement(\"span\");\r\n      const avatarUrl =\r\n        (group.option &&\r\n          (group.option.avatarUrl ||\r\n            group.option.avatar ||\r\n            group.option.imageUrl)) ||\r\n        (() => {\r\n          // try to find in items\r\n          for (const gi of group.items) {\r\n            const it = gi.item || gi;\r\n            if (!it || !Array.isArray(it.fieldValues)) continue;\r\n            const fv = it.fieldValues.find(\r\n              (v: any) =>\r\n                v.type === \"assignees\" ||\r\n                String(v.fieldId) === String(groupingField.id),\r\n            );\r\n            if (fv && fv.assignees && Array.isArray(fv.assignees)) {\r\n              const match = fv.assignees.find(\r\n                (a: any) =>\r\n                  String(a.login || a.name) ===\r\n                  String(group.option.name || group.option.id),\r\n              );\r\n              if (match && (match.avatarUrl || match.avatar))\r\n                return match.avatarUrl || match.avatar;\r\n            }\r\n          }\r\n          return null;\r\n        })();\r\n      if (avatarUrl) {\r\n        avatarEl.innerHTML =\r\n          '<span title=\"' +\r\n          escapeHtml(\r\n            (group.option && (group.option.login || group.option.name)) ||\r\n              \"Assignee\",\r\n          ) +\r\n          '\" style=\"display:inline-block;width:20px;height:20px;border-radius:50%;overflow:hidden;background-size:cover;background-position:center;background-image:url(' +\r\n          escapeHtml(avatarUrl) +\r\n          ');border:2px solid var(--vscode-editor-background)\"></span>';\r\n        leftPane.appendChild(avatarEl);\r\n      } else {\r\n        leftPane.appendChild(colorDot);\r\n      }\r\n    } else if (\r\n      String(groupingField.dataType || \"\").toLowerCase() === \"repository\"\r\n    ) {\r\n      // repository icon\r\n      const repoIcon = document.createElement(\"span\");\r\n      repoIcon.innerHTML =\r\n        '<svg width=\"14\" height=\"14\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style=\"flex-shrink:0;color:var(--vscode-icon-foreground)\"><path fill=\"currentColor\" d=\"M2 2.5A1.5 1.5 0 0 1 3.5 1h9A1.5 1.5 0 0 1 14 2.5v11A1.5 1.5 0 0 1 12.5 15h-9A1.5 1.5 0 0 1 2 13.5v-11zM3.5 2A.5.5 0 0 0 3 2.5V4h10V2.5a.5.5 0 0 0-.5-.5h-9z\"/></svg>';\r\n      leftPane.appendChild(repoIcon);\r\n    } else {\r\n      leftPane.appendChild(colorDot);\r\n    }\r\n\r\n    // Name\r\n    // For parent_issue, prefer the resolved parent item's title if available, else use parentMeta\r\n    if (resolvedParentItem) {\r\n      // Try to extract title and status color from resolved parent\r\n      const content =\r\n        resolvedParentItem.content ||\r\n        (resolvedParentItem.raw && resolvedParentItem.raw.itemContent) ||\r\n        null;\r\n      if (content) {\r\n        // title\r\n        try {\r\n          if (content.title) nameSpan.textContent = String(content.title);\r\n          else if (content.name) nameSpan.textContent = String(content.name);\r\n          else if (content.number)\r\n            nameSpan.textContent = String(content.number);\r\n        } catch (e) {}\r\n\r\n        // Try to get status color from parent's fieldValues (single_select status)\r\n        if (Array.isArray(resolvedParentItem.fieldValues)) {\r\n          const statusFV = resolvedParentItem.fieldValues.find(\r\n            (v: any) =>\r\n              v && v.type === \"single_select\" && v.option && v.option.name,\r\n          );\r\n          if (statusFV && statusFV.option) {\r\n            // If option has color, use it; otherwise try map by name\r\n            try {\r\n              const c =\r\n                statusFV.option.color ||\r\n                statusFV.option.id ||\r\n                statusFV.option.name ||\r\n                null;\r\n              if (c)\r\n                colorDot.style.backgroundColor =\r\n                  normalizeColor(c) || colorDot.style.backgroundColor;\r\n            } catch (e) {}\r\n          }\r\n        }\r\n      }\r\n    } else if (parentMeta) {\r\n      nameSpan.textContent =\r\n        parentMeta.title ||\r\n        parentMeta.name ||\r\n        parentMeta.number ||\r\n        parentMeta.id ||\r\n        nameSpan.textContent;\r\n      if (parentMeta.color) {\r\n        try {\r\n          colorDot.style.backgroundColor =\r\n            normalizeColor(parentMeta.color) || colorDot.style.backgroundColor;\r\n        } catch (e) {}\r\n      }\r\n    }\r\n    leftPane.appendChild(nameSpan);\r\n\r\n    // Count circle (placed before estimate pill)\r\n    const countCircle = document.createElement(\"span\");\r\n    countCircle.style.display = \"inline-flex\";\r\n    countCircle.style.alignItems = \"center\";\r\n    countCircle.style.justifyContent = \"center\";\r\n    countCircle.style.width = \"22px\";\r\n    countCircle.style.height = \"22px\";\r\n    countCircle.style.borderRadius = \"50%\";\r\n    countCircle.style.background = \"var(--vscode-input-background)\";\r\n    countCircle.style.border = \"1px solid var(--vscode-panel-border)\";\r\n    countCircle.style.color = \"var(--vscode-foreground)\";\r\n    countCircle.style.fontSize = \"12px\";\r\n    countCircle.style.fontWeight = \"600\";\r\n    countCircle.style.minWidth = \"22px\";\r\n    countCircle.style.boxSizing = \"border-box\";\r\n    countCircle.textContent = String(group.items.length || 0);\r\n    leftPane.appendChild(countCircle);\r\n\r\n    // Estimate pill and optional extra info\r\n    const estSum = sumEstimate(group.items || []);\r\n    if (estSum && estSum > 0) {\r\n      const estEl = document.createElement(\"div\");\r\n      estEl.style.display = \"inline-block\";\r\n      estEl.style.padding = \"2px 8px\";\r\n      estEl.style.borderRadius = \"999px\";\r\n      estEl.style.border = \"1px solid var(--vscode-panel-border)\";\r\n      estEl.style.background = \"var(--vscode-input-background)\";\r\n      estEl.style.color = \"var(--vscode-foreground)\";\r\n      estEl.style.fontSize = \"12px\";\r\n      estEl.style.lineHeight = \"18px\";\r\n      estEl.style.marginLeft = \"8px\";\r\n      estEl.textContent = \"Estimate: \" + formatEstimate(estSum);\r\n      // Put estimate pill into the left sticky pane so it remains visible when horizontally scrolling\r\n      leftPane.appendChild(estEl);\r\n\r\n      // If parent_issue, show completed/amount + progress bar (only for real parents)\r\n      if (\r\n        String(groupingField.dataType || \"\").toLowerCase() === \"parent_issue\" &&\r\n        !(\r\n          group.option &&\r\n          (group.option.name === \"Unassigned\" ||\r\n            group.option.title === \"Unassigned\")\r\n        )\r\n      ) {\r\n        const completedNames = [\"done\", \"closed\", \"completed\", \"finished\"];\r\n\r\n        // Helper: robust done detection for a single item\r\n        const isDoneByHeuristics = (it: any) => {\r\n          try {\r\n            const content =\r\n              it && (it.content || (it.raw && it.raw.itemContent));\r\n            if (content) {\r\n              const state = (\r\n                content.state ||\r\n                (content.merged ? \"MERGED\" : undefined) ||\r\n                \"\"\r\n              )\r\n                .toString()\r\n                .toUpperCase();\r\n              if (state === \"CLOSED\" || state === \"MERGED\") return true;\r\n            }\r\n\r\n            if (Array.isArray(it.fieldValues)) {\r\n              // single_select status matching\r\n              const ss = it.fieldValues.find(\r\n                (v: any) =>\r\n                  v &&\r\n                  v.type === \"single_select\" &&\r\n                  v.option &&\r\n                  v.option.name &&\r\n                  completedNames.includes(String(v.option.name).toLowerCase()),\r\n              );\r\n              if (ss) return true;\r\n\r\n              // numeric percent-like or explicit done flag\r\n              const percentFV = it.fieldValues.find(\r\n                (v: any) =>\r\n                  v &&\r\n                  (String(v.fieldName || \"\")\r\n                    .toLowerCase()\r\n                    .includes(\"progress\") ||\r\n                    String(v.fieldName || \"\")\r\n                      .toLowerCase()\r\n                      .includes(\"percent\") ||\r\n                    (v.type === \"number\" &&\r\n                      String(v.fieldName || \"\")\r\n                        .toLowerCase()\r\n                        .includes(\"progress\"))),\r\n              );\r\n              if (percentFV && percentFV.number != null) {\r\n                const pct = Number(percentFV.number || 0);\r\n                if (pct >= 100) return true;\r\n              }\r\n            }\r\n\r\n            if (\r\n              content &&\r\n              content.labels &&\r\n              Array.isArray(content.labels.nodes)\r\n            ) {\r\n              const labs = content.labels.nodes.map((l: any) =>\r\n                String(l.name || \"\").toLowerCase(),\r\n              );\r\n              for (const cn of completedNames)\r\n                if (labs.includes(cn)) return true;\r\n            }\r\n          } catch (e) {}\r\n          return false;\r\n        };\r\n\r\n        // Prefer parent-provided aggregate if available\r\n        let done = 0;\r\n        let total = 0;\r\n        if (\r\n          resolvedParentItem &&\r\n          Array.isArray(resolvedParentItem.fieldValues)\r\n        ) {\r\n          const agg = resolvedParentItem.fieldValues.find(\r\n            (v: any) =>\r\n              v &&\r\n              (v.type === \"sub_issues_progress\" ||\r\n                (v.total != null && v.done != null)),\r\n          );\r\n          if (agg && agg.total != null) {\r\n            total = Number(agg.total || 0);\r\n            done = Number(agg.done || 0);\r\n          }\r\n        }\r\n\r\n        // If no parent aggregate found, compute from children\r\n        if (!total) {\r\n          for (const gi of group.items) {\r\n            const it = gi.item || gi;\r\n            if (!it) continue;\r\n            total++;\r\n            if (isDoneByHeuristics(it)) done++;\r\n          }\r\n        }\r\n\r\n        // show completed/total BEFORE progress bar\r\n        const doneText = document.createElement(\"div\");\r\n        doneText.style.color = \"var(--vscode-descriptionForeground)\";\r\n        doneText.style.fontSize = \"12px\";\r\n        doneText.style.marginLeft = \"8px\";\r\n        doneText.style.fontVariantNumeric = \"tabular-nums\";\r\n        doneText.textContent = `${done}/${total}`;\r\n        // Keep completed/total near the left sticky area so it stays visible\r\n        leftPane.appendChild(doneText);\r\n\r\n        // show progress bar\r\n        const progWrapper = document.createElement(\"div\");\r\n        progWrapper.style.display = \"inline-flex\";\r\n        progWrapper.style.alignItems = \"center\";\r\n        progWrapper.style.gap = \"8px\";\r\n        progWrapper.style.marginLeft = \"8px\";\r\n        const pct = total > 0 ? Math.round((done / total) * 100) : 0;\r\n        const bar = document.createElement(\"div\");\r\n        bar.style.display = \"inline-block\";\r\n        bar.style.width = \"120px\";\r\n        bar.style.height = \"12px\";\r\n        bar.style.background = \"transparent\";\r\n        bar.style.border = \"1px solid var(--vscode-focusBorder)\";\r\n        bar.style.borderRadius = \"6px\";\r\n        bar.style.overflow = \"hidden\";\r\n        const fill = document.createElement(\"div\");\r\n        fill.style.height = \"100%\";\r\n        fill.style.width = String(pct) + \"%\";\r\n        fill.style.background = \"var(--vscode-focusBorder)\";\r\n        bar.appendChild(fill);\r\n        progWrapper.appendChild(bar);\r\n        // Progress bar is useful summary info \u2014 keep it in the sticky left pane\r\n        leftPane.appendChild(progWrapper);\r\n      }\r\n    }\r\n\r\n    // Single-select: show option description if available\r\n    if (\r\n      String(groupingField.dataType || \"\").toLowerCase() === \"single_select\"\r\n    ) {\r\n      try {\r\n        const opt = (groupingField.options || []).find(\r\n          (o: any) =>\r\n            String(o.name) === String(group.option && group.option.name),\r\n        );\r\n        if (opt && opt.description) {\r\n          const descEl = document.createElement(\"div\");\r\n          descEl.style.color = \"var(--vscode-descriptionForeground)\";\r\n          descEl.style.fontSize = \"12px\";\r\n          descEl.style.marginLeft = \"8px\";\r\n          descEl.textContent = String(opt.description).slice(0, 120);\r\n          // Keep description fixed in the left sticky pane so it remains visible\r\n          leftPane.appendChild(descEl);\r\n        }\r\n      } catch (e) {}\r\n    }\r\n\r\n    // Iteration: append iteration range (start - end) if startDate/duration available, else title\r\n    if (String(groupingField.dataType || \"\").toLowerCase() === \"iteration\") {\r\n      try {\r\n        const opt = group.option || {};\r\n        let iterText: string | null = null;\r\n        const start = opt.startDate || (opt.start && opt.startDate) || null;\r\n        const duration = opt.duration || opt.length || null;\r\n        if (start && duration) {\r\n          try {\r\n            const s = new Date(start);\r\n            const days = Number(duration) || 0;\r\n            const e = new Date(s.getTime() + days * 24 * 60 * 60 * 1000);\r\n            const sStr = s.toLocaleDateString(\"en-US\", {\r\n              month: \"short\",\r\n              day: \"numeric\",\r\n            });\r\n            const eStr = e.toLocaleDateString(\"en-US\", {\r\n              month: \"short\",\r\n              day: \"numeric\",\r\n            });\r\n            iterText = `${sStr} \u2014 ${eStr}`;\r\n          } catch (e) {\r\n            iterText = null;\r\n          }\r\n        }\r\n        if (!iterText) {\r\n          iterText =\r\n            opt.title || opt.name ? String(opt.title || opt.name) : null;\r\n        }\r\n        if (iterText) {\r\n          const iterEl = document.createElement(\"div\");\r\n          iterEl.style.color = \"var(--vscode-descriptionForeground)\";\r\n          iterEl.style.fontSize = \"12px\";\r\n          iterEl.style.marginLeft = \"8px\";\r\n          iterEl.textContent = String(iterText).slice(0, 120);\r\n          // Keep iteration info fixed in the left sticky pane\r\n          leftPane.appendChild(iterEl);\r\n        }\r\n      } catch (e) {}\r\n    }\r\n\r\n    // If this group corresponds to 'Unassigned', rename to 'No <fieldname>'\r\n    if (\r\n      group.option &&\r\n      (group.option.name === \"Unassigned\" ||\r\n        group.option.title === \"Unassigned\")\r\n    ) {\r\n      nameSpan.textContent = \"No \" + (groupingField.name || \"value\");\r\n    }\r\n\r\n    // Compose header: leftPane (sticky) + rightPane (scrolling content)\r\n    headerContent.appendChild(leftPane);\r\n    headerContent.appendChild(rightPane);\r\n\r\n    tdHeader.appendChild(headerContent);\r\n    trHeader.appendChild(tdHeader);\r\n    tbody.appendChild(trHeader);\r\n\r\n    // Render Items\r\n    const groupRows: HTMLTableRowElement[] = [];\r\n    group.items.forEach((groupItem: any) => {\r\n      const tr = rowRenderer.createRow(groupItem.item, groupItem.index);\r\n      tr.classList.add(\"group-row-\" + group.option.id); // Add class for group toggling\r\n      tbody.appendChild(tr);\r\n      groupRows.push(tr);\r\n    });\r\n\r\n    // Toggle Logic\r\n    let isCollapsed = false;\r\n    toggleBtn.addEventListener(\"click\", () => {\r\n      isCollapsed = !isCollapsed;\r\n      toggleBtn.innerHTML = isCollapsed ? iconCollapsed : iconExpanded;\r\n      groupRows.forEach((row) => {\r\n        row.style.display = isCollapsed ? \"none\" : \"table-row\";\r\n      });\r\n    });\r\n  }\r\n}\r\n", "export class TableResizer {\r\n  constructor(\r\n    private table: HTMLTableElement,\r\n    private fields: any[],\r\n    private options: any,\r\n  ) {}\r\n\r\n  public setupResizers() {\r\n    const headers = this.table.querySelectorAll(\"th\");\r\n\r\n    headers.forEach((th, index) => {\r\n      // Skip index column\r\n      if (index === 0) return;\r\n\r\n      // Create resizer element\r\n      const resizer = document.createElement(\"div\");\r\n      resizer.className = \"column-resizer\";\r\n      resizer.style.position = \"absolute\";\r\n      resizer.style.top = \"0\";\r\n      resizer.style.right = \"0\";\r\n      resizer.style.width = \"4px\";\r\n      resizer.style.height = \"100%\";\r\n      resizer.style.cursor = \"col-resize\";\r\n      resizer.style.userSelect = \"none\";\r\n      resizer.style.zIndex = \"100\";\r\n\r\n      // Visual feedback on hover\r\n      resizer.addEventListener(\"mouseenter\", () => {\r\n        resizer.style.background = \"var(--vscode-focusBorder)\";\r\n      });\r\n\r\n      resizer.addEventListener(\"mouseleave\", () => {\r\n        resizer.style.background = \"transparent\";\r\n      });\r\n\r\n      // Resize logic\r\n      resizer.addEventListener(\"mousedown\", (e: MouseEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const cols = this.table.querySelectorAll(\"col\");\r\n        const col = cols[index] as HTMLTableColElement | undefined; // index aligns with th\r\n        const startW = col\r\n          ? parseInt(col.style.width) || col.offsetWidth\r\n          : th.offsetWidth;\r\n        this.beginColumnResize(index, e.pageX, startW);\r\n      });\r\n\r\n      // Make th position relative for absolute positioning\r\n      (th as HTMLElement).style.position = \"relative\";\r\n      th.appendChild(resizer);\r\n    });\r\n\r\n    // Restore column widths from localStorage\r\n    this.restoreColumnWidths();\r\n  }\r\n\r\n  public beginColumnResize(\r\n    colIndex: number,\r\n    startX: number,\r\n    startWidth: number,\r\n  ) {\r\n    const onMouseMove = (e: MouseEvent) => {\r\n      const newWidth = Math.max(20, startWidth + (e.pageX - startX));\r\n      const cols = this.table.querySelectorAll(\"col\");\r\n      const col = cols[colIndex] as HTMLTableColElement | undefined;\r\n      if (col) {\r\n        col.style.width = `${newWidth}px`;\r\n        col.style.minWidth = `${newWidth}px`;\r\n        col.style.maxWidth = `${newWidth}px`;\r\n      }\r\n    };\r\n\r\n    const onMouseUp = (e?: MouseEvent) => {\r\n      document.removeEventListener(\"mousemove\", onMouseMove);\r\n      document.removeEventListener(\"mouseup\", onMouseUp);\r\n\r\n      // Save mapping to field id (colIndex - 1 => fields)\r\n      const fieldIndex = colIndex - 1;\r\n      if (fieldIndex >= 0 && fieldIndex < this.fields.length) {\r\n        const cols = this.table.querySelectorAll(\"col\");\r\n        const col = cols[colIndex] as HTMLTableColElement | undefined;\r\n        const widthToSave = col\r\n          ? parseInt(col.style.width) || col.offsetWidth\r\n          : undefined;\r\n        if (widthToSave) {\r\n          this.saveColumnWidth(this.fields[fieldIndex].id, widthToSave);\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"mousemove\", onMouseMove);\r\n    document.addEventListener(\"mouseup\", onMouseUp);\r\n  }\r\n\r\n  private saveColumnWidth(fieldId: string, width: number) {\r\n    const key = this.getStorageKey(\"columnWidths\");\r\n    if (!key) return;\r\n\r\n    try {\r\n      const stored = localStorage.getItem(key);\r\n      const widths = stored ? JSON.parse(stored) : {};\r\n      widths[fieldId] = width;\r\n      localStorage.setItem(key, JSON.stringify(widths));\r\n    } catch (e) {}\r\n  }\r\n\r\n  private restoreColumnWidths() {\r\n    const key = this.getStorageKey(\"columnWidths\");\r\n    if (!key) return;\r\n\r\n    try {\r\n      const stored = localStorage.getItem(key);\r\n      if (!stored) return;\r\n\r\n      const widths = JSON.parse(stored);\r\n      const cols = this.table.querySelectorAll(\"col\");\r\n\r\n      this.fields.forEach((field, index) => {\r\n        const width = widths[field.id];\r\n        if (width) {\r\n          const col = cols[index + 1] as HTMLTableColElement; // +1 for index column\r\n          if (col) {\r\n            col.style.width = `${width}px`;\r\n            col.style.minWidth = `${width}px`;\r\n            col.style.maxWidth = `${width}px`;\r\n          }\r\n        }\r\n      });\r\n    } catch (e) {}\r\n  }\r\n\r\n  private getStorageKey(suffix: string): string {\r\n    return this.options.viewKey\r\n      ? `ghProjects.table.${this.options.viewKey}.${suffix}`\r\n      : \"\";\r\n  }\r\n}\r\n", "import { renderCell } from \"../renderers/cellRenderer\";\r\nimport { normalizeColor, getContrastColor, escapeHtml } from \"../utils\";\r\nimport { ColumnHeaderMenu } from \"./ColumnHeaderMenu\";\r\nimport { ColumnHeaderRenderer } from \"../renderers/columnHeaderRenderer\";\r\nimport FieldsMenu from \"./FieldsMenu\";\r\nimport { SlicePanel } from \"./SlicePanel\";\r\nimport type { SortConfig } from \"../utils/tableSorting\";\r\nimport { sortItems } from \"../utils/tableSorting\";\r\nimport { GroupDataService } from \"../services/GroupDataService\";\r\nimport { RowRenderer } from \"../renderers/RowRenderer\";\r\nimport { GroupRenderer } from \"../renderers/GroupRenderer\";\r\nimport { TableResizer } from \"./TableResizer\";\r\n\r\nexport interface TableOptions {\r\n  groupingFieldName?: string;\r\n  sortConfig?: SortConfig | null;\r\n  viewKey?: string;\r\n  hiddenFields?: string[];\r\n  onSortChange?: (config: SortConfig) => void;\r\n  onGroupChange?: (fieldName: string) => void;\r\n  onSliceChange?: (field: any) => void;\r\n  onHiddenFieldsChange?: (hiddenIds: string[]) => void;\r\n}\r\n\r\nexport class ProjectTable {\r\n  private container: HTMLElement;\r\n  private allFields: any[]; // All fields including hidden\r\n  private fields: any[]; // Visible fields only\r\n  private items: any[];\r\n  private options: TableOptions;\r\n  private hiddenFieldIds: Set<string>;\r\n  private activeMenu: ColumnHeaderMenu | null = null;\r\n  private activeFieldsMenu: FieldsMenu | null = null;\r\n  private activeSlicePanel: SlicePanel | null = null;\r\n  private activeSlice: { fieldId: string; value: any } | null = null;\r\n  // Track which field the active slice panel is for (panel may be open before a value is selected)\r\n  private activeSlicePanelFieldId: string | null = null;\r\n  private tableResizer: TableResizer | null = null;\r\n\r\n  constructor(\r\n    container: HTMLElement,\r\n    fields: any[],\r\n    items: any[],\r\n    options: TableOptions = {},\r\n  ) {\r\n    this.container = container;\r\n    // Normalize all field ids to strings to avoid type mismatches\r\n    this.allFields = (fields || []).map((f) => ({ ...f, id: String(f.id) }));\r\n    this.options = options;\r\n    this.items = items;\r\n\r\n    // Load hidden fields from options or localStorage\r\n    const hiddenFromStorage = this.loadHiddenFields().map((id) => String(id));\r\n    const hiddenFromOptions = (options.hiddenFields || []).map((id) =>\r\n      String(id),\r\n    );\r\n    this.hiddenFieldIds = new Set<string>([\r\n      ...hiddenFromStorage,\r\n      ...hiddenFromOptions,\r\n    ]);\r\n\r\n    // Filter visible fields (ids already normalized on allFields)\r\n    this.fields = this.allFields.filter((f) => !this.hiddenFieldIds.has(f.id));\r\n\r\n    // Debug: log initial hidden/visible sets\r\n    try {\r\n      console.debug(\r\n        \"[ProjectTable] init: allFieldIds=\",\r\n        this.allFields.map((f) => f.id),\r\n      );\r\n      console.debug(\r\n        \"[ProjectTable] init: hiddenFieldIds=\",\r\n        Array.from(this.hiddenFieldIds),\r\n      );\r\n      console.debug(\r\n        \"[ProjectTable] init: visibleFieldIds=\",\r\n        this.fields.map((f) => f.id),\r\n      );\r\n    } catch (e) {}\r\n\r\n    // Also forward debug info to the extension output channel so it's visible\r\n    try {\r\n      const dbg = {\r\n        allFieldIds: this.allFields.map((f: any) => String(f.id)),\r\n        hiddenFieldIds: Array.from(this.hiddenFieldIds),\r\n        visibleFieldIds: this.fields.map((f: any) => String(f.id)),\r\n      };\r\n      if (\r\n        (window as any).__APP_MESSAGING__ &&\r\n        typeof (window as any).__APP_MESSAGING__.postMessage === \"function\"\r\n      ) {\r\n        (window as any).__APP_MESSAGING__.postMessage({\r\n          command: \"debugLog\",\r\n          level: \"debug\",\r\n          message: \"ProjectTable init\",\r\n          data: dbg,\r\n          viewKey: this.options.viewKey,\r\n        });\r\n      }\r\n    } catch (e) {}\r\n\r\n    // Load and apply field order if stored\r\n    this.applyFieldOrder();\r\n  }\r\n\r\n  public render() {\r\n    // Preserve slice panel if it exists\r\n    const existingSlicePanel = this.container.querySelector(\".slice-panel\");\r\n\r\n    this.container.innerHTML = \"\";\r\n\r\n    // Re-add slice panel if it existed\r\n    if (existingSlicePanel) {\r\n      this.container.appendChild(existingSlicePanel);\r\n    }\r\n\r\n    const tableContainer = document.createElement(\"div\");\r\n    tableContainer.className = \"table-wrapper\";\r\n    tableContainer.style.overflowX = \"auto\";\r\n    tableContainer.style.overflowY = \"auto\";\r\n    tableContainer.style.width = \"100%\";\r\n    tableContainer.style.display = \"block\";\r\n    tableContainer.style.height = \"100%\"; // Let it grow\r\n\r\n    const table = document.createElement(\"table\");\r\n    table.style.borderCollapse = \"separate\";\r\n    table.style.borderSpacing = \"0\";\r\n    // Use fixed layout so explicit <col> widths are honored and columns can be\r\n    // resized smaller than their content (content will be ellipsised).\r\n    table.style.tableLayout = \"fixed\";\r\n    // Let container control horizontal scrolling while table fills width\r\n    table.style.width = \"100%\";\r\n\r\n    this.renderColGroup(table);\r\n    new ColumnHeaderRenderer({\r\n      fields: this.fields,\r\n      sortConfig: this.options.sortConfig,\r\n      groupingFieldName: this.options.groupingFieldName,\r\n      activeSlice: this.activeSlice,\r\n      activeSlicePanelFieldId: this.activeSlicePanelFieldId,\r\n      onHeaderMenu: this.showHeaderMenu.bind(this),\r\n      onShowFieldsMenu: this.showFieldsMenu.bind(this),\r\n      onClearGroup: this.clearGroup.bind(this),\r\n      onClearSlice: this.clearSlice.bind(this),\r\n    }).render(table);\r\n    this.renderBody(table);\r\n\r\n    tableContainer.appendChild(table);\r\n    this.container.appendChild(tableContainer);\r\n\r\n    // Post-render: adjust column widths based on content (simple heuristic)\r\n    // This was in the original code, we can keep it or improve it.\r\n    // For now, let's keep the sticky header logic and resizers.\r\n    this.tableResizer = new TableResizer(table, this.fields, this.options);\r\n    this.tableResizer.setupResizers();\r\n  }\r\n\r\n  private renderColGroup(table: HTMLTableElement) {\r\n    const colgroup = document.createElement(\"colgroup\");\r\n    // Index column\r\n    const colIndex = document.createElement(\"col\");\r\n    colIndex.style.width = \"40px\";\r\n    colgroup.appendChild(colIndex);\r\n\r\n    for (const field of this.fields) {\r\n      const col = document.createElement(\"col\");\r\n      col.style.width = \"150px\"; // Default width\r\n      // Attach field id so resizer can update the correct <col>\r\n      col.dataset.fieldId = field.id;\r\n      colgroup.appendChild(col);\r\n    }\r\n\r\n    // Add Field column\r\n    const colAddField = document.createElement(\"col\");\r\n    colAddField.style.width = \"50px\";\r\n    colgroup.appendChild(colAddField);\r\n\r\n    table.appendChild(colgroup);\r\n  }\r\n\r\n  private showFieldsMenu(anchorElement: HTMLElement) {\r\n    // Hide existing menus\r\n    if (this.activeMenu) {\r\n      this.activeMenu.hide();\r\n      this.activeMenu = null;\r\n    }\r\n    if (this.activeFieldsMenu) {\r\n      this.activeFieldsMenu.hide();\r\n      this.activeFieldsMenu = null;\r\n    }\r\n\r\n    // Build visible id set from hiddenFieldIds to ensure consistent detection (normalize ids)\r\n    const visibleSet = new Set<string>(\r\n      this.allFields\r\n        .filter((f) => !this.hiddenFieldIds.has(String(f.id)))\r\n        .map((f) => String(f.id)),\r\n    );\r\n\r\n    // Debug: log current hidden/visible sets before showing menu\r\n    try {\r\n      console.debug(\r\n        \"[ProjectTable] showFieldsMenu: hiddenFieldIds=\",\r\n        Array.from(this.hiddenFieldIds),\r\n      );\r\n      console.debug(\r\n        \"[ProjectTable] showFieldsMenu: allFieldIds=\",\r\n        this.allFields.map((f) => f.id),\r\n      );\r\n    } catch (e) {}\r\n\r\n    const menu = new FieldsMenu({\r\n      fields: this.allFields.map((f) => ({\r\n        id: f.id,\r\n        name: f.name,\r\n        iconClass: f.iconClass,\r\n        dataType: f.dataType || f.type,\r\n      })),\r\n      visibleFieldIds: visibleSet,\r\n      onToggleVisibility: (fieldId: string, visible: boolean) => {\r\n        if (visible) this.showField(fieldId);\r\n        else this.hideField(fieldId);\r\n      },\r\n      onCreateField: () => {\r\n        // Placeholder: open create field flow if available\r\n        try {\r\n          console.log(\"Create field requested\");\r\n        } catch (e) {}\r\n      },\r\n    });\r\n\r\n    this.activeFieldsMenu = menu;\r\n    menu.show(anchorElement);\r\n  }\r\n\r\n  private renderBody(table: HTMLTableElement) {\r\n    const tbody = document.createElement(\"tbody\");\r\n\r\n    // Apply sorting\r\n    let displayItems = this.items;\r\n    if (this.options.sortConfig) {\r\n      displayItems = sortItems(\r\n        this.items,\r\n        this.fields,\r\n        this.options.sortConfig,\r\n      );\r\n    }\r\n\r\n    // Apply Slice Filter\r\n    if (this.activeSlice) {\r\n      displayItems = displayItems.filter((item) => {\r\n        const fv = item.fieldValues.find(\r\n          (v: any) => String(v.fieldId) === String(this.activeSlice!.fieldId),\r\n        );\r\n        if (!fv) return this.activeSlice!.value === null; // Match empty if value is null\r\n\r\n        // Extract value logic similar to SlicePanel\r\n        let val = null;\r\n        if (fv.text !== undefined) val = fv.text;\r\n        else if (fv.title !== undefined) val = fv.title;\r\n        else if (fv.number !== undefined) val = fv.number;\r\n        else if (fv.date !== undefined) val = fv.date;\r\n        else if (fv.option) val = fv.option.name;\r\n        else if (fv.iteration) val = fv.iteration.title;\r\n        else val = fv.value;\r\n\r\n        return val === this.activeSlice!.value;\r\n      });\r\n    }\r\n\r\n    // Check for grouping\r\n    const groupingField = this.getGroupingField();\r\n    const rowRenderer = new RowRenderer(\r\n      this.fields,\r\n      this.items,\r\n      (colIndex, pageX, startWidth) => {\r\n        if (this.tableResizer) {\r\n          this.tableResizer.beginColumnResize(colIndex, pageX, startWidth);\r\n        }\r\n      },\r\n    );\r\n\r\n    if (groupingField) {\r\n      this.renderGroupedRows(tbody, groupingField, displayItems, rowRenderer);\r\n    } else {\r\n      this.renderFlatRows(tbody, displayItems, rowRenderer);\r\n    }\r\n\r\n    table.appendChild(tbody);\r\n  }\r\n\r\n  private getGroupingField() {\r\n    // Logic to determine grouping field from options or view details\r\n    // Passed via options.groupingFieldName or similar\r\n    if (this.options.groupingFieldName) {\r\n      return this.fields.find(\r\n        (f) =>\r\n          (f.name &&\r\n            f.name.toLowerCase() ===\r\n              this.options.groupingFieldName?.toLowerCase()) ||\r\n          (f.id && f.id === this.options.groupingFieldName),\r\n      );\r\n    }\r\n    return null;\r\n  }\r\n\r\n  private renderFlatRows(\r\n    tbody: HTMLTableSectionElement,\r\n    items: any[],\r\n    rowRenderer: RowRenderer,\r\n  ) {\r\n    items.forEach((item, index) => {\r\n      const tr = rowRenderer.createRow(item, index);\r\n      tbody.appendChild(tr);\r\n    });\r\n  }\r\n\r\n  private renderGroupedRows(\r\n    tbody: HTMLTableSectionElement,\r\n    groupingField: any,\r\n    items: any[],\r\n    rowRenderer: RowRenderer,\r\n  ) {\r\n    // Group items\r\n    const groups = GroupDataService.groupItems(items, groupingField);\r\n    const groupRenderer = new GroupRenderer(this.fields, this.items);\r\n\r\n    for (const group of groups) {\r\n      groupRenderer.renderGroup(tbody, group, groupingField, rowRenderer);\r\n    }\r\n  }\r\n\r\n  private showHeaderMenu(\r\n    event: MouseEvent,\r\n    field: any,\r\n    headerElement: HTMLElement,\r\n  ) {\r\n    event.stopPropagation();\r\n\r\n    // Hide existing menu\r\n    if (this.activeMenu) {\r\n      this.activeMenu.hide();\r\n    }\r\n\r\n    // Determine capabilities based on field type\r\n    const dataType = (field.dataType || \"\").toLowerCase();\r\n    // Mapping of GitHub ProjectV2 field data types to allowed operations\r\n    // Groupable: assignees, single_select, parent_issue, iteration, number, date, milestone, repository\r\n    const groupableTypes = new Set([\r\n      \"assignees\",\r\n      \"single_select\",\r\n      \"parent_issue\",\r\n      \"iteration\",\r\n      \"number\",\r\n      \"date\",\r\n      \"milestone\",\r\n      \"repository\",\r\n    ]);\r\n\r\n    // Sliceable: same as groupable, plus labels (multi-value) which can be sliced but not grouped\r\n    const sliceableTypes = new Set([\r\n      \"assignees\",\r\n      \"single_select\",\r\n      \"parent_issue\",\r\n      \"iteration\",\r\n      \"number\",\r\n      \"date\",\r\n      \"milestone\",\r\n      \"repository\",\r\n      \"labels\",\r\n    ]);\r\n\r\n    const canGroup = groupableTypes.has(dataType);\r\n    const canSlice = sliceableTypes.has(dataType);\r\n\r\n    // Determine current state (grouped/sliced/sorted)\r\n    const isGrouped = !!(\r\n      this.options.groupingFieldName &&\r\n      field.name &&\r\n      field.name.toLowerCase() === this.options.groupingFieldName.toLowerCase()\r\n    );\r\n    const isSliced = !!(\r\n      (this.activeSlice && this.activeSlice.fieldId === field.id) ||\r\n      (this.activeSlicePanelFieldId &&\r\n        String(this.activeSlicePanelFieldId) === String(field.id))\r\n    );\r\n    const currentSort =\r\n      this.options.sortConfig && this.options.sortConfig.fieldId === field.id\r\n        ? this.options.sortConfig.direction\r\n        : null;\r\n\r\n    // Create and show menu\r\n    const fieldIndex = this.fields.findIndex((f) => f.id === field.id);\r\n    const isFirst = fieldIndex === 0;\r\n    const isLast = fieldIndex === this.fields.length - 1;\r\n\r\n    this.activeMenu = new ColumnHeaderMenu(field, {\r\n      canGroup,\r\n      canSlice,\r\n      canFilter: false, // Optional feature for later\r\n      isGrouped,\r\n      isSliced,\r\n      currentSort,\r\n      isFirst,\r\n      isLast,\r\n      onSort: (direction) => this.handleSort(field, direction),\r\n      onClearSort: () => this.clearSort(field),\r\n      onGroup: () => this.handleGroup(field),\r\n      onClearGroup: () => this.clearGroup(field),\r\n      onSlice: () => this.handleSlice(field),\r\n      onClearSlice: () => this.clearSlice(field),\r\n      onHide: () => this.hideField(field.id),\r\n      onMove: (direction) => this.handleMove(field, direction),\r\n    });\r\n\r\n    this.activeMenu.show(headerElement);\r\n  }\r\n\r\n  private clearGroup(field: any) {\r\n    // Clear local grouping state and notify parent\r\n    this.options.groupingFieldName = undefined;\r\n    if (this.options.onGroupChange) {\r\n      try {\r\n        // Notify parent that grouping was cleared\r\n        this.options.onGroupChange(\"\");\r\n      } catch (e) {}\r\n    }\r\n    this.render();\r\n  }\r\n\r\n  private clearSlice(field: any) {\r\n    this.activeSlice = null;\r\n    if (this.activeSlicePanel) {\r\n      this.activeSlicePanel.close();\r\n      this.activeSlicePanel = null;\r\n    }\r\n    this.activeSlicePanelFieldId = null;\r\n    // Reset container layout\r\n    this.container.style.display = \"block\";\r\n    this.render();\r\n    if (this.options.onSliceChange) {\r\n      this.options.onSliceChange(null as any);\r\n    }\r\n  }\r\n\r\n  private clearSort(field: any) {\r\n    // Remove sort from storage and options; notify parent\r\n    const key = this.getStorageKey(\"sortConfig\");\r\n    if (key) localStorage.removeItem(key);\r\n    if (this.options.onSortChange) {\r\n      this.options.onSortChange(null as any);\r\n    }\r\n  }\r\n\r\n  private showHiddenFieldsMenu(anchorElement: HTMLElement) {\r\n    // Hide any existing menu\r\n    if (this.activeMenu) {\r\n      this.activeMenu.hide();\r\n    }\r\n\r\n    // Get hidden fields\r\n    const hiddenFields = this.allFields.filter((f) =>\r\n      this.hiddenFieldIds.has(String(f.id)),\r\n    );\r\n\r\n    if (hiddenFields.length === 0) {\r\n      // Show message that no fields are hidden\r\n      const message = document.createElement(\"div\");\r\n      message.textContent = \"No hidden fields\";\r\n      message.style.position = \"absolute\";\r\n      message.style.background = \"var(--vscode-menu-background)\";\r\n      message.style.border = \"1px solid var(--vscode-menu-border)\";\r\n      message.style.borderRadius = \"4px\";\r\n      message.style.padding = \"12px\";\r\n      message.style.fontSize = \"13px\";\r\n      message.style.color = \"var(--vscode-descriptionForeground)\";\r\n      message.style.zIndex = \"1000\";\r\n\r\n      const rect = anchorElement.getBoundingClientRect();\r\n      message.style.top = `${rect.bottom + 4}px`;\r\n      message.style.left = `${rect.left}px`;\r\n\r\n      document.body.appendChild(message);\r\n\r\n      setTimeout(() => message.remove(), 2000);\r\n      return;\r\n    }\r\n\r\n    // Create simple menu for hidden fields\r\n    const menu = document.createElement(\"div\");\r\n    menu.style.position = \"absolute\";\r\n    menu.style.background = \"var(--vscode-menu-background)\";\r\n    menu.style.border = \"1px solid var(--vscode-menu-border)\";\r\n    menu.style.borderRadius = \"4px\";\r\n    menu.style.padding = \"4px 0\";\r\n    menu.style.minWidth = \"180px\";\r\n    menu.style.zIndex = \"1000\";\r\n    menu.style.fontSize = \"13px\";\r\n\r\n    const rect = anchorElement.getBoundingClientRect();\r\n    menu.style.top = `${rect.bottom + 4}px`;\r\n    menu.style.left = `${rect.left}px`;\r\n\r\n    // Header\r\n    const header = document.createElement(\"div\");\r\n    header.textContent = \"Show field\";\r\n    header.style.padding = \"6px 12px\";\r\n    header.style.fontWeight = \"600\";\r\n    header.style.color = \"var(--vscode-descriptionForeground)\";\r\n    header.style.fontSize = \"11px\";\r\n    header.style.textTransform = \"uppercase\";\r\n    menu.appendChild(header);\r\n\r\n    const separator = document.createElement(\"div\");\r\n    separator.style.height = \"1px\";\r\n    separator.style.background = \"var(--vscode-menu-separatorBackground)\";\r\n    separator.style.margin = \"4px 0\";\r\n    menu.appendChild(separator);\r\n\r\n    // Field items\r\n    hiddenFields.forEach((field) => {\r\n      const item = document.createElement(\"div\");\r\n      item.textContent = field.name || field.id;\r\n      item.style.padding = \"6px 12px\";\r\n      item.style.cursor = \"pointer\";\r\n      item.style.color = \"var(--vscode-menu-foreground)\";\r\n\r\n      item.addEventListener(\"mouseenter\", () => {\r\n        item.style.background = \"var(--vscode-menu-selectionBackground)\";\r\n        item.style.color = \"var(--vscode-menu-selectionForeground)\";\r\n      });\r\n\r\n      item.addEventListener(\"mouseleave\", () => {\r\n        item.style.background = \"transparent\";\r\n        item.style.color = \"var(--vscode-menu-foreground)\";\r\n      });\r\n\r\n      item.addEventListener(\"click\", () => {\r\n        this.showField(field.id);\r\n        menu.remove();\r\n        backdrop.remove();\r\n      });\r\n\r\n      menu.appendChild(item);\r\n    });\r\n\r\n    // Backdrop\r\n    const backdrop = document.createElement(\"div\");\r\n    backdrop.style.position = \"fixed\";\r\n    backdrop.style.top = \"0\";\r\n    backdrop.style.left = \"0\";\r\n    backdrop.style.right = \"0\";\r\n    backdrop.style.bottom = \"0\";\r\n    backdrop.style.zIndex = \"999\";\r\n\r\n    // Clicking the backdrop closes the menu\r\n    backdrop.addEventListener(\"click\", () => {\r\n      if (menu.parentElement) menu.remove();\r\n      if (backdrop.parentElement) backdrop.remove();\r\n    });\r\n\r\n    // Append to body\r\n    document.body.appendChild(menu);\r\n    document.body.appendChild(backdrop);\r\n\r\n    // End of showHiddenFieldsMenu\r\n  }\r\n\r\n  private handleSort(field: any, direction: \"ASC\" | \"DESC\") {\r\n    const sortConfig: SortConfig = {\r\n      fieldId: field.id,\r\n      direction,\r\n    };\r\n\r\n    // Save to localStorage\r\n    this.saveSortConfig(sortConfig);\r\n\r\n    // Notify parent component\r\n    if (this.options.onSortChange) {\r\n      this.options.onSortChange(sortConfig);\r\n    }\r\n  }\r\n\r\n  private handleGroup(field: any) {\r\n    // Update local grouping state so the UI reflects the change immediately\r\n    if (field && field.name) {\r\n      this.options.groupingFieldName = field.name;\r\n      this.render();\r\n      if (this.options.onGroupChange) {\r\n        try {\r\n          this.options.onGroupChange(field.name);\r\n        } catch (e) {}\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleSlice(field: any) {\r\n    // Close existing panel\r\n    if (this.activeSlicePanel) {\r\n      this.activeSlicePanel.close();\r\n      this.activeSlicePanel = null;\r\n    }\r\n\r\n    // Create and show new panel in the container (left side)\r\n    this.activeSlicePanel = new SlicePanel(\r\n      this.container,\r\n      field,\r\n      this.items,\r\n      this.allFields,\r\n    );\r\n    this.activeSlicePanel.render();\r\n    // Remember which field the panel belongs to so header menu can show an \"unslice\" button\r\n    try {\r\n      this.activeSlicePanelFieldId = String(field.id);\r\n    } catch (e) {\r\n      this.activeSlicePanelFieldId = null;\r\n    }\r\n\r\n    // Make sure the slice panel appears before the table wrapper\r\n    const tableWrapper = this.container.querySelector(\".table-wrapper\");\r\n    if (tableWrapper) {\r\n      const sliceEl = this.container.querySelector(\".slice-panel\");\r\n      if (sliceEl) {\r\n        this.container.insertBefore(sliceEl, tableWrapper);\r\n      }\r\n    }\r\n\r\n    // Setup layout: container should use flexbox to show panel + table side by side\r\n    this.container.style.display = \"flex\";\r\n    this.container.style.flexDirection = \"row\";\r\n    this.container.style.gap = \"0\";\r\n\r\n    // Re-render so header reflects the active slice panel (shows slice icon)\r\n    // We preserve the existing slice panel in render(), so this is safe.\r\n    this.render();\r\n\r\n    this.activeSlicePanel.onValueSelect((value) => {\r\n      // Filter table by this value\r\n      this.activeSlice = { fieldId: field.id, value };\r\n      this.render();\r\n    });\r\n\r\n    // Handle field change\r\n    this.activeSlicePanel.onFieldChange((newField) => {\r\n      // Update active slice field\r\n      this.activeSlice = null; // Reset slice value when changing field\r\n      this.handleSlice(newField); // Re-render with new field\r\n\r\n      // Notify parent\r\n      if (this.options.onSliceChange) {\r\n        this.options.onSliceChange(newField);\r\n      }\r\n    });\r\n\r\n    // Notify parent\r\n    if (this.options.onSliceChange) {\r\n      this.options.onSliceChange(field);\r\n    }\r\n  }\r\n\r\n  public hideField(fieldId: string) {\r\n    const fid = String(fieldId);\r\n    this.hiddenFieldIds.add(fid);\r\n    try {\r\n      console.debug(\r\n        \"[ProjectTable] hideField -> added\",\r\n        fid,\r\n        \"hiddenFieldIds=\",\r\n        Array.from(this.hiddenFieldIds),\r\n      );\r\n    } catch (e) {}\r\n    // If a parent callback is provided (e.g. tableViewFetcher managing Save/Discard),\r\n    // notify it instead of immediately persisting to localStorage. This allows hide/unhide\r\n    // to be treated as an unsaved view-level change which can be saved/discarded by the user.\r\n    if (this.options.onHiddenFieldsChange) {\r\n      // update in-memory state and notify parent (do not persist to localStorage yet)\r\n      this.fields = this.allFields.filter(\r\n        (f) => !this.hiddenFieldIds.has(f.id),\r\n      );\r\n      // Re-apply stored field order so the UI appears consistent after toggling\r\n      try {\r\n        this.applyFieldOrder();\r\n      } catch (e) {}\r\n      try {\r\n        this.options.onHiddenFieldsChange(Array.from(this.hiddenFieldIds));\r\n      } catch (e) {}\r\n      this.render();\r\n    } else {\r\n      this.saveHiddenFields();\r\n      this.fields = this.allFields.filter(\r\n        (f) => !this.hiddenFieldIds.has(f.id),\r\n      );\r\n      try {\r\n        this.applyFieldOrder();\r\n      } catch (e) {}\r\n      this.render();\r\n    }\r\n  }\r\n\r\n  public showField(fieldId: string) {\r\n    const fid = String(fieldId);\r\n    this.hiddenFieldIds.delete(fid);\r\n    try {\r\n      console.debug(\r\n        \"[ProjectTable] showField -> removed\",\r\n        fid,\r\n        \"hiddenFieldIds=\",\r\n        Array.from(this.hiddenFieldIds),\r\n      );\r\n    } catch (e) {}\r\n    if (this.options.onHiddenFieldsChange) {\r\n      this.fields = this.allFields.filter(\r\n        (f) => !this.hiddenFieldIds.has(f.id),\r\n      );\r\n      try {\r\n        this.applyFieldOrder();\r\n      } catch (e) {}\r\n      try {\r\n        this.options.onHiddenFieldsChange(Array.from(this.hiddenFieldIds));\r\n      } catch (e) {}\r\n      this.render();\r\n    } else {\r\n      this.saveHiddenFields();\r\n      this.fields = this.allFields.filter(\r\n        (f) => !this.hiddenFieldIds.has(f.id),\r\n      );\r\n      try {\r\n        this.applyFieldOrder();\r\n      } catch (e) {}\r\n      this.render();\r\n    }\r\n  }\r\n\r\n  private handleMove(field: any, direction: \"left\" | \"right\") {\r\n    const currentIndex = this.fields.findIndex((f) => f.id === field.id);\r\n\r\n    if (direction === \"left\" && currentIndex > 0) {\r\n      // Swap with previous\r\n      [this.fields[currentIndex], this.fields[currentIndex - 1]] = [\r\n        this.fields[currentIndex - 1],\r\n        this.fields[currentIndex],\r\n      ];\r\n    } else if (direction === \"right\" && currentIndex < this.fields.length - 1) {\r\n      // Swap with next\r\n      [this.fields[currentIndex], this.fields[currentIndex + 1]] = [\r\n        this.fields[currentIndex + 1],\r\n        this.fields[currentIndex],\r\n      ];\r\n    }\r\n\r\n    this.saveFieldOrder();\r\n    this.render();\r\n  }\r\n\r\n  // LocalStorage persistence methods\r\n  private getStorageKey(suffix: string): string {\r\n    return this.options.viewKey\r\n      ? `ghProjects.table.${this.options.viewKey}.${suffix}`\r\n      : \"\";\r\n  }\r\n\r\n  private loadHiddenFields(): string[] {\r\n    const key = this.getStorageKey(\"hiddenFields\");\r\n    if (!key) return [];\r\n\r\n    try {\r\n      const stored = localStorage.getItem(key);\r\n      const arr = stored ? JSON.parse(stored) : [];\r\n      // Normalize stored ids to strings\r\n      const normalized = (arr || []).map((id: any) => String(id));\r\n      try {\r\n        console.debug(\"[ProjectTable] loadHiddenFields ->\", normalized);\r\n      } catch (e) {}\r\n      return normalized;\r\n    } catch (e) {\r\n      return [];\r\n    }\r\n  }\r\n\r\n  private saveHiddenFields() {\r\n    const key = this.getStorageKey(\"hiddenFields\");\r\n    if (!key) return;\r\n\r\n    const arr = Array.from(this.hiddenFieldIds).map((id) => String(id));\r\n    try {\r\n      console.debug(\"[ProjectTable] saveHiddenFields ->\", arr);\r\n    } catch (e) {}\r\n    localStorage.setItem(key, JSON.stringify(arr));\r\n  }\r\n\r\n  private saveSortConfig(config: SortConfig) {\r\n    const key = this.getStorageKey(\"sortConfig\");\r\n    if (!key) return;\r\n\r\n    localStorage.setItem(key, JSON.stringify(config));\r\n  }\r\n\r\n  private saveFieldOrder() {\r\n    const key = this.getStorageKey(\"fieldOrder\");\r\n    if (!key) return;\r\n\r\n    const order = this.fields.map((f) => f.id);\r\n    localStorage.setItem(key, JSON.stringify(order));\r\n  }\r\n\r\n  private applyFieldOrder() {\r\n    const key = this.getStorageKey(\"fieldOrder\");\r\n    if (!key) return;\r\n\r\n    try {\r\n      const stored = localStorage.getItem(key);\r\n      if (!stored) return;\r\n\r\n      const order: string[] = JSON.parse(stored);\r\n      const orderedFields: any[] = [];\r\n\r\n      // Add fields in stored order\r\n      for (const fieldId of order) {\r\n        const field = this.fields.find((f) => String(f.id) === String(fieldId));\r\n        if (field) {\r\n          orderedFields.push(field);\r\n        }\r\n      }\r\n\r\n      // Add any new fields not in stored order\r\n      for (const field of this.fields) {\r\n        if (!orderedFields.find((f) => f.id === field.id)) {\r\n          orderedFields.push(field);\r\n        }\r\n      }\r\n\r\n      this.fields = orderedFields;\r\n    } catch (e) {\r\n      // Ignore errors, use default order\r\n    }\r\n  }\r\n}\r\n", "export function setLoadingState(container: HTMLElement, titleText: string) {\r\n  container.innerHTML =\r\n    '<div class=\"title\">' +\r\n    titleText +\r\n    '</div><div class=\"loading\"><em>Loading...</em></div>';\r\n}\r\n\r\nexport function setErrorState(\r\n  container: HTMLElement,\r\n  titleText: string,\r\n  error: string,\r\n) {\r\n  container.innerHTML =\r\n    '<div class=\"title\">' +\r\n    titleText +\r\n    '</div><div style=\"color:var(--vscode-editor-foreground)\">' +\r\n    error +\r\n    \"</div>\";\r\n}\r\n\r\nexport function createLoadMoreButton(onClick: () => void): HTMLButtonElement {\r\n  const btn = document.createElement(\"button\");\r\n  btn.type = \"button\";\r\n  btn.textContent = \"Load more\";\r\n  btn.style.marginLeft = \"8px\";\r\n  btn.style.border = \"1px solid var(--vscode-editorWidget-border)\";\r\n  btn.addEventListener(\"click\", () => {\r\n    onClick();\r\n    btn.disabled = true;\r\n    btn.textContent = \"Loading...\";\r\n  });\r\n  return btn;\r\n}\r\n\r\nexport function clearElement(element: HTMLElement) {\r\n  while (element.firstChild) {\r\n    element.removeChild(element.firstChild);\r\n  }\r\n}\r\n\r\nexport function toggleClass(\r\n  element: HTMLElement,\r\n  className: string,\r\n  force?: boolean,\r\n) {\r\n  element.classList.toggle(className, force);\r\n}\r\n", "/// <reference path=\"./global.d.ts\" />\r\nimport { logDebug } from \"./utils/logger\";\r\nimport {\r\n  setLoadingState,\r\n  setErrorState,\r\n  createLoadMoreButton,\r\n} from \"./utils/domUtils\";\r\n\r\nexport { logDebug, setLoadingState, setErrorState, createLoadMoreButton };\r\n\r\n/**\r\n * Initializes the filter bar using the shared filterBarHelper.\r\n * Returns the barApi if successful, or null.\r\n */\r\nexport function initFilterBar(\r\n  container: HTMLElement,\r\n  viewKey: string,\r\n  options: {\r\n    suffix?: string;\r\n    step?: number;\r\n    effFilter?: string;\r\n    onLoadMore?: () => void;\r\n    onSave?: (filter: any) => void;\r\n    onDiscard?: () => void;\r\n  },\r\n): any {\r\n  if (\r\n    window.filterBarHelper &&\r\n    typeof window.filterBarHelper.create === \"function\"\r\n  ) {\r\n    try {\r\n      return window.filterBarHelper.create({\r\n        parent: container,\r\n        suffix: options.suffix || viewKey,\r\n        effFilter:\r\n          typeof options.effFilter === \"string\" ? options.effFilter : undefined,\r\n        viewKey: viewKey,\r\n        step: options.step || 50,\r\n        onLoadMore: options.onLoadMore,\r\n        onSave: options.onSave,\r\n        onDiscard: options.onDiscard,\r\n      });\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\n/**\r\n * Toggles visibility of elements based on matched IDs from the filter.\r\n */\r\nexport function applyFilterVisibility(\r\n  root: HTMLElement | Document,\r\n  selector: string,\r\n  matchedIds: Set<string>,\r\n  displayStyle: string = \"block\",\r\n) {\r\n  try {\r\n    const elements = Array.from(root.querySelectorAll(selector));\r\n    for (let i = 0; i < elements.length; i++) {\r\n      try {\r\n        const el = elements[i] as HTMLElement;\r\n        const id = el.getAttribute(\"data-gh-item-id\");\r\n        el.style.display = matchedIds.has(String(id)) ? displayStyle : \"none\";\r\n      } catch (e) {}\r\n    }\r\n  } catch (e) {}\r\n}\r\n", "import { ProjectTable } from \"./components/ProjectTable\";\r\nimport {\r\n  setLoadingState,\r\n  setErrorState,\r\n  initFilterBar,\r\n  createLoadMoreButton,\r\n  logDebug,\r\n} from \"./viewFetcherUtils\";\r\nimport { parseSortByFields, sortItems } from \"./utils/tableSorting\";\r\n\r\n/// <reference path=\"./global.d.ts\" />\r\n\r\nwindow.tableViewFetcher = function (\r\n  view: any,\r\n  container: HTMLElement,\r\n  viewKey: any,\r\n) {\r\n  const viewName =\r\n    view && (view.name || view.id) ? view.name || view.id : \"Table View\";\r\n  try {\r\n    setLoadingState(container, viewName);\r\n  } catch (e) {}\r\n\r\n  let itemsLimit = 30;\r\n\r\n  function render(payload: any, effectiveFilter?: string) {\r\n    const snapshot = payload || {};\r\n    const fields = snapshot.fields || [];\r\n    const allItems = snapshot.items || [];\r\n    const items = allItems.slice(0, itemsLimit);\r\n\r\n    // Reset container layout\r\n    container.innerHTML = \"\";\r\n    container.style.margin = \"0\";\r\n    container.style.padding = \"0\";\r\n    container.style.height = \"100%\";\r\n    container.style.display = \"flex\";\r\n    container.style.flexDirection = \"column\";\r\n    container.style.overflow = \"hidden\";\r\n\r\n    // Header / Filter Bar Container\r\n    const headerContainer = document.createElement(\"div\");\r\n    headerContainer.style.flex = \"0 0 auto\";\r\n    headerContainer.style.background = \"var(--vscode-editor-background)\";\r\n    headerContainer.style.zIndex = \"20\";\r\n    headerContainer.style.position = \"relative\";\r\n    headerContainer.style.display = \"flex\";\r\n    headerContainer.style.justifyContent = \"space-between\";\r\n    headerContainer.style.alignItems = \"center\";\r\n    headerContainer.style.width = \"100%\"; // Ensure full width\r\n\r\n    // Filter Wrapper to take available space\r\n    const filterWrapper = document.createElement(\"div\");\r\n    filterWrapper.style.flex = \"1 1 auto\";\r\n    filterWrapper.style.marginRight = \"8px\";\r\n    headerContainer.appendChild(filterWrapper);\r\n\r\n    // Init Filter Bar\r\n    // Track unsaved view-level changes (grouping) and wire Save/Discard hooks\r\n    let unsavedGrouping: string | null = null;\r\n    // Track unsaved hidden fields changes (shown/hidden via the plus-column menu)\r\n    let unsavedHiddenFields: Set<string> | null = null;\r\n    // Track unsaved slice changes\r\n    let unsavedSlice: { fieldId: string; value: any } | null = null;\r\n    let barApi = initFilterBar(filterWrapper, viewKey, {\r\n      suffix: viewKey ? String(viewKey).split(\":\").pop() : \"\",\r\n      step: itemsLimit,\r\n      onLoadMore: () => {\r\n        itemsLimit += 30;\r\n        requestFields();\r\n      },\r\n      onSave: (newFilter: any) => {\r\n        try {\r\n          // Save grouping if changed\r\n          if (unsavedGrouping !== null) {\r\n            if (\r\n              (window as any).__APP_MESSAGING__ &&\r\n              typeof (window as any).__APP_MESSAGING__.postMessage ===\r\n                \"function\"\r\n            ) {\r\n              (window as any).__APP_MESSAGING__.postMessage({\r\n                command: \"setViewGrouping\",\r\n                viewKey: viewKey,\r\n                grouping: unsavedGrouping,\r\n              });\r\n            }\r\n            unsavedGrouping = null;\r\n          }\r\n\r\n          // Save hidden fields if changed\r\n          if (unsavedHiddenFields !== null) {\r\n            const hiddenArr = Array.from(unsavedHiddenFields);\r\n            if (\r\n              (window as any).__APP_MESSAGING__ &&\r\n              typeof (window as any).__APP_MESSAGING__.postMessage ===\r\n                \"function\"\r\n            ) {\r\n              (window as any).__APP_MESSAGING__.postMessage({\r\n                command: \"setViewHiddenFields\",\r\n                viewKey: viewKey,\r\n                hiddenFields: hiddenArr,\r\n              });\r\n            }\r\n            // Persist to localStorage as well so UI persists across reloads (server may also return updated snapshot)\r\n            try {\r\n              const key = viewKey\r\n                ? `ghProjects.table.${viewKey}.hiddenFields`\r\n                : null;\r\n              if (key) localStorage.setItem(key, JSON.stringify(hiddenArr));\r\n            } catch (e) {}\r\n            unsavedHiddenFields = null;\r\n          }\r\n\r\n          // Save slice if changed\r\n          if (unsavedSlice !== null) {\r\n            if (\r\n              (window as any).__APP_MESSAGING__ &&\r\n              typeof (window as any).__APP_MESSAGING__.postMessage ===\r\n                \"function\"\r\n            ) {\r\n              (window as any).__APP_MESSAGING__.postMessage({\r\n                command: \"setViewSlice\",\r\n                viewKey: viewKey,\r\n                slice: unsavedSlice,\r\n              });\r\n            }\r\n            // Persist to localStorage as well\r\n            try {\r\n              const key = viewKey ? `ghProjects.table.${viewKey}.slice` : null;\r\n              if (key) localStorage.setItem(key, JSON.stringify(unsavedSlice));\r\n            } catch (e) {}\r\n            unsavedSlice = null;\r\n          }\r\n        } catch (e) {}\r\n      },\r\n      onDiscard: () => {\r\n        try {\r\n          // Discard grouping changes\r\n          if (unsavedGrouping !== null) {\r\n            if (\r\n              (window as any).__APP_MESSAGING__ &&\r\n              typeof (window as any).__APP_MESSAGING__.postMessage ===\r\n                \"function\"\r\n            ) {\r\n              (window as any).__APP_MESSAGING__.postMessage({\r\n                command: \"discardViewGrouping\",\r\n                viewKey: viewKey,\r\n              });\r\n            }\r\n            unsavedGrouping = null;\r\n          }\r\n\r\n          // Discard hidden fields changes: request fresh snapshot from extension\r\n          if (unsavedHiddenFields !== null) {\r\n            if (\r\n              (window as any).__APP_MESSAGING__ &&\r\n              typeof (window as any).__APP_MESSAGING__.postMessage ===\r\n                \"function\"\r\n            ) {\r\n              (window as any).__APP_MESSAGING__.postMessage({\r\n                command: \"discardViewHiddenFields\",\r\n                viewKey: viewKey,\r\n              });\r\n            }\r\n            unsavedHiddenFields = null;\r\n            // Re-request fields to refresh UI from server state\r\n            requestFields();\r\n          }\r\n\r\n          // Discard slice changes: clear slice and refresh UI\r\n          if (unsavedSlice !== null) {\r\n            if (\r\n              (window as any).__APP_MESSAGING__ &&\r\n              typeof (window as any).__APP_MESSAGING__.postMessage ===\r\n                \"function\"\r\n            ) {\r\n              (window as any).__APP_MESSAGING__.postMessage({\r\n                command: \"discardViewSlice\",\r\n                viewKey: viewKey,\r\n              });\r\n            }\r\n            unsavedSlice = null;\r\n            // Clear localStorage\r\n            try {\r\n              const key = viewKey ? `ghProjects.table.${viewKey}.slice` : null;\r\n              if (key) localStorage.removeItem(key);\r\n            } catch (e) {}\r\n            // Re-request fields to refresh UI from server state\r\n            requestFields();\r\n          }\r\n        } catch (e) {}\r\n      },\r\n    });\r\n\r\n    // If the server provided an effective filter, apply it via the bar API\r\n    // rather than passing it in the options object. This avoids typing\r\n    // mismatches while still initializing the input value at runtime.\r\n    try {\r\n      if (\r\n        effectiveFilter &&\r\n        barApi &&\r\n        typeof barApi.setEffectiveFilter === \"function\"\r\n      ) {\r\n        try {\r\n          barApi.setEffectiveFilter(effectiveFilter);\r\n        } catch (e) {}\r\n      }\r\n    } catch (e) {}\r\n\r\n    // Fallback Header if Filter Bar fails or returns null\r\n    if (!barApi) {\r\n      const title = document.createElement(\"div\");\r\n      title.className = \"title\";\r\n      title.textContent = viewName;\r\n      title.style.padding = \"8px\";\r\n      headerContainer.appendChild(title);\r\n\r\n      const controls = document.createElement(\"div\");\r\n      controls.style.padding = \"8px\";\r\n\r\n      if (allItems.length > itemsLimit) {\r\n        const loadMore = createLoadMoreButton(() => {\r\n          itemsLimit += 30;\r\n          requestFields();\r\n        });\r\n        controls.appendChild(loadMore);\r\n      } else {\r\n        const span = document.createElement(\"span\");\r\n        span.textContent = \"All loaded\";\r\n        span.style.color = \"var(--vscode-descriptionForeground)\";\r\n        controls.appendChild(span);\r\n      }\r\n      headerContainer.appendChild(controls);\r\n    } else {\r\n      // Update load state in barApi\r\n      if (typeof barApi.setLoadState === \"function\") {\r\n        barApi.setLoadState(\r\n          allItems.length < itemsLimit,\r\n          allItems.length >= itemsLimit ? \"Load more\" : \"All loaded\",\r\n        );\r\n      }\r\n      // Register items for filtering\r\n      if (typeof barApi.registerItems === \"function\") {\r\n        barApi.registerItems(allItems, { fields });\r\n      }\r\n    }\r\n\r\n    container.appendChild(headerContainer);\r\n\r\n    // Table Container\r\n    const tableContainer = document.createElement(\"div\");\r\n    tableContainer.style.flex = \"1 1 auto\";\r\n    tableContainer.style.overflow = \"hidden\";\r\n    tableContainer.style.position = \"relative\";\r\n    container.appendChild(tableContainer);\r\n\r\n    // Determine Grouping\r\n    const groupingFieldName = getGroupingFieldName(snapshot);\r\n\r\n    // Parse sort config from GitHub\r\n    let sortConfig = parseSortByFields(snapshot.details?.sortByFields);\r\n\r\n    // Check for local override\r\n    if (viewKey) {\r\n      try {\r\n        const stored = localStorage.getItem(\r\n          `ghProjects.table.${viewKey}.sortConfig`,\r\n        );\r\n        if (stored) sortConfig = JSON.parse(stored);\r\n      } catch (e) {}\r\n    }\r\n\r\n    // Apply sorting\r\n    let displayItems = items;\r\n    if (sortConfig) {\r\n      displayItems = sortItems(items, fields, sortConfig);\r\n    }\r\n\r\n    // Render Table\r\n    // Use `allFields` if provided (full project fields), otherwise fall back to `fields` (view-visible fields)\r\n    const allFields =\r\n      (snapshot as any).allFields && Array.isArray((snapshot as any).allFields)\r\n        ? (snapshot as any).allFields\r\n        : snapshot.fields || [];\r\n\r\n    // Determine which fields the view exposes (visible). If view details contain a fields.nodes\r\n    // list, compute the hidden fields (allFields - viewFields) and pass them to ProjectTable so\r\n    // it picks up view-default hidden fields.\r\n    const viewFieldNodes =\r\n      (snapshot as any).details &&\r\n      (snapshot as any).details.fields &&\r\n      Array.isArray((snapshot as any).details.fields.nodes)\r\n        ? (snapshot as any).details.fields.nodes\r\n        : null;\r\n\r\n    let viewHiddenFieldIds: string[] | undefined = undefined;\r\n    if (viewFieldNodes && Array.isArray(viewFieldNodes)) {\r\n      const visibleIds = new Set(viewFieldNodes.map((n: any) => String(n.id)));\r\n      viewHiddenFieldIds = (allFields || [])\r\n        .map((f: any) => String(f.id))\r\n        .filter((id: string) => !visibleIds.has(id));\r\n    }\r\n\r\n    // Send debug info to extension output (via postMessage) so we can see what the webview computed\r\n    try {\r\n      const dbg = {\r\n        allFieldIds: (allFields || []).map((f: any) => String(f.id)),\r\n        viewFieldIds: viewFieldNodes\r\n          ? viewFieldNodes.map((n: any) => String(n.id))\r\n          : null,\r\n        viewHiddenFieldIds,\r\n      };\r\n      if (\r\n        (window as any).__APP_MESSAGING__ &&\r\n        typeof (window as any).__APP_MESSAGING__.postMessage === \"function\"\r\n      ) {\r\n        (window as any).__APP_MESSAGING__.postMessage({\r\n          command: \"debugLog\",\r\n          level: \"debug\",\r\n          message: \"tableViewFetcher field debug\",\r\n          data: dbg,\r\n          viewKey,\r\n        });\r\n      }\r\n    } catch (e) {}\r\n\r\n    const table = new ProjectTable(tableContainer, allFields, displayItems, {\r\n      groupingFieldName: groupingFieldName || undefined,\r\n      sortConfig,\r\n      viewKey,\r\n      hiddenFields: viewHiddenFieldIds,\r\n      onHiddenFieldsChange: (hiddenIds: string[]) => {\r\n        try {\r\n          unsavedHiddenFields = new Set(\r\n            (hiddenIds || []).map((h: any) => String(h)),\r\n          );\r\n          // Enable Save/Discard buttons in the filter bar if present\r\n          if (barApi && barApi.saveBtn && barApi.discardBtn) {\r\n            try {\r\n              barApi.saveBtn.disabled = false;\r\n              barApi.discardBtn.disabled = false;\r\n              barApi.saveBtn.style.opacity = \"1\";\r\n              barApi.saveBtn.style.cursor = \"pointer\";\r\n              barApi.discardBtn.style.opacity = \"1\";\r\n              barApi.discardBtn.style.cursor = \"pointer\";\r\n            } catch (e) {}\r\n          }\r\n        } catch (e) {}\r\n      },\r\n      onSortChange: () => requestFields(),\r\n      onGroupChange: (fieldName: string) => {\r\n        // Defer persistence of grouping until user explicitly Saves from the filter bar\r\n        try {\r\n          unsavedGrouping = fieldName || null;\r\n          // Enable Save/Discard buttons in the filter bar if present\r\n          if (barApi && barApi.saveBtn && barApi.discardBtn) {\r\n            try {\r\n              barApi.saveBtn.disabled = false;\r\n              barApi.discardBtn.disabled = false;\r\n              barApi.saveBtn.style.opacity = \"1\";\r\n              barApi.saveBtn.style.cursor = \"pointer\";\r\n              barApi.discardBtn.style.opacity = \"1\";\r\n              barApi.discardBtn.style.cursor = \"pointer\";\r\n            } catch (e) {}\r\n          }\r\n        } catch (e) {}\r\n      },\r\n      onSliceChange: (field: any) => {\r\n        // Track slice as unsaved change (requires Save/Discard)\r\n        try {\r\n          unsavedSlice = field ? { fieldId: field.id, value: null } : null;\r\n\r\n          // Enable Save/Discard buttons in the filter bar if present\r\n          if (barApi && barApi.saveBtn && barApi.discardBtn) {\r\n            try {\r\n              barApi.saveBtn.disabled = false;\r\n              barApi.discardBtn.disabled = false;\r\n              barApi.saveBtn.style.opacity = \"1\";\r\n              barApi.saveBtn.style.cursor = \"pointer\";\r\n              barApi.discardBtn.style.opacity = \"1\";\r\n              barApi.discardBtn.style.cursor = \"pointer\";\r\n            } catch (e) {}\r\n          }\r\n\r\n          // Log for debugging\r\n          if (\r\n            (window as any).__APP_MESSAGING__ &&\r\n            typeof (window as any).__APP_MESSAGING__.postMessage === \"function\"\r\n          ) {\r\n            (window as any).__APP_MESSAGING__.postMessage({\r\n              command: \"debugLog\",\r\n              level: \"debug\",\r\n              message: field\r\n                ? `Slice activated on field: ${field.name}`\r\n                : \"Slice cleared\",\r\n              viewKey: viewKey,\r\n            });\r\n          }\r\n        } catch (e) {}\r\n      },\r\n    });\r\n    table.render();\r\n\r\n    // Connect Filter to Table Visibility\r\n    if (barApi && typeof barApi.onFilterChange === \"function\") {\r\n      barApi.onFilterChange((matchedIds: Set<string>) => {\r\n        // Apply visibility to table rows\r\n        const rows = tableContainer.querySelectorAll(\"tr[data-gh-item-id]\");\r\n        rows.forEach((row: any) => {\r\n          const id = row.getAttribute(\"data-gh-item-id\");\r\n          if (id && matchedIds.has(id)) {\r\n            row.style.display = \"table-row\";\r\n          } else {\r\n            row.style.display = \"none\";\r\n          }\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  function onMessage(ev: MessageEvent) {\r\n    const msg = ev && ev.data ? ev.data : ev;\r\n    try {\r\n      if (msg && msg.command === \"fields\") {\r\n        if (msg.viewKey && viewKey && String(msg.viewKey) !== String(viewKey))\r\n          return;\r\n\r\n        if (msg.error) {\r\n          setErrorState(container, viewName, String(msg.error));\r\n        } else {\r\n          render(msg.payload, msg.effectiveFilter);\r\n        }\r\n      }\r\n    } catch (e) {}\r\n  }\r\n\r\n  function requestFields() {\r\n    try {\r\n      if (\r\n        (window as any).__APP_MESSAGING__ &&\r\n        typeof (window as any).__APP_MESSAGING__.postMessage === \"function\"\r\n      ) {\r\n        (window as any).__APP_MESSAGING__.postMessage({\r\n          command: \"requestFields\",\r\n          first: itemsLimit,\r\n          viewKey: viewKey,\r\n        });\r\n      }\r\n    } catch (e) {}\r\n  }\r\n\r\n  try {\r\n    (window as any).__APP_MESSAGING__.onMessage(onMessage);\r\n  } catch (e) {\r\n    window.addEventListener(\"message\", onMessage);\r\n  }\r\n  requestFields();\r\n};\r\n\r\nfunction getGroupingFieldName(snapshot: any): string | null {\r\n  try {\r\n    if (snapshot && snapshot.details) {\r\n      const vgb =\r\n        snapshot.details.verticalGroupByFields &&\r\n        snapshot.details.verticalGroupByFields.nodes;\r\n      const gb =\r\n        snapshot.details.groupByFields && snapshot.details.groupByFields.nodes;\r\n\r\n      if (vgb && vgb.length > 0) return vgb[0].name || null;\r\n      if (gb && gb.length > 0) return gb[0].name || null;\r\n    }\r\n  } catch (e) {}\r\n  return null;\r\n}\r\n"],
  "mappings": "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",
  "names": ["ColumnHeaderMenu", "field", "options", "iconName", "anchorElement", "rect", "disableLeft", "disableRight", "label", "onClick", "item", "iconEl", "labelEl", "clearBtn", "e", "separator", "ColumnHeaderRenderer", "options", "iconName", "table", "thead", "tr", "thIndex", "field", "th", "headerContent", "nameSpan", "headerText", "isGrouped", "isSliced", "isSorted", "iconsContainer", "sortIcon", "direction", "groupIcon", "ev", "sliceIcon", "menuBtn", "e", "thAddField", "addFieldBtn", "FieldsMenu", "options", "anchorElement", "rect", "menuRect", "margin", "vw", "vh", "top", "left", "title", "icon", "label", "newField", "visible", "f", "hidden", "text", "h", "r", "field", "row", "c", "s", "iconHtml", "newVisible", "dataType", "iconName", "FieldsMenu_default", "escapeHtml", "s", "normalizeColor", "color", "n", "b", "u", "addAlpha", "alpha", "S", "v", "C", "getContrastColor", "SlicePanel", "container", "field", "items", "allFields", "stored", "debugOverlay", "resizer", "startX", "startWidth", "onMouseMove", "e", "dx", "newW", "onMouseUp", "ev", "header", "headerTop", "sliceLabel", "fieldButton", "arrow", "content", "anchorButton", "sliceableTypes", "sliceableFields", "f", "dataType", "dropdown", "item", "iconSpan", "labelSpan", "backdrop", "iconName", "valueCounts", "empty", "sorted", "a", "b", "resolveParentProgress", "parentMeta", "result", "identifiers", "found", "A", "d", "M", "o", "m", "statusFV", "v", "c", "normalizeColor", "agg", "key", "value", "count", "rawValue", "parentMetaForIteration", "leftVisual", "makeColorDot", "dot", "visualAppended", "avatarUrl", "avatarEl", "escapeHtml", "repoIcon", "prog", "dotColor", "pd", "lab", "colorCandidate", "normalized", "colorVal", "iter", "it", "labelColumn", "label", "descText", "desc", "p", "titleText", "titleEl", "tspan", "displayedTitle", "summary", "doneText", "bar", "fill", "iterObj", "iterCandidate", "start", "duration", "s", "sStr", "eStr", "rangeEl", "countCircle", "counts", "fv", "existing", "labelsArr", "name", "ass", "fieldValue", "callback", "parseSortByFields", "sortByFields", "primary", "config", "secondary", "sortItems", "items", "fields", "sortConfig", "field", "f", "sorted", "a", "b", "primaryResult", "compareFieldValues", "secondaryField", "direction", "aValue", "getFieldValue", "bValue", "result", "compareText", "compareNumber", "compareDate", "compareSingleSelect", "compareIteration", "compareLabels", "item", "fieldValue", "fv", "aStr", "bStr", "aNum", "bNum", "aDate", "bDate", "aOption", "bOption", "aIndex", "opt", "bIndex", "aLabels", "bLabels", "GroupDataService", "items", "field", "options", "dType", "groups", "opt", "unassigned", "item", "index", "fv", "v", "placed", "matchId", "matchName", "group", "g", "map", "unassignedFallback", "val", "p", "a", "key", "groupsArr", "TitleRenderer", "value", "field", "item", "allItems", "t", "l", "r", "w", "x", "normalizeColor", "p", "g", "escapeHtml", "f", "TextRenderer", "NumberRenderer", "DateRenderer", "o", "SingleSelectRenderer", "n", "c", "bg", "fg", "getContrastColor", "IterationRenderer", "i", "RepositoryRenderer", "LabelsRenderer", "a", "k", "L", "h", "addAlpha", "PullRequestRenderer", "prs", "out", "num", "titleText", "url", "rawColor", "normColor", "hasHex", "border", "IssueRenderer", "AssigneesRenderer", "RequestedReviewersRenderer", "MilestoneRenderer", "SubIssuesProgressRenderer", "totalCount", "doneCount", "pct", "ParentIssueRenderer", "itemsList", "B", "O", "$", "A", "d", "M", "V", "X", "q", "parentWrapper", "strategies", "TitleRenderer", "TextRenderer", "NumberRenderer", "DateRenderer", "SingleSelectRenderer", "IterationRenderer", "RepositoryRenderer", "LabelsRenderer", "PullRequestRenderer", "IssueRenderer", "AssigneesRenderer", "RequestedReviewersRenderer", "MilestoneRenderer", "SubIssuesProgressRenderer", "ParentIssueRenderer", "renderCell", "e", "n", "s", "allItems", "strategy", "err", "RowRenderer", "fields", "allItems", "onResizeStart", "item", "index", "tr", "tdIndex", "colIndex", "field", "td", "fv", "v", "renderCell", "cellResizer", "e", "table", "col", "startWidth", "GroupRenderer", "fields", "allItems", "iconName", "size", "tbody", "group", "groupingField", "rowRenderer", "trHeader", "tdHeader", "headerContent", "estimateField", "f", "estimateFieldId", "sumEstimate", "itemsArr", "sum", "gi", "it", "fv", "v", "num", "formatEstimate", "n", "toggleBtn", "iconExpanded", "iconCollapsed", "colorDot", "normalizeColor", "nameSpan", "leftPane", "rightPane", "parentMeta", "resolvedParentItem", "first", "pfv", "identifiers", "found", "A", "d", "M", "o", "m", "avatarEl", "avatarUrl", "match", "a", "escapeHtml", "repoIcon", "content", "statusFV", "c", "countCircle", "estSum", "estEl", "completedNames", "isDoneByHeuristics", "state", "percentFV", "labs", "l", "cn", "done", "total", "agg", "doneText", "progWrapper", "pct", "bar", "fill", "opt", "descEl", "iterText", "start", "duration", "s", "days", "e", "sStr", "eStr", "iterEl", "groupRows", "groupItem", "tr", "isCollapsed", "row", "TableResizer", "table", "fields", "options", "th", "index", "resizer", "e", "col", "startW", "colIndex", "startX", "startWidth", "onMouseMove", "newWidth", "onMouseUp", "fieldIndex", "widthToSave", "fieldId", "width", "key", "stored", "widths", "cols", "field", "suffix", "ProjectTable", "container", "fields", "items", "options", "f", "hiddenFromStorage", "id", "hiddenFromOptions", "dbg", "existingSlicePanel", "tableContainer", "table", "ColumnHeaderRenderer", "TableResizer", "colgroup", "colIndex", "field", "col", "colAddField", "anchorElement", "visibleSet", "menu", "FieldsMenu_default", "fieldId", "visible", "tbody", "displayItems", "sortItems", "item", "fv", "v", "val", "groupingField", "rowRenderer", "RowRenderer", "pageX", "startWidth", "index", "tr", "groups", "GroupDataService", "groupRenderer", "GroupRenderer", "group", "event", "headerElement", "dataType", "groupableTypes", "sliceableTypes", "canGroup", "canSlice", "isGrouped", "isSliced", "currentSort", "fieldIndex", "isFirst", "isLast", "ColumnHeaderMenu", "direction", "key", "hiddenFields", "message", "rect", "header", "separator", "backdrop", "sortConfig", "SlicePanel", "tableWrapper", "sliceEl", "value", "newField", "fid", "currentIndex", "suffix", "stored", "normalized", "arr", "config", "order", "orderedFields", "setLoadingState", "container", "titleText", "setErrorState", "error", "createLoadMoreButton", "onClick", "btn", "initFilterBar", "container", "viewKey", "options", "view", "container", "viewKey", "viewName", "setLoadingState", "itemsLimit", "render", "payload", "effectiveFilter", "snapshot", "fields", "allItems", "items", "headerContainer", "filterWrapper", "unsavedGrouping", "unsavedHiddenFields", "unsavedSlice", "barApi", "initFilterBar", "requestFields", "newFilter", "hiddenArr", "key", "title", "controls", "loadMore", "createLoadMoreButton", "span", "tableContainer", "groupingFieldName", "getGroupingFieldName", "sortConfig", "parseSortByFields", "stored", "displayItems", "sortItems", "allFields", "viewFieldNodes", "viewHiddenFieldIds", "visibleIds", "n", "id", "dbg", "ProjectTable", "hiddenIds", "h", "fieldName", "field", "matchedIds", "row", "onMessage", "ev", "msg", "setErrorState", "vgb", "gb"]
}
