"use strict";(()=>{var ne=Object.defineProperty;var re=(m,e)=>()=>(m&&(e=m(m=0)),e);var ie=(m,e)=>{for(var t in e)ne(m,t,{get:e[t],enumerable:!0})};var Z={};ie(Z,{AddItemMenu:()=>U});var U,K=re(()=>{"use strict";U=class{constructor(e){this.menuElement=null;this.backdropElement=null;this.options=e}show(){this.hide(),this.backdropElement=document.createElement("div"),this.backdropElement.style.position="fixed",this.backdropElement.style.top="0",this.backdropElement.style.left="0",this.backdropElement.style.right="0",this.backdropElement.style.bottom="0",this.backdropElement.style.zIndex="998",this.backdropElement.addEventListener("click",()=>this.hide()),document.body.appendChild(this.backdropElement),this.menuElement=document.createElement("div"),this.menuElement.className="add-item-menu",this.menuElement.style.position="absolute",this.menuElement.style.background="var(--vscode-menu-background)",this.menuElement.style.border="1px solid var(--vscode-menu-border)",this.menuElement.style.borderRadius="4px",this.menuElement.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)",this.menuElement.style.minWidth="220px",this.menuElement.style.padding="4px 0",this.menuElement.style.zIndex="1000",this.menuElement.style.fontSize="13px",document.body.appendChild(this.menuElement),this.buildMenu();let e=this.options.anchorElement.getBoundingClientRect(),t=this.menuElement.getBoundingClientRect(),n=8,i=window.innerWidth||document.documentElement.clientWidth,s=window.innerHeight||document.documentElement.clientHeight,r=e.bottom+n;e.bottom+t.height+n>s&&(e.top-t.height-n>=0?r=e.top-t.height-n:r=Math.max(n,Math.min(s-t.height-n,e.bottom+n)));let a=e.left;e.left+t.width+n>i&&(a=Math.max(n,e.right-t.width)),a=Math.max(n,Math.min(a,i-t.width-n)),this.menuElement.style.top=`${Math.round(r)}px`,this.menuElement.style.left=`${Math.round(a)}px`}hide(){this.menuElement&&(this.menuElement.remove(),this.menuElement=null),this.backdropElement&&(this.backdropElement.remove(),this.backdropElement=null)}buildMenu(){if(!this.menuElement)return;let e=(t,n,i,s)=>{let r=document.createElement("div");r.className="add-item-menu-item",r.style.display="flex",r.style.alignItems="center",r.style.padding="6px 12px",r.style.cursor="pointer",r.style.color="var(--vscode-menu-foreground)";let a=document.createElement("span");a.style.display="inline-flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.marginRight="8px",a.innerHTML=window.getIconSvg?.(t)||"",r.appendChild(a);let c=document.createElement("div");c.style.display="flex",c.style.flexDirection="column",c.style.flex="1";let o=document.createElement("div");if(o.textContent=n,o.style.fontWeight="500",c.appendChild(o),i){let l=document.createElement("div");l.textContent=i,l.style.fontSize="11px",l.style.color="var(--vscode-descriptionForeground)",c.appendChild(l)}r.appendChild(c),r.addEventListener("mouseenter",()=>{r.style.background="var(--vscode-menu-selectionBackground)",r.style.color="var(--vscode-menu-selectionForeground)"}),r.addEventListener("mouseleave",()=>{r.style.background="transparent",r.style.color="var(--vscode-menu-foreground)"}),r.addEventListener("click",()=>{s(),this.hide()}),this.menuElement.appendChild(r)};e("issue-opened","Create new issue","Create a project issue in a repository.",this.options.onCreateIssue),e("repo","Add item from repository","Attach an existing issue or pull request from a repo.",this.options.onAddFromRepo)}}});function d(m){return m?String(m).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function P(m){if(!m)return null;let e=String(m).trim();if(/^#?[0-9a-f]{3}$/i.test(e)||/^#?[0-9a-f]{6}$/i.test(e)||/^#?[0-9a-f]{8}$/i.test(e)){let i=e[0]==="#"?e.slice(1):e;return"#"+(i.length===8?i.substring(0,6):i)}let t={GRAY:"#848d97",RED:"#f85149",ORANGE:"#db6d28",YELLOW:"#d29922",GREEN:"#3fb950",BLUE:"#2f81f7",PURPLE:"#a371f7",PINK:"#db61a2",BLACK:"#000000",WHITE:"#ffffff"},n=e.toUpperCase();return t[n]||null}function D(m,e){if(!m)return null;let t=m.replace("#",""),n=i=>parseInt(i,16);if(t.length===3){let i=n(t[0]+t[0]),s=n(t[1]+t[1]),r=n(t[2]+t[2]);return"rgba("+i+","+s+","+r+","+e+")"}if(t.length===6||t.length===8){let i=t.length===8?t.substring(0,6):t,s=n(t.substring(0,2)),r=n(i.substring(2,4)),a=n(i.substring(4,6));return"rgba("+s+","+r+","+a+","+e+")"}return null}function G(m){if(!m)return"#333333";let e=m.replace("#",""),t=r=>parseInt(r,16),n,i,s;if(e.length===3)n=t(e[0]+e[0]),i=t(e[1]+e[1]),s=t(e[2]+e[2]);else if(e.length===6||e.length===8){let r=e.length===8?e.substring(0,6):e;n=t(r.substring(0,2)),i=t(r.substring(2,4)),s=t(r.substring(4,6))}else return"#333333";return .2126*(n/255)+.7152*(i/255)+.0722*(s/255)>.6?"#111111":"#ffffff"}function F(m,e,t){try{window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"debugLog",level:"debug",viewKey:m,message:e,data:t})}catch{}try{console&&console.log&&console.log(e,t)}catch{}}function O(m,e){m.innerHTML='<div class="title">'+e+'</div><div class="loading"><em>Loading...</em></div>'}function H(m,e,t){m.innerHTML='<div class="title">'+e+'</div><div style="color:var(--vscode-editor-foreground)">'+t+"</div>"}function j(m){let e=document.createElement("button");return e.type="button",e.textContent="Load more",e.style.marginLeft="8px",e.style.border="1px solid var(--vscode-editorWidget-border)",e.addEventListener("click",()=>{m(),e.disabled=!0,e.textContent="Loading..."}),e}function J(m,e,t){if(window.filterBarHelper&&typeof window.filterBarHelper.create=="function")try{return window.filterBarHelper.create({parent:m,suffix:t.suffix||e,effFilter:typeof t.effFilter=="string"?t.effFilter:void 0,viewKey:e,step:t.step||50,onLoadMore:t.onLoadMore,onSave:t.onSave,onDiscard:t.onDiscard})}catch{return null}return null}function Q(m,e,t,n="block"){try{let i=Array.from(m.querySelectorAll(e));for(let s=0;s<i.length;s++)try{let r=i[s],a=r.getAttribute("data-gh-item-id");r.style.display=t.has(String(a))?n:"none"}catch{}}catch{}}var q=class{constructor(e,t,n,i,s){this.fields=e;this.allItems=t;this.visibleFieldIds=n;this.onFilter=i;this.onAction=s;this.handlePillClick=this.handlePillClick.bind(this)}handlePillClick(e,t,n){if(e.stopPropagation(),e.preventDefault(),this.onFilter){let i=n.includes(" ")?`"${n.replace(/"/g,'\\"')}"`:n,s=t.includes(" ")?`"${t.replace(/"/g,'\\"')}"`:t;this.onFilter(`${s}:${i}`)}}getIconSvg(e,t=14,n){return window.getIconSvg?window.getIconSvg(e,{size:t,fill:n}):""}getEstimateField(){return this.fields.find(e=>e.dataType&&String(e.dataType).toLowerCase()==="number"&&String(e.name||"").toLowerCase().includes("estimate"))||this.fields.find(e=>e.dataType&&String(e.dataType).toLowerCase()==="number")}sumEstimate(e){let t=this.getEstimateField();if(!t)return 0;let n=0;for(let i of e){if(!i||!Array.isArray(i.fieldValues))continue;let s=i.fieldValues.find(r=>r.fieldId&&String(r.fieldId)===String(t.id)||r.fieldName&&String(r.fieldName).toLowerCase().includes("estimate")||r.type==="number");if(s){let r=Number(s.number!=null?s.number:s.value!=null?s.value:NaN);isNaN(r)||(n+=r)}}return n}formatEstimate(e){return isFinite(e)?String(e):""}groupItemsByColumn(e,t){let n=new Map,i=String(t.dataType||"").toLowerCase(),s=[];i==="single_select"&&Array.isArray(t.options)?s=t.options:i==="iteration"&&t.configuration?.iterations&&(s=t.configuration.iterations.map(r=>({id:r.id,name:r.title,title:r.title,color:r.color||null,startDate:r.startDate,duration:r.duration})));for(let r of s){let a=String(r.id||r.name||"");a&&n.set(a,{option:r,items:[]})}n.set("__no_value__",{option:{id:"__no_value__",name:`No ${t.name}`,color:null},items:[]});for(let r of e){if(!r||!Array.isArray(r.fieldValues)){n.get("__no_value__").items.push(r);continue}let a=r.fieldValues.find(o=>String(o.fieldId)===String(t.id)||o.fieldName===t.name||o.type===i),c="__no_value__";if(a){if(i==="single_select"&&a.option)c=String(a.option.id||a.option.name||"__no_value__");else if(i==="iteration"&&a.iterationId)c=String(a.iterationId);else if(i==="iteration"&&a.title){for(let[o,l]of n)if(l.option.title===a.title||l.option.name===a.title){c=o;break}}}n.has(c)?n.get(c).items.push(r):n.get("__no_value__").items.push(r)}return n}getIterationRange(e){let t=e.startDate||e.start,n=e.duration||e.length;if(!t||!n)return null;try{let i=new Date(t),s=new Date(i.getTime()+Number(n)*24*60*60*1e3),r=a=>a.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${r(i)} \u2014 ${r(s)}`}catch{return null}}renderCard(e,t,n){let i=String(n.dataType||"").toLowerCase(),s=document.createElement("div");s.className="board-card",s.setAttribute("data-column-id",String(e.id||e.name||"")),s.style.width="350px",s.style.minWidth="350px",s.style.maxWidth="350px",s.style.background="var(--vscode-editorWidget-background)",s.style.border="1px solid var(--vscode-editorWidget-border)",s.style.borderRadius="0",s.style.display="flex",s.style.flexDirection="column",s.style.flexShrink="0";let r=document.createElement("div");r.className="board-card-header",r.style.padding="12px",r.style.borderBottom="1px solid var(--vscode-editorWidget-border)",r.style.flexShrink="0";let a=document.createElement("div");a.className="board-card-header-row",a.style.display="flex",a.style.alignItems="center",a.style.gap="8px";let c=document.createElement("span");c.className="board-card-color-dot",c.style.width="12px",c.style.height="12px",c.style.borderRadius="50%",c.style.flexShrink="0";let o=P(e.color)||"#666666";c.style.backgroundColor=o,a.appendChild(c);let l=document.createElement("span");l.className="board-card-title",l.style.fontWeight="600",l.style.flex="1",l.style.overflow="hidden",l.style.textOverflow="ellipsis",l.style.whiteSpace="nowrap",l.textContent=e.name||e.title||"Unnamed",a.appendChild(l);let h=document.createElement("span");h.className="board-card-count",h.style.fontSize="12px",h.style.color="var(--vscode-descriptionForeground)",h.style.fontVariantNumeric="tabular-nums",h.textContent=String(t.length),a.appendChild(h);let x=this.sumEstimate(t);if(x>0){let p=document.createElement("span");p.className="board-card-estimate",p.style.display="inline-block",p.style.padding="2px 8px",p.style.borderRadius="999px",p.style.background="var(--vscode-input-background)",p.style.border="1px solid var(--vscode-panel-border)",p.style.fontSize="12px",p.style.lineHeight="18px",p.textContent=this.formatEstimate(x),a.appendChild(p)}r.appendChild(a);let v=null;if(i==="single_select"&&e.description?v=String(e.description).slice(0,120):i==="iteration"&&(v=this.getIterationRange(e)),v){let p=document.createElement("div");p.className="board-card-description",p.style.fontSize="12px",p.style.color="var(--vscode-descriptionForeground)",p.style.marginTop="4px",p.style.overflow="hidden",p.style.textOverflow="ellipsis",p.style.whiteSpace="nowrap",p.textContent=v,r.appendChild(p)}s.appendChild(r);let b=document.createElement("div");b.className="board-card-items",b.style.padding="8px",b.style.overflowY="auto",b.style.flex="1",b.style.minHeight="0";let C=P(e.color)||"#666666";for(let p of t){let g=this.renderItem(p,n,C);b.appendChild(g)}s.appendChild(b);let S=document.createElement("div");S.className="board-card-footer",S.style.padding="8px 12px",S.style.borderTop="1px solid var(--vscode-editorWidget-border)",S.style.cursor="pointer",S.style.userSelect="none",S.style.flexShrink="0",S.style.transition="background-color 0.15s ease",S.setAttribute("data-column-field-id",String(n.id||"")),S.setAttribute("data-column-value-id",String(e.id||"")),S.setAttribute("data-column-value-name",String(e.name||e.title||""));let L=document.createElement("span");return L.textContent="+ Add item",L.style.opacity="0.9",L.style.fontSize="13px",S.appendChild(L),S.addEventListener("mouseenter",()=>{S.style.backgroundColor="var(--vscode-list-hoverBackground)"}),S.addEventListener("mouseleave",()=>{S.style.backgroundColor="transparent"}),S.addEventListener("click",p=>{p.stopPropagation(),this.onAction&&this.onAction("add-item-to-column",{columnFieldId:n.id,columnValueId:e.id,columnValueName:e.name||e.title},{anchorElement:S})}),s.appendChild(S),s}renderItem(e,t,n){let i=document.createElement("div");i.className="board-item",i.setAttribute("data-gh-item-id",String(e?.id||"")),i.style.padding="10px",i.style.border="1px solid var(--vscode-editorWidget-border)",i.style.borderRadius="0",i.style.marginBottom="8px",i.style.background="var(--vscode-editor-background)",i.style.cursor="pointer",i.style.position="relative";let s=e?.content||e?.raw&&e.raw.itemContent||null,r=e?.content&&(e.content.title||e.content.name)||e?.title||e?.raw&&e.raw.title||"Untitled",a=e?.content&&e.content.number||e?.raw&&e.raw.itemContent&&e.raw.itemContent.number||null,c=e?.content&&e.content.url||e?.raw&&e.raw.itemContent&&e.raw.itemContent.url||null,o="issue-opened",l=!1;if(s){let k=String(s.__typename||"").toLowerCase(),f=String(s.state||"").toUpperCase();l=k.includes("pullrequest");let u=f==="CLOSED",y=s.merged===!0,_=s.isDraft===!0;l?y?o="git-merge":u?o="git-pull-request-closed":_?o="git-pull-request-draft":o="git-pull-request":u?o="issue-closed":_?o="issue-draft":o="issue-opened"}let h=!1;try{let k=s&&s.issueDependenciesSummary?s.issueDependenciesSummary:null;h=(k&&typeof k.blockedBy=="number"?k.blockedBy:0)>0}catch{}let x=n,v=this.extractAssignees(e),b=document.createElement("div");b.style.display="flex",b.style.flexDirection="column",b.style.gap="6px";let C=document.createElement("div");C.style.display="flex",C.style.justifyContent="flex-start",C.style.alignItems="center";let S=this.getIconSvg(o,16,x),L=h?`<span class='blocked-overlay' style='position:absolute;right:-3px;bottom:-3px;width:14px;height:14px;border-radius:999px;background:var(--vscode-editor-background);display:flex;align-items:center;justify-content:center;box-sizing:border-box;'>${this.getIconSvg("blocked",9,"#dc3545")}</span>`:"";C.innerHTML=`<span style="position:relative;display:inline-flex;align-items:center;justify-content:center;color:${d(x)};">${S}${L}</span>`;let p=document.createElement("span");p.className="board-item-menu-btn",p.setAttribute("data-item-id",String(e?.id||"")),p.style.marginLeft="6px",p.style.color="var(--vscode-descriptionForeground)",p.innerHTML=this.getIconSvg("kebab-horizontal",14)||"<span>...</span>",C.appendChild(p),b.appendChild(C);let g=document.createElement("div");g.style.fontWeight="500",g.style.lineHeight="1.3",g.innerHTML=`${d(r)}${a?` <span style="color:var(--vscode-descriptionForeground);font-weight:400;">#${d(String(a))}</span>`:""}`,b.appendChild(g);let w=this.renderFieldValues(e,t);w&&b.appendChild(w);let $=this.renderSubIssuesProgress(e);if($&&b.appendChild($),i.appendChild(b),v&&v.length>0){let k=this.renderAssigneeAvatars(v);k.style.position="absolute",k.style.top="10px",k.style.right="10px",i.appendChild(k)}return c&&(i.setAttribute("data-gh-open",c),i.title=`${r}${a?` #${a}`:""}`),i}getFieldName(e){if(e.fieldName)return e.fieldName;if(e.field?.name)return e.field.name;if(e.fieldId&&this.fields){let t=this.fields.find(n=>String(n.id)===String(e.fieldId));if(t&&t.name)return t.name}return"Field"}extractAssignees(e){if(!e)return[];if(e.content?.assignees?.nodes)return e.content.assignees.nodes;if(e.content?.assignees&&Array.isArray(e.content.assignees))return e.content.assignees;if(Array.isArray(e.fieldValues)){let t=e.fieldValues.find(n=>n?.type==="assignees"||n?.assignees);if(t?.assignees)return Array.isArray(t.assignees)?t.assignees:[]}return[]}extractLinkedPullRequests(e){if(console.log("[BoardCard] extractLinkedPullRequests called with item:",e?.id,"fieldValues:",e?.fieldValues?.length),!e)return[];if(Array.isArray(e.fieldValues)){console.log("[BoardCard] Checking fieldValues, types:",e.fieldValues.map(n=>n?.type));let t=e.fieldValues.find(n=>n?.type==="linked_pull_requests"||n?.type==="pull_request");if(t){if(console.log("[BoardCard] Found PR field value:",t),Array.isArray(t.pullRequests))return console.log("[BoardCard] Returning direct array:",t.pullRequests),t.pullRequests;if(t.pullRequests?.nodes&&Array.isArray(t.pullRequests.nodes))return console.log("[BoardCard] Returning nodes array:",t.pullRequests.nodes),t.pullRequests.nodes}else console.log("[BoardCard] No PR field found in fieldValues")}if(e.content?.linkedPullRequests){if(Array.isArray(e.content.linkedPullRequests))return e.content.linkedPullRequests;if(Array.isArray(e.content.linkedPullRequests.nodes))return e.content.linkedPullRequests.nodes}return console.log("[BoardCard] Returning empty array for linkedPRs"),[]}renderAssigneeAvatars(e){let t=document.createElement("div");t.className="board-item-assignees",t.style.display="flex",t.style.alignItems="center";let n=3;if(e.slice(0,n).forEach((s,r)=>{let a=s.login||s.name||"Unknown",c=s.avatarUrl||"";if(!c)return;let o=document.createElement("img");o.src=c,o.className="board-pill",o.setAttribute("data-filter-field","Assignees"),o.setAttribute("data-filter-value",a),o.title=a,o.style.width="16px",o.style.height="16px",o.style.borderRadius="50%",o.style.border="1px solid var(--vscode-editorWidget-border)",o.style.cursor="pointer",o.style.marginLeft=r===0?"0":"-6px",o.style.zIndex=String(n-r),o.style.position="relative",t.appendChild(o)}),e.length>n){let s=document.createElement("span");s.className="board-pill",s.setAttribute("data-filter-field","Assignees"),s.style.marginLeft="-6px",s.style.width="22px",s.style.height="22px",s.style.borderRadius="50%",s.style.background="var(--vscode-badge-background)",s.style.color="var(--vscode-badge-foreground)",s.style.fontSize="10px",s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="center",s.style.fontWeight="bold",s.style.lineHeight="1",s.textContent=`+${e.length-n}`,s.title="More assignees",t.appendChild(s)}return t}renderFieldValues(e,t){if(!e||!Array.isArray(e.fieldValues))return null;let n=["sub_issues_progress","assignees","title","status"],i=["sub issues progress","assignees","title"],s=t?.id,r=[],a=this.extractLinkedPullRequests(e);if(a.length>0){let o=a.map(l=>{let h=d(String(l.number||"")),x=d(l.title||""),v=d(l.url||""),b=l.state_color||l.color||l.colour||l.state||null,C=P(b)||null,S=!!(C&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(C)),L=C||"#999999",p=S&&D(C,.12)||"rgba(0,0,0,0.06)",g=G(C)||"#333333",w=!!l.isDraft,$=l.state&&String(l.state).toUpperCase()||"",k=!!l.merged,f=!k&&$==="CLOSED",u="git-pull-request";k?u="git-merge":f?u="git-pull-request-closed":w&&(u="git-pull-request-draft");let y=this.getIconSvg(u,12),_=x?d(`#${l.number} ${l.title}`):d(`#${l.number}`);return`<a href="${v}" title="${_}" data-gh-open="${v}" style="cursor:pointer;text-decoration:none;color:inherit"><span class="board-pill" style="display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;border:1px solid ${d(L)};background:${d(p)};color:${d(g)};font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;max-width:160px"><span style="position:relative;display:inline-flex;align-items:center;justify-content:center">${y}</span><span style="flex:1 1 auto;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">#${h}</span></span></a>`}).join("");r.push(o)}for(let o of e.fieldValues){if(!o)continue;let l=String(o.type||"").toLowerCase(),h=String(o.fieldName||o.field?.name||"").toLowerCase();if(n.includes(l)||i.includes(h)||s&&String(o.fieldId)===String(s))continue;if(this.visibleFieldIds&&this.visibleFieldIds.length>0){let b=o.fieldId||o.field&&o.field.id;if(b&&!this.visibleFieldIds.includes(String(b)))continue}if(!this.hasFieldValue(o))continue;let v=this.renderFieldValue(o);v&&r.push(v)}if(r.length===0)return null;let c=document.createElement("div");return c.className="board-item-fields",c.style.display="flex",c.style.flexWrap="wrap",c.style.gap="4px",c.style.marginTop="4px",c.innerHTML=r.join(""),c}hasFieldValue(e){switch(String(e.type||"").toLowerCase()){case"single_select":return!!(e.option?.name||e.name);case"iteration":return!!(e.iteration?.title||e.title);case"labels":return Array.isArray(e.labels)&&e.labels.length>0;case"milestone":return!!e.milestone?.title;case"repository":return!!(e.repository?.nameWithOwner||e.repository?.name);case"parent_issue":return!!(e.parent||e.parentIssue);case"number":return e.number!=null&&e.number!=="";case"date":return!!(e.date||e.startDate);case"text":return!!e.text;case"pull_request":case"linked_pull_requests":return!!(e.pullRequests?.nodes?.length>0||Array.isArray(e.pullRequests)&&e.pullRequests.length>0);default:return!1}}renderFieldValue(e){switch(String(e.type||"").toLowerCase()){case"single_select":return this.renderSingleSelectPill(e);case"labels":return this.renderLabelsPills(e);case"iteration":return this.renderIterationPill(e);case"milestone":return this.renderMilestonePill(e);case"repository":return this.renderRepositoryPill(e);case"parent_issue":return this.renderParentIssuePill(e);case"number":return this.renderNumberPill(e);case"text":return this.renderTextPill(e);case"date":return this.renderDatePill(e);case"pull_request":case"linked_pull_requests":return this.renderLinkedPullRequests(e);default:return""}}renderSingleSelectPill(e){let t=e.option?.name||e.name||"";if(!t)return"";let n=e.option?.color||e.color||null,i=P(n)||null,s=!!(i&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(i)),r=i||"#999999",a=s&&D(i,.12)||"rgba(0,0,0,0.06)",c=i||"#333333",o=this.getFieldName(e);return`<span class="board-pill" data-filter-field="${d(o)}" data-filter-value="${d(t)}" style="display:inline-block;padding:2px 6px;border-radius:999px;border:1px solid ${d(r)};background:${d(a)};color:${d(c)};font-size:11px;line-height:16px;white-space:nowrap;max-width:100px;overflow:hidden;text-overflow:ellipsis;" title="${d(t)}">${d(t)}</span>`}renderLabelsPills(e){let t=e.labels||[];return!t||t.length===0?"":t.slice(0,3).map(n=>{let i=n.name||"",s=n.color||n.colour||null,r=P(s)||null,a=!!(r&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(r)),c=r||"#999999",o=a&&D(r,.12)||"rgba(0,0,0,0.06)",l=r||"#333333";return`<span class="board-pill" data-filter-field="Labels" data-filter-value="${d(i)}" style="display:inline-block;padding:2px 6px;border-radius:999px;border:1px solid ${d(c)};background:${d(o)};color:${d(l)};font-size:11px;line-height:16px;white-space:nowrap;max-width:80px;overflow:hidden;text-overflow:ellipsis;">${d(i)}</span>`}).join("")}renderIterationPill(e){let n=(e.iteration||e)?.title||"";if(!n)return"";let i=this.getIconSvg("iterations",12);return`<span class="board-pill" data-filter-field="Iteration" data-filter-value="${d(n)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;max-width:100px;overflow:hidden;text-overflow:ellipsis;" title="${d(n)}">${i}<span>${d(n)}</span></span>`}renderMilestonePill(e){let t=e.milestone?.title||"";if(!t)return"";let n=this.getIconSvg("milestone",12);return`<span class="board-pill" data-filter-field="Milestone" data-filter-value="${d(t)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;max-width:100px;overflow:hidden;text-overflow:ellipsis;" title="${d(t)}">${n}<span>${d(t)}</span></span>`}renderRepositoryPill(e){let t=e.repository||e,n=t?.nameWithOwner||t?.name||"";if(!n)return"";let i=this.getIconSvg("repo",12);return`<span class="board-pill" data-filter-field="repo" data-filter-value="${d(n)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;" title="${d(n)}">${i}<span style="max-width:100px;overflow:hidden;text-overflow:ellipsis;">${d(n)}</span></span>`}renderNumberPill(e){let t=e.number;if(t==null||t==="")return"";let n=this.getFieldName(e);return`<span class="board-pill" data-filter-field="${d(n)}" data-filter-value="${d(String(t))}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;"><span style="color:var(--vscode-descriptionForeground);">${d(n)}:</span><span>${d(String(t))}</span></span>`}renderTextPill(e){let t=e.text||"";if(!t)return"";let n=this.getFieldName(e),i=String(t).slice(0,30);return`<span class="board-pill" data-filter-field="${d(n)}" data-filter-value="${d(t)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;max-width:150px;overflow:hidden;text-overflow:ellipsis;" title="${d(t)}"><span style="color:var(--vscode-descriptionForeground);">${d(n)}:</span><span>${d(i)}</span></span>`}renderDatePill(e){let t=e.date||e.startDate||null;if(!t)return"";let n=this.getFieldName(e),i=t,s=t;try{let a=new Date(t);isNaN(a.getTime())||(i=a.toLocaleDateString("en-US",{month:"short",day:"numeric"}),s=a.toISOString().split("T")[0])}catch{}let r=this.getIconSvg("calendar",12);return`<span class="board-pill" data-filter-field="${d(n)}" data-filter-value="${d(String(s))}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;"><span style="color:var(--vscode-descriptionForeground);">${d(n)}:</span>${r}<span>${d(String(i))}</span></span>`}renderParentIssuePill(e){let t=e.parent||e.parentIssue||e.issue||null;if(!t)return"";let n=t.title||t.name||"",i=t.number||"",s=t.url||t.html_url||"";if(!n&&!i)return"";let r="#999999",a=!1,c=["done","closed","completed","finished"],o=null;if(this.allItems&&this.allItems.length>0){let $=t.id||t.raw&&t.raw.id,k=t.url||t.html_url||t.raw&&t.raw.url,f=t.number||t.raw&&t.raw.number;if(o=this.allItems.find(u=>{let y=u.content||u.raw&&u.raw.itemContent;if(!y)return!1;if($&&String(y.id)===String($)||k&&String(y.url)===String(k))return!0;if(f&&String(y.number)===String(f)){let _=y.repository?.nameWithOwner||y.repository?.name,I=t.repository?.nameWithOwner||t.repository?.name;return!(_&&I&&_!==I)}return!1}),o&&Array.isArray(o.fieldValues)){let u=o.fieldValues.find(y=>y&&y.type==="single_select"&&(y.raw&&y.raw.field&&String(y.raw.field.name||"").toLowerCase()==="status"||y.fieldName&&String(y.fieldName||"").toLowerCase()==="status"||y.field&&y.field.name&&String(y.field.name||"").toLowerCase()==="status"));if(u){let y=u.option&&(u.option.color||u.option.id||u.option.name)||u.raw&&u.raw.color||null;if(y&&(r=P(y)||r),u.option&&u.option.name){let _=String(u.option.name).toLowerCase();c.includes(_)&&(a=!0)}}}}r==="#999999"&&(t.statusColor?r=P(t.statusColor)||r:t.color&&(r=P(t.color)||r));let l=r,h=!!(l&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(l)),x=l||"#999999",v=h&&D(l,.12)||"rgba(0,0,0,0.06)",b=G(l)||"#333333",C=String(t.state||"").toUpperCase()==="CLOSED";a&&(C=!0);let S=!1;try{let $=!!(t.labels&&Array.isArray(t.labels)&&t.labels.some(f=>String(f.name||"").toLowerCase()==="blocked")),k=0;o&&o.content&&o.content.issueDependenciesSummary&&(k=o.content.issueDependenciesSummary.blockedBy||0),($||k>0)&&(S=!0)}catch{}let L=C?"issue-closed":"issue-opened",p=this.getIconSvg(L,12,l),g=S?`<span class='blocked-overlay' style='position:absolute;right:-3px;bottom:-3px;width:14px;height:14px;border-radius:999px;background:var(--vscode-editor-background);display:flex;align-items:center;justify-content:center;box-sizing:border-box;'>${this.getIconSvg("blocked",9,"#dc3545")}</span>`:"",w=`<span class="board-pill" data-filter-field="parent" data-filter-value="${d(n)}" style="display:inline-flex;align-items:center;gap:6px;padding:3px 8px;border:1px solid ${d(x)};border-radius:999px;background:${d(v)};color:${d(b)};font-size:11px;line-height:16px;max-width:150px;" title="${d(n+(i?" #"+i:""))}"${s?` data-gh-open="${d(s)}"`:""}>`;return w+=`<span style="position:relative;display:inline-flex;align-items:center;justify-content:center;flex-shrink:0;">${p}${g}</span>`,w+=`<span style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${d(n)}</span>`,i&&(w+=`<span style="flex-shrink:0;color:var(--vscode-descriptionForeground);">#${d(String(i))}</span>`),w+="</span>",w}renderLinkedPullRequests(e){let t=e.pullRequests?.nodes||[];return!t||t.length===0?"":t.map(n=>{let i=n.title||"#"+n.number||"PR",s=this.getIconSvg("git-pull-request",12);return`<span class="board-pill" data-filter-field="Linked Pull Requests" data-filter-value="${d(i)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;margin-right:2px;max-width:100px;overflow:hidden;text-overflow:ellipsis;" title="${d(i)}">${s}<span>${d(i)}</span></span>`}).join("")}renderSubIssuesProgress(e){if(!e||!Array.isArray(e.fieldValues))return null;let t=e.fieldValues.find(c=>c?.type==="sub_issues_progress");if(!t||!t.total||Number(t.total)<=0)return null;let n=Math.max(0,Math.floor(Number(t.total)||0)),i=Math.max(0,Math.floor(Number(t.done||0)));if(n===0)return null;let s=Math.round(i/n*100),r=document.createElement("div");r.className="board-item-progress board-pill",r.setAttribute("data-filter-field","parent");let a=e.content&&(e.content.title||e.content.name)||e.title||e.raw&&e.raw.title||"";return r.setAttribute("data-filter-value",a),r.style.marginTop="6px",r.title=`${i} of ${n} sub-issues complete (${s}%) -- Click to filter by this parent`,r.innerHTML=`
      <div style="display:flex;align-items:center;gap:6px;width:100%;">
        <span style="font-size:11px;color:var(--vscode-descriptionForeground);font-variant-numeric:tabular-nums;min-width:30px;">${i}/${n}</span>
        <div style="flex:1;height:8px;border-radius:4px;border:1px solid var(--vscode-focusBorder);overflow:hidden;background:transparent;">
          <div style="height:100%;width:${s}%;background:var(--vscode-focusBorder);"></div>
        </div>
        <span style="font-size:11px;color:var(--vscode-descriptionForeground);font-variant-numeric:tabular-nums;min-width:28px;text-align:right;">${s}%</span>
      </div>
    `,r}renderBoard(e,t){let n=this.groupItemsByColumn(this.allItems,t),i=document.createElement("div");i.className="board-container",i.style.display="flex",i.style.gap="16px",i.style.overflowX="auto",i.style.overflowY="hidden",i.style.padding="8px 0",i.style.alignItems="stretch",i.style.flex="1 1 auto",i.style.height="100%",i.style.boxSizing="border-box";let s=document.createElement("style");s.textContent=`
            .board-item-menu-btn { opacity: 0; transition: opacity 0.2s; cursor: pointer; padding: 2px; border-radius: 4px; }
            .board-item-menu-btn:hover { background: var(--vscode-toolbar-hoverBackground); }
            .board-item:hover .board-item-menu-btn { opacity: 1; }
            .board-pill { cursor: pointer; transition: opacity 0.2s; }
            .board-pill:hover { opacity: 0.8; }
        `,i.appendChild(s),i.addEventListener("click",r=>{let a=r.target,c=a.closest("[data-filter-field]");if(c){let l=c.getAttribute("data-filter-field"),h=c.getAttribute("data-filter-value");if(l&&h){this.handlePillClick(r,l,h);return}}let o=a.closest(".board-item-menu-btn");if(o){r.stopPropagation(),r.preventDefault();let l=o.getAttribute("data-item-id");if(this.onAction&&l){let h=this.allItems.find(v=>String(v.id)===String(l))||{id:l},x=o.getBoundingClientRect();this.onAction("open-menu",h,{x:x.left,y:x.bottom})}return}});for(let[r,a]of n){if(r==="__no_value__"&&a.items.length===0)continue;let c=this.renderCard(a.option,a.items,t);i.appendChild(c)}e.appendChild(i)}};try{F("global","boardViewFetcher.loaded")}catch{}try{console.log&&console.log("boardViewFetcher script loaded")}catch{}function se(){return function(m,e,t){let n=m&&(m.name||m.id)?m.name||m.id:"Board View";try{O(e,n)}catch{}var i=50;function s(o,l){try{var h=o&&o.items||[],x=o&&o.fields||[],v=o&&o.allFields||x;e.innerHTML="",e.style.margin="0",e.style.padding="0",e.style.height="100%",e.style.display="flex",e.style.flexDirection="column",e.style.overflow="hidden";let g=J(e,t,{suffix:t,step:i,onLoadMore:function(){i+=50,c()}});try{if(l&&g&&typeof g.setEffectiveFilter=="function")try{g.setEffectiveFilter(l)}catch{}}catch{}if(!g){var b=document.createElement("div");b.style.display="flex",b.style.justifyContent="space-between",b.style.alignItems="center",b.style.marginBottom="8px";var C=document.createElement("div");C.style.fontWeight="600",C.style.padding="6px",C.textContent=n;var S=document.createElement("div"),L=j(()=>{i+=50,c()});S.appendChild(L),b.appendChild(C),b.appendChild(S),e.appendChild(b)}let w=null;try{let f=o&&o.details,u=f&&f.verticalGroupByFields&&f.verticalGroupByFields.nodes;if(u&&u.length>0){let y=u[0];if(w=v.find(_=>String(_.id)===String(y.id)||String(_.name)===String(y.name)),w){let _=String(w.dataType||"").toLowerCase();_!=="single_select"&&_!=="iteration"&&(F(t,"boardViewFetcher.invalidColumnFieldType",{dataType:_,fieldName:w.name}),w=null)}}}catch(f){F(t,"boardViewFetcher.columnFieldDetection.error",{message:String(f?.message||f)})}w||(w=v.find(f=>String(f.dataType||"").toLowerCase()==="single_select"&&String(f.name||"").toLowerCase()==="status")),w||(w=v.find(f=>String(f.dataType||"").toLowerCase()==="single_select"));var p=document.createElement("div");p.style.flex="1 1 auto",p.style.overflow="hidden",p.style.position="relative",p.style.display="flex",p.style.flexDirection="column";let $=f=>{if(g&&g.inputEl){let u=String(g.inputEl.value||"").trim(),y=u?`${u} ${f}`:f;g.inputEl.value=y,g.inputEl.dispatchEvent(new Event("input",{bubbles:!0}))}},k=(f,u,y)=>{if(f==="open-menu"&&y){document.querySelectorAll(".board-context-menu").forEach(M=>M.remove());let I=document.createElement("div");I.className="board-context-menu",I.style.position="fixed";let A=Math.min(y.x,window.innerWidth-180),ee=Math.min(y.y,window.innerHeight-150);I.style.left=A+"px",I.style.top=ee+"px",I.style.background="var(--vscode-menu-background)",I.style.color="var(--vscode-menu-foreground)",I.style.border="1px solid var(--vscode-menu-border)",I.style.borderRadius="4px",I.style.zIndex="1000",I.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)",I.style.minWidth="160px",I.style.padding="4px 0";let z=(M,N,B,W=!1)=>{if(W){let R=document.createElement("div");R.style.height="1px",R.style.background="var(--vscode-menu-separatorBackground)",R.style.margin="4px 0",I.appendChild(R);return}let E=document.createElement("div");E.style.padding="4px 8px",E.style.cursor="pointer",E.style.display="flex",E.style.alignItems="center",E.style.gap="8px",E.style.fontSize="13px";let T=document.createElement("span");N&&(T.className="codicon codicon-"+N,N==="link-external"?T.textContent="\u2197":N==="globe"?T.textContent="\u{1F310}":N==="arrow-both"&&(T.textContent="\u21C4"));let V=document.createElement("span");V.textContent=M,E.appendChild(T),E.appendChild(V),E.addEventListener("click",R=>{R.stopPropagation(),I.remove(),B()}),E.addEventListener("mouseenter",()=>E.style.background="var(--vscode-menu-selectionBackground)"),E.addEventListener("mouseleave",()=>E.style.background="transparent"),I.appendChild(E)};z("Open issue","link-external",()=>{let M=u.content?.url||u.url||u.raw&&u.raw.itemContent&&u.raw.itemContent.url;M&&window.__APP_MESSAGING__&&window.__APP_MESSAGING__.postMessage({command:"openUrl",url:M})}),z("","",()=>{},!0),z("Move to column...","arrow-both",()=>{if(window.__APP_MESSAGING__){let M=[];if(w){let N=w.options||w.configuration&&w.configuration.options,B=w.configuration&&w.configuration.iterations,W=(E,T)=>{try{let V=new Date(E),R=new Date(V.getTime()+Number(T)*24*60*60*1e3),X=te=>te.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${X(V)} \u2014 ${X(R)}`}catch{return""}};N&&Array.isArray(N)?M=N.map(E=>({id:E.id,name:E.name,color:E.color,description:E.description})):B&&Array.isArray(B)&&(M=B.map(E=>({id:E.id,name:E.title,color:E.color,description:W(E.startDate,E.duration)})))}window.__APP_MESSAGING__.postMessage({command:"moveItem",viewKey:t,itemId:u.id,projectId:o&&o.id,fieldId:w?w.id:null,options:M,currentValue:""})}}),document.body.appendChild(I);let Y=()=>{I.remove(),document.removeEventListener("click",Y)};setTimeout(()=>document.addEventListener("click",Y),0)}else f==="add-item-to-column"&&u&&y&&Promise.resolve().then(()=>(K(),Z)).then(({AddItemMenu:_})=>{new _({anchorElement:y.anchorElement,onCreateIssue:()=>{try{let A=window.__APP_MESSAGING__;A&&typeof A.postMessage=="function"&&A.postMessage({command:"addItem:createIssue",viewKey:t,projectId:o&&o.id,columnFieldId:u.columnFieldId,columnValueId:u.columnValueId,columnValueName:u.columnValueName})}catch(A){console.error("[boardViewFetcher] create-issue action failed",A)}},onAddFromRepo:()=>{try{let A=window.__APP_MESSAGING__;A&&typeof A.postMessage=="function"&&A.postMessage({command:"addItem:addFromRepo",viewKey:t,projectId:o&&o.id,columnFieldId:u.columnFieldId,columnValueId:u.columnValueId,columnValueName:u.columnValueName})}catch(A){console.error("[boardViewFetcher] add-from-repo action failed",A)}}}).show()}).catch(_=>{console.error("Failed to load AddItemMenu",_)})};if(w)try{let f=x.map(y=>String(y.id));new q(v,h,f,$,k).renderBoard(p,w)}catch(f){F(t,"boardViewFetcher.cardRenderer.error",{message:String(f?.message||f)}),r(p,h)}else F(t,"boardViewFetcher.noColumnField",{fieldsCount:v.length}),r(p,h);e.appendChild(p);try{g&&typeof g.setCount=="function"&&g.setCount(h.length),g&&typeof g.setLoadState=="function"&&g.setLoadState(h.length<i,h.length>=i?"Load more":"All loaded"),g&&g.inputEl&&(typeof g.registerItems=="function"&&g.registerItems(h,{fields:x}),typeof g.onFilterChange=="function"&&g.onFilterChange(function(f,u){Q(e,"[data-gh-item-id]",f,"block"),g&&typeof g.setCount=="function"&&g.setCount(f.size),F(t,"filterInput",{filter:u,matched:f.size,original:h.length})}))}catch{}}catch(g){F(t,"boardViewFetcher.render.error",{message:String(g&&g.message),stack:g&&g.stack}),H(e,n,"Error rendering board view: "+String(g&&g.message))}}function r(o,l){for(var h=0;h<l.length;h++){var x=l[h],v=document.createElement("div");try{v.setAttribute("data-gh-item-id",String(x&&x.id))}catch{}v.style.padding="8px",v.style.border="1px solid var(--vscode-editorWidget-border)",v.style.marginBottom="8px",v.style.borderRadius="2px";var b=x&&x.content&&(x.content.title||x.content.name)||x&&x.title||x&&x.raw&&x.raw.title||"#"+(h+1);v.innerHTML='<div style="font-weight:600">'+d(b)+"</div>"+(x&&x.id?'<div style="color:var(--vscode-descriptionForeground);font-size:12px">'+d(String(x.id))+"</div>":""),o.appendChild(v)}}function a(o){var l=o&&o.data?o.data:o;try{if(l&&l.command==="fields"){if(l.viewKey&&t&&String(l.viewKey)!==String(t))return;l.error?H(e,n,String(l.error)):s(l.payload||l.payload&&l.payload.data||l.payload,l.effectiveFilter)}}catch{}}function c(){try{window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"requestFields",first:i,viewKey:t})}catch{}}try{window.__APP_MESSAGING__.onMessage(a)}catch{window.addEventListener("message",a)}c()}}try{window.boardViewFetcher=se()}catch{}})();
//# sourceMappingURL=boardViewFetcher.js.map
