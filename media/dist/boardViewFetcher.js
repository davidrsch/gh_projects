"use strict";(()=>{var re=Object.defineProperty;var ie=(h,e)=>()=>(h&&(e=h(h=0)),e);var se=(h,e)=>{for(var t in e)re(h,t,{get:e[t],enumerable:!0})};var Z={};se(Z,{AddItemMenu:()=>Y});var Y,ee=ie(()=>{"use strict";Y=class{constructor(e){this.menuElement=null;this.backdropElement=null;this.options=e}show(){this.hide(),this.backdropElement=document.createElement("div"),this.backdropElement.style.position="fixed",this.backdropElement.style.top="0",this.backdropElement.style.left="0",this.backdropElement.style.right="0",this.backdropElement.style.bottom="0",this.backdropElement.style.zIndex="998",this.backdropElement.addEventListener("click",()=>this.hide()),document.body.appendChild(this.backdropElement),this.menuElement=document.createElement("div"),this.menuElement.className="add-item-menu",this.menuElement.style.position="absolute",this.menuElement.style.background="var(--vscode-menu-background)",this.menuElement.style.border="1px solid var(--vscode-menu-border)",this.menuElement.style.borderRadius="4px",this.menuElement.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)",this.menuElement.style.minWidth="220px",this.menuElement.style.padding="4px 0",this.menuElement.style.zIndex="1000",this.menuElement.style.fontSize="13px",document.body.appendChild(this.menuElement),this.buildMenu();let e=this.options.anchorElement.getBoundingClientRect(),t=this.menuElement.getBoundingClientRect(),r=8,s=window.innerWidth||document.documentElement.clientWidth,a=window.innerHeight||document.documentElement.clientHeight,i=e.bottom+r;e.bottom+t.height+r>a&&(e.top-t.height-r>=0?i=e.top-t.height-r:i=Math.max(r,Math.min(a-t.height-r,e.bottom+r)));let o=e.left;e.left+t.width+r>s&&(o=Math.max(r,e.right-t.width)),o=Math.max(r,Math.min(o,s-t.width-r)),this.menuElement.style.top=`${Math.round(i)}px`,this.menuElement.style.left=`${Math.round(o)}px`}hide(){this.menuElement&&(this.menuElement.remove(),this.menuElement=null),this.backdropElement&&(this.backdropElement.remove(),this.backdropElement=null)}buildMenu(){if(!this.menuElement)return;let e=(t,r,s,a)=>{let i=document.createElement("div");i.className="add-item-menu-item",i.style.display="flex",i.style.alignItems="center",i.style.padding="6px 12px",i.style.cursor="pointer",i.style.color="var(--vscode-menu-foreground)";let o=document.createElement("span");o.style.display="inline-flex",o.style.alignItems="center",o.style.justifyContent="center",o.style.marginRight="8px",o.innerHTML=window.getIconSvg?.(t)||"",i.appendChild(o);let d=document.createElement("div");d.style.display="flex",d.style.flexDirection="column",d.style.flex="1";let n=document.createElement("div");if(n.textContent=r,n.style.fontWeight="500",d.appendChild(n),s){let l=document.createElement("div");l.textContent=s,l.style.fontSize="11px",l.style.color="var(--vscode-descriptionForeground)",d.appendChild(l)}i.appendChild(d),i.addEventListener("mouseenter",()=>{i.style.background="var(--vscode-menu-selectionBackground)",i.style.color="var(--vscode-menu-selectionForeground)"}),i.addEventListener("mouseleave",()=>{i.style.background="transparent",i.style.color="var(--vscode-menu-foreground)"}),i.addEventListener("click",()=>{a(),this.hide()}),this.menuElement.appendChild(i)};e("issue-opened","Create new issue","Create a project issue in a repository.",this.options.onCreateIssue),e("repo","Add item from repository","Attach an existing issue or pull request from a repo.",this.options.onAddFromRepo)}}});function u(h){return h?String(h).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function N(h){if(!h)return null;let e=String(h).trim();if(/^#?[0-9a-f]{3}$/i.test(e)||/^#?[0-9a-f]{6}$/i.test(e)||/^#?[0-9a-f]{8}$/i.test(e)){let s=e[0]==="#"?e.slice(1):e;return"#"+(s.length===8?s.substring(0,6):s)}let t={GRAY:"#848d97",RED:"#f85149",ORANGE:"#db6d28",YELLOW:"#d29922",GREEN:"#3fb950",BLUE:"#2f81f7",PURPLE:"#a371f7",PINK:"#db61a2",BLACK:"#000000",WHITE:"#ffffff"},r=e.toUpperCase();return t[r]||null}function D(h,e){if(!h)return null;let t=h.replace("#",""),r=s=>parseInt(s,16);if(t.length===3){let s=r(t[0]+t[0]),a=r(t[1]+t[1]),i=r(t[2]+t[2]);return"rgba("+s+","+a+","+i+","+e+")"}if(t.length===6||t.length===8){let s=t.length===8?t.substring(0,6):t,a=r(t.substring(0,2)),i=r(s.substring(2,4)),o=r(s.substring(4,6));return"rgba("+a+","+i+","+o+","+e+")"}return null}function O(h){if(!h)return"#333333";let e=h.replace("#",""),t=i=>parseInt(i,16),r,s,a;if(e.length===3)r=t(e[0]+e[0]),s=t(e[1]+e[1]),a=t(e[2]+e[2]);else if(e.length===6||e.length===8){let i=e.length===8?e.substring(0,6):e;r=t(i.substring(0,2)),s=t(i.substring(2,4)),a=t(i.substring(4,6))}else return"#333333";return .2126*(r/255)+.7152*(s/255)+.0722*(a/255)>.6?"#111111":"#ffffff"}function R(h,e,t){try{window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"debugLog",level:"debug",viewKey:h,message:e,data:t})}catch{}try{console&&console.log&&console.log(e,t)}catch{}}function U(h,e){h.innerHTML='<div class="title">'+e+'</div><div class="loading"><em>Loading...</em></div>'}function z(h,e,t){h.innerHTML='<div class="title">'+e+'</div><div style="color:var(--vscode-editor-foreground)">'+t+"</div>"}function j(h){let e=document.createElement("button");return e.type="button",e.textContent="Load more",e.style.marginLeft="8px",e.style.border="1px solid var(--vscode-editorWidget-border)",e.addEventListener("click",()=>{h(),e.disabled=!0,e.textContent="Loading..."}),e}function Q(h,e,t){if(window.filterBarHelper&&typeof window.filterBarHelper.create=="function")try{return window.filterBarHelper.create({parent:h,suffix:t.suffix||e,effFilter:typeof t.effFilter=="string"?t.effFilter:void 0,viewKey:e,step:t.step||50,onLoadMore:t.onLoadMore,onSave:t.onSave,onDiscard:t.onDiscard})}catch{return null}return null}function X(h,e,t,r="block"){try{let s=Array.from(h.querySelectorAll(e));for(let a=0;a<s.length;a++)try{let i=s[a],o=i.getAttribute("data-gh-item-id");i.style.display=t.has(String(o))?r:"none"}catch{}}catch{}}var W=class{constructor(e,t,r,s,a){this.fields=e;this.allItems=t;this.visibleFieldIds=r;this.onFilter=s;this.onAction=a;this.handlePillClick=this.handlePillClick.bind(this)}handlePillClick(e,t,r){if(e.stopPropagation(),e.preventDefault(),this.onFilter){let s=r.includes(" ")?`"${r.replace(/"/g,'\\"')}"`:r,a=t.includes(" ")?`"${t.replace(/"/g,'\\"')}"`:t;this.onFilter(`${a}:${s}`)}}getIconSvg(e,t=14,r){return window.getIconSvg?window.getIconSvg(e,{size:t,fill:r}):""}getEstimateField(){return this.fields.find(e=>e.dataType&&String(e.dataType).toLowerCase()==="number"&&String(e.name||"").toLowerCase().includes("estimate"))||this.fields.find(e=>e.dataType&&String(e.dataType).toLowerCase()==="number")}sumEstimate(e){let t=this.getEstimateField();if(!t)return 0;let r=0;for(let s of e){if(!s||!Array.isArray(s.fieldValues))continue;let a=s.fieldValues.find(i=>i.fieldId&&String(i.fieldId)===String(t.id)||i.fieldName&&String(i.fieldName).toLowerCase().includes("estimate")||i.type==="number");if(a){let i=Number(a.number!=null?a.number:a.value!=null?a.value:NaN);isNaN(i)||(r+=i)}}return r}formatEstimate(e){return isFinite(e)?String(e):""}groupItemsByColumn(e,t){let r=new Map,s=String(t.dataType||"").toLowerCase(),a=[];s==="single_select"&&Array.isArray(t.options)?a=t.options:s==="iteration"&&t.configuration?.iterations&&(a=t.configuration.iterations.map(i=>({id:i.id,name:i.title,title:i.title,color:i.color||null,startDate:i.startDate,duration:i.duration})));for(let i of a){let o=String(i.id||i.name||"");o&&r.set(o,{option:i,items:[]})}r.set("__no_value__",{option:{id:"__no_value__",name:`No ${t.name}`,color:null},items:[]});for(let i of e){if(!i||!Array.isArray(i.fieldValues)){r.get("__no_value__").items.push(i);continue}let o=i.fieldValues.find(n=>String(n.fieldId)===String(t.id)||String(n.fieldName).toLowerCase()===String(t.name).toLowerCase()),d="__no_value__";if(o){if(s==="single_select"){let n=o.optionId||o.option&&o.option.id,l=o.name||o.option&&o.option.name;if(n&&r.has(String(n)))d=String(n);else if(l){for(let[m,g]of r)if(String(g.option.name).toLowerCase()===String(l).toLowerCase()){d=m;break}}}else if(s==="iteration"){let n=o.iterationId||o.iteration&&o.iteration.id||o.id,l=o.title||o.iteration&&o.iteration.title;if(n&&r.has(String(n)))d=String(n);else if(l){for(let[m,g]of r)if(String(g.option.title).toLowerCase()===String(l).toLowerCase()||String(g.option.name).toLowerCase()===String(l).toLowerCase()){d=m;break}}}}r.has(d)?r.get(d).items.push(i):r.get("__no_value__").items.push(i)}return r}getIterationRange(e){let t=e.startDate||e.start,r=e.duration||e.length;if(!t||!r)return null;try{let s=new Date(t),a=new Date(s.getTime()+Number(r)*24*60*60*1e3),i=o=>o.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${i(s)} \u2014 ${i(a)}`}catch{return null}}renderCard(e,t,r){let s=document.createElement("div");s.className="board-card",s.setAttribute("data-column-id",String(e.id||e.name||"")),s.style.width="350px",s.style.minWidth="350px",s.style.maxWidth="350px",s.style.background="var(--vscode-editorWidget-background)",s.style.border="1px solid var(--vscode-editorWidget-border)",s.style.borderRadius="0",s.style.display="flex",s.style.flexDirection="column",s.style.flexShrink="0";let a=this.renderColumnHeaderOnly(e,t,r);a.style.borderBottom="1px solid var(--vscode-editorWidget-border)",s.appendChild(a);let i=document.createElement("div");i.className="board-card-items",i.style.padding="8px",i.style.overflowY="auto",i.style.flex="1",i.style.minHeight="0";let o=N(e.color)||"#666666";for(let n of t){let l=this.renderItem(n,r,o);i.appendChild(l)}s.appendChild(i);let d=this.renderColumnFooterOnly(e,r);return s.appendChild(d),s}renderColumnHeaderOnly(e,t,r){let s=String(r.dataType||"").toLowerCase(),a=document.createElement("div");a.className="board-card-header",a.style.padding="12px",a.style.background="var(--vscode-sideBar-background)",a.style.flexShrink="0";let i=document.createElement("div");i.className="board-card-header-row",i.style.display="flex",i.style.alignItems="center",i.style.gap="8px";let o=document.createElement("span");o.className="board-card-color-dot",o.style.width="12px",o.style.height="12px",o.style.borderRadius="50%",o.style.flexShrink="0";let d=N(e.color)||"#666666";o.style.backgroundColor=d,i.appendChild(o);let n=document.createElement("span");n.className="board-card-title",n.style.fontWeight="600",n.style.flex="1",n.style.overflow="hidden",n.style.textOverflow="ellipsis",n.style.whiteSpace="nowrap",n.textContent=e.name||e.title||"Unnamed",i.appendChild(n);let l=document.createElement("span");l.className="board-card-count",l.style.fontSize="12px",l.style.color="var(--vscode-descriptionForeground)",l.style.fontVariantNumeric="tabular-nums",l.textContent=String(t.length),i.appendChild(l);let m=this.sumEstimate(t);if(m>0){let c=document.createElement("span");c.className="board-card-estimate",c.style.display="inline-block",c.style.padding="2px 8px",c.style.borderRadius="999px",c.style.background="var(--vscode-input-background)",c.style.border="1px solid var(--vscode-panel-border)",c.style.fontSize="12px",c.style.lineHeight="18px",c.textContent=this.formatEstimate(m),i.appendChild(c)}a.appendChild(i);let g=null;if(s==="single_select"&&e.description?g=String(e.description).slice(0,120):s==="iteration"&&(g=this.getIterationRange(e)),g){let c=document.createElement("div");c.className="board-card-description",c.style.fontSize="12px",c.style.color="var(--vscode-descriptionForeground)",c.style.marginTop="4px",c.style.overflow="hidden",c.style.textOverflow="ellipsis",c.style.whiteSpace="nowrap",c.textContent=g,a.appendChild(c)}return a}renderColumnFooterOnly(e,t){let r=document.createElement("div");r.className="board-card-footer",r.style.padding="8px 12px",r.style.borderTop="1px solid var(--vscode-editorWidget-border)",r.style.cursor="pointer",r.style.userSelect="none",r.style.flexShrink="0",r.style.transition="background-color 0.15s ease",r.setAttribute("data-column-field-id",String(t.id||"")),r.setAttribute("data-column-value-id",String(e.id||"")),r.setAttribute("data-column-value-name",String(e.name||e.title||""));let s=document.createElement("span");return s.textContent="+ Add item",s.style.opacity="0.9",s.style.fontSize="13px",r.appendChild(s),r.addEventListener("mouseenter",()=>{r.style.backgroundColor="var(--vscode-list-hoverBackground)"}),r.addEventListener("mouseleave",()=>{r.style.backgroundColor="transparent"}),r.addEventListener("click",a=>{a.stopPropagation(),this.onAction&&this.onAction("add-item-to-column",{columnFieldId:t.id,columnValueId:e.id,columnValueName:e.name||e.title},{anchorElement:r})}),r}renderItem(e,t,r){let s=document.createElement("div");s.className="board-item",s.setAttribute("data-gh-item-id",String(e?.id||"")),s.style.padding="10px",s.style.border="1px solid var(--vscode-editorWidget-border)",s.style.borderRadius="0",s.style.marginBottom="8px",s.style.background="var(--vscode-editor-background)",s.style.cursor="pointer",s.style.position="relative";let a=e?.content||e?.raw&&e.raw.itemContent||null,i=e?.content&&(e.content.title||e.content.name)||e?.title||e?.raw&&e.raw.title||"Untitled",o=e?.content&&e.content.number||e?.raw&&e.raw.itemContent&&e.raw.itemContent.number||null,d=e?.content&&e.content.url||e?.raw&&e.raw.itemContent&&e.raw.itemContent.url||null,n="issue-opened",l=!1;if(a){let C=String(a.__typename||"").toLowerCase(),A=String(a.state||"").toUpperCase();l=C.includes("pullrequest");let p=A==="CLOSED",f=a.merged===!0,S=a.isDraft===!0;l?f?n="git-merge":p?n="git-pull-request-closed":S?n="git-pull-request-draft":n="git-pull-request":p?n="issue-closed":S?n="issue-draft":n="issue-opened"}let m=!1;try{let C=a&&a.issueDependenciesSummary?a.issueDependenciesSummary:null;m=(C&&typeof C.blockedBy=="number"?C.blockedBy:0)>0}catch{}let g=r,c=this.extractAssignees(e),b=document.createElement("div");b.style.display="flex",b.style.flexDirection="column",b.style.gap="6px";let v=document.createElement("div");v.style.display="flex",v.style.justifyContent="flex-start",v.style.alignItems="center";let L=this.getIconSvg(n,16,g),M=m?`<span class='blocked-overlay' style='position:absolute;right:-3px;bottom:-3px;width:14px;height:14px;border-radius:999px;background:var(--vscode-editor-background);display:flex;align-items:center;justify-content:center;box-sizing:border-box;'>${this.getIconSvg("blocked",9,"#dc3545")}</span>`:"";v.innerHTML=`<span style="position:relative;display:inline-flex;align-items:center;justify-content:center;color:${u(g)};">${L}${M}</span>`;let E=document.createElement("span");E.className="board-item-menu-btn",E.setAttribute("data-item-id",String(e?.id||"")),E.style.marginLeft="6px",E.style.color="var(--vscode-descriptionForeground)",E.innerHTML=this.getIconSvg("kebab-horizontal",14)||"<span>...</span>",v.appendChild(E),b.appendChild(v);let y=document.createElement("div");y.style.fontWeight="500",y.style.lineHeight="1.3",y.innerHTML=`${u(i)}${o?` <span style="color:var(--vscode-descriptionForeground);font-weight:400;">#${u(String(o))}</span>`:""}`,b.appendChild(y);let x=this.renderFieldValues(e,t);x&&b.appendChild(x);let _=this.renderSubIssuesProgress(e);if(_&&b.appendChild(_),s.appendChild(b),c&&c.length>0){let C=this.renderAssigneeAvatars(c);C.style.position="absolute",C.style.top="10px",C.style.right="10px",s.appendChild(C)}return d&&(s.setAttribute("data-gh-open",d),s.title=`${i}${o?` #${o}`:""}`),s}getFieldName(e){if(e.fieldName)return e.fieldName;if(e.field?.name)return e.field.name;if(e.fieldId&&this.fields){let t=this.fields.find(r=>String(r.id)===String(e.fieldId));if(t&&t.name)return t.name}return"Field"}extractAssignees(e){if(!e)return[];if(e.content?.assignees?.nodes)return e.content.assignees.nodes;if(e.content?.assignees&&Array.isArray(e.content.assignees))return e.content.assignees;if(Array.isArray(e.fieldValues)){let t=e.fieldValues.find(r=>r?.type==="assignees"||r?.assignees);if(t?.assignees)return Array.isArray(t.assignees)?t.assignees:[]}return[]}extractLinkedPullRequests(e){if(console.log("[BoardCard] extractLinkedPullRequests called with item:",e?.id,"fieldValues:",e?.fieldValues?.length),!e)return[];if(Array.isArray(e.fieldValues)){console.log("[BoardCard] Checking fieldValues, types:",e.fieldValues.map(r=>r?.type));let t=e.fieldValues.find(r=>r?.type==="linked_pull_requests"||r?.type==="pull_request");if(t){if(console.log("[BoardCard] Found PR field value:",t),Array.isArray(t.pullRequests))return console.log("[BoardCard] Returning direct array:",t.pullRequests),t.pullRequests;if(t.pullRequests?.nodes&&Array.isArray(t.pullRequests.nodes))return console.log("[BoardCard] Returning nodes array:",t.pullRequests.nodes),t.pullRequests.nodes}else console.log("[BoardCard] No PR field found in fieldValues")}if(e.content?.linkedPullRequests){if(Array.isArray(e.content.linkedPullRequests))return e.content.linkedPullRequests;if(Array.isArray(e.content.linkedPullRequests.nodes))return e.content.linkedPullRequests.nodes}return console.log("[BoardCard] Returning empty array for linkedPRs"),[]}renderAssigneeAvatars(e){let t=document.createElement("div");t.className="board-item-assignees",t.style.display="flex",t.style.alignItems="center";let r=3;if(e.slice(0,r).forEach((a,i)=>{let o=a.login||a.name||"Unknown",d=a.avatarUrl||"";if(!d)return;let n=document.createElement("img");n.src=d,n.className="board-pill",n.setAttribute("data-filter-field","Assignees"),n.setAttribute("data-filter-value",o),n.title=o,n.style.width="16px",n.style.height="16px",n.style.borderRadius="50%",n.style.border="1px solid var(--vscode-editorWidget-border)",n.style.cursor="pointer",n.style.marginLeft=i===0?"0":"-6px",n.style.zIndex=String(r-i),n.style.position="relative",t.appendChild(n)}),e.length>r){let a=document.createElement("span");a.className="board-pill",a.setAttribute("data-filter-field","Assignees"),a.style.marginLeft="-6px",a.style.width="22px",a.style.height="22px",a.style.borderRadius="50%",a.style.background="var(--vscode-badge-background)",a.style.color="var(--vscode-badge-foreground)",a.style.fontSize="10px",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.fontWeight="bold",a.style.lineHeight="1",a.textContent=`+${e.length-r}`,a.title="More assignees",t.appendChild(a)}return t}renderFieldValues(e,t){if(!e||!Array.isArray(e.fieldValues))return null;let r=["sub_issues_progress","assignees","title","status"],s=["sub issues progress","assignees","title"],a=t?.id,i=[],o=this.extractLinkedPullRequests(e);if(o.length>0){let n=o.map(l=>{let m=u(String(l.number||"")),g=u(l.title||""),c=u(l.url||""),b=l.state_color||l.color||l.colour||l.state||null,v=N(b)||null,L=!!(v&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(v)),M=v||"#999999",E=L&&D(v,.12)||"rgba(0,0,0,0.06)",y=O(v)||"#333333",x=!!l.isDraft,_=l.state&&String(l.state).toUpperCase()||"",C=!!l.merged,A=!C&&_==="CLOSED",p="git-pull-request";C?p="git-merge":A?p="git-pull-request-closed":x&&(p="git-pull-request-draft");let f=this.getIconSvg(p,12),S=g?u(`#${l.number} ${l.title}`):u(`#${l.number}`);return`<a href="${c}" title="${S}" data-gh-open="${c}" style="cursor:pointer;text-decoration:none;color:inherit"><span class="board-pill" style="display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;border:1px solid ${u(M)};background:${u(E)};color:${u(y)};font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;max-width:160px"><span style="position:relative;display:inline-flex;align-items:center;justify-content:center">${f}</span><span style="flex:1 1 auto;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">#${m}</span></span></a>`}).join("");i.push(n)}for(let n of e.fieldValues){if(!n)continue;let l=String(n.type||"").toLowerCase(),m=String(n.fieldName||n.field?.name||"").toLowerCase();if(r.includes(l)||s.includes(m)||a&&String(n.fieldId)===String(a))continue;if(this.visibleFieldIds&&this.visibleFieldIds.length>0){let b=n.fieldId||n.field&&n.field.id;if(b&&!this.visibleFieldIds.includes(String(b)))continue}if(!this.hasFieldValue(n))continue;let c=this.renderFieldValue(n);c&&i.push(c)}if(i.length===0)return null;let d=document.createElement("div");return d.className="board-item-fields",d.style.display="flex",d.style.flexWrap="wrap",d.style.gap="4px",d.style.marginTop="4px",d.innerHTML=i.join(""),d}hasFieldValue(e){switch(String(e.type||"").toLowerCase()){case"single_select":return!!(e.option?.name||e.name);case"iteration":return!!(e.iteration?.title||e.title);case"labels":return Array.isArray(e.labels)&&e.labels.length>0;case"milestone":return!!e.milestone?.title;case"repository":return!!(e.repository?.nameWithOwner||e.repository?.name);case"parent_issue":return!!(e.parent||e.parentIssue);case"number":return e.number!=null&&e.number!=="";case"date":return!!(e.date||e.startDate);case"text":return!!e.text;case"pull_request":case"linked_pull_requests":return!!(e.pullRequests?.nodes?.length>0||Array.isArray(e.pullRequests)&&e.pullRequests.length>0);default:return!1}}renderFieldValue(e){switch(String(e.type||"").toLowerCase()){case"single_select":return this.renderSingleSelectPill(e);case"labels":return this.renderLabelsPills(e);case"iteration":return this.renderIterationPill(e);case"milestone":return this.renderMilestonePill(e);case"repository":return this.renderRepositoryPill(e);case"parent_issue":return this.renderParentIssuePill(e);case"number":return this.renderNumberPill(e);case"text":return this.renderTextPill(e);case"date":return this.renderDatePill(e);case"pull_request":case"linked_pull_requests":return this.renderLinkedPullRequests(e);default:return""}}renderSingleSelectPill(e){let t=e.option?.name||e.name||"";if(!t)return"";let r=e.option?.color||e.color||null,s=N(r)||null,a=!!(s&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(s)),i=s||"#999999",o=a&&D(s,.12)||"rgba(0,0,0,0.06)",d=s||"#333333",n=this.getFieldName(e);return`<span class="board-pill" data-filter-field="${u(n)}" data-filter-value="${u(t)}" style="display:inline-block;padding:2px 6px;border-radius:999px;border:1px solid ${u(i)};background:${u(o)};color:${u(d)};font-size:11px;line-height:16px;white-space:nowrap;max-width:100px;overflow:hidden;text-overflow:ellipsis;" title="${u(t)}">${u(t)}</span>`}renderLabelsPills(e){let t=e.labels||[];return!t||t.length===0?"":t.slice(0,3).map(r=>{let s=r.name||"",a=r.color||r.colour||null,i=N(a)||null,o=!!(i&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(i)),d=i||"#999999",n=o&&D(i,.12)||"rgba(0,0,0,0.06)",l=i||"#333333";return`<span class="board-pill" data-filter-field="Labels" data-filter-value="${u(s)}" style="display:inline-block;padding:2px 6px;border-radius:999px;border:1px solid ${u(d)};background:${u(n)};color:${u(l)};font-size:11px;line-height:16px;white-space:nowrap;max-width:80px;overflow:hidden;text-overflow:ellipsis;">${u(s)}</span>`}).join("")}renderIterationPill(e){let r=(e.iteration||e)?.title||"";if(!r)return"";let s=this.getIconSvg("iterations",12);return`<span class="board-pill" data-filter-field="Iteration" data-filter-value="${u(r)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;max-width:100px;overflow:hidden;text-overflow:ellipsis;" title="${u(r)}">${s}<span>${u(r)}</span></span>`}renderMilestonePill(e){let t=e.milestone?.title||"";if(!t)return"";let r=this.getIconSvg("milestone",12);return`<span class="board-pill" data-filter-field="Milestone" data-filter-value="${u(t)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;max-width:100px;overflow:hidden;text-overflow:ellipsis;" title="${u(t)}">${r}<span>${u(t)}</span></span>`}renderRepositoryPill(e){let t=e.repository||e,r=t?.nameWithOwner||t?.name||"";if(!r)return"";let s=this.getIconSvg("repo",12);return`<span class="board-pill" data-filter-field="repo" data-filter-value="${u(r)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;" title="${u(r)}">${s}<span style="max-width:100px;overflow:hidden;text-overflow:ellipsis;">${u(r)}</span></span>`}renderNumberPill(e){let t=e.number;if(t==null||t==="")return"";let r=this.getFieldName(e);return`<span class="board-pill" data-filter-field="${u(r)}" data-filter-value="${u(String(t))}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;"><span style="color:var(--vscode-descriptionForeground);">${u(r)}:</span><span>${u(String(t))}</span></span>`}renderTextPill(e){let t=e.text||"";if(!t)return"";let r=this.getFieldName(e),s=String(t).slice(0,30);return`<span class="board-pill" data-filter-field="${u(r)}" data-filter-value="${u(t)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;max-width:150px;overflow:hidden;text-overflow:ellipsis;" title="${u(t)}"><span style="color:var(--vscode-descriptionForeground);">${u(r)}:</span><span>${u(s)}</span></span>`}renderDatePill(e){let t=e.date||e.startDate||null;if(!t)return"";let r=this.getFieldName(e),s=t,a=t;try{let o=new Date(t);isNaN(o.getTime())||(s=o.toLocaleDateString("en-US",{month:"short",day:"numeric"}),a=o.toISOString().split("T")[0])}catch{}let i=this.getIconSvg("calendar",12);return`<span class="board-pill" data-filter-field="${u(r)}" data-filter-value="${u(String(a))}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;"><span style="color:var(--vscode-descriptionForeground);">${u(r)}:</span>${i}<span>${u(String(s))}</span></span>`}renderParentIssuePill(e){let t=e.parent||e.parentIssue||e.issue||null;if(!t)return"";let r=t.title||t.name||"",s=t.number||"",a=t.url||t.html_url||"";if(!r&&!s)return"";let i="#999999",o=!1,d=["done","closed","completed","finished"],n=null;if(this.allItems&&this.allItems.length>0){let _=t.id||t.raw&&t.raw.id,C=t.url||t.html_url||t.raw&&t.raw.url,A=t.number||t.raw&&t.raw.number;if(n=this.allItems.find(p=>{let f=p.content||p.raw&&p.raw.itemContent;if(!f)return!1;if(_&&String(f.id)===String(_)||C&&String(f.url)===String(C))return!0;if(A&&String(f.number)===String(A)){let S=f.repository?.nameWithOwner||f.repository?.name,I=t.repository?.nameWithOwner||t.repository?.name;return!(S&&I&&S!==I)}return!1}),n&&Array.isArray(n.fieldValues)){let p=n.fieldValues.find(f=>f&&f.type==="single_select"&&(f.raw&&f.raw.field&&String(f.raw.field.name||"").toLowerCase()==="status"||f.fieldName&&String(f.fieldName||"").toLowerCase()==="status"||f.field&&f.field.name&&String(f.field.name||"").toLowerCase()==="status"));if(p){let f=p.option&&(p.option.color||p.option.id||p.option.name)||p.raw&&p.raw.color||null;if(f&&(i=N(f)||i),p.option&&p.option.name){let S=String(p.option.name).toLowerCase();d.includes(S)&&(o=!0)}}}}i==="#999999"&&(t.statusColor?i=N(t.statusColor)||i:t.color&&(i=N(t.color)||i));let l=i,m=!!(l&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(l)),g=l||"#999999",c=m&&D(l,.12)||"rgba(0,0,0,0.06)",b=O(l)||"#333333",v=String(t.state||"").toUpperCase()==="CLOSED";o&&(v=!0);let L=!1;try{let _=!!(t.labels&&Array.isArray(t.labels)&&t.labels.some(A=>String(A.name||"").toLowerCase()==="blocked")),C=0;n&&n.content&&n.content.issueDependenciesSummary&&(C=n.content.issueDependenciesSummary.blockedBy||0),(_||C>0)&&(L=!0)}catch{}let M=v?"issue-closed":"issue-opened",E=this.getIconSvg(M,12,l),y=L?`<span class='blocked-overlay' style='position:absolute;right:-3px;bottom:-3px;width:14px;height:14px;border-radius:999px;background:var(--vscode-editor-background);display:flex;align-items:center;justify-content:center;box-sizing:border-box;'>${this.getIconSvg("blocked",9,"#dc3545")}</span>`:"",x=`<span class="board-pill" data-filter-field="parent" data-filter-value="${u(r)}" style="display:inline-flex;align-items:center;gap:6px;padding:3px 8px;border:1px solid ${u(g)};border-radius:999px;background:${u(c)};color:${u(b)};font-size:11px;line-height:16px;max-width:150px;" title="${u(r+(s?" #"+s:""))}"${a?` data-gh-open="${u(a)}"`:""}>`;return x+=`<span style="position:relative;display:inline-flex;align-items:center;justify-content:center;flex-shrink:0;">${E}${y}</span>`,x+=`<span style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${u(r)}</span>`,s&&(x+=`<span style="flex-shrink:0;color:var(--vscode-descriptionForeground);">#${u(String(s))}</span>`),x+="</span>",x}renderLinkedPullRequests(e){let t=e.pullRequests?.nodes||[];return!t||t.length===0?"":t.map(r=>{let s=r.title||"#"+r.number||"PR",a=this.getIconSvg("git-pull-request",12);return`<span class="board-pill" data-filter-field="Linked Pull Requests" data-filter-value="${u(s)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;margin-right:2px;max-width:100px;overflow:hidden;text-overflow:ellipsis;" title="${u(s)}">${a}<span>${u(s)}</span></span>`}).join("")}renderSubIssuesProgress(e){if(!e||!Array.isArray(e.fieldValues))return null;let t=e.fieldValues.find(d=>d?.type==="sub_issues_progress");if(!t||!t.total||Number(t.total)<=0)return null;let r=Math.max(0,Math.floor(Number(t.total)||0)),s=Math.max(0,Math.floor(Number(t.done||0)));if(r===0)return null;let a=Math.round(s/r*100),i=document.createElement("div");i.className="board-item-progress board-pill",i.setAttribute("data-filter-field","parent");let o=e.content&&(e.content.title||e.content.name)||e.title||e.raw&&e.raw.title||"";return i.setAttribute("data-filter-value",o),i.style.marginTop="6px",i.title=`${s} of ${r} sub-issues complete (${a}%) -- Click to filter by this parent`,i.innerHTML=`
      <div style="display:flex;align-items:center;gap:6px;width:100%;">
        <span style="font-size:11px;color:var(--vscode-descriptionForeground);font-variant-numeric:tabular-nums;min-width:30px;">${s}/${r}</span>
        <div style="flex:1;height:8px;border-radius:4px;border:1px solid var(--vscode-focusBorder);overflow:hidden;background:transparent;">
          <div style="height:100%;width:${a}%;background:var(--vscode-focusBorder);"></div>
        </div>
        <span style="font-size:11px;color:var(--vscode-descriptionForeground);font-variant-numeric:tabular-nums;min-width:28px;text-align:right;">${a}%</span>
      </div>
    `,i}groupItemsBySwimlane(e,t){let r=new Map,s=String(t.dataType||"").toLowerCase(),a=[];if(s==="single_select"&&Array.isArray(t.options))a=t.options;else if(s==="iteration"&&t.configuration?.iterations)a=t.configuration.iterations.map(i=>({id:i.id,name:i.title,title:i.title,color:i.color||null,startDate:i.startDate,duration:i.duration}));else if(s==="assignees"){let i=new Map;for(let o of e){let d=this.extractAssignees(o);for(let n of d)i.has(n.login)||i.set(n.login,n)}a=Array.from(i.values()).map(o=>({id:o.login,name:o.login,avatarUrl:o.avatarUrl,type:"assignee"}))}else if(s==="repository"){let i=new Map;for(let o of e){let d=o.content?.repository||o.raw?.itemContent?.repository||o.repository;if(d&&(d.nameWithOwner||d.name)){let n=d.nameWithOwner||d.name;i.has(n)||i.set(n,d)}}a=Array.from(i.values()).map(o=>({id:o.nameWithOwner||o.name,name:o.nameWithOwner||o.name,type:"repository"}))}else if(s==="milestone"){let i=new Map;for(let o of e){let d=o.fieldValues?.find(n=>n.type==="milestone");d?.milestone&&(i.has(d.milestone.id||d.milestone.title)||i.set(d.milestone.id||d.milestone.title,d.milestone))}a=Array.from(i.values()).map(o=>({id:o.id||o.title,name:o.title,type:"milestone"}))}else if(s==="labels"){let i=new Map;for(let o of e){let d=o.fieldValues?.find(n=>n.type==="labels");if(d?.labels?.nodes)for(let n of d.labels.nodes)i.has(n.id||n.name)||i.set(n.id||n.name,n)}a=Array.from(i.values()).map(o=>({id:o.id||o.name,name:o.name,color:o.color,type:"label"}))}for(let i of a){let o=String(i.id||i.name||"");o&&r.set(o,{option:i,items:[]})}r.set("__no_value__",{option:{id:"__no_value__",name:`No ${t.name}`,color:null},items:[]});for(let i of e){let o="__no_value__";if(s==="assignees"){let n=this.extractAssignees(i);if(n.length>0){for(let l of n){let m=l.login;r.has(m)&&r.get(m).items.push(i)}continue}}else if(s==="labels"){let n=i.fieldValues?.find(l=>l.type==="labels");if(n?.labels?.nodes&&n.labels.nodes.length>0){for(let l of n.labels.nodes){let m=String(l.id||l.name);r.has(m)&&r.get(m).items.push(i)}continue}}else if(s==="repository"){let n=i.content?.repository||i.raw?.itemContent?.repository||i.repository;n&&(o=n.nameWithOwner||n.name||"__no_value__")}else if(s==="parent_issue"){let n=i.fieldValues?.find(m=>m.type==="parent_issue"||String(m.fieldName).toLowerCase()==="parent"),l=n?.parent||n?.parentIssue||n?.issue||n?.item||n?.value;l&&(o=String(l.number||l.id||l.title||"__no_value__"))}else if(Array.isArray(i.fieldValues)){let n=i.fieldValues.find(l=>String(l.fieldId)===String(t.id)||String(l.fieldName).toLowerCase()===String(t.name).toLowerCase());if(n)if(s==="single_select"){let l=n.optionId||n.option&&n.option.id,m=n.name||n.option&&n.option.name;if(l&&r.has(String(l)))o=String(l);else if(m){for(let[g,c]of r)if(String(c.option.name).toLowerCase()===String(m).toLowerCase()){o=g;break}}}else if(s==="iteration"){let l=n.iterationId||n.iteration&&n.iteration.id||n.id,m=n.title||n.iteration&&n.iteration.title;if(l&&r.has(String(l)))o=String(l);else if(m){for(let[g,c]of r)if(String(c.option.title).toLowerCase()===String(m).toLowerCase()||String(c.option.name).toLowerCase()===String(m).toLowerCase()){o=g;break}}}else{let l=n.text??n.number??n.date??n.title??n.value;l!=null&&l!==""&&(o=String(l))}}let d=r.has(o)?o:"__no_value__";o!=="__no_value__"&&!r.has(o)&&r.set(o,{option:{id:o,name:o,title:o},items:[]}),r.get(r.has(o)?o:"__no_value__").items.push(i)}return r}renderSwimlaneHeader(e,t,r){let s=document.createElement("div");s.className="board-swimlane-header",s.style.display="flex",s.style.alignItems="center",s.style.gap="8px",s.style.padding="8px 16px",s.style.top="var(--board-headers-height, 72px)",s.style.zIndex="20",s.style.cursor="pointer",s.style.userSelect="none";let a=document.createElement("span");if(a.className="swimlane-toggle-icon",a.innerHTML=this.getIconSvg("triangle-down",16),a.style.opacity="0.7",s.appendChild(a),e.avatarUrl){let n=document.createElement("img");n.src=e.avatarUrl,n.style.width="20px",n.style.height="20px",n.style.borderRadius="50%",s.appendChild(n)}else if(e.type==="repository"){let n=document.createElement("span");n.innerHTML=this.getIconSvg("repo",16),s.appendChild(n)}else{let n=document.createElement("div");n.style.width="12px",n.style.height="12px",n.style.borderRadius="50%",n.style.backgroundColor=N(e.color)||"gray",s.appendChild(n)}let i=document.createElement("span");i.textContent=e.name||e.title||"Unassigned",s.appendChild(i);let o=document.createElement("span");o.style.display="inline-flex",o.style.alignItems="center",o.style.justifyContent="center",o.style.minWidth="22px",o.style.height="22px",o.style.borderRadius="50%",o.style.background="var(--vscode-input-background)",o.style.border="1px solid var(--vscode-panel-border)",o.style.fontSize="12px",o.style.padding="0 4px",o.textContent=String(t.length),s.appendChild(o);let d=this.sumEstimate(t);if(d>0){let n=document.createElement("div");n.style.padding="2px 8px",n.style.borderRadius="999px",n.style.border="1px solid var(--vscode-panel-border)",n.style.background="var(--vscode-input-background)",n.style.fontSize="11px",n.textContent="Estimate: "+this.formatEstimate(d),s.appendChild(n)}if(String(r.dataType||"").toLowerCase()==="iteration"){let n=this.getIterationRange(e);if(n){let l=document.createElement("span");l.style.color="var(--vscode-descriptionForeground)",l.style.fontSize="12px",l.style.fontWeight="400",l.textContent=n,s.appendChild(l)}}return s}renderBoard(e,t,r){let s=document.createElement("style");s.textContent=`
            * { box-sizing: border-box; }
            .board-item-menu-btn { opacity: 0; transition: opacity 0.2s; cursor: pointer; padding: 2px; border-radius: 4px; }
            .board-item-menu-btn:hover { background: var(--vscode-toolbar-hoverBackground); }
            .board-item:hover .board-item-menu-btn { opacity: 1; }
            .board-pill { cursor: pointer; transition: opacity 0.2s; }
            .board-pill:hover { opacity: 0.8; }
            .board-swimlane { display: flex; flex-direction: column; }
            .board-swimlane-content { display: flex; gap: 16px; padding: 0 16px 16px 16px; align-items: stretch; }
            .board-container { display: flex; flex-direction: column; overflow: auto; height: 100%; width: 100%; }
            .board-column-headers { 
              display: flex; 
              gap: 16px; 
              padding: 16px 16px 0 16px; 
              position: sticky; 
              top: 0; 
              z-index: 30; 
              background: var(--vscode-editor-background); 
              align-items: stretch;
              border-bottom: 1px solid var(--vscode-panel-border);
            }
            .board-column-header { 
              width: 350px; 
              min-width: 350px; 
              flex-shrink: 0; 
              background: var(--vscode-sideBar-background);
              border: 1px solid var(--vscode-editorWidget-border);
              display: flex;
              flex-direction: column;
            }
            .board-column-items { 
              width: 350px; 
              min-width: 350px; 
              flex-shrink: 0; 
              display: flex; 
              flex-direction: column; 
              gap: 8px; 
              background: var(--vscode-editorWidget-background); 
              border: 1px solid var(--vscode-editorWidget-border); 
              padding: 8px; 
            }
            .board-swimlane-header {
              border-bottom: 1px solid var(--vscode-panel-border);
              background: var(--vscode-editor-background);
              position: sticky;
              z-index: 20;
              margin: 0;
            }
        `,e.appendChild(s);let a=document.createElement("div");a.className="board-container",a.style.background="var(--vscode-editor-background)",a.addEventListener("click",d=>{let n=d.target,l=n.closest(".board-swimlane-header");if(l){let b=l.parentElement.querySelector(".board-swimlane-content"),v=l.querySelector(".swimlane-toggle-icon"),L=b.style.display==="none";b.style.display=L?"flex":"none",v.innerHTML=this.getIconSvg(L?"triangle-down":"triangle-right",16);return}let m=n.closest("[data-filter-field]");if(m){let c=m.getAttribute("data-filter-field"),b=m.getAttribute("data-filter-value");if(c&&b){this.handlePillClick(d,c,b);return}}let g=n.closest(".board-item-menu-btn");if(g){d.stopPropagation(),d.preventDefault();let c=g.getAttribute("data-item-id");if(this.onAction&&c){let b=this.allItems.find(L=>String(L.id)===String(c))||{id:c},v=g.getBoundingClientRect();this.onAction("open-menu",b,{x:v.left,y:v.bottom})}return}});let i=this.groupItemsByColumn(this.allItems,t),o=Array.from(i.values());if(r){let d=document.createElement("div");d.className="board-column-headers js-board-headers",new ResizeObserver(m=>{let g=m[0]?.contentRect.height;g&&a.style.setProperty("--board-headers-height",`${g+16}px`)}).observe(d);for(let m of o){if(m.option.id==="__no_value__"&&m.items.length===0)continue;let g=document.createElement("div");g.className="board-column-header";let c=this.renderColumnHeaderOnly(m.option,m.items,t);g.appendChild(c),d.appendChild(g)}a.appendChild(d),a.style.setProperty("--board-headers-height","72px");let l=this.groupItemsBySwimlane(this.allItems,r);for(let[m,g]of l){if(m==="__no_value__"&&g.items.length===0)continue;let c=document.createElement("div");c.className="board-swimlane";let b=this.renderSwimlaneHeader(g.option,g.items,r);c.appendChild(b);let v=document.createElement("div");v.className="board-swimlane-content";let L=this.groupItemsByColumn(g.items,t);for(let M of o){if(M.option.id==="__no_value__"&&M.items.length===0)continue;let E=String(M.option.id||M.option.name||""),y=L.get(E)?.items||[],x=document.createElement("div");x.className="board-column-items";let _=document.createElement("div");_.style.display="flex",_.style.flexDirection="column",_.style.gap="8px",_.style.flex="1";let C=N(M.option.color)||"#666666";for(let p of y)_.appendChild(this.renderItem(p,t,C));x.appendChild(_);let A=this.renderColumnFooterOnly(M.option,t);A.style.marginTop="8px",A.style.margin="0 -8px -8px -8px",x.appendChild(A),v.appendChild(x)}c.appendChild(v),a.appendChild(c)}}else{let d=document.createElement("div");d.className="board-swimlane-content",d.style.height="100%";for(let n of o){if(n.option.id==="__no_value__"&&n.items.length===0)continue;let l=this.renderCard(n.option,n.items,t);d.appendChild(l)}a.appendChild(d)}e.appendChild(a)}};try{R("global","boardViewFetcher.loaded")}catch{}try{console.log&&console.log("boardViewFetcher script loaded")}catch{}function oe(){return function(h,e,t){let r=h&&(h.name||h.id)?h.name||h.id:"Board View";try{U(e,r)}catch{}var s=50;function a(n,l){try{var m=n&&n.items||[],g=n&&n.fields||[],c=n&&n.allFields||g;e.innerHTML="",e.style.margin="0",e.style.padding="0",e.style.height="100%",e.style.display="flex",e.style.flexDirection="column",e.style.overflow="hidden";let y=Q(e,t,{suffix:t,step:s,onLoadMore:function(){s+=50,d()}});try{if(l&&y&&typeof y.setEffectiveFilter=="function")try{y.setEffectiveFilter(l)}catch{}}catch{}if(!y){var b=document.createElement("div");b.style.display="flex",b.style.justifyContent="space-between",b.style.alignItems="center",b.style.marginBottom="8px";var v=document.createElement("div");v.style.fontWeight="600",v.style.padding="6px",v.textContent=r;var L=document.createElement("div"),M=j(()=>{s+=50,d()});L.appendChild(M),b.appendChild(v),b.appendChild(L),e.appendChild(b)}let x=null;try{let p=n&&n.details,f=p&&p.verticalGroupByFields&&p.verticalGroupByFields.nodes;if(f&&f.length>0){let S=f[0];if(x=c.find(I=>String(I.id)===String(S.id)||String(I.name)===String(S.name)),x){let I=String(x.dataType||"").toLowerCase();I!=="single_select"&&I!=="iteration"&&(R(t,"boardViewFetcher.invalidColumnFieldType",{dataType:I,fieldName:x.name}),x=null)}}}catch(p){R(t,"boardViewFetcher.columnFieldDetection.error",{message:String(p?.message||p)})}x||(x=c.find(p=>String(p.dataType||"").toLowerCase()==="single_select"&&String(p.name||"").toLowerCase()==="status")),x||(x=c.find(p=>String(p.dataType||"").toLowerCase()==="single_select"));let _=null;try{let p=n&&n.details,f=p&&p.groupByFields&&p.groupByFields.nodes;if(f&&f.length>0){let S=f[0];_=c.find(I=>String(I.id)===String(S.id)||String(I.name)===String(S.name))}}catch(p){R(t,"boardViewFetcher.swimlaneFieldDetection.error",{message:String(p?.message||p)})}var E=document.createElement("div");E.style.flex="1 1 auto",E.style.overflow="hidden",E.style.position="relative",E.style.display="flex",E.style.flexDirection="column";let C=p=>{if(y&&y.inputEl){let f=String(y.inputEl.value||"").trim(),S=f?`${f} ${p}`:p;y.inputEl.value=S,y.inputEl.dispatchEvent(new Event("input",{bubbles:!0}))}},A=(p,f,S)=>{if(p==="open-menu"&&S){document.querySelectorAll(".board-context-menu").forEach(P=>P.remove());let k=document.createElement("div");k.className="board-context-menu",k.style.position="fixed";let $=Math.min(S.x,window.innerWidth-180),te=Math.min(S.y,window.innerHeight-150);k.style.left=$+"px",k.style.top=te+"px",k.style.background="var(--vscode-menu-background)",k.style.color="var(--vscode-menu-foreground)",k.style.border="1px solid var(--vscode-menu-border)",k.style.borderRadius="4px",k.style.zIndex="1000",k.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)",k.style.minWidth="160px",k.style.padding="4px 0";let q=(P,F,B,G=!1)=>{if(G){let T=document.createElement("div");T.style.height="1px",T.style.background="var(--vscode-menu-separatorBackground)",T.style.margin="4px 0",k.appendChild(T);return}let w=document.createElement("div");w.style.padding="4px 8px",w.style.cursor="pointer",w.style.display="flex",w.style.alignItems="center",w.style.gap="8px",w.style.fontSize="13px";let H=document.createElement("span");F&&(H.className="codicon codicon-"+F,F==="link-external"?H.textContent="\u2197":F==="globe"?H.textContent="\u{1F310}":F==="arrow-both"&&(H.textContent="\u21C4"));let V=document.createElement("span");V.textContent=P,w.appendChild(H),w.appendChild(V),w.addEventListener("click",T=>{T.stopPropagation(),k.remove(),B()}),w.addEventListener("mouseenter",()=>w.style.background="var(--vscode-menu-selectionBackground)"),w.addEventListener("mouseleave",()=>w.style.background="transparent"),k.appendChild(w)};q("Open issue","link-external",()=>{let P=f.content?.url||f.url||f.raw&&f.raw.itemContent&&f.raw.itemContent.url;P&&window.__APP_MESSAGING__&&window.__APP_MESSAGING__.postMessage({command:"openUrl",url:P})}),q("","",()=>{},!0),q("Move to column...","arrow-both",()=>{if(window.__APP_MESSAGING__){let P=[];if(x){let F=x.options||x.configuration&&x.configuration.options,B=x.configuration&&x.configuration.iterations,G=(w,H)=>{try{let V=new Date(w),T=new Date(V.getTime()+Number(H)*24*60*60*1e3),K=ne=>ne.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${K(V)} \u2014 ${K(T)}`}catch{return""}};F&&Array.isArray(F)?P=F.map(w=>({id:w.id,name:w.name,color:w.color,description:w.description})):B&&Array.isArray(B)&&(P=B.map(w=>({id:w.id,name:w.title,color:w.color,description:G(w.startDate,w.duration)})))}window.__APP_MESSAGING__.postMessage({command:"moveItem",viewKey:t,itemId:f.id,projectId:n&&n.id,fieldId:x?x.id:null,options:P,currentValue:""})}}),document.body.appendChild(k);let J=()=>{k.remove(),document.removeEventListener("click",J)};setTimeout(()=>document.addEventListener("click",J),0)}else p==="add-item-to-column"&&f&&S&&Promise.resolve().then(()=>(ee(),Z)).then(({AddItemMenu:I})=>{new I({anchorElement:S.anchorElement,onCreateIssue:()=>{try{let $=window.__APP_MESSAGING__;$&&typeof $.postMessage=="function"&&$.postMessage({command:"addItem:createIssue",viewKey:t,projectId:n&&n.id,columnFieldId:f.columnFieldId,columnValueId:f.columnValueId,columnValueName:f.columnValueName})}catch($){console.error("[boardViewFetcher] create-issue action failed",$)}},onAddFromRepo:()=>{try{let $=window.__APP_MESSAGING__;$&&typeof $.postMessage=="function"&&$.postMessage({command:"addItem:addFromRepo",viewKey:t,projectId:n&&n.id,columnFieldId:f.columnFieldId,columnValueId:f.columnValueId,columnValueName:f.columnValueName})}catch($){console.error("[boardViewFetcher] add-from-repo action failed",$)}}}).show()}).catch(I=>{console.error("Failed to load AddItemMenu",I)})};if(x)try{let p=g.map(S=>String(S.id));new W(c,m,p,C,A).renderBoard(E,x,_)}catch(p){R(t,"boardViewFetcher.cardRenderer.error",{message:String(p?.message||p)}),i(E,m)}else R(t,"boardViewFetcher.noColumnField",{fieldsCount:c.length}),i(E,m);e.appendChild(E);try{y&&typeof y.setCount=="function"&&y.setCount(m.length),y&&typeof y.setLoadState=="function"&&y.setLoadState(m.length<s,m.length>=s?"Load more":"All loaded"),y&&y.inputEl&&(typeof y.registerItems=="function"&&y.registerItems(m,{fields:g}),typeof y.onFilterChange=="function"&&y.onFilterChange(function(p,f){X(e,"[data-gh-item-id]",p,"block"),y&&typeof y.setCount=="function"&&y.setCount(p.size),R(t,"filterInput",{filter:f,matched:p.size,original:m.length})}))}catch{}}catch(y){R(t,"boardViewFetcher.render.error",{message:String(y&&y.message),stack:y&&y.stack}),z(e,r,"Error rendering board view: "+String(y&&y.message))}}function i(n,l){for(var m=0;m<l.length;m++){var g=l[m],c=document.createElement("div");try{c.setAttribute("data-gh-item-id",String(g&&g.id))}catch{}c.style.padding="8px",c.style.border="1px solid var(--vscode-editorWidget-border)",c.style.marginBottom="8px",c.style.borderRadius="2px";var b=g&&g.content&&(g.content.title||g.content.name)||g&&g.title||g&&g.raw&&g.raw.title||"#"+(m+1);c.innerHTML='<div style="font-weight:600">'+u(b)+"</div>"+(g&&g.id?'<div style="color:var(--vscode-descriptionForeground);font-size:12px">'+u(String(g.id))+"</div>":""),n.appendChild(c)}}function o(n){var l=n&&n.data?n.data:n;try{if(l&&l.command==="fields"){if(l.viewKey&&t&&String(l.viewKey)!==String(t))return;l.error?z(e,r,String(l.error)):a(l.payload||l.payload&&l.payload.data||l.payload,l.effectiveFilter)}}catch{}}function d(){try{window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"requestFields",first:s,viewKey:t})}catch{}}try{window.__APP_MESSAGING__.onMessage(o)}catch{window.addEventListener("message",o)}d()}}try{window.boardViewFetcher=oe()}catch{}})();
//# sourceMappingURL=boardViewFetcher.js.map
