"use strict";(()=>{var ge=Object.defineProperty;var fe=(c,e)=>()=>(c&&(e=c(c=0)),e);var ye=(c,e)=>{for(var t in e)ge(c,t,{get:e[t],enumerable:!0})};var ce={};ye(ce,{AddItemMenu:()=>Z});var Z,ue=fe(()=>{"use strict";Z=class{constructor(e){this.menuElement=null;this.backdropElement=null;this.options=e}show(){this.hide(),this.backdropElement=document.createElement("div"),this.backdropElement.style.position="fixed",this.backdropElement.style.top="0",this.backdropElement.style.left="0",this.backdropElement.style.right="0",this.backdropElement.style.bottom="0",this.backdropElement.style.zIndex="998",this.backdropElement.addEventListener("click",()=>this.hide()),document.body.appendChild(this.backdropElement),this.menuElement=document.createElement("div"),this.menuElement.className="add-item-menu",this.menuElement.style.position="absolute",this.menuElement.style.background="var(--vscode-menu-background)",this.menuElement.style.border="1px solid var(--vscode-menu-border)",this.menuElement.style.borderRadius="4px",this.menuElement.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)",this.menuElement.style.minWidth="220px",this.menuElement.style.padding="4px 0",this.menuElement.style.zIndex="1000",this.menuElement.style.fontSize="13px",document.body.appendChild(this.menuElement),this.buildMenu();let e=this.options.anchorElement.getBoundingClientRect(),t=this.menuElement.getBoundingClientRect(),n=8,r=window.innerWidth||document.documentElement.clientWidth,o=window.innerHeight||document.documentElement.clientHeight,i=e.bottom+n;e.bottom+t.height+n>o&&(e.top-t.height-n>=0?i=e.top-t.height-n:i=Math.max(n,Math.min(o-t.height-n,e.bottom+n)));let a=e.left;e.left+t.width+n>r&&(a=Math.max(n,e.right-t.width)),a=Math.max(n,Math.min(a,r-t.width-n)),this.menuElement.style.top=`${Math.round(i)}px`,this.menuElement.style.left=`${Math.round(a)}px`}hide(){this.menuElement&&(this.menuElement.remove(),this.menuElement=null),this.backdropElement&&(this.backdropElement.remove(),this.backdropElement=null)}buildMenu(){if(!this.menuElement)return;let e=(t,n,r,o)=>{let i=document.createElement("div");i.className="add-item-menu-item",i.style.display="flex",i.style.alignItems="center",i.style.padding="6px 12px",i.style.cursor="pointer",i.style.color="var(--vscode-menu-foreground)";let a=document.createElement("span");a.style.display="inline-flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.marginRight="8px",a.innerHTML=window.getIconSvg?.(t)||"",i.appendChild(a);let d=document.createElement("div");d.style.display="flex",d.style.flexDirection="column",d.style.flex="1";let s=document.createElement("div");if(s.textContent=n,s.style.fontWeight="500",d.appendChild(s),r){let l=document.createElement("div");l.textContent=r,l.style.fontSize="11px",l.style.color="var(--vscode-descriptionForeground)",d.appendChild(l)}i.appendChild(d),i.addEventListener("mouseenter",()=>{i.style.background="var(--vscode-menu-selectionBackground)",i.style.color="var(--vscode-menu-selectionForeground)"}),i.addEventListener("mouseleave",()=>{i.style.background="transparent",i.style.color="var(--vscode-menu-foreground)"}),i.addEventListener("click",()=>{o(),this.hide()}),this.menuElement.appendChild(i)};e("issue-opened","Create new issue","Create a project issue in a repository.",this.options.onCreateIssue),e("repo","Add item from repository","Attach an existing issue or pull request from a repo.",this.options.onAddFromRepo)}}});function m(c){return c?String(c).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function F(c){if(!c)return null;let e=String(c).trim();if(/^#?[0-9a-f]{3}$/i.test(e)||/^#?[0-9a-f]{6}$/i.test(e)||/^#?[0-9a-f]{8}$/i.test(e)){let r=e[0]==="#"?e.slice(1):e;return"#"+(r.length===8?r.substring(0,6):r)}let t={GRAY:"#848d97",RED:"#f85149",ORANGE:"#db6d28",YELLOW:"#d29922",GREEN:"#3fb950",BLUE:"#2f81f7",PURPLE:"#a371f7",PINK:"#db61a2",BLACK:"#000000",WHITE:"#ffffff"},n=e.toUpperCase();return t[n]||null}function O(c,e){if(!c)return null;let t=c.replace("#",""),n=r=>parseInt(r,16);if(t.length===3){let r=n(t[0]+t[0]),o=n(t[1]+t[1]),i=n(t[2]+t[2]);return"rgba("+r+","+o+","+i+","+e+")"}if(t.length===6||t.length===8){let r=t.length===8?t.substring(0,6):t,o=n(t.substring(0,2)),i=n(r.substring(2,4)),a=n(r.substring(4,6));return"rgba("+o+","+i+","+a+","+e+")"}return null}function J(c){if(!c)return"#333333";let e=c.replace("#",""),t=i=>parseInt(i,16),n,r,o;if(e.length===3)n=t(e[0]+e[0]),r=t(e[1]+e[1]),o=t(e[2]+e[2]);else if(e.length===6||e.length===8){let i=e.length===8?e.substring(0,6):e;n=t(i.substring(0,2)),r=t(i.substring(2,4)),o=t(i.substring(4,6))}else return"#333333";return .2126*(n/255)+.7152*(r/255)+.0722*(o/255)>.6?"#111111":"#ffffff"}function D(c,e,t){try{window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"debugLog",level:"debug",viewKey:c,message:e,data:t})}catch{}try{console&&console.log&&console.log(e,t)}catch{}}function Q(c,e){c.innerHTML='<div class="title">'+e+'</div><div class="loading"><em>Loading...</em></div>'}function G(c,e,t){c.innerHTML='<div class="title">'+e+'</div><div style="color:var(--vscode-editor-foreground)">'+t+"</div>"}function X(c){let e=document.createElement("button");return e.type="button",e.textContent="Load more",e.style.marginLeft="8px",e.style.border="1px solid var(--vscode-editorWidget-border)",e.addEventListener("click",()=>{c(),e.disabled=!0,e.textContent="Loading..."}),e}function te(c,e,t){if(window.filterBarHelper&&typeof window.filterBarHelper.create=="function")try{return window.filterBarHelper.create({parent:c,suffix:t.suffix||e,effFilter:typeof t.effFilter=="string"?t.effFilter:void 0,viewKey:e,step:t.step||50,onLoadMore:t.onLoadMore,onSave:t.onSave,onDiscard:t.onDiscard})}catch{return null}return null}function ne(c,e,t,n="block"){try{let r=Array.from(c.querySelectorAll(e));for(let o=0;o<r.length;o++)try{let i=r[o],a=i.getAttribute("data-gh-item-id");i.style.display=t.has(String(a))?n:"none"}catch{}}catch{}}var j=class{constructor(e,t,n,r,o){this.fields=e;this.allItems=t;this.visibleFieldIds=n;this.onFilter=r;this.onAction=o;this.handlePillClick=this.handlePillClick.bind(this)}handlePillClick(e,t,n){if(e.stopPropagation(),e.preventDefault(),this.onFilter){let r=n.includes(" ")?`"${n.replace(/"/g,'\\"')}"`:n,o=t.includes(" ")?`"${t.replace(/"/g,'\\"')}"`:t;this.onFilter(`${o}:${r}`)}}getIconSvg(e,t=14,n){return window.getIconSvg?window.getIconSvg(e,{size:t,fill:n}):""}getEstimateField(){return this.fields.find(e=>e.dataType&&String(e.dataType).toLowerCase()==="number"&&String(e.name||"").toLowerCase().includes("estimate"))||this.fields.find(e=>e.dataType&&String(e.dataType).toLowerCase()==="number")}sumEstimate(e){let t=this.getEstimateField();if(!t)return 0;let n=0;for(let r of e){if(!r||!Array.isArray(r.fieldValues))continue;let o=r.fieldValues.find(i=>i.fieldId&&String(i.fieldId)===String(t.id)||i.fieldName&&String(i.fieldName).toLowerCase().includes("estimate")||i.type==="number");if(o){let i=Number(o.number!=null?o.number:o.value!=null?o.value:NaN);isNaN(i)||(n+=i)}}return n}formatEstimate(e){return isFinite(e)?String(e):""}groupItemsByColumn(e,t){let n=new Map,r=String(t.dataType||"").toLowerCase(),o=[];r==="single_select"&&Array.isArray(t.options)?o=t.options:r==="iteration"&&t.configuration?.iterations&&(o=t.configuration.iterations.map(i=>({id:i.id,name:i.title,title:i.title,color:i.color||null,startDate:i.startDate,duration:i.duration})));for(let i of o){let a=String(i.id||i.name||"");a&&n.set(a,{option:i,items:[]})}n.set("__no_value__",{option:{id:"__no_value__",name:`No ${t.name}`,color:null},items:[]});for(let i of e){if(!i||!Array.isArray(i.fieldValues)){n.get("__no_value__").items.push(i);continue}let a=i.fieldValues.find(s=>String(s.fieldId)===String(t.id)||String(s.fieldName).toLowerCase()===String(t.name).toLowerCase()),d="__no_value__";if(a){if(r==="single_select"){let s=a.optionId||a.option&&a.option.id,l=a.name||a.option&&a.option.name;if(s&&n.has(String(s)))d=String(s);else if(l){for(let[p,g]of n)if(String(g.option.name).toLowerCase()===String(l).toLowerCase()){d=p;break}}}else if(r==="iteration"){let s=a.iterationId||a.iteration&&a.iteration.id||a.id,l=a.title||a.iteration&&a.iteration.title;if(s&&n.has(String(s)))d=String(s);else if(l){for(let[p,g]of n)if(String(g.option.title).toLowerCase()===String(l).toLowerCase()||String(g.option.name).toLowerCase()===String(l).toLowerCase()){d=p;break}}}}n.has(d)?n.get(d).items.push(i):n.get("__no_value__").items.push(i)}return n}getIterationRange(e){let t=e.startDate||e.start,n=e.duration||e.length;if(!t||!n)return null;try{let r=new Date(t),o=new Date(r.getTime()+Number(n)*24*60*60*1e3),i=a=>a.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${i(r)} \u2014 ${i(o)}`}catch{return null}}renderCard(e,t,n){let r=document.createElement("div");r.className="board-card",r.setAttribute("data-column-id",String(e.id||e.name||"")),r.style.width="350px",r.style.minWidth="350px",r.style.maxWidth="350px",r.style.background="var(--vscode-editorWidget-background)",r.style.border="1px solid var(--vscode-editorWidget-border)",r.style.borderRadius="0",r.style.display="flex",r.style.flexDirection="column",r.style.flexShrink="0";let o=this.renderColumnHeaderOnly(e,t,n);o.style.borderBottom="1px solid var(--vscode-editorWidget-border)",r.appendChild(o);let i=document.createElement("div");i.className="board-card-items",i.style.padding="8px",i.style.overflowY="auto",i.style.flex="1",i.style.minHeight="0";let a=F(e.color)||"#666666";for(let s of t){let l=this.renderItem(s,n,a);i.appendChild(l)}r.appendChild(i);let d=this.renderColumnFooterOnly(e,n);return r.appendChild(d),r}renderColumnHeaderOnly(e,t,n){let r=String(n.dataType||"").toLowerCase(),o=document.createElement("div");o.className="board-card-header",o.style.padding="12px",o.style.background="var(--vscode-sideBar-background)",o.style.flexShrink="0";let i=document.createElement("div");i.className="board-card-header-row",i.style.display="flex",i.style.alignItems="center",i.style.gap="8px";let a=document.createElement("span");a.className="board-card-color-dot",a.style.width="12px",a.style.height="12px",a.style.borderRadius="50%",a.style.flexShrink="0";let d=F(e.color)||"#666666";a.style.backgroundColor=d,i.appendChild(a);let s=document.createElement("span");s.className="board-card-title",s.style.fontWeight="600",s.style.flex="1",s.style.overflow="hidden",s.style.textOverflow="ellipsis",s.style.whiteSpace="nowrap",s.textContent=e.name||e.title||"Unnamed",i.appendChild(s);let l=document.createElement("span");l.className="board-card-count",l.style.fontSize="12px",l.style.color="var(--vscode-descriptionForeground)",l.style.fontVariantNumeric="tabular-nums",l.textContent=String(t.length),i.appendChild(l);let p=this.sumEstimate(t);if(p>0){let u=document.createElement("span");u.className="board-card-estimate",u.style.display="inline-block",u.style.padding="2px 8px",u.style.borderRadius="999px",u.style.background="var(--vscode-input-background)",u.style.border="1px solid var(--vscode-panel-border)",u.style.fontSize="12px",u.style.lineHeight="18px",u.textContent=this.formatEstimate(p),i.appendChild(u)}o.appendChild(i);let g=null;if(r==="single_select"&&e.description?g=String(e.description).slice(0,120):r==="iteration"&&(g=this.getIterationRange(e)),g){let u=document.createElement("div");u.className="board-card-description",u.style.fontSize="12px",u.style.color="var(--vscode-descriptionForeground)",u.style.marginTop="4px",u.style.overflow="hidden",u.style.textOverflow="ellipsis",u.style.whiteSpace="nowrap",u.textContent=g,o.appendChild(u)}return o}renderColumnFooterOnly(e,t){let n=document.createElement("div");n.className="board-card-footer",n.style.padding="8px 12px",n.style.borderTop="1px solid var(--vscode-editorWidget-border)",n.style.cursor="pointer",n.style.userSelect="none",n.style.flexShrink="0",n.style.transition="background-color 0.15s ease",n.setAttribute("data-column-field-id",String(t.id||"")),n.setAttribute("data-column-value-id",String(e.id||"")),n.setAttribute("data-column-value-name",String(e.name||e.title||""));let r=document.createElement("span");return r.textContent="+ Add item",r.style.opacity="0.9",r.style.fontSize="13px",n.appendChild(r),n.addEventListener("mouseenter",()=>{n.style.backgroundColor="var(--vscode-list-hoverBackground)"}),n.addEventListener("mouseleave",()=>{n.style.backgroundColor="transparent"}),n.addEventListener("click",o=>{o.stopPropagation(),this.onAction&&this.onAction("add-item-to-column",{columnFieldId:t.id,columnValueId:e.id,columnValueName:e.name||e.title},{anchorElement:n})}),n}renderItem(e,t,n){let r=document.createElement("div");r.className="board-item",r.setAttribute("data-gh-item-id",String(e?.id||"")),r.style.padding="10px",r.style.border="1px solid var(--vscode-editorWidget-border)",r.style.borderRadius="0",r.style.marginBottom="8px",r.style.background="var(--vscode-editor-background)",r.style.cursor="pointer",r.style.position="relative";let o=e?.content||e?.raw&&e.raw.itemContent||null,i=e?.content&&(e.content.title||e.content.name)||e?.title||e?.raw&&e.raw.title||"Untitled",a=e?.content&&e.content.number||e?.raw&&e.raw.itemContent&&e.raw.itemContent.number||null,d=e?.content&&e.content.url||e?.raw&&e.raw.itemContent&&e.raw.itemContent.url||null,s="issue-opened",l=!1;if(o){let E=String(o.__typename||"").toLowerCase(),L=String(o.state||"").toUpperCase();l=E.includes("pullrequest");let w=L==="CLOSED",S=o.merged===!0,P=o.isDraft===!0;l?S?s="git-merge":w?s="git-pull-request-closed":P?s="git-pull-request-draft":s="git-pull-request":w?s="issue-closed":P?s="issue-draft":s="issue-opened"}let p=!1;try{let E=o&&o.issueDependenciesSummary?o.issueDependenciesSummary:null;p=(E&&typeof E.blockedBy=="number"?E.blockedBy:0)>0}catch{}let g=n,u=this.extractAssignees(e),b=document.createElement("div");b.style.display="flex",b.style.flexDirection="column",b.style.gap="6px";let v=document.createElement("div");v.style.display="flex",v.style.justifyContent="flex-start",v.style.alignItems="center";let A=this.getIconSvg(s,16,g),M=p?`<span class='blocked-overlay' style='position:absolute;right:-3px;bottom:-3px;width:14px;height:14px;border-radius:999px;background:var(--vscode-editor-background);display:flex;align-items:center;justify-content:center;box-sizing:border-box;'>${this.getIconSvg("blocked",9,"#dc3545")}</span>`:"";v.innerHTML=`<span style="position:relative;display:inline-flex;align-items:center;justify-content:center;color:${m(g)};">${A}${M}</span>`;let k=document.createElement("span");k.className="board-item-menu-btn",k.setAttribute("data-item-id",String(e?.id||"")),k.style.marginLeft="6px",k.style.color="var(--vscode-descriptionForeground)",k.innerHTML=this.getIconSvg("kebab-horizontal",14)||"<span>...</span>",v.appendChild(k),b.appendChild(v);let _=document.createElement("div");_.style.fontWeight="500",_.style.lineHeight="1.3",_.innerHTML=`${m(i)}${a?` <span style="color:var(--vscode-descriptionForeground);font-weight:400;">#${m(String(a))}</span>`:""}`,b.appendChild(_);let f=this.renderFieldValues(e,t);f&&b.appendChild(f);let h=this.renderSubIssuesProgress(e);if(h&&b.appendChild(h),r.appendChild(b),u&&u.length>0){let E=this.renderAssigneeAvatars(u);E.style.position="absolute",E.style.top="10px",E.style.right="10px",r.appendChild(E)}return d&&(r.setAttribute("data-gh-open",d),r.title=`${i}${a?` #${a}`:""}`),r}getFieldName(e){if(e.fieldName)return e.fieldName;if(e.field?.name)return e.field.name;if(e.fieldId&&this.fields){let t=this.fields.find(n=>String(n.id)===String(e.fieldId));if(t&&t.name)return t.name}return"Field"}extractAssignees(e){if(!e)return[];if(e.content?.assignees?.nodes)return e.content.assignees.nodes;if(e.content?.assignees&&Array.isArray(e.content.assignees))return e.content.assignees;if(Array.isArray(e.fieldValues)){let t=e.fieldValues.find(n=>n?.type==="assignees"||n?.assignees);if(t?.assignees)return Array.isArray(t.assignees)?t.assignees:[]}return[]}extractLinkedPullRequests(e){if(console.log("[BoardCard] extractLinkedPullRequests called with item:",e?.id,"fieldValues:",e?.fieldValues?.length),!e)return[];if(Array.isArray(e.fieldValues)){console.log("[BoardCard] Checking fieldValues, types:",e.fieldValues.map(n=>n?.type));let t=e.fieldValues.find(n=>n?.type==="linked_pull_requests"||n?.type==="pull_request");if(t){if(console.log("[BoardCard] Found PR field value:",t),Array.isArray(t.pullRequests))return console.log("[BoardCard] Returning direct array:",t.pullRequests),t.pullRequests;if(t.pullRequests?.nodes&&Array.isArray(t.pullRequests.nodes))return console.log("[BoardCard] Returning nodes array:",t.pullRequests.nodes),t.pullRequests.nodes}else console.log("[BoardCard] No PR field found in fieldValues")}if(e.content?.linkedPullRequests){if(Array.isArray(e.content.linkedPullRequests))return e.content.linkedPullRequests;if(Array.isArray(e.content.linkedPullRequests.nodes))return e.content.linkedPullRequests.nodes}return console.log("[BoardCard] Returning empty array for linkedPRs"),[]}renderAssigneeAvatars(e){let t=document.createElement("div");t.className="board-item-assignees",t.style.display="flex",t.style.alignItems="center";let n=3;if(e.slice(0,n).forEach((o,i)=>{let a=o.login||o.name||"Unknown",d=o.avatarUrl||"";if(!d)return;let s=document.createElement("img");s.src=d,s.className="board-pill",s.setAttribute("data-filter-field","Assignees"),s.setAttribute("data-filter-value",a),s.title=a,s.style.width="16px",s.style.height="16px",s.style.borderRadius="50%",s.style.border="1px solid var(--vscode-editorWidget-border)",s.style.cursor="pointer",s.style.marginLeft=i===0?"0":"-6px",s.style.zIndex=String(n-i),s.style.position="relative",t.appendChild(s)}),e.length>n){let o=document.createElement("span");o.className="board-pill",o.setAttribute("data-filter-field","Assignees"),o.style.marginLeft="-6px",o.style.width="22px",o.style.height="22px",o.style.borderRadius="50%",o.style.background="var(--vscode-badge-background)",o.style.color="var(--vscode-badge-foreground)",o.style.fontSize="10px",o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center",o.style.fontWeight="bold",o.style.lineHeight="1",o.textContent=`+${e.length-n}`,o.title="More assignees",t.appendChild(o)}return t}renderFieldValues(e,t){if(!e||!Array.isArray(e.fieldValues))return null;let n=["sub_issues_progress","assignees","title","status"],r=["sub issues progress","assignees","title"],o=t?.id,i=[],a=this.extractLinkedPullRequests(e);if(a.length>0){let s=a.map(l=>{let p=m(String(l.number||"")),g=m(l.title||""),u=m(l.url||""),b=l.state_color||l.color||l.colour||l.state||null,v=F(b)||null,A=!!(v&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(v)),M=v||"#999999",k=A&&O(v,.12)||"rgba(0,0,0,0.06)",_=J(v)||"#333333",f=!!l.isDraft,h=l.state&&String(l.state).toUpperCase()||"",E=!!l.merged,L=!E&&h==="CLOSED",w="git-pull-request";E?w="git-merge":L?w="git-pull-request-closed":f&&(w="git-pull-request-draft");let S=this.getIconSvg(w,12),P=g?m(`#${l.number} ${l.title}`):m(`#${l.number}`);return`<a href="${u}" title="${P}" data-gh-open="${u}" style="cursor:pointer;text-decoration:none;color:inherit"><span class="board-pill" style="display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;border:1px solid ${m(M)};background:${m(k)};color:${m(_)};font-size:12px;line-height:18px;overflow:hidden;box-sizing:border-box;max-width:160px"><span style="position:relative;display:inline-flex;align-items:center;justify-content:center">${S}</span><span style="flex:1 1 auto;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">#${p}</span></span></a>`}).join("");i.push(s)}for(let s of e.fieldValues){if(!s)continue;let l=String(s.type||"").toLowerCase(),p=String(s.fieldName||s.field?.name||"").toLowerCase();if(n.includes(l)||r.includes(p)||o&&String(s.fieldId)===String(o))continue;if(this.visibleFieldIds&&this.visibleFieldIds.length>0){let b=s.fieldId||s.field&&s.field.id;if(b&&!this.visibleFieldIds.includes(String(b)))continue}if(!this.hasFieldValue(s))continue;let u=this.renderFieldValue(s);u&&i.push(u)}if(i.length===0)return null;let d=document.createElement("div");return d.className="board-item-fields",d.style.display="flex",d.style.flexWrap="wrap",d.style.gap="4px",d.style.marginTop="4px",d.innerHTML=i.join(""),d}hasFieldValue(e){switch(String(e.type||"").toLowerCase()){case"single_select":return!!(e.option?.name||e.name);case"iteration":return!!(e.iteration?.title||e.title);case"labels":return Array.isArray(e.labels)&&e.labels.length>0;case"milestone":return!!e.milestone?.title;case"repository":return!!(e.repository?.nameWithOwner||e.repository?.name);case"parent_issue":return!!(e.parent||e.parentIssue);case"number":return e.number!=null&&e.number!=="";case"date":return!!(e.date||e.startDate);case"text":return!!e.text;case"pull_request":case"linked_pull_requests":return!!(e.pullRequests?.nodes?.length>0||Array.isArray(e.pullRequests)&&e.pullRequests.length>0);default:return!1}}renderFieldValue(e){switch(String(e.type||"").toLowerCase()){case"single_select":return this.renderSingleSelectPill(e);case"labels":return this.renderLabelsPills(e);case"iteration":return this.renderIterationPill(e);case"milestone":return this.renderMilestonePill(e);case"repository":return this.renderRepositoryPill(e);case"parent_issue":return this.renderParentIssuePill(e);case"number":return this.renderNumberPill(e);case"text":return this.renderTextPill(e);case"date":return this.renderDatePill(e);case"pull_request":case"linked_pull_requests":return this.renderLinkedPullRequests(e);default:return""}}renderSingleSelectPill(e){let t=e.option?.name||e.name||"";if(!t)return"";let n=e.option?.color||e.color||null,r=F(n)||null,o=!!(r&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(r)),i=r||"#999999",a=o&&O(r,.12)||"rgba(0,0,0,0.06)",d=r||"#333333",s=this.getFieldName(e);return`<span class="board-pill" data-filter-field="${m(s)}" data-filter-value="${m(t)}" style="display:inline-block;padding:2px 6px;border-radius:999px;border:1px solid ${m(i)};background:${m(a)};color:${m(d)};font-size:11px;line-height:16px;white-space:nowrap;max-width:100px;overflow:hidden;text-overflow:ellipsis;" title="${m(t)}">${m(t)}</span>`}renderLabelsPills(e){let t=e.labels||[];return!t||t.length===0?"":t.slice(0,3).map(n=>{let r=n.name||"",o=n.color||n.colour||null,i=F(o)||null,a=!!(i&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(i)),d=i||"#999999",s=a&&O(i,.12)||"rgba(0,0,0,0.06)",l=i||"#333333";return`<span class="board-pill" data-filter-field="Labels" data-filter-value="${m(r)}" style="display:inline-block;padding:2px 6px;border-radius:999px;border:1px solid ${m(d)};background:${m(s)};color:${m(l)};font-size:11px;line-height:16px;white-space:nowrap;max-width:80px;overflow:hidden;text-overflow:ellipsis;">${m(r)}</span>`}).join("")}renderIterationPill(e){let n=(e.iteration||e)?.title||"";if(!n)return"";let r=this.getIconSvg("iterations",12);return`<span class="board-pill" data-filter-field="Iteration" data-filter-value="${m(n)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;max-width:100px;overflow:hidden;text-overflow:ellipsis;" title="${m(n)}">${r}<span>${m(n)}</span></span>`}renderMilestonePill(e){let t=e.milestone?.title||"";if(!t)return"";let n=this.getIconSvg("milestone",12);return`<span class="board-pill" data-filter-field="Milestone" data-filter-value="${m(t)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;max-width:100px;overflow:hidden;text-overflow:ellipsis;" title="${m(t)}">${n}<span>${m(t)}</span></span>`}renderRepositoryPill(e){let t=e.repository||e,n=t?.nameWithOwner||t?.name||"";if(!n)return"";let r=this.getIconSvg("repo",12);return`<span class="board-pill" data-filter-field="repo" data-filter-value="${m(n)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;" title="${m(n)}">${r}<span style="max-width:100px;overflow:hidden;text-overflow:ellipsis;">${m(n)}</span></span>`}renderNumberPill(e){let t=e.number;if(t==null||t==="")return"";let n=this.getFieldName(e);return`<span class="board-pill" data-filter-field="${m(n)}" data-filter-value="${m(String(t))}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;"><span style="color:var(--vscode-descriptionForeground);">${m(n)}:</span><span>${m(String(t))}</span></span>`}renderTextPill(e){let t=e.text||"";if(!t)return"";let n=this.getFieldName(e),r=String(t).slice(0,30);return`<span class="board-pill" data-filter-field="${m(n)}" data-filter-value="${m(t)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;max-width:150px;overflow:hidden;text-overflow:ellipsis;" title="${m(t)}"><span style="color:var(--vscode-descriptionForeground);">${m(n)}:</span><span>${m(r)}</span></span>`}renderDatePill(e){let t=e.date||e.startDate||null;if(!t)return"";let n=this.getFieldName(e),r=t,o=t;try{let a=new Date(t);isNaN(a.getTime())||(r=a.toLocaleDateString("en-US",{month:"short",day:"numeric"}),o=a.toISOString().split("T")[0])}catch{}let i=this.getIconSvg("calendar",12);return`<span class="board-pill" data-filter-field="${m(n)}" data-filter-value="${m(String(o))}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;"><span style="color:var(--vscode-descriptionForeground);">${m(n)}:</span>${i}<span>${m(String(r))}</span></span>`}renderParentIssuePill(e){let t=e.parent||e.parentIssue||e.issue||null;if(!t)return"";let n=t.title||t.name||"",r=t.number||"",o=t.url||t.html_url||"";if(!n&&!r)return"";let i="#999999",a=!1,d=["done","closed","completed","finished"],s=null;if(this.allItems&&this.allItems.length>0){let h=t.id||t.raw&&t.raw.id,E=t.url||t.html_url||t.raw&&t.raw.url,L=t.number||t.raw&&t.raw.number;if(s=this.allItems.find(w=>{let S=w.content||w.raw&&w.raw.itemContent;if(!S)return!1;if(h&&String(S.id)===String(h)||E&&String(S.url)===String(E))return!0;if(L&&String(S.number)===String(L)){let P=S.repository?.nameWithOwner||S.repository?.name,y=t.repository?.nameWithOwner||t.repository?.name;return!(P&&y&&P!==y)}return!1}),s&&Array.isArray(s.fieldValues)){let w=s.fieldValues.find(S=>S&&S.type==="single_select"&&(S.raw&&S.raw.field&&String(S.raw.field.name||"").toLowerCase()==="status"||S.fieldName&&String(S.fieldName||"").toLowerCase()==="status"||S.field&&S.field.name&&String(S.field.name||"").toLowerCase()==="status"));if(w){let S=w.option&&(w.option.color||w.option.id||w.option.name)||w.raw&&w.raw.color||null;if(S&&(i=F(S)||i),w.option&&w.option.name){let P=String(w.option.name).toLowerCase();d.includes(P)&&(a=!0)}}}}i==="#999999"&&(t.statusColor?i=F(t.statusColor)||i:t.color&&(i=F(t.color)||i));let l=i,p=!!(l&&/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(l)),g=l||"#999999",u=p&&O(l,.12)||"rgba(0,0,0,0.06)",b=J(l)||"#333333",v=String(t.state||"").toUpperCase()==="CLOSED";a&&(v=!0);let A=!1;try{let h=!!(t.labels&&Array.isArray(t.labels)&&t.labels.some(L=>String(L.name||"").toLowerCase()==="blocked")),E=0;s&&s.content&&s.content.issueDependenciesSummary&&(E=s.content.issueDependenciesSummary.blockedBy||0),(h||E>0)&&(A=!0)}catch{}let M=v?"issue-closed":"issue-opened",k=this.getIconSvg(M,12,l),_=A?`<span class='blocked-overlay' style='position:absolute;right:-3px;bottom:-3px;width:14px;height:14px;border-radius:999px;background:var(--vscode-editor-background);display:flex;align-items:center;justify-content:center;box-sizing:border-box;'>${this.getIconSvg("blocked",9,"#dc3545")}</span>`:"",f=`<span class="board-pill" data-filter-field="parent" data-filter-value="${m(n)}" style="display:inline-flex;align-items:center;gap:6px;padding:3px 8px;border:1px solid ${m(g)};border-radius:999px;background:${m(u)};color:${m(b)};font-size:11px;line-height:16px;max-width:150px;" title="${m(n+(r?" #"+r:""))}"${o?` data-gh-open="${m(o)}"`:""}>`;return f+=`<span style="position:relative;display:inline-flex;align-items:center;justify-content:center;flex-shrink:0;">${k}${_}</span>`,f+=`<span style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${m(n)}</span>`,r&&(f+=`<span style="flex-shrink:0;color:var(--vscode-descriptionForeground);">#${m(String(r))}</span>`),f+="</span>",f}renderLinkedPullRequests(e){let t=e.pullRequests?.nodes||[];return!t||t.length===0?"":t.map(n=>{let r=n.title||"#"+n.number||"PR",o=this.getIconSvg("git-pull-request",12);return`<span class="board-pill" data-filter-field="Linked Pull Requests" data-filter-value="${m(r)}" style="display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;border:1px solid var(--vscode-editorWidget-border);background:var(--vscode-input-background);font-size:11px;line-height:16px;white-space:nowrap;margin-right:2px;max-width:100px;overflow:hidden;text-overflow:ellipsis;" title="${m(r)}">${o}<span>${m(r)}</span></span>`}).join("")}renderSubIssuesProgress(e){if(!e||!Array.isArray(e.fieldValues))return null;let t=e.fieldValues.find(d=>d?.type==="sub_issues_progress");if(!t||!t.total||Number(t.total)<=0)return null;let n=Math.max(0,Math.floor(Number(t.total)||0)),r=Math.max(0,Math.floor(Number(t.done||0)));if(n===0)return null;let o=Math.round(r/n*100),i=document.createElement("div");i.className="board-item-progress board-pill",i.setAttribute("data-filter-field","parent");let a=e.content&&(e.content.title||e.content.name)||e.title||e.raw&&e.raw.title||"";return i.setAttribute("data-filter-value",a),i.style.marginTop="6px",i.title=`${r} of ${n} sub-issues complete (${o}%) -- Click to filter by this parent`,i.innerHTML=`
      <div style="display:flex;align-items:center;gap:6px;width:100%;">
        <span style="font-size:11px;color:var(--vscode-descriptionForeground);font-variant-numeric:tabular-nums;min-width:30px;">${r}/${n}</span>
        <div style="flex:1;height:8px;border-radius:4px;border:1px solid var(--vscode-focusBorder);overflow:hidden;background:transparent;">
          <div style="height:100%;width:${o}%;background:var(--vscode-focusBorder);"></div>
        </div>
        <span style="font-size:11px;color:var(--vscode-descriptionForeground);font-variant-numeric:tabular-nums;min-width:28px;text-align:right;">${o}%</span>
      </div>
    `,i}groupItemsBySwimlane(e,t){let n=new Map,r=String(t.dataType||"").toLowerCase(),o=[];if(r==="single_select"&&Array.isArray(t.options))o=t.options;else if(r==="iteration"&&t.configuration?.iterations)o=t.configuration.iterations.map(i=>({id:i.id,name:i.title,title:i.title,color:i.color||null,startDate:i.startDate,duration:i.duration}));else if(r==="assignees"){let i=new Map;for(let a of e){let d=this.extractAssignees(a);for(let s of d)i.has(s.login)||i.set(s.login,s)}o=Array.from(i.values()).map(a=>({id:a.login,name:a.login,avatarUrl:a.avatarUrl,type:"assignee"}))}else if(r==="repository"){let i=new Map;for(let a of e){let d=a.content?.repository||a.raw?.itemContent?.repository||a.repository;if(d&&(d.nameWithOwner||d.name)){let s=d.nameWithOwner||d.name;i.has(s)||i.set(s,d)}}o=Array.from(i.values()).map(a=>({id:a.nameWithOwner||a.name,name:a.nameWithOwner||a.name,type:"repository"}))}else if(r==="milestone"){let i=new Map;for(let a of e){let d=a.fieldValues?.find(s=>s.type==="milestone");d?.milestone&&(i.has(d.milestone.id||d.milestone.title)||i.set(d.milestone.id||d.milestone.title,d.milestone))}o=Array.from(i.values()).map(a=>({id:a.id||a.title,name:a.title,type:"milestone"}))}else if(r==="labels"){let i=new Map;for(let a of e){let d=a.fieldValues?.find(s=>s.type==="labels");if(d?.labels?.nodes)for(let s of d.labels.nodes)i.has(s.id||s.name)||i.set(s.id||s.name,s)}o=Array.from(i.values()).map(a=>({id:a.id||a.name,name:a.name,color:a.color,type:"label"}))}for(let i of o){let a=String(i.id||i.name||"");a&&n.set(a,{option:i,items:[]})}n.set("__no_value__",{option:{id:"__no_value__",name:`No ${t.name}`,color:null},items:[]});for(let i of e){let a="__no_value__";if(r==="assignees"){let s=this.extractAssignees(i);if(s.length>0){for(let l of s){let p=l.login;n.has(p)&&n.get(p).items.push(i)}continue}}else if(r==="labels"){let s=i.fieldValues?.find(l=>l.type==="labels");if(s?.labels?.nodes&&s.labels.nodes.length>0){for(let l of s.labels.nodes){let p=String(l.id||l.name);n.has(p)&&n.get(p).items.push(i)}continue}}else if(r==="repository"){let s=i.content?.repository||i.raw?.itemContent?.repository||i.repository;s&&(a=s.nameWithOwner||s.name||"__no_value__")}else if(r==="parent_issue"){let s=i.fieldValues?.find(p=>p.type==="parent_issue"||String(p.fieldName).toLowerCase()==="parent"),l=s?.parent||s?.parentIssue||s?.issue||s?.item||s?.value;l&&(a=String(l.number||l.id||l.title||"__no_value__"))}else if(Array.isArray(i.fieldValues)){let s=i.fieldValues.find(l=>String(l.fieldId)===String(t.id)||String(l.fieldName).toLowerCase()===String(t.name).toLowerCase());if(s)if(r==="single_select"){let l=s.optionId||s.option&&s.option.id,p=s.name||s.option&&s.option.name;if(l&&n.has(String(l)))a=String(l);else if(p){for(let[g,u]of n)if(String(u.option.name).toLowerCase()===String(p).toLowerCase()){a=g;break}}}else if(r==="iteration"){let l=s.iterationId||s.iteration&&s.iteration.id||s.id,p=s.title||s.iteration&&s.iteration.title;if(l&&n.has(String(l)))a=String(l);else if(p){for(let[g,u]of n)if(String(u.option.title).toLowerCase()===String(p).toLowerCase()||String(u.option.name).toLowerCase()===String(p).toLowerCase()){a=g;break}}}else{let l=s.text??s.number??s.date??s.title??s.value;l!=null&&l!==""&&(a=String(l))}}let d=n.has(a)?a:"__no_value__";a!=="__no_value__"&&!n.has(a)&&n.set(a,{option:{id:a,name:a,title:a},items:[]}),n.get(n.has(a)?a:"__no_value__").items.push(i)}return n}renderSwimlaneHeader(e,t,n){let r=document.createElement("div");r.className="board-swimlane-header",r.style.position="sticky",r.style.top="var(--board-headers-height, 72px)",r.style.zIndex="20",r.style.cursor="pointer",r.style.userSelect="none",r.style.background="var(--vscode-editor-background)";let o=document.createElement("div");o.style.display="flex",o.style.alignItems="center",o.style.gap="8px",o.style.padding="8px 16px",o.style.position="sticky",o.style.left="0",o.style.width="max-content",o.style.background="inherit";let i=document.createElement("span");if(i.className="swimlane-toggle-icon",i.innerHTML=this.getIconSvg("triangle-down",16),i.style.opacity="0.7",o.appendChild(i),e.avatarUrl){let l=document.createElement("img");l.src=e.avatarUrl,l.style.width="20px",l.style.height="20px",l.style.borderRadius="50%",o.appendChild(l)}else if(e.type==="repository"){let l=document.createElement("span");l.innerHTML=this.getIconSvg("repo",16),o.appendChild(l)}else{let l=document.createElement("div");l.style.width="12px",l.style.height="12px",l.style.borderRadius="50%",l.style.backgroundColor=F(e.color)||"gray",o.appendChild(l)}let a=document.createElement("span");a.style.fontWeight="600",a.style.fontSize="13px",a.textContent=e.name||e.title||"Unassigned",o.appendChild(a);let d=document.createElement("span");d.style.display="inline-flex",d.style.alignItems="center",d.style.justifyContent="center",d.style.minWidth="22px",d.style.height="22px",d.style.borderRadius="50%",d.style.background="var(--vscode-input-background)",d.style.border="1px solid var(--vscode-panel-border)",d.style.fontSize="12px",d.style.padding="0 4px",d.textContent=String(t.length),o.appendChild(d);let s=this.sumEstimate(t);if(s>0){let l=document.createElement("div");l.style.padding="2px 8px",l.style.borderRadius="999px",l.style.border="1px solid var(--vscode-panel-border)",l.style.background="var(--vscode-input-background)",l.style.fontSize="11px",l.textContent="Estimate: "+this.formatEstimate(s),o.appendChild(l)}if(String(n.dataType||"").toLowerCase()==="iteration"){let l=this.getIterationRange(e);if(l){let p=document.createElement("span");p.style.color="var(--vscode-descriptionForeground)",p.style.fontSize="12px",p.style.fontWeight="400",p.textContent=l,o.appendChild(p)}}return r.appendChild(o),r}renderBoard(e,t,n){let r=document.createElement("style");r.textContent=`
            * { box-sizing: border-box; }
            .board-item-menu-btn { opacity: 0; transition: opacity 0.2s; cursor: pointer; padding: 2px; border-radius: 4px; }
            .board-item-menu-btn:hover { background: var(--vscode-toolbar-hoverBackground); }
            .board-item:hover .board-item-menu-btn { opacity: 1; }
            .board-pill { cursor: pointer; transition: opacity 0.2s; }
            .board-pill:hover { opacity: 0.8; }
            .board-swimlane { display: flex; flex-direction: column; }
            .board-swimlane-content { display: flex; gap: 16px; padding: 0 16px 16px 16px; align-items: stretch; }
            .board-container { display: flex; flex-direction: column; overflow: auto; height: 100%; width: 100%; }
            .board-column-headers { 
              display: flex; 
              gap: 16px; 
              padding: 16px 16px 0 16px; 
              position: sticky; 
              top: 0; 
              z-index: 30; 
              background: var(--vscode-editor-background); 
              align-items: stretch;
              border-bottom: 1px solid var(--vscode-panel-border);
            }
            .board-column-header { 
              width: 350px; 
              min-width: 350px; 
              flex-shrink: 0; 
              background: var(--vscode-sideBar-background);
              border: 1px solid var(--vscode-editorWidget-border);
              display: flex;
              flex-direction: column;
            }
            .board-column-items { 
              width: 350px; 
              min-width: 350px; 
              flex-shrink: 0; 
              display: flex; 
              flex-direction: column; 
              gap: 8px; 
              background: var(--vscode-editorWidget-background); 
              border: 1px solid var(--vscode-editorWidget-border); 
              padding: 8px; 
            }
            .board-swimlane-header {
              border-bottom: 1px solid var(--vscode-panel-border);
              background: var(--vscode-editor-background);
              position: sticky;
              z-index: 20;
              margin: 0;
            }
        `,e.appendChild(r);let o=document.createElement("div");o.className="board-container",o.style.background="var(--vscode-editor-background)",o.addEventListener("click",d=>{let s=d.target,l=s.closest(".board-swimlane-header");if(l){let b=l.parentElement.querySelector(".board-swimlane-content"),v=l.querySelector(".swimlane-toggle-icon"),A=b.style.display==="none";b.style.display=A?"flex":"none",v.innerHTML=this.getIconSvg(A?"triangle-down":"triangle-right",16);return}let p=s.closest("[data-filter-field]");if(p){let u=p.getAttribute("data-filter-field"),b=p.getAttribute("data-filter-value");if(u&&b){this.handlePillClick(d,u,b);return}}let g=s.closest(".board-item-menu-btn");if(g){d.stopPropagation(),d.preventDefault();let u=g.getAttribute("data-item-id");if(this.onAction&&u){let b=this.allItems.find(A=>String(A.id)===String(u))||{id:u},v=g.getBoundingClientRect();this.onAction("open-menu",b,{x:v.left,y:v.bottom})}return}});let i=this.groupItemsByColumn(this.allItems,t),a=Array.from(i.values());if(n){let d=document.createElement("div");d.className="board-column-headers js-board-headers",new ResizeObserver(p=>{let g=p[0]?.contentRect.height;g&&o.style.setProperty("--board-headers-height",`${g+16}px`)}).observe(d);for(let p of a){if(p.option.id==="__no_value__"&&p.items.length===0)continue;let g=document.createElement("div");g.className="board-column-header";let u=this.renderColumnHeaderOnly(p.option,p.items,t);g.appendChild(u),d.appendChild(g)}o.appendChild(d),o.style.setProperty("--board-headers-height","72px");let l=this.groupItemsBySwimlane(this.allItems,n);for(let[p,g]of l){if(p==="__no_value__"&&g.items.length===0)continue;let u=document.createElement("div");u.className="board-swimlane";let b=this.renderSwimlaneHeader(g.option,g.items,n);u.appendChild(b);let v=document.createElement("div");v.className="board-swimlane-content";let A=this.groupItemsByColumn(g.items,t);for(let M of a){if(M.option.id==="__no_value__"&&M.items.length===0)continue;let k=String(M.option.id||M.option.name||""),_=A.get(k)?.items||[],f=document.createElement("div");f.className="board-column-items";let h=document.createElement("div");h.style.display="flex",h.style.flexDirection="column",h.style.gap="8px",h.style.flex="1";let E=F(M.option.color)||"#666666";for(let w of _)h.appendChild(this.renderItem(w,t,E));f.appendChild(h);let L=this.renderColumnFooterOnly(M.option,t);L.style.marginTop="8px",L.style.margin="0 -8px -8px -8px",f.appendChild(L),v.appendChild(f)}u.appendChild(v),o.appendChild(u)}}else{let d=document.createElement("div");d.className="board-swimlane-content",d.style.height="100%";for(let s of a){if(s.option.id==="__no_value__"&&s.items.length===0)continue;let l=this.renderCard(s.option,s.items,t);d.appendChild(l)}o.appendChild(d)}e.appendChild(o)}};function ae(c){if(!c||!c.nodes||c.nodes.length===0)return null;let e=c.nodes[0];if(!e||!e.field)return null;let t={fieldId:e.field.id||e.field.name,direction:e.direction||"ASC"};if(c.nodes.length>1){let n=c.nodes[1];n&&n.field&&(t.secondary={fieldId:n.field.id||n.field.name,direction:n.direction||"ASC"})}return t}function le(c,e,t){if(!t||c.length===0)return c;let n=e.find(o=>o.id===t.fieldId||o.name===t.fieldId);if(!n)return c;let r=[...c];return r.sort((o,i)=>{let a=re(o,i,n,t.direction);if(a===0&&t.secondary){let d=e.find(s=>s.id===t.secondary.fieldId||s.name===t.secondary.fieldId);if(d)return re(o,i,d,t.secondary.direction)}return a}),r}function re(c,e,t,n){let r=ie(c,t),o=ie(e,t);if(r===null&&o===null)return 0;if(r===null)return n==="ASC"?1:-1;if(o===null)return n==="ASC"?-1:1;let i=0;switch((t.dataType||"").toLowerCase()){case"text":case"title":i=W(r,o);break;case"number":i=oe(r,o);break;case"date":i=de(r,o);break;case"single_select":i=he(r,o,t);break;case"iteration":i=be(r,o);break;case"labels":i=xe(r,o);break;case"assignees":case"repository":case"milestone":case"issue_type":case"parent_issue":case"tracked_by":case"tracks":case"reviewers":i=W(r,o);break;case"linked_pull_requests":case"sub_issues_progress":i=oe(r,o);break;default:i=0}return n==="ASC"?i:-i}function ie(c,e){let t=c.fieldValues?.find(r=>r.fieldId===e.id||r.fieldName===e.name);if(!t)return null;switch((e.dataType||"").toLowerCase()){case"text":return t.text!=null?t.text:se(t,c);case"title":return se(t,c);case"number":return t.number!==void 0?t.number:null;case"date":return t.date||t.startDate||t.dueOn||null;case"single_select":return t.option||t;case"iteration":return t;case"labels":return t.labels||[];case"assignees":{let r=t.assignees;if(Array.isArray(r)&&r.length>0){let o=r[0];return o.login||o.name||null}return null}case"repository":{let r=t.repository;return r&&(r.nameWithOwner||r.name||r.full_name||r.id)||null}case"milestone":{let r=t.milestone;return r&&(r.dueOn||r.title||r.name)||null}case"issue_type":return t.text?t.text:t.option&&(t.option.name||t.option.title)||null;case"parent_issue":{let r=t.parent;return r?r.title?r.title:typeof r.number=="number"?String(r.number):r.id||null:null}case"linked_pull_requests":{let r=t.pullRequests;if(Array.isArray(r)&&r.length>0){let o=r[0];return typeof o.number=="number"?o.number:o.title||null}return null}case"reviewers":{let r=t.reviewers;if(Array.isArray(r)&&r.length>0){let o=r[0];return o.login||o.name||o.id||null}return null}case"sub_issues_progress":return typeof t.percent=="number"?t.percent:typeof t.done=="number"&&typeof t.total=="number"&&t.total>0?t.done/t.total*100:null;case"tracked_by":case"tracks":{let r=t.issues;if(Array.isArray(r)&&r.length>0){let o=r[0];return o.title?o.title:typeof o.number=="number"?String(o.number):o.id||null}return null}default:return t}}function se(c,e){if(!c)return null;let t=c.title&&c.title.raw||c.raw||null;if(t&&typeof t.text=="string"&&t.text.trim())return t.text;let n=c.title&&c.title.content||c.content||t&&t.itemContent||e&&e.content||null;if(n){if(typeof n=="string"&&n.trim())return n;if(typeof n.title=="string"&&n.title.trim())return n.title;if(typeof n.name=="string"&&n.name.trim())return n.name}return typeof c.text=="string"&&c.text.trim()?c.text:t&&typeof t.title=="string"&&t.title.trim()?t.title:null}function W(c,e){let t=String(c||"").toLowerCase(),n=String(e||"").toLowerCase();return t.localeCompare(n)}function oe(c,e){let t=typeof c=="number"?c:parseFloat(c),n=typeof e=="number"?e:parseFloat(e);return isNaN(t)&&isNaN(n)?0:isNaN(t)?1:isNaN(n)?-1:t-n}function de(c,e){let t=new Date(c),n=new Date(e);return isNaN(t.getTime())&&isNaN(n.getTime())?0:isNaN(t.getTime())?1:isNaN(n.getTime())?-1:t.getTime()-n.getTime()}function he(c,e,t){let n=c.option||c,r=e.option||e;if(!n||!r)return W(n?.name||"",r?.name||"");if(t.options&&Array.isArray(t.options)){let o=t.options.findIndex(a=>a.id===n.id||a.name===n.name),i=t.options.findIndex(a=>a.id===r.id||a.name===r.name);if(o!==-1&&i!==-1)return o-i}return W(n.name,r.name)}function be(c,e){let t=c.startDate||c.iteration?.startDate,n=e.startDate||e.iteration?.startDate;return!t&&!n?W(c.title||c.iteration?.title,e.title||e.iteration?.title):de(t,n)}function xe(c,e){let t=Array.isArray(c)?c:[],n=Array.isArray(e)?e:[];return t.length===0&&n.length===0?0:t.length===0?1:n.length===0?-1:W(t[0].name,n[0].name)}try{D("global","boardViewFetcher.loaded")}catch{}try{console.log&&console.log("boardViewFetcher script loaded")}catch{}function ve(){return function(c,e,t){let n=c&&(c.name||c.id)?c.name||c.id:"Board View";try{Q(e,n)}catch{}var r=50;function o(s,l){try{var p=s&&s.items||[],g=s&&s.fields||[],u=s&&s.allFields||g;e.innerHTML="",e.style.margin="0",e.style.padding="0",e.style.height="100%",e.style.display="flex",e.style.flexDirection="column",e.style.overflow="hidden";let _,f=te(e,t,{suffix:t,step:r,onLoadMore:function(){r+=50,d()},onSave:y=>{if(_!==void 0){try{let x=t?`ghProjects.table.${t}.sortConfig`:null;x&&(_===null?localStorage.removeItem(x):localStorage.setItem(x,JSON.stringify(_)))}catch{}_=void 0}},onDiscard:()=>{_!==void 0&&(_=void 0,d())}});try{if(l&&f&&typeof f.setEffectiveFilter=="function")try{f.setEffectiveFilter(l)}catch{}}catch{}if(!f){var b=document.createElement("div");b.style.display="flex",b.style.justifyContent="space-between",b.style.alignItems="center",b.style.marginBottom="8px";var v=document.createElement("div");v.style.fontWeight="600",v.style.padding="6px",v.textContent=n;var A=document.createElement("div"),M=X(()=>{r+=50,d()});A.appendChild(M),b.appendChild(v),b.appendChild(A),e.appendChild(b)}let h=null;try{let y=s&&s.details,x=y&&y.verticalGroupByFields&&y.verticalGroupByFields.nodes;if(x&&x.length>0){let N=x[0];if(h=u.find($=>String($.id)===String(N.id)||String($.name)===String(N.name)),h){let $=String(h.dataType||"").toLowerCase();$!=="single_select"&&$!=="iteration"&&(D(t,"boardViewFetcher.invalidColumnFieldType",{dataType:$,fieldName:h.name}),h=null)}}}catch(y){D(t,"boardViewFetcher.columnFieldDetection.error",{message:String(y?.message||y)})}h||(h=u.find(y=>String(y.dataType||"").toLowerCase()==="single_select"&&String(y.name||"").toLowerCase()==="status")),h||(h=u.find(y=>String(y.dataType||"").toLowerCase()==="single_select"));let E=null;try{let y=s&&s.details,x=y&&y.groupByFields&&y.groupByFields.nodes;if(x&&x.length>0){let N=x[0];E=u.find($=>String($.id)===String(N.id)||String($.name)===String(N.name))}}catch(y){D(t,"boardViewFetcher.swimlaneFieldDetection.error",{message:String(y?.message||y)})}var k=document.createElement("div");k.style.flex="1 1 auto",k.style.overflow="hidden",k.style.position="relative",k.style.display="flex",k.style.flexDirection="column";let L=y=>{if(f&&f.inputEl){let x=String(f.inputEl.value||"").trim(),N=x?`${x} ${y}`:y;f.inputEl.value=N,f.inputEl.dispatchEvent(new Event("input",{bubbles:!0}))}},w=ae(s&&s.details&&s.details.sortByFields);if(t)try{let y=localStorage.getItem(`ghProjects.table.${t}.sortConfig`);y&&(w=JSON.parse(y))}catch{}let S=p;w&&(S=le(p,u,w));let P=(y,x,N)=>{if(y==="open-menu"&&N){document.querySelectorAll(".board-context-menu").forEach(R=>R.remove());let I=document.createElement("div");I.className="board-context-menu",I.style.position="fixed";let T=Math.min(N.x,window.innerWidth-180),pe=Math.min(N.y,window.innerHeight-150);I.style.left=T+"px",I.style.top=pe+"px",I.style.background="var(--vscode-menu-background)",I.style.color="var(--vscode-menu-foreground)",I.style.border="1px solid var(--vscode-menu-border)",I.style.borderRadius="4px",I.style.zIndex="1000",I.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)",I.style.minWidth="160px",I.style.padding="4px 0";let U=(R,B,z,Y=!1)=>{if(Y){let H=document.createElement("div");H.style.height="1px",H.style.background="var(--vscode-menu-separatorBackground)",H.style.margin="4px 0",I.appendChild(H);return}let C=document.createElement("div");C.style.padding="4px 8px",C.style.cursor="pointer",C.style.display="flex",C.style.alignItems="center",C.style.gap="8px",C.style.fontSize="13px";let V=document.createElement("span");B&&(V.className="codicon codicon-"+B,B==="link-external"?V.textContent="\u2197":B==="globe"?V.textContent="\u{1F310}":B==="arrow-both"&&(V.textContent="\u21C4"));let q=document.createElement("span");q.textContent=R,C.appendChild(V),C.appendChild(q),C.addEventListener("click",H=>{H.stopPropagation(),I.remove(),z()}),C.addEventListener("mouseenter",()=>C.style.background="var(--vscode-menu-selectionBackground)"),C.addEventListener("mouseleave",()=>C.style.background="transparent"),I.appendChild(C)};U("Open issue","link-external",()=>{let R=x.content?.url||x.url||x.raw&&x.raw.itemContent&&x.raw.itemContent.url;R&&window.__APP_MESSAGING__&&window.__APP_MESSAGING__.postMessage({command:"openUrl",url:R})}),U("","",()=>{},!0),U("Move to column...","arrow-both",()=>{if(window.__APP_MESSAGING__){let R=[];if(h){let B=h.options||h.configuration&&h.configuration.options,z=h.configuration&&h.configuration.iterations,Y=(C,V)=>{try{let q=new Date(C),H=new Date(q.getTime()+Number(V)*24*60*60*1e3),ee=me=>me.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${ee(q)} \u2014 ${ee(H)}`}catch{return""}};B&&Array.isArray(B)?R=B.map(C=>({id:C.id,name:C.name,color:C.color,description:C.description})):z&&Array.isArray(z)&&(R=z.map(C=>({id:C.id,name:C.title,color:C.color,description:Y(C.startDate,C.duration)})))}window.__APP_MESSAGING__.postMessage({command:"moveItem",viewKey:t,itemId:x.id,projectId:s&&s.id,fieldId:h?h.id:null,options:R,currentValue:""})}}),document.body.appendChild(I);let K=()=>{I.remove(),document.removeEventListener("click",K)};setTimeout(()=>document.addEventListener("click",K),0)}else y==="add-item-to-column"&&x&&N&&Promise.resolve().then(()=>(ue(),ce)).then(({AddItemMenu:$})=>{new $({anchorElement:N.anchorElement,onCreateIssue:()=>{try{let T=window.__APP_MESSAGING__;T&&typeof T.postMessage=="function"&&T.postMessage({command:"addItem:createIssue",viewKey:t,projectId:s&&s.id,columnFieldId:x.columnFieldId,columnValueId:x.columnValueId,columnValueName:x.columnValueName})}catch(T){console.error("[boardViewFetcher] create-issue action failed",T)}},onAddFromRepo:()=>{try{let T=window.__APP_MESSAGING__;T&&typeof T.postMessage=="function"&&T.postMessage({command:"addItem:addFromRepo",viewKey:t,projectId:s&&s.id,columnFieldId:x.columnFieldId,columnValueId:x.columnValueId,columnValueName:x.columnValueName})}catch(T){console.error("[boardViewFetcher] add-from-repo action failed",T)}}}).show()}).catch($=>{console.error("Failed to load AddItemMenu",$)})};if(h)try{let y=g.map(N=>String(N.id));new j(u,S,y,L,P).renderBoard(k,h,E)}catch(y){D(t,"boardViewFetcher.cardRenderer.error",{message:String(y?.message||y)}),i(k,p)}else D(t,"boardViewFetcher.noColumnField",{fieldsCount:u.length}),i(k,p);e.appendChild(k);try{f&&typeof f.setCount=="function"&&f.setCount(p.length),f&&typeof f.setLoadState=="function"&&f.setLoadState(p.length<r,p.length>=r?"Load more":"All loaded"),f&&f.inputEl&&(typeof f.registerItems=="function"&&f.registerItems(p,{fields:g}),typeof f.onFilterChange=="function"&&f.onFilterChange(function(y,x){ne(e,"[data-gh-item-id]",y,"block"),f&&typeof f.setCount=="function"&&f.setCount(y.size),D(t,"filterInput",{filter:x,matched:y.size,original:p.length})}),typeof f.onSortChange=="function"&&f.onSortChange(y=>{_=y||null,f&&f.saveBtn&&f.discardBtn&&(f.saveBtn.disabled=!1,f.discardBtn.disabled=!1,f.saveBtn.style.opacity="1",f.saveBtn.style.cursor="pointer",f.discardBtn.style.opacity="1",f.discardBtn.style.cursor="pointer")}))}catch{}}catch(_){D(t,"boardViewFetcher.render.error",{message:String(_&&_.message),stack:_&&_.stack}),G(e,n,"Error rendering board view: "+String(_&&_.message))}}function i(s,l){for(var p=0;p<l.length;p++){var g=l[p],u=document.createElement("div");try{u.setAttribute("data-gh-item-id",String(g&&g.id))}catch{}u.style.padding="8px",u.style.border="1px solid var(--vscode-editorWidget-border)",u.style.marginBottom="8px",u.style.borderRadius="2px";var b=g&&g.content&&(g.content.title||g.content.name)||g&&g.title||g&&g.raw&&g.raw.title||"#"+(p+1);u.innerHTML='<div style="font-weight:600">'+m(b)+"</div>"+(g&&g.id?'<div style="color:var(--vscode-descriptionForeground);font-size:12px">'+m(String(g.id))+"</div>":""),s.appendChild(u)}}function a(s){var l=s&&s.data?s.data:s;try{if(l&&l.command==="fields"){if(l.viewKey&&t&&String(l.viewKey)!==String(t))return;l.error?G(e,n,String(l.error)):o(l.payload||l.payload&&l.payload.data||l.payload,l.effectiveFilter)}}catch{}}function d(){try{window.__APP_MESSAGING__&&typeof window.__APP_MESSAGING__.postMessage=="function"&&window.__APP_MESSAGING__.postMessage({command:"requestFields",first:r,viewKey:t})}catch{}}try{window.__APP_MESSAGING__.onMessage(a)}catch{window.addEventListener("message",a)}d()}}try{window.boardViewFetcher=ve()}catch{}})();
//# sourceMappingURL=boardViewFetcher.js.map
